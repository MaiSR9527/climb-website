<!DOCTYPE HTML>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE">
        <title> | </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GoBook 0.1">
        <meta name="HandheldFriendly" content="true">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        
        
    
</head>
<body>

<link rel="stylesheet" href="static/css/style.css">

<div class="book" data-level="0" data-basepath="." data-revision="1419950039633">

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control">
    </div>
    <ul class="summary">
        <li>
            <a href="index.html" target="blank" class="custom-link">返回书本首页</a>
        </li>
        <li class="divider"></li>
        <li>
        <ul>
<li><a href="index1.html">创建Orm引擎</a>

<ul>
<li><a href="1.engine.html">单库引擎</a></li>
<li><a href="2.engine_group.html">引擎组</a></li>
<li><a href="3.policy.html">引擎组策略</a></li>
</ul></li>
<li><a href="index2.html">定义表结构体</a>

<ul>
<li><a href="1.mapping.html">名称映射规则</a></li>
<li><a href="2.prefix.html">前缀映射，后缀映射和缓存映射</a></li>
<li><a href="3.tags.html">使用Table和Tag改变名称映射</a></li>
<li><a href="">Column属性定义</a></li>
<li><a href="5.types.html">Go与字段类型对应表</a></li>
</ul></li>
<li><a href="index3.html">表结构操作</a>

<ul>
<li><a href="1.metas.html">获取数据库信息</a></li>
<li><a href="2.tables.html">表操作</a></li>
<li><a href="3.indexes.html">创建索引和唯一索引</a></li>
<li><a href="4.sync.html">同步数据库结构</a></li>
<li><a href="5.dumpimport.html">导出导入SQL脚本</a></li>
</ul></li>
<li><a href="index4.html">插入数据</a>

<ul>
<li><a href="1.created.html">创建时间Created</a></li>
</ul></li>
<li><a href="index5.html">查询和统计数据</a>

<ul>
<li><a href="1.conditions.html">查询条件方法</a></li>
<li><a href="2.overrides.html">临时开关方法</a></li>
<li><a href="3.get.html">Get方法</a></li>
<li><a href="10.exist.html">Exist方法</a></li>
<li><a href="4.find.html">Find方法</a></li>
<li><a href="5.join.html">Join的使用</a></li>
<li><a href="6.iterate.html">Iterate方法</a></li>
<li><a href="7.count.html">Count方法</a></li>
<li><a href="8.rows.html">Rows方法</a></li>
<li><a href="9.sums.html">Sum系列方法</a></li>
</ul></li>
<li><a href="index6.html">更新数据</a>

<ul>
<li><a href="1.lock.html">乐观锁Version</a></li>
<li><a href="2.updated.html">更新时间Updated</a></li>
</ul></li>
<li><a href="index7.html">删除数据</a>

<ul>
<li><a href="1.deleted.html">软删除Deleted</a></li>
</ul></li>
<li><a href="index8.html">执行SQL查询</a></li>
<li><a href="index9.html">执行SQL命令</a></li>
<li><a href="index10.html">事务处理</a></li>
<li><a href="index11.html">缓存</a></li>
<li><a href="index12.html">事件</a></li>
<li><a href="index13.html">Reverse 工具</a></li>
<li><a href="index14.html">常见问题</a></li>
<li><a href="index15.html">案例</a></li>
</ul>

    </li>
        <li class="divider"></li>
        <li>
            <a href="index16.html" target="blank" class="gitbook-link">GoBook出品</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>

            <div class="buttons">
                <button type="button" id="reduce-font-size" class="button size-2">A</button>
                <button type="button" id="enlarge-font-size" class="button size-2">A</button>
            </div>

            <div class="buttons font-family-list">
                <button type="button" data-font="0" class="button">Serif</button>
                <button type="button" data-font="1" class="button">Sans</button>
            </div>

            <div class="buttons color-theme-list">
                <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
                <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
                <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
            </div>
        </div>
    </div>

    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
        </div>
    </div>

    
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="index2.html"></a>
    </h1>
</div>

    <div class="page-wrapper" tabindex="-1">
        <div class="page-inner">
            <section class="normal" id="section-gitbook_2">
            <h3>Column 属性定义</h3>

<p>我们在 field 对应的 Tag 中对 Column 的一些属性进行定义，定义的方法基本和我们写SQL定义表结构类似，比如：</p>

<pre><code class="language-go">type User struct {
    Id   int64
    Name string  `xorm:&quot;varchar(25) notnull unique 'usr_name' comment('姓名')&quot;`
}
</code></pre>

<p>对于不同的数据库系统，数据类型其实是有些差异的。因此xorm中对数据类型有自己的定义，基本的原则是尽量兼容各种数据库的字段类型，具体的字段对应关系可以查看<a href="javascript:;">字段类型对应表</a>。对于使用者，一般只要使用自己熟悉的数据库字段定义即可。</p>

<p>具体的 Tag 规则如下，另 Tag 中的关键字均不区分大小写，但字段名根据不同的数据库是区分大小写：</p>

<table>
    <tr>
        <td>name</td><td>当前field对应的字段的名称，可选，如不写，则自动根据field名字和转换规则命名，如与其它关键字冲突，请使用单引号括起来。</td>
    </tr>
    <tr>
        <td>pk</td><td>是否是Primary Key，如果在一个struct中有多个字段都使用了此标记，则这多个字段构成了复合主键，单主键当前支持int32,int,int64,uint32,uint,uint64,string这7种Go的数据类型，复合主键支持这7种Go的数据类型的组合。</td>
    </tr>
    <tr>
        <td>当前支持30多种字段类型，详情参见本文最后一个表格</td><td>字段类型</td>
    </tr>
    <tr>
        <td>autoincr</td><td>是否是自增</td>
    </tr>
    <tr>
        <td>[not ]null 或 notnull</td><td>是否可以为空</td>
    </tr>
    <tr>
        <td>unique或unique(uniquename)</td><td>是否是唯一，如不加括号则该字段不允许重复；如加上括号，则括号中为联合唯一索引的名字，此时如果有另外一个或多个字段和本unique的uniquename相同，则这些uniquename相同的字段组成联合唯一索引</td>
    </tr>
    <tr>
        <td>index或index(indexname)</td><td>是否是索引，如不加括号则该字段自身为索引，如加上括号，则括号中为联合索引的名字，此时如果有另外一个或多个字段和本index的indexname相同，则这些indexname相同的字段组成联合索引</td>
    </tr>
    <tr>
        <td>extends</td><td>应用于一个匿名成员结构体或者非匿名成员结构体之上，表示此结构体的所有成员也映射到数据库中，extends可加载无限级</td>
    </tr>
    <tr>
        <td>-</td><td>这个Field将不进行字段映射</td>
    </tr>
     <tr>
        <td>-></td><td>这个Field将只写入到数据库而不从数据库读取</td>
    </tr>
     <tr>
        <td>&lt;-</td><td>这个Field将只从数据库读取，而不写入到数据库</td>
    </tr>
     <tr>
        <td>created</td><td>这个Field将在Insert时自动赋值为当前时间</td>
    </tr>
     <tr>
        <td>updated</td><td>这个Field将在Insert或Update时自动赋值为当前时间</td>
    </tr>
    <tr>
        <td>deleted</td><td>这个Field将在Delete时设置为当前时间，并且当前记录不删除</td>
    </tr>
     <tr>
        <td>version</td><td>这个Field将会在insert时默认为1，每次更新自动加1</td>
    </tr>
    <tr>
        <td>default 0或default(0)</td><td>设置默认值，紧跟的内容如果是Varchar等需要加上单引号</td>
    </tr>
    <tr>
        <td>json</td><td>表示内容将先转成Json格式，然后存储到数据库中，数据库中的字段类型可以为Text或者二进制</td>
    </tr>
    <tr>
        <td>comment</td><td>设置字段的注释（当前仅支持mysql）</td>
    </tr>
</table>

<p>另外有如下几条自动映射的规则：</p>

<ul>
<li><p>1.如果field名称为<code>Id</code>而且类型为<code>int64</code>并且没有定义tag，则会被xorm视为主键，并且拥有自增属性。如果想用<code>Id</code>以外的名字或非int64类型做为主键名，必须在对应的Tag上加上<code>xorm:&quot;pk&quot;</code>来定义主键，加上<code>xorm:&quot;autoincr&quot;</code>作为自增。这里需要注意的是，有些数据库并不允许非主键的自增属性。</p></li>

<li><p>2.string类型默认映射为<code>varchar(255)</code>，如果需要不同的定义，可以在tag中自定义，如：<code>varchar(1024)</code></p></li>

<li><p>3.支持<code>type MyString string</code>等自定义的field，支持Slice, Map等field成员，这些成员默认存储为Text类型，并且默认将使用Json格式来序列化和反序列化。也支持数据库字段类型为Blob类型。如果是Blob类型，则先使用Json格式序列化再转成[]byte格式。如果是[]byte或者[]uint8，则不做转换二十直接以二进制方式存储。具体参见 <a href="javascript:;">Go与字段类型对应表</a></p></li>

<li><p>4.实现了Conversion接口的类型或者结构体，将根据接口的转换方式在类型和数据库记录之间进行相互转换，这个接口的优先级是最高的。</p></li>
</ul>

<pre><code class="language-Go">type Conversion interface {
    FromDB([]byte) error
    ToDB() ([]byte, error)
}
</code></pre>

<ul>
<li>5.如果一个结构体包含一个 Conversion 的接口类型，那么在获取数据时，必须要预先设置一个实现此接口的struct或者struct的指针。此时可以在此struct中实现<code>BeforeSet(name string, cell xorm.Cell)</code>方法来进行预先给Conversion赋值。例子参见 <a href="javascript:;">testConversion</a></li>
</ul>

<p>下表为xorm类型和各个数据库类型的对应表：</p>

<table>
    <tr>
    <td>xorm
    </td>
    <td>mysql
    </td>
    <td>sqlite3
    </td>
    <td>postgres
    </td>
    <td>remark</td>
    </tr>

    <tr>
    <td>BIT
    </td>
    <td>BIT
    </td>
    <td>INTEGER
    </td>
    <td>BIT
    </td>
    <td></td>
    </tr>
    
    <tr>
    <td>TINYINT
    </td>
    <td>TINYINT
    </td>
    <td>INTEGER
    </td>
    <td>SMALLINT
    </td>
    <td></td>
    </tr>


<tr>
    <td>SMALLINT
    </td>
    <td>SMALLINT
    </td>
    <td>INTEGER
    </td>
    <td>SMALLINT
    </td>
    <td></td>
    </tr>


<tr>
    <td>MEDIUMINT
    </td>
    <td>MEDIUMINT
    </td>
    <td>INTEGER
    </td>
    <td>INTEGER
    </td>
    <td></td>
    </tr>


<tr>
    <td>INT
    </td>
    <td>INT
    </td>
    <td>INTEGER
    </td>
    <td>INTEGER
    </td>
    <td></td>
    </tr>

<tr>
    <td>INTEGER
    </td>
    <td>INTEGER
    </td>
    <td>INTEGER
    </td>
    <td>INTEGER
    </td>
    <td></td>
    </tr>


<tr>
    <td>BIGINT
    </td>
    <td>BIGINT
    </td>
    <td>INTEGER
    </td>
    <td>BIGINT
    </td>
    <td></td>
    </tr>
 <tr><td cols="5"></td></tr>

<tr>
    <td>CHAR
    </td>
    <td>CHAR
    </td>
    <td>TEXT
    </td>
    <td>CHAR
    </td>
    <td></td>
    </tr>


<tr>
    <td>VARCHAR
    </td>
    <td>VARCHAR
    </td>
    <td>TEXT
    </td>
    <td>VARCHAR
    </td>
    <td></td>
    </tr>


<tr>
    <td>TINYTEXT
    </td>
    <td>TINYTEXT
    </td>
    <td>TEXT
    </td>
    <td>TEXT
    </td>
    <td></td>
    </tr>

<tr>
    <td>TEXT
    </td>
    <td>TEXT
    </td>
    <td>TEXT
    </td>
    <td>TEXT
    </td>
    <td></td>
    </tr>

<tr>
    <td>MEDIUMTEXT
    </td>
    <td>MEDIUMTEXT
    </td>
    <td>TEXT
    </td>
    <td>TEXT
    </td>
    <td></td>
    </tr>


<tr>
    <td>LONGTEXT
    </td>
    <td>LONGTEXT
    </td>
    <td>TEXT
    </td>
    <td>TEXT
    </td>
    <td></td>
    </tr>
<tr><td cols="5"></td></tr>

<tr>
    <td>BINARY
    </td>
    <td>BINARY
    </td>
    <td>BLOB
    </td>
    <td>BYTEA
    </td>
    <td></td>
    </tr>


<tr>
    <td>VARBINARY
    </td>
    <td>VARBINARY
    </td>
    <td>BLOB
    </td>
    <td>BYTEA
    </td>
    <td></td>
    </tr>
<tr><td cols="5"></td></tr>

<tr>
    <td>DATE
    </td>
    <td>DATE
    </td>
    <td>NUMERIC
    </td>
    <td>DATE
    </td>
    <td></td>
    </tr>


<tr>
    <td>DATETIME
    </td>
    <td>DATETIME
    </td>
    <td>NUMERIC
    </td>
    <td>TIMESTAMP
    </td>
    <td></td>
    </tr>


<tr>
    <td>TIME
    </td>
    <td>TIME
    </td>
    <td>NUMERIC
    </td>
    <td>TIME
    </td>
    <td></td>
    </tr>


<tr>
    <td>TIMESTAMP
    </td>
    <td>TIMESTAMP
    </td>
    <td>NUMERIC
    </td>
    <td>TIMESTAMP
    </td>
    <td></td>
    </tr>


<tr>
    <td>TIMESTAMPZ
    </td>
    <td>TEXT
    </td>
    <td>TEXT
    </td>
    <td>TIMESTAMP with zone
    </td>
    <td>timestamp with zone info</td>
    </tr>

<tr><td cols="5"></td></tr>
<tr>
    <td>REAL
    </td>
    <td>REAL
    </td>
    <td>REAL
    </td>
    <td>REAL
    </td>
    <td></td>
    </tr>


<tr>
    <td>FLOAT
    </td>
    <td>FLOAT
    </td>
    <td>REAL
    </td>
    <td>REAL
    </td>
    <td></td>
    </tr>


<tr>
    <td>DOUBLE
    </td>
    <td>DOUBLE
    </td>
    <td>REAL
    </td>
    <td>DOUBLE PRECISION
    </td>
    <td></td>
    </tr>

<tr><td cols="5"></td></tr>
<tr>
    <td>DECIMAL
    </td>
    <td>DECIMAL
    </td>
    <td>NUMERIC
    </td>
    <td>DECIMAL
    </td>
    <td></td>
    </tr>


<tr>
    <td>NUMERIC
    </td>
    <td>NUMERIC
    </td>
    <td>NUMERIC
    </td>
    <td>NUMERIC
    </td>
    <td></td>
    </tr>

<tr><td cols="5"></td></tr>
<tr>
    <td>TINYBLOB
    </td>
    <td>TINYBLOB
    </td>
    <td>BLOB
    </td>
    <td>BYTEA
    </td>
    <td></td>
    </tr>


<tr>
    <td>BLOB
    </td>
    <td>BLOB
    </td>
    <td>BLOB
    </td>
    <td>BYTEA
    </td>
    <td></td>
    </tr>


<tr>
    <td>MEDIUMBLOB
    </td>
    <td>MEDIUMBLOB
    </td>
    <td>BLOB
    </td>
    <td>BYTEA
    </td>
    <td></td>
    </tr>


<tr>
    <td>LONGBLOB
    </td>
    <td>LONGBLOB
    </td>
    <td>BLOB
    </td>
    <td>BYTEA
    </td>
    <td></td>
    </tr>

<tr>
    <td>BYTEA
    </td>
    <td>BLOB
    </td>
    <td>BLOB
    </td>
    <td>BYTEA
    </td>
    <td></td>
    </tr>

<tr><td cols="5"></td></tr>

<tr>
    <td>BOOL
    </td>
    <td>TINYINT
    </td>
    <td>INTEGER
    </td>
    <td>BOOLEAN
    </td>
    <td></td>
    </tr>


<tr>
    <td>SERIAL
    </td>
    <td>INT
    </td>
    <td>INTEGER
    </td>
    <td>SERIAL
    </td>
    <td>auto increment</td>
    </tr>

<tr>
    <td>BIGSERIAL
    </td>
    <td>BIGINT
    </td>
    <td>INTEGER
    </td>
    <td>BIGSERIAL
    </td>
    <td>auto increment</td>
    </tr>

</table>

            </section>
        </div>
    </div>
</div>

        

    </div>
</div>

<script src="static/js/app.js"></script>

    

    <script src="static/js/plugin.js"></script>



    </body>
</html>
