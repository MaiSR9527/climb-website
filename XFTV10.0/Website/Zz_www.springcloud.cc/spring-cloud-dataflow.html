<!DOCTYPE html><html lang="zh-CN"><head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<meta name="author" content="Sabby Anandan, Marius Bogoevici, Eric Bottard, Mark Fisher, Ilayaperumal Gopinathan, Gunnar Hillert, Mark Pollack, Patrick Peralta, Glenn Renfro, Thomas Risberg, Dave Syer, David Turanski, Janne Valkealahti, Oleg Zhurakousky, Jay Bryant, Vinicius Carvalho, Chris Schaefer">
<title>Spring Cloud Data Flow 中文文档 参考手册 中文版</title>
<link rel="stylesheet" href="static/css/css-OpenSans300300italic400400it.css">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="static/css/font-awesome.min1.css">
<style>
  #tocbot a.toc-link.node-name--H1{ font-style: italic }
  @media screen{
    #tocbot > ul.toc-list{ margin-bottom: 0.5em; margin-left: 0.125em }
    #tocbot ul.sectlevel0, #tocbot a.toc-link.node-name--H1 + ul{
      padding-left: 0 }
    #tocbot a.toc-link{ height:100% }
    .is-collapsible{ max-height:3000px; overflow:hidden; }
    .is-collapsed{ max-height:0 }
    .is-active-link{ font-weight:700 }
  }
  @media print{
    #tocbot a.toc-link.node-name--H4{ display:none }
  }
</style>
<link type="text/css" rel="stylesheet" href="static/css/springcloud.min.css"><script type="text/javascript" src="static/js/springcloud.min.js"></script></head>
<body class="book toc2 toc-left">
<div id="header">
<h1><font o="1">Spring Cloud Data Flow参考指南</font></h1>
<div class="details">
<span id="author" class="author"><font o="2">Sabby Anandan </font></span><br>
<span id="author2" class="author"><font o="2">Marius Bogoevici </font></span><br>
<span id="author3" class="author"><font o="2">Eric Bottard </font></span><br>
<span id="author4" class="author"><font o="2">Mark Fisher </font></span><br>
<span id="author5" class="author"><font o="2">Ilayaperumal Gopinathan </font></span><br>
<span id="author6" class="author"><font o="2">Gunnar Hillert </font></span><br>
<span id="author7" class="author"><font o="2">Mark Pollack </font></span><br>
<span id="author8" class="author"><font o="2">Patrick Peralta </font></span><br>
<span id="author9" class="author"><font o="2">Glenn Renfro </font></span><br>
<span id="author10" class="author"><font o="2">Thomas Risberg </font></span><br>
<span id="author11" class="author"><font o="2">Dave Syer </font></span><br>
<span id="author12" class="author"><font o="2">David Turanski </font></span><br>
<span id="author13" class="author"><font o="2">Janne </font></span><br>
<span id="author14" class="author"><font o="2">Valkealahti Oleg Zhurakousky </font></span><br>
<span id="author15" class="author"><font o="2">Jay Bryant </font></span><br>
<span id="author16" class="author"><font o="2">Vinicius Carvalho </font></span><br>
<span id="author17" class="author"><font o="2">Chris Schaefer</font></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle"><font o="3">目录</font></div>
<div id="tocbot" class="js-toc"><ul class="toc-list "><li class="toc-list-item"><a href="#preface" class="toc-link node-name--H1">前言</a><ul class="toc-list  is-collapsible"><li class="toc-list-item"><a href="#dataflow-documentation-about" class="toc-link node-name--H2 ">1.关于文档</a></li><li class="toc-list-item"><a href="#dataflow-documentation-getting-help" class="toc-link node-name--H2 ">2.获得帮助</a></li></ul></li><li class="toc-list-item"><a href="#getting-started" class="toc-link node-name--H1 ">入门</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#getting-started-system-requirements" class="toc-link node-name--H2 ">3.系统要求</a></li><li class="toc-list-item"><a href="#getting-started-deploying-spring-cloud-dataflow-docker" class="toc-link node-name--H2 ">4. Docker Compose入门</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#getting-started-customizing-spring-cloud-dataflow-docker" class="toc-link node-name--H3 ">4.1.Docker撰写自定义</a></li></ul></li><li class="toc-list-item"><a href="#getting-started-deploying-spring-cloud-dataflow" class="toc-link node-name--H2 ">5.手动安装入门</a></li><li class="toc-list-item"><a href="#getting-started-deploying-streams-spring-cloud-dataflow" class="toc-link node-name--H2 ">6.部署Streams</a></li><li class="toc-list-item"><a href="#_deploying_tasks" class="toc-link node-name--H2 ">7.部署任务</a></li></ul></li><li class="toc-list-item"><a href="#applications" class="toc-link node-name--H1 ">应用</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_available_applications" class="toc-link node-name--H2 ">8.可用应用程序</a></li></ul></li><li class="toc-list-item"><a href="#architecture" class="toc-link node-name--H1 ">架构</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#arch-intro" class="toc-link node-name--H2 ">9.简介</a></li><li class="toc-list-item"><a href="#arch-microservice-style" class="toc-link node-name--H2 ">10.微服务架构风格</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#arch-comparison" class="toc-link node-name--H3 ">10.1.与其他平台架构的比较</a></li></ul></li><li class="toc-list-item"><a href="#arch-data-flow-server" class="toc-link node-name--H2 ">11.数据流服务器</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#arch-data-flow-server-endpoints" class="toc-link node-name--H3 ">11.1.端点</a></li><li class="toc-list-item"><a href="#arch-data-flow-server-security" class="toc-link node-name--H3 ">11.2.安全</a></li></ul></li><li class="toc-list-item"><a href="#arch-streams" class="toc-link node-name--H2 ">12.流</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#arch-streams-topologies" class="toc-link node-name--H3 ">12.1.拓扑</a></li><li class="toc-list-item"><a href="#arch-streams-concurrency" class="toc-link node-name--H3 ">12.2.并发</a></li><li class="toc-list-item"><a href="#arch-streams-partitioning" class="toc-link node-name--H3 ">12.3.分区</a></li><li class="toc-list-item"><a href="#arch-streams-delivery" class="toc-link node-name--H3 ">12.4.消息传递保证</a></li></ul></li><li class="toc-list-item"><a href="#arch-streaming-apps" class="toc-link node-name--H2 ">13.流编程模型</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#arch-streaming-imperative-programming" class="toc-link node-name--H3 ">13.1.命令式编程模型</a></li><li class="toc-list-item"><a href="#arch-streaming-functional-programming" class="toc-link node-name--H3 ">13.2.功能编程模型</a></li></ul></li><li class="toc-list-item"><a href="#arch-application-versioning" class="toc-link node-name--H2 ">14.应用程序版本控制</a></li><li class="toc-list-item"><a href="#arch-task" class="toc-link node-name--H2 ">15.任务编程模型</a></li><li class="toc-list-item"><a href="#arch-analytics" class="toc-link node-name--H2 ">16.分析</a></li><li class="toc-list-item"><a href="#arch-runtime" class="toc-link node-name--H2 ">17.运行时</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#arch-runtime-fault-tolerance" class="toc-link node-name--H3 ">17.1.容错</a></li><li class="toc-list-item"><a href="#arch-runtime-resource-management" class="toc-link node-name--H3 ">17.2.资源管理</a></li><li class="toc-list-item"><a href="#arch-runtime-scaling" class="toc-link node-name--H3 ">17.3.在运行时缩放</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#configuration" class="toc-link node-name--H1 ">组态</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#enable-disable-specific-features" class="toc-link node-name--H2 ">18.功能切换</a></li><li class="toc-list-item"><a href="#configuration-rdbms" class="toc-link node-name--H2 ">19.数​​据库</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_disabling_database_schema_creation_and_migration_strategies" class="toc-link node-name--H3 ">19.1.禁用数据库架构创建和迁移策略</a></li><li class="toc-list-item"><a href="#_adding_a_custom_jdbc_driver" class="toc-link node-name--H3 ">19.2.添加自定义JDBC驱动程序</a></li></ul></li><li class="toc-list-item"><a href="#configuration-deployer" class="toc-link node-name--H2 ">20.当地部署人员</a></li><li class="toc-list-item"><a href="#configuration-maven" class="toc-link node-name--H2 ">21. Maven</a></li><li class="toc-list-item"><a href="#configuration-logging" class="toc-link node-name--H2 ">22.本地数据流服务器日志记录配置</a></li><li class="toc-list-item"><a href="#configuration-skipper" class="toc-link node-name--H2 ">23.船长</a></li><li class="toc-list-item"><a href="#configuration-security" class="toc-link node-name--H2 ">24.安全</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#configuration-security-enabling-https" class="toc-link node-name--H3 ">24.1.启用HTTPS</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#configuration-security-self-signed-certificates" class="toc-link node-name--H4 ">24.1.1.使用自签名证书</a></li><li class="toc-list-item"><a href="#configuration-security-self-signed-certificates-shell" class="toc-link node-name--H4 ">24.1.2.自签证书和壳牌</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_adding_the_self_signed_certificate_to_the_jvm_truststore" class="toc-link node-name--H5 ">将自签名证书添加到JVM信任库</a></li><li class="toc-list-item"><a href="#_skipping_certificate_validation" class="toc-link node-name--H5 ">跳过证书验证</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#configuration-security-basic-authentication" class="toc-link node-name--H3 ">24.2.传统认证</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#configuration-security-single-user-authentication" class="toc-link node-name--H4 ">24.2.1.单用户身份验证</a></li><li class="toc-list-item"><a href="#configuration-security-file-based-authentication" class="toc-link node-name--H4 ">24.2.2.基于文件的身份验证</a></li><li class="toc-list-item"><a href="#configuration-security-ldap-authentication" class="toc-link node-name--H4 ">24.2.3.LDAP身份验证</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_ldap_role_mapping" class="toc-link node-name--H5 ">LDAP角色映射</a></li><li class="toc-list-item"><a href="#_ldap_transport_security" class="toc-link node-name--H5 ">LDAP传输安全性</a></li></ul></li><li class="toc-list-item"><a href="#configuration-security-authentication-via-shell" class="toc-link node-name--H4 ">24.2.4.Shell身份验证</a></li><li class="toc-list-item"><a href="#customizing-authorization" class="toc-link node-name--H4 ">24.2.5.自定义授权</a></li><li class="toc-list-item"><a href="#authorization-shell-and-dashboard" class="toc-link node-name--H4 ">24.2.6.授权 -  Shell和Dashboard行为</a></li><li class="toc-list-item"><a href="#ldap-authorization-and-roles" class="toc-link node-name--H4 ">24.2.7.使用LDAP授权</a></li></ul></li><li class="toc-list-item"><a href="#configuration-security-oauth2" class="toc-link node-name--H3 ">24.3.OAuth 2.0</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#configuration-security-oauth2-authorization" class="toc-link node-name--H4 ">24.3.1.OAuth REST端点授权</a></li><li class="toc-list-item"><a href="#configuration-security-oauth2-shell" class="toc-link node-name--H4 ">24.3.2.使用Spring Cloud Data Flow Shell进行OAuth身份验证</a></li><li class="toc-list-item"><a href="#_oauth2_authentication_examples" class="toc-link node-name--H4 ">24.3.3.OAuth2身份验证示例</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#oauth2-examples-local" class="toc-link node-name--H5 ">本地OAuth2服务器</a></li><li class="toc-list-item"><a href="#oauth2-examples-github" class="toc-link node-name--H5 ">使用GitHub进行身份验证</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#_securing_the_spring_boot_management_endpoints" class="toc-link node-name--H3 ">24.4.保护Spring Boot管理端点</a></li></ul></li><li class="toc-list-item"><a href="#configuration-monitoring-management" class="toc-link node-name--H2 ">25.监测和管理</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#configuration-monitoring-deployed-applications" class="toc-link node-name--H3 ">25.1.监控已部署的流应用程序</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_using_the_metrics_collector" class="toc-link node-name--H4 ">25.1.1.使用Metrics Collector</a></li><li class="toc-list-item"><a href="#_spring_boot_2_x" class="toc-link node-name--H4 ">25.1.2.Spring Boot 2.x</a></li><li class="toc-list-item"><a href="#_spring_boot_1_x" class="toc-link node-name--H4 ">25.1.3.Spring Boot 1.x</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#_about_configuration" class="toc-link node-name--H2 ">26.关于配置</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_enabling_shell_checksum_values" class="toc-link node-name--H3 ">26.1.启用S​​hell Checksum值</a></li><li class="toc-list-item"><a href="#_reserved_values_for_urls" class="toc-link node-name--H3 ">26.2.URL的保留值</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#shell" class="toc-link node-name--H1 ">Shell</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#shell-options" class="toc-link node-name--H2 ">27. Shell选项</a></li><li class="toc-list-item"><a href="#shell-commands" class="toc-link node-name--H2 ">28.列出可用命令</a></li><li class="toc-list-item"><a href="#shell-tab-completion" class="toc-link node-name--H2 ">29.标签完成</a></li><li class="toc-list-item"><a href="#shell-white-space" class="toc-link node-name--H2 ">30.白色空间和报价规则</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#dsl-quotes-escaping" class="toc-link node-name--H3 ">30.1.行情和逃避</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_shell_rules" class="toc-link node-name--H4 ">30.1.1.壳牌规则</a></li><li class="toc-list-item"><a href="#_property_files_rules" class="toc-link node-name--H4 ">30.1.2.属性文件规则</a></li><li class="toc-list-item"><a href="#_dsl_parsing_rules" class="toc-link node-name--H4 ">30.1.3.DSL解析规则</a></li><li class="toc-list-item"><a href="#_spel_syntax_and_spel_literals" class="toc-link node-name--H4 ">30.1.4.SpEL语法和SpEL文字</a></li><li class="toc-list-item"><a href="#_putting_it_all_together" class="toc-link node-name--H4 ">30.1.5.把它放在一起</a></li></ul></li></ul></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-streams" class="toc-link node-name--H1 ">流</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-intro" class="toc-link node-name--H2 ">31.简介</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-intro-dsl" class="toc-link node-name--H3 ">31.1.流管道DSL</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-app-dsl" class="toc-link node-name--H3 ">31.2.流应用程序DSL</a></li><li class="toc-list-item"><a href="#_application_properties" class="toc-link node-name--H3 ">31.3.应用属性</a></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-lifecycle" class="toc-link node-name--H2 ">32.流生命周期</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#spring-cloud-dataflow-register-stream-apps" class="toc-link node-name--H3 ">32.1.注册流应用程序</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#supported-apps-and-tasks" class="toc-link node-name--H4 ">32.1.1.注册支持的应用和任务</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-app-whitelisting" class="toc-link node-name--H4 ">32.1.2.白名单应用程序属性</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-app-metadata-artifact" class="toc-link node-name--H4 ">32.1.3.创建和使用专用元数据工件</a></li><li class="toc-list-item"><a href="#_using_the_companion_artifact" class="toc-link node-name--H4 ">32.1.4.使用Companion Artifact</a></li><li class="toc-list-item"><a href="#custom-applications" class="toc-link node-name--H4 ">32.1.5.创建定制应用程序</a></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-create-stream" class="toc-link node-name--H3 ">32.2.创建流</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_application_properties_2" class="toc-link node-name--H4 ">32.2.1.申请Properties</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-global-properties" class="toc-link node-name--H4 ">32.2.2.共同申请Properties</a></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-deploy-stream" class="toc-link node-name--H3 ">32.3.部署流</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_deployment_properties" class="toc-link node-name--H4 ">32.3.1.部署Properties</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_passing_instance_count" class="toc-link node-name--H5 ">传递实例计数</a></li><li class="toc-list-item"><a href="#_inline_versus_file_based_properties" class="toc-link node-name--H5 ">内联与基于文件的Properties</a></li><li class="toc-list-item"><a href="#_passing_application_properties" class="toc-link node-name--H5 ">传递应用程序属性</a></li><li class="toc-list-item"><a href="#passing_producer_consumer_properties" class="toc-link node-name--H5 ">传递Spring Cloud Stream属性</a></li><li class="toc-list-item"><a href="#_passing_per_binding_producer_and_consumer_properties" class="toc-link node-name--H5 ">传递每个绑定生产者和消费者Properties</a></li><li class="toc-list-item"><a href="#passing_stream_partition_properties" class="toc-link node-name--H5 ">通过流分区Properties</a></li><li class="toc-list-item"><a href="#passing_content_type_properties" class="toc-link node-name--H5 ">传递应用程序内容类型属性</a></li><li class="toc-list-item"><a href="#_overriding_application_properties_during_stream_deployment" class="toc-link node-name--H5 ">在流部署期间覆盖应用程序Properties</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-destroy-stream" class="toc-link node-name--H3 ">32.4.摧毁一条小溪</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-undeploy-stream" class="toc-link node-name--H3 ">32.5.取消部署流</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-validate-stream" class="toc-link node-name--H3 ">32.6.验证流</a></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-lifecycle-skipper" class="toc-link node-name--H2 ">33.船长生命周期与船长</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_register_a_versioned_stream_app" class="toc-link node-name--H3 ">33.1.注册Versioned Stream应用程序</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-lifecycle-skipper-create" class="toc-link node-name--H3 ">33.2.创建和部署流</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-lifecycle-skipper-update" class="toc-link node-name--H3 ">33.3.更新流</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-lifecycle-skipper-force-update" class="toc-link node-name--H3 ">33.4.强制更新流</a></li><li class="toc-list-item"><a href="#_stream_versions" class="toc-link node-name--H3 ">33.5.流版本</a></li><li class="toc-list-item"><a href="#_stream_manifests" class="toc-link node-name--H3 ">33.6.流清单</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-lifecycle-skipper-rollback" class="toc-link node-name--H3 ">33.7.回滚流</a></li><li class="toc-list-item"><a href="#_application_count" class="toc-link node-name--H3 ">33.8.申请数量</a></li><li class="toc-list-item"><a href="#_skipper_s_upgrade_strategy" class="toc-link node-name--H3 ">33.9.船长的升级策略</a></li></ul></li><li class="toc-list-item"><a href="#_stream_dsl" class="toc-link node-name--H2 ">34.流DSL</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-dsl-tap" class="toc-link node-name--H3 ">34.1.点按一个流</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-dsl-labels" class="toc-link node-name--H3 ">34.2.在流中使用标签</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-dsl-named-destinations" class="toc-link node-name--H3 ">34.3.命名目的地</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-dsl-fanin-fanout" class="toc-link node-name--H3 ">34.4.扇入和扇出</a></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-java-dsl" class="toc-link node-name--H2 ">35.流Java DSL</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_overview" class="toc-link node-name--H3 ">35.1.概观</a></li><li class="toc-list-item"><a href="#_java_dsl_styles" class="toc-link node-name--H3 ">35.2.Java DSL样式</a></li><li class="toc-list-item"><a href="#_using_the_deploymentpropertiesbuilder" class="toc-link node-name--H3 ">35.3.使用DeploymentPropertiesBuilder</a></li><li class="toc-list-item"><a href="#_deploying_using_skipper" class="toc-link node-name--H3 ">35.4.使用Skipper进行部署</a></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-multi-binder" class="toc-link node-name--H2 ">36.使用多个Binder配置流应用程序</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-examples" class="toc-link node-name--H2 ">37.例子</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#spring-cloud-dataflow-simple-stream" class="toc-link node-name--H3 ">37.1.简单的流处理</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-partitions" class="toc-link node-name--H3 ">37.2.有状态流处理</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-stream-app-types" class="toc-link node-name--H3 ">37.3.其他源和接收器应用程序类型</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-streams-skipper" class="toc-link node-name--H1 ">带船长的流</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#spring-cloud-dataflow-streams-skipper-upgrading" class="toc-link node-name--H2 ">38.升级</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_force_upgrade_of_a_stream" class="toc-link node-name--H3 ">38.1.强制升级流</a></li><li class="toc-list-item"><a href="#_overriding_properties_during_stream_update" class="toc-link node-name--H3 ">38.2.在Stream更新期间覆盖属性</a></li><li class="toc-list-item"><a href="#_stream_history" class="toc-link node-name--H3 ">38.3.流历史</a></li><li class="toc-list-item"><a href="#_stream_manifest" class="toc-link node-name--H3 ">38.4.流清单</a></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-streams-skipper-rollback" class="toc-link node-name--H2 ">39.回滚</a></li></ul></li><li class="toc-list-item"><a href="#streams-dev-guide" class="toc-link node-name--H1 ">流开发者指南</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#streams-dev-guide-prebuilt-apps" class="toc-link node-name--H2 ">40.预建应用程序</a></li><li class="toc-list-item"><a href="#streams-dev-guiderunning-prebuilt-apps" class="toc-link node-name--H2 ">41.运行预建应用程序</a></li><li class="toc-list-item"><a href="#_custom_processor_application" class="toc-link node-name--H2 ">42.定制处理器应用程序</a></li><li class="toc-list-item"><a href="#_improving_the_quality_of_service" class="toc-link node-name--H2 ">43.提高服务质量</a></li><li class="toc-list-item"><a href="#_mapping_applications_onto_data_flow" class="toc-link node-name--H2 ">44.将应用程序映射到数据流</a></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-task" class="toc-link node-name--H1 ">任务</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#spring-cloud-dataflow-task-intro" class="toc-link node-name--H2 ">45.导言</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_application_properties_3" class="toc-link node-name--H3 ">45.1.应用属性</a></li></ul></li><li class="toc-list-item"><a href="#_the_lifecycle_of_a_task" class="toc-link node-name--H2 ">46.任务的生命周期</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#spring-cloud-dataflow-create-task-apps" class="toc-link node-name--H3 ">46.1.创建任务应用程序</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_task_database_configuration" class="toc-link node-name--H4 ">46.1.1.任务数据库配置</a></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-register-task-apps" class="toc-link node-name--H3 ">46.2.注册任务应用程序</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-create-task-definition" class="toc-link node-name--H3 ">46.3.创建任务定义</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-task-launch" class="toc-link node-name--H3 ">46.4.启动任务</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_common_application_properties" class="toc-link node-name--H4 ">46.4.1.常见的应用属性</a></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-task-limit-concurrent-executions" class="toc-link node-name--H3 ">46.5.限制并发任务启动的数量</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-task-review-executions" class="toc-link node-name--H3 ">46.6.检查任务执行</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-task-definition-destroying" class="toc-link node-name--H3 ">46.7.销毁任务定义</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-validate-task" class="toc-link node-name--H3 ">46.8.验证任务</a></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-task-events" class="toc-link node-name--H2 ">47.订阅任务/批次Events</a></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-composed-tasks" class="toc-link node-name--H2 ">48.组成的任务</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_configuring_the_composed_task_runner" class="toc-link node-name--H3 ">48.1.配置组合任务运行器</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_registering_the_composed_task_runner" class="toc-link node-name--H4 ">48.1.1.注册Composed Task Runner</a></li><li class="toc-list-item"><a href="#_configuring_the_composed_task_runner_2" class="toc-link node-name--H4 ">48.1.2.配置组合任务运行器</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_configuration_options" class="toc-link node-name--H5 ">配置选项</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#_the_lifecycle_of_a_composed_task" class="toc-link node-name--H3 ">48.2.组合任务的生命周期</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#spring-cloud-data-flow-composed-task-creating" class="toc-link node-name--H4 ">48.2.1.创建组合任务</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_task_application_parameters" class="toc-link node-name--H5 ">任务应用参数</a></li></ul></li><li class="toc-list-item"><a href="#_launching_a_composed_task" class="toc-link node-name--H4 ">48.2.2.启动组合任务</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_passing_properties_to_the_child_tasks" class="toc-link node-name--H5 ">将属性传递给子任务</a></li><li class="toc-list-item"><a href="#_passing_arguments_to_the_composed_task_runner" class="toc-link node-name--H5 ">将参数传递给组合任务运行器</a></li><li class="toc-list-item"><a href="#_exit_statuses" class="toc-link node-name--H5 ">退出状态</a></li></ul></li><li class="toc-list-item"><a href="#_destroying_a_composed_task" class="toc-link node-name--H4 ">48.2.3.破坏组合任务</a></li><li class="toc-list-item"><a href="#spring-cloud-data-flow-composed-task-stopping" class="toc-link node-name--H4 ">48.2.4.停止组合任务</a></li><li class="toc-list-item"><a href="#spring-cloud-data-flow-composed-task-restarting" class="toc-link node-name--H4 ">48.2.5.重新启动组合任务</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#_composed_tasks_dsl" class="toc-link node-name--H2 ">49.组成的任务DSL</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#spring-cloud-data-flow-conditional-execution" class="toc-link node-name--H3 ">49.1.条件执行</a></li><li class="toc-list-item"><a href="#spring-cloud-data-flow-transitional-execution" class="toc-link node-name--H3 ">49.2.过渡执行</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_basic_transition" class="toc-link node-name--H4 ">49.2.1.基本过渡</a></li><li class="toc-list-item"><a href="#_transition_with_a_wildcard" class="toc-link node-name--H4 ">49.2.2.转换为通配符</a></li><li class="toc-list-item"><a href="#_transition_with_a_following_conditional_execution" class="toc-link node-name--H4 ">49.2.3.通过以下条件执行进行转换</a></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-data-flow-split-execution" class="toc-link node-name--H3 ">49.3.拆分执行</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_split_containing_conditional_execution" class="toc-link node-name--H4 ">49.3.1.拆分包含条件执行</a></li><li class="toc-list-item"><a href="#_establishing_the_proper_thread_count_for_splits" class="toc-link node-name--H4 ">49.3.2.为拆分建立正确的线程计数</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-launch-tasks-from-stream" class="toc-link node-name--H2 ">50.从流中启动任务</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_triggertask" class="toc-link node-name--H3 ">50.1.TriggerTask</a></li><li class="toc-list-item"><a href="#_tasklaunchrequest_transform" class="toc-link node-name--H3 ">50.2.TaskLaunchRequest变换</a></li><li class="toc-list-item"><a href="#_launching_a_composed_task_from_a_stream" class="toc-link node-name--H3 ">50.3.从流中启动组合任务</a></li></ul></li><li class="toc-list-item"><a href="#sharing-spring-cloud-dataflows-datastore-with-tasks" class="toc-link node-name--H2 ">51.与任务共享Spring Cloud Data Flow的数据存储</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_a_common_datastore_dependency" class="toc-link node-name--H3 ">51.1.通用DataStore依赖项</a></li><li class="toc-list-item"><a href="#_a_common_data_store" class="toc-link node-name--H3 ">51.2.通用数据存储</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_simple_task_launch" class="toc-link node-name--H4 ">51.2.1.简单的任务启动</a></li><li class="toc-list-item"><a href="#_task_launcher_sink" class="toc-link node-name--H4 ">51.2.2.任务启动器接收器</a></li><li class="toc-list-item"><a href="#_composed_task_runner" class="toc-link node-name--H4 ">51.2.3.组成的任务运行器</a></li><li class="toc-list-item"><a href="#_launching_a_task_externally_from_spring_cloud_data_flow" class="toc-link node-name--H4 ">51.2.4.从Spring Cloud Data Flow外部启动任务</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#spring-cloud-dataflow-schedule-launch-tasks" class="toc-link node-name--H2 ">52.安排任务</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_the_scheduler" class="toc-link node-name--H3 ">52.1.调度程序</a></li><li class="toc-list-item"><a href="#_enabling_scheduling" class="toc-link node-name--H3 ">52.2.启用计划</a></li><li class="toc-list-item"><a href="#_the_lifecycle_of_a_schedule" class="toc-link node-name--H3 ">52.3.附表的生命周期</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#spring-cloud-data-flow-schedule-scheduling" class="toc-link node-name--H4 ">52.3.1.安排任务执行</a></li><li class="toc-list-item"><a href="#spring-cloud-data-flow-schedule-unscheduling" class="toc-link node-name--H4 ">52.3.2.删除计划</a></li></ul></li></ul></li></ul></li><li class="toc-list-item"><a href="#task-dev-guide" class="toc-link node-name--H1 ">任务开发者指南</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#task-dev-guide-prebuilt-apps" class="toc-link node-name--H2 ">53.预建应用程序</a></li><li class="toc-list-item"><a href="#task-dev-guide-running-prebuilt-apps" class="toc-link node-name--H2 ">54.运行预建应用程序</a></li><li class="toc-list-item"><a href="#task-dev-guide-building-timestamp-task" class="toc-link node-name--H2 ">55.构建时间戳任务</a></li><li class="toc-list-item"><a href="#task-dev-guide-building-timestamp-task-from-initializr" class="toc-link node-name--H2 ">56.开发时间戳应用程序</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#task-dev-guide-creating-project" class="toc-link node-name--H3 ">56.1.使用Spring Initializr创建Spring任务项目</a></li><li class="toc-list-item"><a href="#getting-started-writing-the-code" class="toc-link node-name--H3 ">56.2.编写代码</a></li><li class="toc-list-item"><a href="#getting-started-running-the-example" class="toc-link node-name--H3 ">56.3.运行示例</a></li><li class="toc-list-item"><a href="#task-dev-guide-building-timestamp-task-recording-error" class="toc-link node-name--H3 ">56.4.录制错误</a></li><li class="toc-list-item"><a href="#task-dev-guide-building-timestamp-task-adding-pre-post-processing" class="toc-link node-name--H3 ">56.5.添加预处理和后处理</a></li><li class="toc-list-item"><a href="#task-dev-guide-building-timestamp-task-bonus-adding-mysql" class="toc-link node-name--H3 ">56.6.添加MySQL数据库</a></li></ul></li><li class="toc-list-item"><a href="#task-dev-guide-building-timestamp-adding-tasks-to-dataflow" class="toc-link node-name--H2 ">57.使用数据流添加和启动Spring Cloud任务</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#task-dev-guide-building-batch-task-creating-first-task" class="toc-link node-name--H3 ">57.1.注册并启动您的第一个任务</a></li><li class="toc-list-item"><a href="#task-dev-guide-building-batch-task-creating-first-batch-task" class="toc-link node-name--H3 ">57.2.注册并启动您的第一个Spring Batch  - 任务</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#task-dev-guide-building-batch-task-verify-batch-task" class="toc-link node-name--H4 ">57.2.1.验证您的任务是批处理</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#task-dev-guide-database-requirement" class="toc-link node-name--H2 ">58.在Spring Cloud Data Flow中运行任务的数据库要求</a></li></ul></li><li class="toc-list-item"><a href="#dashboard" class="toc-link node-name--H1 ">仪表板</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#dashboard-introduction" class="toc-link node-name--H2 ">59.简介</a></li><li class="toc-list-item"><a href="#dashboard-apps" class="toc-link node-name--H2 ">60.应用程序</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_bulk_import_of_applications" class="toc-link node-name--H3 ">60.1.批量导入应用程序</a></li></ul></li><li class="toc-list-item"><a href="#dashboard-runtime" class="toc-link node-name--H2 ">61.运行时</a></li><li class="toc-list-item"><a href="#dashboard-streams" class="toc-link node-name--H2 ">62.流</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#dashboard-stream-definitions" class="toc-link node-name--H3 ">62.1.使用流定义</a></li><li class="toc-list-item"><a href="#dashboard-flo-streams-designer" class="toc-link node-name--H3 ">62.2.创建流</a></li><li class="toc-list-item"><a href="#dashboard-stream-deploy" class="toc-link node-name--H3 ">62.3.部署流</a></li><li class="toc-list-item"><a href="#_creating_fan_in_fan_out_streams" class="toc-link node-name--H3 ">62.4.创建扇入/扇出流</a></li><li class="toc-list-item"><a href="#_creating_a_tap_stream" class="toc-link node-name--H3 ">62.5.创建点按流</a></li></ul></li><li class="toc-list-item"><a href="#dashboard-tasks" class="toc-link node-name--H2 ">63.任务</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#dashboard-tasks-apps" class="toc-link node-name--H3 ">63.1.应用</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_view_task_app_details" class="toc-link node-name--H4 ">63.1.1.查看任务应用详情</a></li><li class="toc-list-item"><a href="#_create_a_task_definition" class="toc-link node-name--H4 ">63.1.2.创建任务定义</a></li></ul></li><li class="toc-list-item"><a href="#dashboard-task-definition" class="toc-link node-name--H3 ">63.2.定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_creating_composed_task_definitions" class="toc-link node-name--H4 ">63.2.1.创建组合任务定义</a></li><li class="toc-list-item"><a href="#_launching_tasks" class="toc-link node-name--H4 ">63.2.2.启动任务</a></li></ul></li><li class="toc-list-item"><a href="#dashboard-tasks-executions" class="toc-link node-name--H3 ">63.3.处决</a></li><li class="toc-list-item"><a href="#dashboard-tasks-execution-detail" class="toc-link node-name--H3 ">63.4.执行细节</a></li></ul></li><li class="toc-list-item"><a href="#dashboard-jobs" class="toc-link node-name--H2 ">64.工作</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#dashboard-job-executions-details" class="toc-link node-name--H3 ">64.1.工作执行细节</a></li><li class="toc-list-item"><a href="#dashboard-job-executions-steps" class="toc-link node-name--H3 ">64.2.步骤执行细节</a></li><li class="toc-list-item"><a href="#dashboard-job-executions-steps-progress" class="toc-link node-name--H3 ">64.3.步骤执行进度</a></li></ul></li><li class="toc-list-item"><a href="#dashboard-task-scheduling" class="toc-link node-name--H2 ">65.安排</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_creating_or_deleting_a_schedule_from_the_task_definition_s_page" class="toc-link node-name--H3 ">65.1.从“任务定义”页面创建或删除计划</a></li><li class="toc-list-item"><a href="#_creating_a_schedule" class="toc-link node-name--H3 ">65.2.创建计划</a></li><li class="toc-list-item"><a href="#_listing_available_schedules" class="toc-link node-name--H3 ">65.3.列出可用的计划</a></li></ul></li><li class="toc-list-item"><a href="#dashboard-analytics" class="toc-link node-name--H2 ">66.分析</a></li><li class="toc-list-item"><a href="#dashboard-auditing" class="toc-link node-name--H2 ">67.审计</a></li></ul></li><li class="toc-list-item"><a href="#dataflow-samples" class="toc-link node-name--H1 ">样品</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#samples-links" class="toc-link node-name--H2 ">68.链接</a></li></ul></li><li class="toc-list-item"><a href="#api-guide" class="toc-link node-name--H1 ">REST API指南</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-overview" class="toc-link node-name--H2 ">69.概述</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-overview-http-verbs" class="toc-link node-name--H3 ">69.1.HTTP动词</a></li><li class="toc-list-item"><a href="#api-guide-overview-http-status-codes" class="toc-link node-name--H3 ">69.2.HTTP状态代码</a></li><li class="toc-list-item"><a href="#api-guide-overview-headers" class="toc-link node-name--H3 ">69.3.头</a></li><li class="toc-list-item"><a href="#api-guide-overview-errors" class="toc-link node-name--H3 ">69.4.错误</a></li><li class="toc-list-item"><a href="#api-guide-overview-hypermedia" class="toc-link node-name--H3 ">69.5.超媒体</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources" class="toc-link node-name--H2 ">70.资源</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-index" class="toc-link node-name--H3 ">70.1.指数</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-index-access" class="toc-link node-name--H4 ">70.1.1.访问索引</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-index-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-index-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-index-response-structure" class="toc-link node-name--H5 ">响应结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-index-example-response" class="toc-link node-name--H5 ">示例响应</a></li><li class="toc-list-item"><a href="#api-guide-resources-index-links" class="toc-link node-name--H5 ">链接</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#resources-about" class="toc-link node-name--H3 ">70.2.服务器元信息</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-server-meta-retrieving" class="toc-link node-name--H4 ">70.2.1.检索有关服务器的信息</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-server-meta-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-server-meta-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-server-meta-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#resources-registered-applications" class="toc-link node-name--H3 ">70.3.注册申请</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#resources-app-registry-list" class="toc-link node-name--H4 ">70.3.1.上市申请</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-app-registry-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#resources-app-registry-get" class="toc-link node-name--H4 ">70.3.2.获取特定应用的信息</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-app-registry-get-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-get-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-get-path-parameters" class="toc-link node-name--H5 ">路径参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-get-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-get-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#resources-app-registry-post" class="toc-link node-name--H4 ">70.3.3.注册新的应用程序</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-app-registry-post-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-post-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-post-path-parameters" class="toc-link node-name--H5 ">路径参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-post-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-post-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#resources-app-registry-post-skipper" class="toc-link node-name--H4 ">70.3.4.使用版本注册新应用程序</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-app-registry-post-skipper-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-post-skipper-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-post-skipper-path-parameters" class="toc-link node-name--H5 ">路径参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-post-skipper-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-post-skipper-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#resources-app-registry-default" class="toc-link node-name--H4 ">70.3.5.设置默认应用程序版本</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-app-registry-default-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-default-path-parameters" class="toc-link node-name--H5 ">路径参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-default-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-default-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#resources-app-registry-delete" class="toc-link node-name--H4 ">70.3.6.取消注册应用程序</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-app-registry-delete-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-delete-path-parameters" class="toc-link node-name--H5 ">路径参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-delete-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-delete-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#resources-app-registry-bulk" class="toc-link node-name--H4 ">70.3.7.批量注册应用程序</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-app-registry-bulk-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-bulk-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-bulk-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-app-registry-bulk-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-audit-records" class="toc-link node-name--H3 ">70.4.审计记录</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-audit-records-list" class="toc-link node-name--H4 ">70.4.1.列出所有审核记录</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-audit-records-list-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-audit-records-list-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-audit-records-list-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-audit-records-list-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions" class="toc-link node-name--H3 ">70.5.流定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-create" class="toc-link node-name--H4 ">70.5.1.创建新的流定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-create-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-create-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-create-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-create-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-list" class="toc-link node-name--H4 ">70.5.2.列出所有流定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-list-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-list-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-list-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-list-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-list-related" class="toc-link node-name--H4 ">70.5.3.列出相关的流定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-list-related-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-list-related-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-list-related-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-list-related-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-delete-one" class="toc-link node-name--H4 ">70.5.4.删除单流定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-delete-one-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-delete-one-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-delete-one-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-delete-one-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-delete-all" class="toc-link node-name--H4 ">70.5.5.删除所有流定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-delete-all-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-delete-all-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-delete-all-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-delete-all-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-validate" class="toc-link node-name--H3 ">70.6.流验证</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-validation-request-structure" class="toc-link node-name--H4 ">70.6.1.请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-validation-request-parameters" class="toc-link node-name--H4 ">70.6.2.请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-validation-example-request" class="toc-link node-name--H4 ">70.6.3.示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-validation-response-structure" class="toc-link node-name--H4 ">70.6.4.响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-deployment" class="toc-link node-name--H3 ">70.7.流部署</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-deployment-deploy" class="toc-link node-name--H4 ">70.7.1.部署流定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-deploy-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-deploy-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-deploy-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-deploy-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-deployment-undeploy" class="toc-link node-name--H4 ">70.7.2.取消部署流定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-undeploy-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-undeploy-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-undeploy-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-undeploy-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-deployment-undeploy-all" class="toc-link node-name--H4 ">70.7.3.取消部署所有流定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-undeploy-all-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-undeploy-all-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-undeploy-all-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-undeploy-all-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-deployment-update" class="toc-link node-name--H4 ">70.7.4.更新已部署的流</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-update-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-update-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-update-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-update-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-deployment-rollback" class="toc-link node-name--H4 ">70.7.5.回滚流定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-rollback-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-rollback-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-rollback-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-rollback-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-deployment-manifest" class="toc-link node-name--H4 ">70.7.6.获得清单</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-manifest-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-manifest-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-manifest-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-manifest-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-deployment-history" class="toc-link node-name--H4 ">70.7.7.获取部署历史记录</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-history-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-history-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-history-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-stream-deployment-platform-list" class="toc-link node-name--H4 ">70.7.8.获取部署平台</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-platform-list-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-platform-list-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-definitions-deployment-platform-list-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-definitions" class="toc-link node-name--H3 ">70.8.任务定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-task-definitions-creating" class="toc-link node-name--H4 ">70.8.1.创建新的任务定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-task-definitions-creating-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-definitions-creating-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-definitions-creating-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-definitions-creating-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-definitions-list" class="toc-link node-name--H4 ">70.8.2.列出所有任务定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-task-definitions-list-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-definitions-list-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-definitions-list-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-definitions-list-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-definition-detail" class="toc-link node-name--H4 ">70.8.3.检索任务定义详细信息</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-task-definitions-detail-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-definitions-detail-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-definitions-detail-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-definitions-detail-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-delete-task-definition" class="toc-link node-name--H4 ">70.8.4.删除任务定义</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-delete-task-definition-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-delete-task-definition-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-delete-task-definition-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-delete-task-definition-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-scheduler" class="toc-link node-name--H3 ">70.9.任务计划程序</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-task-schedule-creating" class="toc-link node-name--H4 ">70.9.1.创建新的任务计划</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-task-schedule-creating-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-schedule-creating-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-schedule-creating-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-schedule-creating-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-schedule-list" class="toc-link node-name--H4 ">70.9.2.列出所有时间表</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-task-schedule-list-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-schedule-list-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-schedule-list-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-schedule-list-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-schedule-filtered-list" class="toc-link node-name--H4 ">70.9.3.列出已过滤的计划</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-stream-task-schedule-list-filtered-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-schedule-list-filtered-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-schedule-list-filtered-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-stream-task-schedule-list-filtered-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-delete-schedule" class="toc-link node-name--H4 ">70.9.4.删除任务时间表</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-delete-task-schedule-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-delete-task-schedule-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-delete-task-schedule-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-delete-task-schedule-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-validate" class="toc-link node-name--H3 ">70.10.任务验证</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-task-validation-request-structure" class="toc-link node-name--H5 ">请求结构</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-task-validation-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-validation-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-validation-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions" class="toc-link node-name--H3 ">70.11.任务执行</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-task-executions-launching" class="toc-link node-name--H4 ">70.11.1.启动任务</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-task-executions-launching-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-launching-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-launching-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-launching-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-list" class="toc-link node-name--H4 ">70.11.2.列出所有任务执行</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-task-executions-list-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-list-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-list-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-list-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-list-by-name" class="toc-link node-name--H4 ">70.11.3.列出具有指定任务名称的所有任务执行</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-task-executions-list-by-name-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-list-by-name-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-list-by-name-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-list-by-name-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-detail" class="toc-link node-name--H4 ">70.11.4.任务执行细节</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-task-executions-detail-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-detail-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-detail-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-detail-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-delete" class="toc-link node-name--H4 ">70.11.5.删除任务执行</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-task-executions-delete-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-delete-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-delete-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-delete-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-current-count" class="toc-link node-name--H4 ">70.11.6.任务执行当前计数</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-task-executions-current-count-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-current-count-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-current-count-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-task-executions-current-count-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions" class="toc-link node-name--H3 ">70.12.工作执行</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-executions-list" class="toc-link node-name--H4 ">70.12.1.列出所有工作执行</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-executions-list-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-list-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-list-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-list-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-list-by-name" class="toc-link node-name--H4 ">70.12.2.列出具有指定作业名称的所有作业执行</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-executions-list-by-name-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-list-by-name-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-list-by-name-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-list-by-name-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-detail" class="toc-link node-name--H4 ">70.12.3.工作执行细节</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-executions-detail-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-detail-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-detail-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-detail-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-stop" class="toc-link node-name--H4 ">70.12.4.停止执行作业</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-executions-stop-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-stop-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-stop-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-stop-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-restart" class="toc-link node-name--H4 ">70.12.5.重新启动作业执行</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-executions-restart-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-restart-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-restart-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-executions-restart-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-job-instances" class="toc-link node-name--H3 ">70.13.工作实例</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-instances-list" class="toc-link node-name--H4 ">70.13.1.列出所有作业实例</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-instances-list-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-instances-list-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-instances-list-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-instances-list-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-job-instances-detail" class="toc-link node-name--H4 ">70.13.2.工作实例细节</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-instances-detail-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-instances-detail-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-instances-detail-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-instances-detail-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-job-step-executions" class="toc-link node-name--H3 ">70.14.工作步骤执行</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-step-executions-list" class="toc-link node-name--H4 ">70.14.1.列出作业执行的所有步骤执行</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-step-executions-list-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-step-executions-list-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-step-executions-list-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-step-executions-list-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-job-step-execution-detail" class="toc-link node-name--H4 ">70.14.2.工作步骤执行细节</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-step-execution-detail-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-step-execution-detail-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-step-execution-detail-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-step-execution-detail-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-job-step-execution-progress" class="toc-link node-name--H4 ">70.14.3.工作步骤执行进度</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-job-step-execution-progress-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-step-execution-progress-request-parameters" class="toc-link node-name--H5 ">请求参数</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-step-execution-progress-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-job-step-execution-progress-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications" class="toc-link node-name--H3 ">70.15.有关应用程序的运行时信息</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications-listing-all" class="toc-link node-name--H4 ">70.15.1.在运行时列出所有应用程序</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications-listing-all-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications-listing-all-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications-listing-all-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications-querying-all-instances-single-app" class="toc-link node-name--H4 ">70.15.2.查询单个应用程序的所有实例</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications-querying-all-instances-single-app-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications-querying-all-instances-single-app-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications-querying-all-instances-single-app-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications-querying-single-instance-single-app" class="toc-link node-name--H4 ">70.15.3.查询单个应用程序的单个实例</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications-querying-single-instance-single-app-request-structure" class="toc-link node-name--H5 ">请求结构</a></li><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications-querying-single-instance-single-app-example-request" class="toc-link node-name--H5 ">示例请求</a></li><li class="toc-list-item"><a href="#api-guide-resources-runtime-information-applications-querying-single-instance-single-app-response-structure" class="toc-link node-name--H5 ">响应结构</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#api-guide-resources-metrics-stream-applications" class="toc-link node-name--H3 ">70.16.流应用程序的度量标准</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#api-guide-resources-metrics-stream-applications-request-structure" class="toc-link node-name--H4 ">70.16.1.请求结构</a></li><li class="toc-list-item"><a href="#_example_request" class="toc-link node-name--H4 ">70.16.2.示例请求</a></li><li class="toc-list-item"><a href="#_response_structure" class="toc-link node-name--H4 ">70.16.3.响应结构</a></li><li class="toc-list-item"><a href="#_example_response" class="toc-link node-name--H4 ">70.16.4.示例响应</a></li></ul></li></ul></li></ul></li><li class="toc-list-item"><a href="#appendix" class="toc-link node-name--H1 ">附录</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#dataflow-template" class="toc-link node-name--H2 ">附录A：数据流模板</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_using_the_data_flow_template" class="toc-link node-name--H3 ">A.1.使用数据流模板</a></li></ul></li><li class="toc-list-item"><a href="#howto" class="toc-link node-name--H2 ">附录B：“操作方法”指南</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_configure_maven_properties" class="toc-link node-name--H3 ">B.1.配置Maven Properties</a></li><li class="toc-list-item"><a href="#_logging" class="toc-link node-name--H3 ">B.2.记录</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#troubleshooting-deployment-logs" class="toc-link node-name--H4 ">B.2.1.部署日志</a></li><li class="toc-list-item"><a href="#troubleshooting-application-logs" class="toc-link node-name--H4 ">B.2.2.应用程序日志</a></li><li class="toc-list-item"><a href="#_remote_debugging" class="toc-link node-name--H4 ">B.2.3.远程调试</a></li><li class="toc-list-item"><a href="#_log_redirect" class="toc-link node-name--H4 ">B.2.4.记录重定向</a></li></ul></li><li class="toc-list-item"><a href="#faqs" class="toc-link node-name--H3 ">B.3.经常问的问题</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_advanced_spel_expressions" class="toc-link node-name--H4 ">B.3.1.高级SpEL表达式</a></li><li class="toc-list-item"><a href="#dataflow-jdbc-sink" class="toc-link node-name--H4 ">B.3.2.如何使用JDBC-sink？</a></li><li class="toc-list-item"><a href="#dataflow-multiple-brokers" class="toc-link node-name--H4 ">B.3.3.如何使用多个邮件绑定器？</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#migrationguide" class="toc-link node-name--H2 ">附录C：Spring XD到SCDF</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_terminology_changes" class="toc-link node-name--H3 ">C.1.术语变化</a></li><li class="toc-list-item"><a href="#_modules_to_applications" class="toc-link node-name--H3 ">C.2.模块到应用程序</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_custom_applications" class="toc-link node-name--H4 ">C.2.1.定制应用</a></li><li class="toc-list-item"><a href="#_application_registration" class="toc-link node-name--H4 ">C.2.2.申请注册</a></li><li class="toc-list-item"><a href="#_application_properties_4" class="toc-link node-name--H4 ">C.2.3.申请Properties</a></li></ul></li><li class="toc-list-item"><a href="#_message_bus_to_binders" class="toc-link node-name--H3 ">C.3.消息Bus至Binders</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_message_bus" class="toc-link node-name--H4 ">C.3.1.消息Bus</a></li><li class="toc-list-item"><a href="#_binders" class="toc-link node-name--H4 ">C.3.2.Binders</a></li><li class="toc-list-item"><a href="#_named_channels" class="toc-link node-name--H4 ">C.3.3.命名频道</a></li><li class="toc-list-item"><a href="#_directed_graphs" class="toc-link node-name--H4 ">C.3.4.有向图</a></li></ul></li><li class="toc-list-item"><a href="#_batch_to_tasks" class="toc-link node-name--H3 ">C.4.批量到任务</a></li><li class="toc-list-item"><a href="#_shell_and_dsl_command_changes" class="toc-link node-name--H3 ">C.5.Shell和DSL命令的变化</a></li><li class="toc-list-item"><a href="#_rest_api_changes" class="toc-link node-name--H3 ">C.6.REST API更改</a></li><li class="toc-list-item"><a href="#_ui_including_flo" class="toc-link node-name--H3 ">C.7.UI（包括Flo）</a></li><li class="toc-list-item"><a href="#_architecture_components" class="toc-link node-name--H3 ">C.8.架构组件</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_zookeeper" class="toc-link node-name--H4 ">C.8.1.ZooKeeper</a></li><li class="toc-list-item"><a href="#rdbms" class="toc-link node-name--H4 ">C.8.2.RDBMS</a></li><li class="toc-list-item"><a href="#_redis" class="toc-link node-name--H4 ">C.8.3.Redis的</a></li><li class="toc-list-item"><a href="#_cluster_topology" class="toc-link node-name--H4 ">C.8.4.集群拓扑</a></li></ul></li><li class="toc-list-item"><a href="#_central_configuration" class="toc-link node-name--H3 ">C.9.中央配置</a></li><li class="toc-list-item"><a href="#_distribution" class="toc-link node-name--H3 ">C.10.分配</a></li><li class="toc-list-item"><a href="#_hadoop_distribution_compatibility" class="toc-link node-name--H3 ">C.11.Hadoop分发兼容性</a></li><li class="toc-list-item"><a href="#_use_case_comparison" class="toc-link node-name--H3 ">C.12.用例比较</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_use_case_1_ticktock" class="toc-link node-name--H4 ">C.12.1.用例＃1：Ticktock</a></li><li class="toc-list-item"><a href="#_use_case_2_stream_with_custom_module_or_application" class="toc-link node-name--H4 ">C.12.2.用例＃2：使用自定义模块或应用程序流</a></li><li class="toc-list-item"><a href="#_use_case_3_batch_job" class="toc-link node-name--H4 ">C.12.3.用例＃3：批处理作业</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#building" class="toc-link node-name--H2 ">附录D：建筑</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_documentation" class="toc-link node-name--H3 ">D.1.文档</a></li><li class="toc-list-item"><a href="#_working_with_the_code" class="toc-link node-name--H3 ">D.2.使用本准则</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_importing_into_eclipse_with_m2eclipse" class="toc-link node-name--H4 ">D.2.1.使用m2eclipse导入Eclipse</a></li><li class="toc-list-item"><a href="#_importing_into_eclipse_without_m2eclipse" class="toc-link node-name--H4 ">D.2.2.在没有m2eclipse的情况下导入Eclipse</a></li></ul></li></ul></li><li class="toc-list-item"><a href="#contributing" class="toc-link node-name--H2 ">附录E：贡献</a><ul class="toc-list  is-collapsible is-collapsed"><li class="toc-list-item"><a href="#_sign_the_contributor_license_agreement" class="toc-link node-name--H3 ">E.1.签署贡献者许可协议</a></li><li class="toc-list-item"><a href="#_code_conventions_and_housekeeping" class="toc-link node-name--H3 ">E.2.代码约定和内务管理</a></li></ul></li></ul></li></ul></div>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><font o="869">版本1.7.3.RELEASE</font></p>
</div>
<div class="paragraph">
<p><font o="870">©2012-2018 Pivotal Software，Inc。</font></p>
</div>
<div class="paragraph">
<p><em><font o="871">本文档的副本可供您自己使用并分发给他人，前提是您不对此类副本收取任何费用，并且每份副本均包含本版权声明，无论是以印刷版还是电子版分发。</font></em></p>
</div>
</div>
</div>
<h1 id="preface" class="sect0"><font o="872">前言</font></h1>
<div class="sect1">
<h2 id="dataflow-documentation-about"><font o="873">1.关于文档</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="874">此版本的文档以</font><a href="javascript:;"><font o="874">HTML格式提供</font></a><font o="874">。</font></p>
</div>
<div class="paragraph">
<p><font o="875">可以在</font><a href="javascript:;"><font o="875">此处</font></a><font o="875">找到Spring Cloud Data Flow参考指南的最新副本</font><font o="875">。</font></p>
</div>
<div class="paragraph">
<p><font o="876">本文档的副本可供您自己使用并分发给他人，前提是您不对此类副本收取任何费用，并且每份副本均包含本版权声明，无论是以印刷版还是电子版分发。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dataflow-documentation-getting-help"><font o="877">2.获得帮助</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="878">遇到Spring Cloud Data Flow问题，我们想帮忙！</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="879">问一个问题。</font><font o="880">我们监控</font><a href="javascript:;"><font o="880">stackoverflow.com</font></a><font o="880">以获取标记的问题</font><a href="javascript:;"><code>spring-cloud-dataflow</code></a><font o="880">。</font></p>
</li>
<li>
<p><font o="881">在</font><a href="javascript:;" class="bare"><font o="881">github.com/spring-cloud/spring-cloud-dataflow/issues上</font></a><font o="881">使用Spring Cloud Data Flow报告错误</font><font o="881">。</font></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="882">
所有Spring Cloud Data Flow都是开源的，包括文档！</font><font o="883">如果您发现文档有问题，或者您只想改进它们，请</font><a href="javascript:;"><font o="883">参与其中</font></a><font o="883">。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<h1 id="getting-started" class="sect0"><font o="884">入门</font></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p><font o="885">如果您开始使用Spring Cloud Data Flow，则本节适合您。</font><font o="886">在本节中，我们回答基本的“什么？”，“如何？”和“为什么？”的问题。</font><font o="887">您可以找到Spring Cloud Data Flow的简要介绍以及安装说明。</font><font o="888">然后，我们构建一个介绍性的Spring Cloud Data Flow应用程序，讨论一些核心原则。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started-system-requirements"><font o="889">3.系统要求</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="890">您需要运行Java 8并构建您需要拥有Maven。</font></p>
</div>
<div class="paragraph">
<p><font o="891">您需要一个RDBMS来存储流定义和部署属性以及任务/批处理作业状态。</font><font o="892">默认情况下，数据流服务器使用嵌入式H2数据库来实现此目的，但您可以轻松地将服务器配置为使用其他外部数据库。</font></p>
</div>
<div class="paragraph">
<p><font o="893">如果您正在运行涉及分析应用程序的任何流，则</font><font o="893">还需要</font><font o="893">运行</font><a href="javascript:;"><font o="893">Redis</font></a><font o="893">。</font><font o="894">Redis也可能需要运行单元/集成测试。</font></p>
</div>
<div class="paragraph">
<p><font o="895">对于部署的流应用程序通信，</font><font o="895">需要安装</font><a href="javascript:;"><font o="895">RabbitMQ</font></a><font o="895">或</font><a href="javascript:;"><font o="895">Kafka</font></a><font o="895">。</font></p>
</div>
<div class="paragraph">
<p><font o="896">如果您希望在运行时具有在Streams中升级和回滚应用程序的功能，则应安装Spring Cloud Skipper服务器。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started-deploying-spring-cloud-dataflow-docker"><font o="897">4. Docker Compose入门</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="898">从Spring Cloud Data Flow 1.4开始，提供Docker Compose文件以快速显示Spring Cloud Data Flow及其依赖项，而无需手动获取它们。</font><font o="899">运行时，组合系统包括Spring Cloud Data Flow本地服务器的最新GA版本，使用Kafka绑定器进行通信。</font><font o="900">Docker Compose是必需的，建议使用</font><a href="javascript:;"><font o="900">最新版本</font></a><font o="900">。</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="901">下载Spring Cloud Data Flow本地服务器Docker Compose文件：</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ wget https://raw.githubusercontent.com/spring-cloud/spring-cloud-dataflow/v1.7.3.RELEASE/spring-cloud-dataflow-server-local/docker-compose.yml</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="902">
如果<code i="36">wget</code>命令不可用，则可以使用<code i="37">curl</code>或其他特定于平台的实用程序。</font><font o="903">或者导航到</font><font o="903">web中的</font><a href="javascript:;"><font o="903">https://raw.githubusercontent.com/spring-cloud/spring-cloud-dataflow/v1.7.3.RELEASE/spring-cloud-dataflow-server-local/docker-compose.yml</font></a><font o="903">浏览器并保存内容。</font><font o="904">确保下载的文件名为<code i="38">docker-compose.yml</code>。
</font></td>
</tr>
</tbody></table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="905">启动Docker Compose</font></p>
<div class="paragraph">
<p><font o="906">在您下载<code i="39">docker-compose.yml</code>的目录中，启动系统，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ export DATAFLOW_VERSION=1.7.3.RELEASE
$ docker-compose up</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="907"><code i="40">docker-compose.yml</code>文件定义变量<code i="41">DATAFLOW_VERSION</code>，以便可以轻松更改。</font><font o="908">上面的命令首先设置要在环境中使用的<code i="42">DATAFLOW_VERSION</code>，然后启动<code i="43">docker-compose</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="909">只将<code i="44">DATAFLOW_VERSION</code>变量暴露给<code i="45">docker-compose</code>进程而不是在环境中设置的简写版本如下：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ DATAFLOW_VERSION=1.7.3.RELEASE docker-compose up</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="910">使用Windows时，使用<code i="46">set</code>命令定义环境变量。</font><font o="911">要在Windows上启动系统，请输入以下命令：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">C:\ set DATAFLOW_VERSION=1.7.3.RELEASE
C:\ docker-compose up</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="912">
默认情况下，Docker Compose将使用本地可用的图像。</font><font o="913">例如，在使用<code i="47">latest</code>标记时，请在<code i="49">docker-compose up</code>之前执行<code i="48">docker-compose pull</code>以确保下载最新图像。
</font></td>
</tr>
</tbody></table>
</div>
</li>
<li>
<p><font o="914">启动Spring Cloud Data Flow仪表板</font></p>
<div class="paragraph">
<p><font o="915"><code i="50">docker-compose</code>命令停止发出日志消息后，Spring Cloud Data Flow将可以使用。</font><font o="916">此时，在浏览器中导航到</font><a href="javascript:;"><font o="916">Spring Cloud Data Flow仪表板</font></a><font o="916">。</font><font o="917">默认情况下，将自动导入最新的GA版本的Stream和Task应用程序。</font></p>
</div>
</li>
<li>
<p><font o="918">创建一个流</font></p>
<div class="paragraph">
<p><font o="919">要创建流，首先导航到“Streams”菜单链接，然后单击“Create Stream”链接。</font><font o="920">在“Create Stream”textarea中输入<code i="51">time | log</code>，然后单击“CREATE STREAM”按钮。</font><font o="921">输入“ticktock”作为流名称，然后单击“Deploy Stream（s）”复选框，如下图所示：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-stream-create.png" alt="创建流">
</div>
<div class="title"><font o="922">图1.创建流</font></div>
</div>
<div class="paragraph">
<p><font o="923">然后单击“确定”，它将返回到“定义”页面。</font><font o="924">流将处于“部署”状态，并在完成后移至“已部署”。</font><font o="925">您可能需要刷新浏览器才能看到更新后的状态。</font></p>
</div>
</li>
<li>
<p><font o="926">查看流日志</font></p>
<div class="paragraph">
<p><font o="927">要查看流日志，请导航到“运行时”菜单链接，然后单击“ticktock.log”链接。</font><font o="928">复制仪表板上“stdout”文本框中的路径以及另一种控制台类型：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ docker exec -it dataflow-server tail -f /path/from/stdout/textbox/in/dashboard</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="929">您现在应该看到日志接收器的输出，每秒打印一次时间戳。</font><font o="930">按CTRL + c结束<code i="52">tail</code>。</font></p>
</div>
</li>
<li>
<p><font o="931">删除流</font></p>
<div class="paragraph">
<p><font o="932">要删除流，首先导航到仪表板中的“Streams”菜单链接，然后单击“ticktock”行上的复选框。</font><font o="933">单击“DESTROY ALL 1 SELECTED STREAMS”按钮，然后单击“YES”以销毁流。</font></p>
</div>
</li>
<li>
<p><font o="934">销毁快速启动环境</font></p>
<div class="paragraph">
<p><font o="935">要破坏快速启动环境，请在<code i="53">docker-compose.yml</code>所在的另一个控制台中键入如下内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ docker-compose down</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="936">
某些流应用程序可能会打开一个端口，例如<code i="54">http --server.port=</code>。</font><font o="937">默认情况下，端口范围<code i="55">9000-9010</code>从容器暴露给主机。</font><font o="938">如果要更改此范围，请修改<code i="58">docker-compose.yml</code>文件中<code i="57">dataflow-server</code>服务的<code i="56">ports</code>块。
</font></td>
</tr>
</tbody></table>
</div>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="getting-started-customizing-spring-cloud-dataflow-docker">4.1.<font o="940">Docker撰写自定义</font></h3>
<div class="paragraph">
<p><font o="941">开箱即用的Spring Cloud Data Flow将使用H2嵌入式数据库来存储状态，Kafka用于通信而不使用分析。</font><font o="942">可以通过编辑<code i="59">docker-compose.yml</code>文件对这些组件进行自定义，如下所述。</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a id="getting-started-customizing-spring-cloud-dataflow-docker-mysql"></a><font o="943">要使用MySQL而不是H2嵌入式数据库，请在<code i="60">services</code>部分下添加以下配置：</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">  mysql:
    image: mariadb:10.2
    environment:
      MYSQL_DATABASE: dataflow
      MYSQL_USER: root
      MYSQL_ROOT_PASSWORD: rootpw
    expose:
      - 3306</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="944">需要将以下条目添加到<code i="62">dataflow-server</code>服务定义的<code i="61">environment</code>块中：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">      - spring.datasource.url=jdbc:mysql://mysql:3306/dataflow
      - spring.datasource.username=root
      - spring.datasource.password=rootpw
      - spring.datasource.driver-class-name=org.mariadb.jdbc.Driver</code></pre>
</div>
</div>
</li>
<li>
<p><font o="945">要使用RabbitMQ代替Kafka进行通信，请替换<code i="63">services</code>部分下的以下配置：</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">  kafka:
    image: wurstmeister/kafka:1.1.0
    expose:
      - "9092"
    environment:
      - KAFKA_ADVERTISED_PORT=9092
      - KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181
      - KAFKA_ADVERTISED_HOST_NAME=kafka
  zookeeper:
    image: wurstmeister/zookeeper
    expose:
      - "2181"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="946">附：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">  rabbitmq:
    image: rabbitmq:3.7
    expose:
      - "5672"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="947">在<code i="64">dataflow-server</code>服务配置块中，添加以下<code i="65">environment</code>条目：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">      - spring.cloud.dataflow.applicationProperties.stream.spring.rabbitmq.host=rabbitmq</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="948">最后，修改<code i="66">app-import</code>服务定义<code i="67">command</code>属性，将<code i="68"><a href="javascript:;" class="bare">bit.ly/Celsius-SR3-stream-applications-kafka-10-maven</a></code>替换为<code i="69"><a href="javascript:;" class="bare">bit.ly/Celsius-SR3-stream-applications-rabbit-maven</a></code>。</font></p>
</div>
</li>
<li>
<p><a id="getting-started-customizing-spring-cloud-dataflow-docker-redis"></a><font o="949">要使用redis作为后端启用分析，请在<code i="70">services</code>部分下添加以下配置：</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">  redis:
    image: redis:2.8
    expose:
      - "6379"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="950">然后将以下条目添加到<code i="72">dataflow-server</code>服务定义的<code i="71">environment</code>块中：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">      - spring.cloud.dataflow.applicationProperties.stream.spring.redis.host=redis
      - spring.redis.host=redis</code></pre>
</div>
</div>
</li>
<li>
<p><font o="951">要直接从主机启用<code i="73">app starters</code>注册，您必须将源主机文件夹装载到<code i="74">dataflow-server</code>容器。</font><font o="952">例如，如果<code i="75">my-app.jar</code>位于主机上的<code i="76">/foo/bar/apps</code>文件夹中，则将以下<code i="77">volumes</code>块添加到<code i="78">dataflow-server</code>服务定义中：</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">  dataflow-server:
    image: springcloud/spring-cloud-dataflow-server-local:${DATAFLOW_VERSION}
    container_name: dataflow-server
    ports:
      - "9393:9393"
    environment:
      - spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.kafka.binder.brokers=kafka:9092
      - spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.kafka.binder.zkNodes=zookeeper:2181
    volumes:
      - /foo/bar/apps:/root/apps</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="953">稍后，可以从容器的<code i="80">/root/apps/</code>文件夹中访问<code i="79">my-app.jar</code>（以及文件夹中的其他文件）。</font><font o="954">检查</font><a href="javascript:;"><font o="954">撰写文件参考</font></a><font o="954">以了解其他配置详细信息。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="955">
显式卷安装将docker-compose耦合到主机的文件系统，从而限制了对其他计算机和操作系统的可移植性。</font><font o="956">与<code i="81">docker</code>不同，<code i="82">docker-compose</code>不允许从命令行进行卷安装（例如，没有<code i="83">-v</code>类参数）。</font><font o="957">相反，您可以定义占位符环境变量（例如<code i="84">HOST_APP_FOLDER</code>）来代替硬编码路径：<code i="85">- ${HOST_APP_FOLDER}:/root/apps</code>并在启动docker-compose之前设置此变量。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="958">挂载主机文件夹后，您可以</font><font o="958">使用<code i="87">file://</code> URI架构</font><font o="958">向SCDF </font><a href="javascript:;"><font o="958">Shell</font></a><font o="958">或</font><a href="javascript:;"><font o="958">仪表板</font></a><font o="958">注册应用程序启动器（来自<code i="86">/root/apps</code>）</font><font o="958">：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;app register --type source --name my-app --uri file://root/apps/my-app.jar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="959">
如果元数据jar在/ root / apps中可用，也可以使用<code i="88">--metadata-uri</code>。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="960">要从<code i="89">dataflow-server</code>容器中访问主机的本地maven存储库，您应该将主机maven本地存储库（OSX和Linux的默认值为<code i="90">~/.m2</code>，Windows的默认值为<code i="91">C:\Documents and Settings{your-username}\.m2</code>）挂载到名为{的<code i="92">dataflow-server</code>卷。 5 /}。</font><font o="961">对于MacOS或Linux主机，这看起来像这样：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">  dataflow-server:
  .........
    volumes:
      - ~/.m2:/root/.m2</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="962">现在，您可以使用<code i="94">maven://</code> URI模式和maven坐标来解析安装在主机maven存储库中的jar：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;app register --type processor --name pose-estimation --uri maven://org.springframework.cloud.stream.app:pose-estimation-processor-rabbit:2.0.2.BUILD-SNAPSHOT --metadata-uri maven://org.springframework.cloud.stream.app:pose-estimation-processor-rabbit:jar:metadata:2.0.2.BUILD-SNAPSHOT --force</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="963">这种方法允许您直接与数据流服务器容器共享构建并安装在主机上的jar（例如<code i="95">mvn clean install</code>）。</font></p>
</div>
<div class="paragraph">
<p><font o="964">也可以直接在docker-compose中预先注册应用程序。</font><font o="965">对于每个预先注册的app starer，在<code i="97">app-import</code>块配置中添加一个额外的<code i="96">wget</code>语句：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">  app-import:
    image: alpine:3.7
    command: &gt;
      /bin/sh -c "
        ....
        wget -qO- 'http://dataflow-server:9393/apps/source/my-app' --post-data='uri=file:/root/apps/my-app.jar&amp;metadata-uri=file:/root/apps/my-app-metadata.jar';
        echo 'My custom apps imported'"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="966">有关更多详细信息，</font><font o="966">请查看</font><a href="javascript:;"><font o="966">SCDF REST API</font></a><font o="966">。</font></p>
</div>
</li>
<li>
<p><font o="967">要启用Spring Cloud Skipper以及Metrics支持，需要进行以下修改。</font><font o="968">在此示例中，假设stock <code i="98">docker-compose.yml</code>文件用作起点。</font><font o="969">仍然可以应用自定义，例如使用上面的示例与Rabbit交换Kafka。</font></p>
<div class="paragraph">
<p><font o="970">首先，在<code i="99">zookeeper</code>服务定义之后：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="971">按照</font><a href="#getting-started-customizing-spring-cloud-dataflow-docker-mysql"><font o="971">使用MySQL中的</font></a><font o="971">描述添加</font><a href="#getting-started-customizing-spring-cloud-dataflow-docker-mysql"><font o="971">MySQL</font></a></p>
</li>
<li>
<p><font o="972">按照</font><a href="#getting-started-customizing-spring-cloud-dataflow-docker-redis"><font o="972">使用Redis启用分析中</font></a><font o="972">所述添加</font><a href="#getting-started-customizing-spring-cloud-dataflow-docker-redis"><font o="972">Redis</font></a></p>
<div class="paragraph">
<p><font o="973">然后在<code i="100">dataflow-server</code>服务定义下添加Skipper和Metrics：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">  skipper-server:
    image: springcloud/spring-cloud-skipper-server:1.1.2.RELEASE
    container_name: skipper
    ports:
      - "7577:7577"
      - "9000-9010:9000-9010"
    environment:
      - spring.datasource.url=jdbc:mysql://mysql:3306/dataflow
      - spring.datasource.username=root
      - spring.datasource.password=rootpw
      - spring.datasource.driver-class-name=org.mariadb.jdbc.Driver

  metrics-collector:
    image: springcloud/metrics-collector-kafka:2.0.0.RELEASE
    environment:
      - spring.cloud.stream.kafka.binder.brokers=kafka:9092
      - spring.cloud.stream.kafka.binder.zkNodes=zookeeper:2181
      - spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration
    expose:
      - "8080"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="974">从<code i="101">dataflow-server</code>删除应用程序端口映射，因为它们现在已分配给<code i="102">skipper-server</code>容器：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">  dataflow-server:
    ...
    ports:
      - "9393:9393"
      - "9000-9010:9000-9010"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="975">变为：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">  dataflow-server:
    ...
    ports:
      - "9393:9393"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="976">最后将以下环境变量附加到<code i="103">dataflow-server</code> <code i="104">environment</code>块：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">      - spring.cloud.dataflow.features.skipper-enabled=true
      - spring.cloud.skipper.client.serverUri=http://skipper-server:7577/api</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="977">
使用Skipper时，已启动的应用程序及其日志驻留在<code i="105">skipper</code>容器而不是<code i="106">dataflow-server</code>容器中。</font><font o="978">例如，如前所述查看流日志时，将引用<code i="107">skipper</code>容器：
</font></td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">$ docker exec -it skipper tail -f /path/from/stdout/textbox/in/dashboard</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started-deploying-spring-cloud-dataflow"><font o="979">5.手动安装入门</font></h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="980">下载Spring Cloud Data Flow服务器和Shell应用程序：</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">wget https://repo.spring.io/release/org/springframework/cloud/spring-cloud-dataflow-server-local/1.7.3.RELEASE/spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar

wget https://repo.spring.io/release/org/springframework/cloud/spring-cloud-dataflow-shell/1.7.3.RELEASE/spring-cloud-dataflow-shell-1.7.3.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="981">从1.3.x开始，数据流服务器可以以<code i="108">skipper</code>或<code i="109">classic</code>模式运行。</font><font o="982"><code i="110">classic</code>模式是数据流服务器在1.2.x版本中的工作方式。</font><font o="983">使用属性<code i="111">spring.cloud.dataflow.features.skipper-enabled</code>启动数据流服务器时指定模式。</font><font o="984">默认情况下，启用<code i="112">classic</code>模式。</font></p>
</div>
</li>
<li>
<p><font o="985">如果您希望在Streams中升级和回滚应用程序的附加功能，请</font><font o="985">下载</font><a href="javascript:;"><font o="985">Skipper</font></a><font o="985">，因为Data Flow会委托Skipper获取这些功能。</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-yaml" data-lang="yaml">wget https://repo.spring.io/release/org/springframework/cloud/spring-cloud-skipper-server/1.1.2.RELEASE/spring-cloud-skipper-server-1.1.2.RELEASE.jar

wget https://repo.spring.io/release/org/springframework/cloud/spring-cloud-skipper-shell/1.1.2.RELEASE/spring-cloud-skipper-shell-1.1.2.RELEASE.jar</code></pre>
</div>
</div>
</li>
<li>
<p><font o="986">启动Skipper（仅当您要在<code i="113">skipper</code>模式下运行Spring Cloud Data Flow服务器时才需要）</font></p>
<div class="paragraph">
<p><font o="987">在您下载Skipper的目录中，使用<code i="114">java -jar</code>运行服务器，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar spring-cloud-skipper-server-1.1.2.RELEASE.jar</code></pre>
</div>
</div>
</li>
<li>
<p><font o="988">启动数据流服务器</font></p>
<div class="paragraph">
<p><font o="989">在下载数据流的目录中，使用<code i="115">java -jar</code>运行服务器，如下所示：</font></p>
</div>
<div class="paragraph">
<p><font o="990">要以<code i="116">classic</code>模式运行数据流服务器：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="991">要以<code i="117">skipper</code>模式运行数据流服务器：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar --spring.cloud.dataflow.features.skipper-enabled=true</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="992">如果Skipper和数据流服务器未在同一主机上运行，​​请将配置属性<code i="118">spring.cloud.skipper.client.serverUri</code>设置为Skipper的位置，例如</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar --spring.cloud.skipper.client.serverUri=http://192.51.100.1:7577/api</code></pre>
</div>
</div>
</li>
<li>
<p><font o="993">启动数据流Shell，如下所示：</font></p>
<div class="paragraph">
<p><font o="994">启动Data Flow shell需要指定适当的数据流服务器模式。</font><font o="995">要以<code i="119">classic</code>模式运行的数据流服务器启动数据流Shell：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar spring-cloud-dataflow-shell-1.7.3.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="996">要以<code i="120">skipper</code>模式运行的数据流服务器启动数据流Shell：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar spring-cloud-dataflow-shell-1.7.3.RELEASE.jar --dataflow.mode=skipper</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="997">
数据流服务器和命令行管理程序必须处于同一模式。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="998">如果数据流服务器和shell未在同一主机上运行，​​则在shell的交互模式下，您还可以使用<code i="121">dataflow config server</code>命令将shell指向数据流服务器URL。</font></p>
</div>
<div class="paragraph">
<p><font o="999">如果数据流服务器和shell未在同一主机上运行，​​请将shell指向数据流服务器URL，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">server-unknown:&gt;dataflow config server http://198.51.100.0
Successfully targeted http://198.51.100.0
dataflow:&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1000">或者，传入命令行选项<code i="122">--dataflow.uri</code>。</font><font o="1001">shell的命令行选项<code i="123">--help</code>显示可用的内容。</font></p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started-deploying-streams-spring-cloud-dataflow"><font o="1002">6.部署Streams</font></h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="1003">注册流应用</font></p>
<div class="paragraph">
<p><font o="1004">默认情况下，应用程序注册表为空。</font><font o="1005">例如，注册使用RabbitMQ进行通信的两个应用程序<code i="124">http</code>和<code i="125">log</code>。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;app register --name http --type source --uri maven://org.springframework.cloud.stream.app:http-source-rabbit:1.2.0.RELEASE
Successfully registered application 'source:http'

dataflow:&gt;app register --name log --type sink --uri maven://org.springframework.cloud.stream.app:log-sink-rabbit:1.1.0.RELEASE
Successfully registered application 'sink:log'</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1006">有关更多详细信息，例如如何注册基于docker容器的应用程序或使用Kafka作为消息传递中间件，请查看有关如何</font><a href="#spring-cloud-dataflow-register-stream-apps"><font o="1006">注册应用程序</font></a><font o="1006">的部分</font><font o="1006">。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1007">
根据您的环境，您可能需要将数据流服务器配置为指向自定义Maven存储库位置或配置代理设置。</font><font o="1008">有关</font><font o="1008">更多信息，</font><font o="1008">请参阅</font><a href="#configuration-maven"><font o="1008">Maven</font></a><font o="1008">。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1009">在本入门部分中，我们仅显示部署流，因此命令在服务器的<code i="126">skipper</code>和<code i="127">classic</code>模式下是相同的。</font></p>
</div>
</li>
<li>
<p><font o="1010">创建一个流</font></p>
<div class="paragraph">
<p><font o="1011">使用<code i="128">stream create</code>命令创建一个带有<code i="129">http</code>源和<code i="130">log</code>接收器的流并部署它：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; stream create --name httptest --definition "http --server.port=9000 | log" --deploy</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1012">
在发布数据之前，您需要等待一段时间，直到应用程序实际部署成功。</font><font o="1013">查看数据流服务器的日志文件，以获取<code i="131">http</code>和<code i="132">log</code>应用程序的日志文件的位置。</font><font o="1014">对每个应用程序使用日志文件上的<code i="133">tail</code>命令验证应用程序是否已启动。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1015">现在发布一些数据，如下例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; http post --target http://localhost:9000 --data "hello world"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1016">检查<code i="134">hello world</code>应用程序的日志文件中是否<code i="134">hello world</code>结束。</font><font o="1017"><code i="136">log</code>应用程序的日志文件的位置将显示在数据流服务器的日志中。</font></p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><font o="1018">您可以在使用Skipper的</font><a href="#spring-cloud-dataflow-stream-lifecycle-skipper"><font o="1018">Stream Lifecycle</font></a><font o="1018">部分</font><font o="1018">以及如何</font><a href="#spring-cloud-dataflow-streams-skipper"><font o="1018">使用Skipper</font></a><font o="1018">在</font><a href="#spring-cloud-dataflow-streams-skipper"><font o="1018">Streams中</font></a><font o="1018">升级和回滚流中</font><a href="#spring-cloud-dataflow-streams-skipper"><font o="1018">，</font></a><font o="1018">阅读有关使用Skipper部署流的一般功能的更多信息</font><font o="1018">。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="1019">在本地部署时，每个应用程序（以及每个应用程序实例，在<code i="137">count &gt; 1</code>的情况下）都会获得动态分配的<code i="138">server.port</code>，除非您明确指定一个<code i="139">--server.port=x</code>。</font><font o="1020">在这两种情况下，此设置都将作为配置属性传播，该属性将覆盖您可能已使用的任何较低级别设置（例如，在<code i="140">application.yml</code>文件中）。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploying_tasks"><font o="1021">7.部署任务</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1022">在本入门部分，我们将展示如何注册任务，创建任务定义然后启动它。</font><font o="1023">然后，我们还将审查有关任务执行的信息。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1024">
启动Spring Cloud Task应用程序不会委托给Skipper，因为它们是短期应用程序。</font><font o="1025">通过数据流服务器直接部署任务。
</font></td>
</tr>
</tbody></table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="1026">注册任务应用程序</font></p>
<div class="paragraph">
<p><font o="1027">默认情况下，应用程序注册表为空。</font><font o="1028">例如，我们将注册一个任务应用程序<code i="141">timestamp</code>，它只是将当前时间打印到日志中。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;app register --name timestamp --type task --uri maven://org.springframework.cloud.task.app:timestamp-task:1.3.0.RELEASE
Successfully registered application 'task:timestamp'</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1029">
根据您的环境，您可能需要将数据流服务器配置为指向自定义Maven存储库位置或配置代理设置。</font><font o="1030">有关</font><font o="1030">更多信息，</font><font o="1030">请参阅</font><a href="#configuration-maven"><font o="1030">Maven</font></a><font o="1030">。
</font></td>
</tr>
</tbody></table>
</div>
</li>
<li>
<p><font o="1031">创建任务定义</font></p>
<div class="paragraph">
<p><font o="1032">使用<code i="142">task create</code>命令使用以前注册的<code i="143">timestamp</code>应用程序创建任务定义。</font><font o="1033">在此示例中，没有使用其他属性来配置<code i="144">timestamp</code>应用程序。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; task create --name printTimeStamp --definition "timestamp"</code></pre>
</div>
</div>
</li>
<li>
<p><font o="1034">启动任务</font></p>
<div class="paragraph">
<p><font o="1035">任务定义的启动是通过shell的<code i="145">task launch</code>命令完成的。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; task launch printTimeStamp</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1036">检查时间戳是否在时间戳任务的日志文件中结束。</font><font o="1037">任务应用程序的日志文件的位置将显示在数据流服务器的日志中。</font><font o="1038">您应该看到类似的日志条目</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">TimestampTaskConfiguration$TimestampTask : 2018-02-28 16:42:21.051</code></pre>
</div>
</div>
</li>
<li>
<p><font o="1039">检查任务执行</font></p>
<div class="paragraph">
<p><font o="1040">可以使用命令<code i="146">task execution list</code>获取有关任务执行的信息。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;task execution list
╔══════════════╤══╤════════════════════════════╤════════════════════════════╤═════════╗
║  Task Name   │ID│         Start Time         │          End Time          │Exit Code║
╠══════════════╪══╪════════════════════════════╪════════════════════════════╪═════════╣
║printTimeStamp│1 │Wed Feb 28 16:42:21 EST 2018│Wed Feb 28 16:42:21 EST 2018│0        ║
╚══════════════╧══╧════════════════════════════╧════════════════════════════╧═════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1041">可以使用命令<code i="147">task execution status</code>获取其他信息。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;task execution status --id 1
╔══════════════════════╤═══════════════════════════════════════════════════╗
║         Key          │                       Value                       ║
╠══════════════════════╪═══════════════════════════════════════════════════╣
║Id                    │1                                                  ║
║Name                  │printTimeStamp                                     ║
║Arguments             │[--spring.cloud.task.executionid=1]                ║
║Job Execution Ids     │[]                                                 ║
║Start Time            │Wed Feb 28 16:42:21 EST 2018                       ║
║End Time              │Wed Feb 28 16:42:21 EST 2018                       ║
║Exit Code             │0                                                  ║
║Exit Message          │                                                   ║
║Error Message         │                                                   ║
║External Execution Id │printTimeStamp-ab86b2cc-0508-4c1e-b33d-b3896d17fed7║
╚══════════════════════╧═══════════════════════════════════════════════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1042">“ </font><a href="#spring-cloud-dataflow-task"><font o="1042">任务”</font></a><font o="1042">部分提供了有关</font><font o="1042">“ </font><a href="#spring-cloud-dataflow-task"><font o="1042">任务</font></a><font o="1042"> ”生命周期的更多信息，以及如何使用“
 </font><a href="#spring-cloud-dataflow-composed-tasks"><font o="1042">组合任务”</font></a><font o="1042">，使您可以创建有向图，其中图的每个节点都是任务应用程序。</font></p>
</div>
</li>
</ol>
</div>
</div>
</div>
<h1 id="applications" class="sect0"><font o="1043">应用</font></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p><font o="1044">一系列预构建的</font><a href="javascript:;"><font o="1044">流</font></a><font o="1044">和</font><a href="javascript:;"><font o="1044">任务/批量</font></a><font o="1044">启动应用程序，用于各种数据集成和处理场景，以促进学习和实验。</font><font o="1045">下表包括预先构建的应用程序。</font><font o="1046">欲了解更多详情，请参阅如何</font><a href="#supported-apps-and-tasks"><font o="1046">注册支持的应用程序</font></a><font o="1046">。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_available_applications"><font o="1047">8.可用应用程序</font></h2>
<div class="sectionbody">
<table class="tableblock frame-topbot grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="1048">资源</font></th>
<th class="tableblock halign-left valign-top"><font o="1049">处理器</font></th>
<th class="tableblock halign-left valign-top"><font o="1050">下沉</font></th>
<th class="tableblock halign-left valign-top"><font o="1051">任务</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">sftp</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">tcp-client</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">mqtt</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">spark-yarn</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">jms</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">scriptable-transform</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">log</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">spark-cluster</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">ftp</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">transform</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">task-launcher-yarn</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">spark-client</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">time</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">header-enricher</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">throughput</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">timestamp</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">load-generator</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">python-http</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">task-launcher-local</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">jdbchdfs-local</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">syslog</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">twitter-sentiment</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">mongodb</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">composed-task-runner</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">s3</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">splitter</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">hdfs-dataset</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">timestamp-batch</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">loggregator</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">bridge</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">ftp</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">triggertask</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">pmml</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">jdbc</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">twitterstream</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">python-jython</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">aggregate-counter</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">mongodb</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">groovy-transform</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">cassandra</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">gemfire-cq</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">httpclient</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">router</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">http</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">filter</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">redis-pubsub</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">rabbit</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">groovy-filter</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">file</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">tcp</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">aggregator</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">websocket</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">trigger</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">tensorflow</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">s3</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">mqtt</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">tasklaunchrequest-transform</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">rabbit</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">tcp-client</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">counter</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">mail</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">pgcopy</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">jdbc</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">gpfdist</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">gemfire</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">sftp</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">file</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">field-value-counter</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">hdfs</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">tcp</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;">gemfire</a></p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">task-launcher-cloudfoundry</p></td>
<td class="tableblock halign-left valign-top notranslate"></td>
</tr>
</tbody>
</table>
</div>
</div>
<h1 id="architecture" class="sect0"><font o="1052">架构</font></h1>
<div class="sect1">
<h2 id="arch-intro"><font o="1053">9.简介</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1054">Spring Cloud Data Flow简化了专注于数据处理用例的应用程序的开发和部署。</font><font o="1055">该体系结构的主要概念是Applications，Data Flow Server和目标运行时。</font></p>
</div>
<div class="paragraph">
<p><font o="1056">应用程序有两种形式：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1057">长期存在的Stream应用程序，通过消息传递中间件消耗或生成无限量的数据。</font></p>
</li>
<li>
<p><font o="1058">短期任务应用程序，处理有限的数据集然后终止。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1059">根据运行时的不同，应用程序可以通过两种方式打包：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1060">托管在maven存储库，文件或HTTP（S）中的Spring Boot uber-jar。</font></p>
</li>
<li>
<p><font o="1061">Docker图像。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1062">运行时是应用程序执行的位置。</font><font o="1063">应用程序的目标运行时是您可能已用于其他应用程序部署的平台。</font></p>
</div>
<div class="paragraph">
<p><font o="1064">支持的平台是：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cloud Foundry</p>
</li>
<li>
<p><font o="1066">Kubernetes</font></p>
</li>
<li>
<p><font o="1067">本地服务器</font></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1068">
生产中支持本地服务器以进行任务部署，以替代Spring Batch Admin项目。</font><font o="1069">Stream部署的生产中不支持本地服务器。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1070">有一个部署服务提供程序接口（SPI），允许您扩展数据流以部署到其他运行时。</font><font o="1071">社区实施</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javascript:;"><font o="1072">HashiCorp Nomad</font></a></p>
</li>
<li>
<p><a href="javascript:;"><font o="1073">OpenShift</font></a></p>
</li>
<li>
<p><a href="javascript:;"><font o="1074">Apache Mesos</font></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1075">在</font><a href="javascript:;"><font o="1075">Apache的纱</font></a><font o="1075">实现已达到最终的在线状态。</font><font o="1076">如果您有兴趣让项目继续开发和维护，请</font><font o="1076">在</font><a href="javascript:;"><font o="1076">Gitter</font></a><font o="1076">告诉我们</font><font o="1076">。</font></p>
</div>
<div class="paragraph">
<p><font o="1077">有两个互斥选项可确定将流应用程序部署到平台的时间。</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="1078">选择面向单个平台的Spring Cloud Data Flow服务器可执行jar。</font></p>
</li>
<li>
<p><font o="1079">使Spring Cloud Data Flow服务器能够将应用程序的部署和运行时状态委派给Spring Cloud Skipper Server，后者具有部署到多个平台的能力。</font></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><font o="1080">选择Spring Cloud Skipper选项还可以在运行时更新和回滚Stream中的应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="1081">数据流服务器还负责：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1082">解释和执行流DSL，该流描述通过多个长期存在的应用程序的数据逻辑流。</font></p>
</li>
<li>
<p><font o="1083">启动一个长期存在的任务应用程序。</font></p>
</li>
<li>
<p><font o="1084">解释和执行组合任务DSL，描述通过多个短期应用程序的数据逻辑流程。</font></p>
</li>
<li>
<p><font o="1085">应用描述应用程序到运行时映射的部署清单 - 例如，设置初始实例数，内存要求和数据分区。</font></p>
</li>
<li>
<p><font o="1086">提供已部署应用程序的运行时状态。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1087">作为示例，用于描述从HTTP源到Apache Cassandra接收器的数据流的流DSL将使用Unix管道和过滤器语法“<code i="148">http | cassandra</code>”来编写。</font><font o="1088">DSL中的每个名称都映射到可以存储Maven或Docker存储库的应用程序。</font><font o="1089">您还可以将申请注册到<code i="149">http</code>位置。</font><font o="1090">许多常见用例（例如JDBC，HDFS，HTTP和路由器）的源，处理器和接收器应用程序由Spring Cloud Data Flow团队提供。</font><font o="1091">管道符号表示通过消息传递中间件在两个应用程序之间进行通信。</font><font o="1092">支持的两个消息传递中间件代理是：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Apache Kafka</p>
</li>
<li>
<p>RabbitMQ</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1095">在Kafka的情况下，在部署流时，数据流服务器负责创建与每个管道符号对应的主题，并配置每个应用程序以生成或使用主题，从而实现所需的数据流。</font><font o="1096">类似地，对于RabbitMQ，根据需要创建交换和队列以实现期望的流。</font></p>
</div>
<div class="paragraph">
<p><font o="1097">主要组件的交互如下图所示：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-arch.png" alt="Spring Cloud数据流高级架构">
</div>
<div class="title"><font o="1098">图2. Spring Cloud数据高级Architecure</font></div>
</div>
<div class="paragraph">
<p><font o="1099">在上图中，流的DSL描述被POST到数据流服务器。</font><font o="1100">基于DSL应用程序名称到Maven和Docker工件的映射，http-source和cassandra-sink应用程序部署在目标运行时上。</font><font o="1101">然后，发布到HTTP应用程序的数据将存储在Cassandra中。</font><font o="1102">的</font><a href="javascript:;"><font o="1102">样品Repository</font></a><font o="1102">显示了在全部细节这种使用情况。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="arch-microservice-style"><font o="1103">10.微服务架构风格</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1104">数据流服务器将应用程序部署到符合微服务架构风格的目标运行时。</font><font o="1105">例如，流表示一个高级应用程序，它由多个小型微服务应用程序组成，每个应用程序都在自己的进程中运行。</font><font o="1106">每个微服务应用程序可以独立于另一个扩展或缩小，并且每个应用程序都有自己的版本控制生命周期。</font><font o="1107">通过使用带有Skipper的数据流，您可以在运行时独立升级或回滚每个应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="1108">Streaming和基于任务的微服务应用程序都基于Spring Boot作为基础库。</font><font o="1109">这为所有微服务应用程序提供了诸如运行状况检查，安全性，可配置日志记录，监视和管理功能以及可执行JAR打包等功能。</font></p>
</div>
<div class="paragraph">
<p><font o="1110">需要强调的是，这些微服务应用程序只是“应用程序”，您可以使用<code i="150">java -jar</code>并传递适当的配置属性来自行运行。</font><font o="1111">我们为常见操作提供了许多常见的微服务应用程序，因此在处理基于Spring项目的丰富生态系统的常见用例时，您无需从头开始，例如Spring Integration，Spring Data和Spring Batch。</font><font o="1112">创建自己的微服务应用程序与创建其他Spring Boot应用程序类似。</font><font o="1113">您可以首先使用</font><a href="javascript:;"><font o="1113">Spring Initializr web站点</font></a><font o="1113">来创建基于Stream或任务的微服务的基本支架。</font></p>
</div>
<div class="paragraph">
<p><font o="1114">除了将适当的应用程序属性传递给每个应用程序之外，数据流服务器还负责准备目标平台的基础结构，以便可以部署应用程序。</font><font o="1115">例如，在Cloud Foundry中，它会将指定的服务绑定到应用程序，并为每个应用程序执行<code i="151">cf push</code>命令。</font><font o="1116">对于Kubernetes，它将创建复制控制器，服务和负载均衡器。</font></p>
</div>
<div class="paragraph">
<p><font o="1117">数据流服务器有助于简化将多个相关应用程序部署到目标运行时，设置必要的输入和输出主题，分区和度量标准功能。</font><font o="1118">但是，也可以选择手动部署每个微服务应用程序，而根本不使用数据流。</font><font o="1119">对于小规模部署而言，这种方法可能更合适，在开发更多应用程序时逐渐采用数据流的便利性和一致性。</font><font o="1120">手动部署基于流和任务的微服务也是一项有用的教育练习，可以帮助您更好地理解数据流服务器提供的一些自动应用程序配置和平台定位步骤。</font></p>
</div>
<div class="sect2">
<h3 id="arch-comparison">10.1.<font o="1122">与其他平台架构的比较</font></h3>
<div class="paragraph">
<p><font o="1123">Spring Cloud Data Flow的架构风格与其他Stream和Batch处理平台不同。</font><font o="1124">例如，在Apache Spark，Apache Flink和Google Cloud Dataflow中，应用程序在专用计算引擎集群上运行。</font><font o="1125">与Spring Cloud Data Flow相比，计算引擎的性质为这些平台提供了更丰富的环境，可以对数据执行复杂的计算，但它引入了创建以数据为中心的应用程序时通常不需要的另一个执行环境的复杂性。</font><font o="1126">这并不意味着您在使用Spring Cloud Data Flow时无法进行实时数据计算。</font><font o="1127">请参阅“ </font><a href="#arch-analytics"><font o="1127">分析</font></a><font o="1127"> ”部分</font><font o="1127">，该</font><font o="1127">部分</font><font o="1127">描述了Redis与处理常见的基于计数的用例的集成。</font><font o="1128">Spring Cloud Stream还支持使用Reactive API，例如</font><a href="javascript:;"><font o="1128">Project Reactor和RxJava</font></a><font o="1128">，这对于创建包含时间滑动窗口和移动平均功能的功能样式应用程序非常有用。</font><font o="1129">同样，Spring Cloud Stream也支持使用</font><a href="javascript:;"><font o="1129">Kafka Streams</font></a><font o="1129"> API </font><font o="1129">开发应用程序</font><font o="1129">。</font></p>
</div>
<div class="paragraph">
<p><font o="1130">Apache Storm，Hortonworks DataFlow和Spring Cloud Data Flow的前身Spring XD使用专用的应用程序执行集群，该集群对每个产品都是唯一的，它确定代码应在集群上运行的位置并执行运行状况检查以确保如果失败，则重新启动长期应用程序。</font><font o="1131">通常，需要特定于框架的接口才能正确地“插入”到集群的执行框架。</font></p>
</div>
<div class="paragraph">
<p><font o="1132">正如我们在Spring XD的发展过程中发现的那样，2015年多个容器框架的兴起使我们自己的运行时创建了重复工作。</font><font o="1133">当有多个运行时平台已经提供此功能时，没有理由构建自己的资源管理机制。</font><font o="1134">考虑到这些因素是我们转向当前架构的原因，我们将执行委托给流行的运行时，您可能已将其用于其他目的。</font><font o="1135">这是一个优势，因为它减少了创建和管理以数据为中心的应用程序的认知距离，因为许多用于部署其他最终用户/ web应用程序的相同技能都适用。</font></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="arch-data-flow-server"><font o="1136">11.数据流服务器</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1137">数据流服务器提供以下功能：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#arch-data-flow-server-endpoints"><font o="1138">端点</font></a></p>
</li>
<li>
<p><a href="#arch-data-flow-server-security"><font o="1139">安全</font></a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="arch-data-flow-server-endpoints">11.1.<font o="1141">端点</font></h3>
<div class="paragraph">
<p><font o="1142">数据流服务器使用嵌入式servlet容器并公开REST端点，用于创建，部署，取消部署和销毁流和任务，查询运行时状态，分析等。</font><font o="1143">数据流服务器通过使用Spring的MVC框架和</font><a href="javascript:;"><font o="1143">Spring HATEOAS</font></a><font o="1143">库来实现，以创建遵循HATEOAS原则的REST表示，如下图所示：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-server-arch.png" alt="Spring Cloud数据流服务器架构">
</div>
<div class="title"><font o="1144">图3. Spring Cloud Data Flow服务器</font></div>
</div>
<div class="paragraph">
<p><font o="1145">[注意]将应用程序部署到本地计算机的数据流服务器不打算用于流式用例的生产，而是用于开发和测试基于流的应用程序。</font><font o="1146">本地数据流量</font><strong><font o="1146">是</font></strong><font o="1146">打算在生产中使用批量使用情况作为Spring Batch管理项目的替代品。</font><font o="1147">流式和批量使用情况都是在部署到Cloud Foundry或Kuberenetes时用于生产。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="arch-data-flow-server-security">11.2.<font o="1149">安全</font></h3>
<div class="paragraph">
<p><font o="1150">数据流服务器可执行jar支持基本HTTP，LDAP（S），基于文件和OAuth 2.0身份验证以访问其端点。</font><font o="1151">有关更多信息，</font><font o="1151">请参阅</font><a href="#configuration-security"><font o="1151">安全性部分</font></a><font o="1151">。</font></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="arch-streams"><font o="1152">12.流</font></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="arch-streams-topologies">12.1.<font o="1154">拓扑</font></h3>
<div class="paragraph">
<p><font o="1155">Stream DSL描述了流经系统的线性数据序列。</font><font o="1156">例如，在流定义<code i="152">http | transformer | cassandra</code>中，每个管道符号将左侧的应用程序连接到右侧的应用程序。</font><font o="1157">命名通道可用于路由和扇出/扇出数据到多个消息传递目的地。</font></p>
</div>
<div class="paragraph">
<p><font></font><a href="#spring-cloud-dataflow-stream-dsl-tap"><font o="1158">敲击</font></a><font o="1158">的概念</font><font o="1158">可用于“监听”流过任何管道符号的数据。</font><font o="1159">“Taps”只是其他流，它们使用输入目标流中的任何一个“管道”，并且与目标流具有独立的生命周期。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="arch-streams-concurrency">12.2.<font o="1161">并发</font></h3>
<div class="paragraph">
<p><font o="1162">对于使用事件的应用程序，Spring Cloud Stream公开了一个并发设置，该设置控制用于调度传入消息的线程池的大小。</font><font o="1163">有关</font><font o="1163">更多信息，</font><font o="1163">请参阅</font><a href="javascript:;"><font o="1163">使用者属性</font></a><font o="1163">文档。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="arch-streams-partitioning">12.3.<font o="1165">分区</font></h3>
<div class="paragraph">
<p><font o="1166">流处理中的常见模式是在数据从一个应用程序移动到下一个应用程序时对数据进行分区。</font><font o="1167">出于性能或一致性原因，分区是有状态处理中的关键概念，以确保所有相关数据一起处理。</font><font o="1168">例如，在时间窗口平均计算示例中，重要的是来自任何给定传感器的所有测量都由相同的应用实例处理。</font><font o="1169">或者，您可能希望缓存与传入事件相关的一些数据，以便可以在不进行远程过程调用的情况下丰富它以检索相关数据。</font></p>
</div>
<div class="paragraph">
<p><font o="1170">Spring Cloud Data Flow通过配置Spring Cloud Stream的输出和输入绑定来支持分区。</font><font o="1171">Spring Cloud Stream提供了一种通用抽象，用于跨不同类型的中间件以统一的方式实现分区处理用例。</font><font o="1172">因此，无论代理本身是自然分区（例如，Kafka主题）还是不分区（RabbitMQ），都可以使用分区。</font><font o="1173">下图显示了如何将数据分区为两个存储区，以便平均处理器应用程序的每个实例都使用一组唯一的数据。</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/stream-partitioning.png" alt="流分区架构">
</div>
<div class="title"><font o="1174">图4. Spring Cloud Stream分区</font></div>
</div>
<div class="paragraph">
<p><font o="1175">要在Spring Cloud Data Flow中使用简单的分区策略，您只需为流中的每个应用程序设置实例计数，并在部署流时设置<code i="153">partitionKeyExpression</code>生产者属性。</font><font o="1176"><code i="154">partitionKeyExpression</code>标识消息的哪个部分用作分区底层中间件中数据的密钥。</font><font o="1177"><code i="155">ingest</code>流可以定义为<code i="156">http | averageprocessor | cassandra</code>。</font><font o="1178">（请注意，Cassandra接收器未在上图中显示。）假设发送到HTTP源的有效负载是JSON格式，并且有一个名为<code i="157">sensorId</code>的字段。</font><font o="1179">例如，考虑使用shell命令<code i="158">stream deploy ingest --propertiesFile ingestStream.properties</code>部署流的情况，其中<code i="159">ingestStream.properties</code>文件的内容如下：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">deployer.http.count=3
deployer.averageprocessor.count=2
app.http.producer.partitionKeyExpression=payload.sensorId</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1180">结果是部署流，以便配置所有输入和输出目标以使数据流过应用程序，同时确保始终将一组唯一数据传递到每个<code i="160">averageprocessor</code>实例。</font><font o="1181">在这种情况下，默认算法是评估<code i="161">payload.sensorId % partitionCount</code> <code i="162">partitionCount</code>，其中<code i="162">partitionCount</code>是RabbitMQ的应用程序计数，而Kafka是主题的分区计数。</font></p>
</div>
<div class="paragraph">
<p><font o="1182">有关</font><font o="1182">在部署期间对流进行分区的其他策略以及它们如何映射到基础</font><a href="javascript:;"><font o="1182">Spring Cloud Stream分区属性，</font></a><font o="1182">请参阅</font><a href="#passing_stream_partition_properties"><font o="1182">传递流分区Properties</font></a><font o="1182">。</font><a href="javascript:;"><font></font></a><font></font></p>
</div>
<div class="paragraph">
<p><font o="1183">另请注意，您目前无法扩展分区流。</font><a href="#arch-runtime-scaling"><font o="1184">在运行时</font></a><font o="1184">读取</font><a href="#arch-runtime-scaling"><font o="1184">缩放以</font></a><font o="1184">获取更多信息。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="arch-streams-delivery">12.4.<font o="1186">消息传递保证</font></h3>
<div class="paragraph">
<p><font o="1187">Streams由使用Spring Cloud Stream库作为与底层消息传递中间件产品进行通信的基础的应用程序组成。</font><font o="1188">Spring Cloud Stream还提供了来自多个供应商的中间件的固定配置，特别是提供</font><a href="javascript:;"><font o="1188">持久的发布 - 订阅语义</font></a><font o="1188">。</font></p>
</div>
<div class="paragraph">
<p><font o="1189">Spring Cloud Stream中</font><font o="1189">的</font><a href="javascript:;"><font o="1189">Binder抽象</font></a><font o="1189">是将应用程序连接到中间件的原因。</font><font o="1190">绑定器的几个配置属性可以跨所有绑定器实现移植，还有一些属于中间件。</font></p>
</div>
<div class="paragraph">
<p><font o="1191">对于使用者应用程序，在消息处理期间生成的异常存在重试策略。</font><font o="1192">通过使用</font><a href="javascript:;"><font o="1192">公共使用者属性</font></a><font o="1192"> <code i="163">maxAttempts</code>，<code i="164">backOffInitialInterval</code>，<code i="165">backOffMaxInterval</code>和<code i="166">backOffMultiplier</code> </font><font o="1192">配置重试策略</font><font o="1192">。</font><font o="1193">这些属性的默认值重试回调方法调用3次，并等待一秒钟进行第一次重试。</font><font o="1194">退避乘数2用于第二次和第三次尝试。</font></p>
</div>
<div class="paragraph">
<p><font o="1195">当重试次数超过<code i="167">maxAttempts</code>值时，异常和失败的消息将成为消息的有效负载，并发送到应用程序的错误通道。</font><font o="1196">默认情况下，此错误通道的默认消息处理程序会记录该消息。</font><font o="1197">您可以通过创建自己的订阅错误通道的消息处理程序来更改应用程序中的默认行为。</font></p>
</div>
<div class="paragraph">
<p><font o="1198">Spring Cloud Stream还支持Kafka和RabbitMQ绑定器实现的配置选项，它们将失败的消息和堆栈跟踪发送到死信队列。</font><font o="1199">死信队列是一个目的地，其性质取决于消息中间件（例如，在Kafka的情况下，它是一个专用主​​题）。</font><font o="1200">要为RabbitMQ启用此功能，请</font><font o="1200">在部署流时将</font><font o="1200"><code i="168">republishtoDlq</code>和<code i="169">autoBindDlq</code> </font><a href="javascript:;"><font o="1200">使用者属性</font></a><font o="1200">和<code i="170">autoBindDlq</code> </font><a href="javascript:;"><font o="1200">生产者属性设置</font></a><font o="1200">为true。</font><font o="1201">要在部署流时始终应用这些生产者和使用者属性，请</font><font o="1201">在启动数据流服务器</font><font o="1201">时将它们配置为</font><a href="#spring-cloud-dataflow-global-properties"><font o="1201">常用应用程序属性</font></a><font o="1201">。</font></p>
</div>
<div class="paragraph">
<p><font o="1202">其他消息传递保证是由为应用程序选择生成和使用应用程序而选择的底层消息传递中间件提供的保证。</font><font o="1203">有关更多详细信息，</font><font o="1203">请参阅Kafka </font><a href="javascript:;"><font o="1203">消费者</font></a><font o="1203">和</font><a href="javascript:;"><font o="1203">生产者</font></a><font o="1203">以及Rabbit </font><a href="javascript:;"><font o="1203">消费者</font></a><font o="1203">和</font><a href="javascript:;"><font o="1203">生产者</font></a><font o="1203">文档。</font><font o="1204">您可以找到所有本机QOS选项的广泛声明支持。</font></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="arch-streaming-apps"><font o="1205">13.流编程模型</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1206">虽然Spring Boot为创建DevOps友好的微服务应用程序提供了基础，但Spring生态系统中的其他库有助于创建基于流的微服务应用程序。</font><font o="1207">其中最重要的是Spring Cloud Stream。</font></p>
</div>
<div class="paragraph">
<p><font o="1208">Spring Cloud Stream编程模型的本质是提供一种简单的方法来描述通过消息传递中间件进行通信的应用程序的多个输入和输出。</font><font o="1209">这些输入和输出映射到Kafka主题或Rabbit交换和队列以及KStream / KTable编程模型。</font><font o="1210">生成数据的Source，消耗和生成数据的处理器以及消耗数据的Sink的常见应用程序配置作为库的一部分提供。</font></p>
</div>
<div class="sect2">
<h3 id="arch-streaming-imperative-programming">13.1.<font o="1212">命令式编程模型</font></h3>
<div class="paragraph">
<p><font o="1213">Spring Cloud Stream与Spring Integration的命令式“一次一个事件”编程模型最紧密地结合在一起。</font><font o="1214">这意味着您编写处理单个事件回调的代码，如以下示例所示，</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">@EnableBinding(Sink.class)
public class LoggingSink {

    @StreamListener(Sink.INPUT)
    public void log(String message) {
        System.out.println(message);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1215">在这种情况下，输入通道上的消息的<code i="171">String</code>有效载荷将传递给<code i="172">log</code>方法。</font><font o="1216"><code i="173">@EnableBinding</code>注释用于将输入通道绑定到外部中间件。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="arch-streaming-functional-programming">13.2.<font o="1218">功能编程模型</font></h3>
<div class="paragraph">
<p><font o="1219">但是，Spring Cloud Stream可以支持其他编程样式，例如反应式API，其中传入和传出数据作为连续数据流处理，以及如何处理每个单独的消息。</font><font o="1220">对于许多反应性AOI，您还可以使用描述从入站数据流到出站数据流的功能转换的运算符。</font><font o="1221">这是一个例子：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">@EnableBinding(Processor.class)
public static class UppercaseTransformer {

  @StreamListener
  @Output(Processor.OUTPUT)
  public Flux&lt;String&gt; receive(@Input(Processor.INPUT) Flux&lt;String&gt; input) {
    return input.map(s -&gt; s.toUpperCase());
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="arch-application-versioning"><font o="1222">14.应用程序版本控制</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1223">现在，在将数据流与Skipper一起使用时，现在支持在Stream中进行应用程序版本控制。</font><font o="1224">您可以更新应用程序和部署属性以及应用程序的版本。</font><font o="1225">还支持回滚到先前的应用程序版本。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="arch-task"><font o="1226">15.任务编程模型</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1227">Spring Cloud Task编程模型提供：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1228">持久化任务的生命周期事件和退出代码状态。</font></p>
</li>
<li>
<p><font o="1229">生命周期钩子在任务执行之前或之后执行代码。</font></p>
</li>
<li>
<p><font o="1230">在任务生命周期中将任务事件发送到流（作为源）的能力。</font></p>
</li>
<li>
<p><font o="1231">与Spring Batch工作集成。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1232">有关</font><font o="1232">更多信息，</font><font o="1232">请参阅</font><a href="#spring-cloud-dataflow-task"><font o="1232">任务</font></a><font o="1232">部分。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="arch-analytics"><font o="1233">16.分析</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1234">Spring Cloud Data Flow知道某些Sink应用程序将计数器数据写入Redis并提供REST端点来读取计数器数据。</font><font o="1235">支持的计数器类型如下：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javascript:;"><font o="1236">计数器</font></a><font o="1236">：计算收到的消息数，可选择将计数存储在Redis等单独的存储中。</font></p>
</li>
<li>
<p><a href="javascript:;"><font o="1237">字段值计数器</font></a><font o="1237">：计算消息有效内容中命名字段的唯一值的出现次数。</font></p>
</li>
<li>
<p><a href="javascript:;"><font o="1238">聚合计数器</font></a><font o="1238">：存储总计数，但也保留每分钟，小时，日和月的总计数值。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1239">请注意，聚合计数器中使用的时间戳可以来自消息本身中的字段，以便正确计算无序消息。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="arch-runtime"><font o="1240">17.运行时</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1241">数据流服务器依赖于目标平台来实现以下运行时功能：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#arch-runtime-fault-tolerance"><font o="1242">容错</font></a></p>
</li>
<li>
<p><a href="#arch-runtime-resource-management"><font o="1243">资源管理</font></a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="arch-runtime-fault-tolerance">17.1.<font o="1245">容错</font></h3>
<div class="paragraph">
<p><font o="1246">数据流支持的目标运行时都能够重新启动长期存在的应用程序。</font><font o="1247">部署应用程序时，运行时环境需要Spring Cloud Data Flow设置运行状况探测器。</font><font o="1248">您还可以自定义运行状况探测器。</font></p>
</div>
<div class="paragraph">
<p><font o="1249">组成流的所有应用程序的集合状态用于确定流的状态。</font><font o="1250">如果应用程序失败，则流的状态将从“已部署”更改为“部分”。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="arch-runtime-resource-management">17.2.<font o="1252">资源管理</font></h3>
<div class="paragraph">
<p><font o="1253">每个目标运行时都允许您控制分配给每个应用程序的内存，磁盘和CPU的数量。</font><font o="1254">它们通过使用每个运行时唯一的键名称作为部署清单中的属性传递。</font><font o="1255">有关更多信息，请参阅每个平台的服务器文档。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="arch-runtime-scaling">17.3.<font o="1257">在运行时缩放</font></h3>
<div class="paragraph">
<p><font o="1258">部署流时，您可以为组成流的每个应用程序设置实例计数。</font><font o="1259">部署流后，每个目标运行时都允许您控制每个应用程序的目标实例数。</font><font o="1260">使用每个运行时的API，UI或命令行工具，您可以根据需要向上或向下扩展实例数。</font></p>
</div>
<div class="paragraph">
<p><font o="1261">目前，Kafka绑定器以及分区流不支持运行时扩展，建议的解决方法是使用更新的实例数重新部署流。</font><font o="1262">两种情况都需要根据有关总实例数和当前实例索引的信息来设置静态使用者。</font></p>
</div>
</div>
</div>
</div>
<h1 id="configuration" class="sect0"><font o="1263">组态</font></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p><font o="1264">本节介绍如何配置Spring Cloud Data Flow服务器的功能，例如要使用的关系数据库和安全性。</font><font o="1265">它还介绍了如何配置Spring Cloud Data Flow的shell功能。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="enable-disable-specific-features"><font o="1266">18.功能切换</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1267">Sprig Cloud Data Flow Server提供了一组特定功能，可在启动时启用/禁用。</font><font o="1268">这些功能包括所有生命周期操作和REST端点（服务器和客户端实现，包括shell和UI）：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1269">流</font></p>
</li>
<li>
<p><font o="1270">任务</font></p>
</li>
<li>
<p><font o="1271">Analytics（分析）</font></p>
</li>
<li>
<p><font o="1272">船长</font></p>
</li>
<li>
<p><font o="1273">任务计划程序</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1274">可以通过在启动数据流服务器时设置以下布尔属性来启用和禁用这些功能：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>spring.cloud.dataflow.features.streams-enabled</code></p>
</li>
<li>
<p><code>spring.cloud.dataflow.features.tasks-enabled</code></p>
</li>
<li>
<p><code>spring.cloud.dataflow.features.analytics-enabled</code></p>
</li>
<li>
<p><code>spring.cloud.dataflow.features.skipper-enabled</code></p>
</li>
<li>
<p><code>spring.cloud.dataflow.features.schedules-enabled</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1275">默认情况下，启用流，任务和分析，默认情况下禁用Skipper和Task Scheduler。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1276">
由于默认情况下启用了分析功能，因此数据流服务器希望将有效的Redis存储作为分析存储库提供给服务器，因为Spring Cloud Data Flow提供了基于Redis的默认分析实现。</font><font o="1277">这也意味着数据流服务器的<code i="174">health</code>也取决于redis商店的可用性。</font><font o="1278">如果您不希望Data Flow的端点读取写入Redis的分析数据，请通过设置上述属性来禁用分析功能。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1279">REST <code i="175">/about</code>端点提供有关已启用和禁用的功能的信息。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-rdbms"><font o="1280">19.数​​据库</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1281">关系数据库用于存储流和任务定义以及执行任务的状态。</font><font o="1282">Spring Cloud Data Flow为H2，HSQLDB，MySQL，Oracle，Postgresql，DB2和SqlServer提供模式。</font><font o="1283">服务器启动时会自动创建架构。</font></p>
</div>
<div class="paragraph">
<p><font o="1284">默认情况下，Spring Cloud Data Flow提供H2数据库的嵌入式实例。</font><font o="1285">H2数据库有利于开发目的，但不建议用于生产。</font></p>
</div>
<div class="paragraph">
<p><font></font><strong><font o="1286">MySQL</font></strong><font o="1286">（通过MariaDB驱动程序），</font><strong><font o="1286">HSQLDB</font></strong><font o="1286">，</font><strong><font o="1286">PostgreSQL</font></strong><font o="1286">和嵌入式</font><strong><font o="1286">H2</font></strong><font o="1286">的JDBC驱动程序</font><font o="1286">无需额外配置即可使用。</font><font o="1287">如果您正在使用任何其他数据库，则需要将相应的JDBC驱动程序jar放在服务器的类路径上。</font></p>
</div>
<div class="paragraph">
<p><font o="1288">数据库属性可以作为环境变量或命令行参数传递给数据流服务器。</font></p>
</div>
<div class="paragraph">
<p><font o="1289">以下示例显示如何使用环境变量定义数据库连接：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">export spring_datasource_url=jdbc:postgresql://localhost:5432/mydb
export spring_datasource_username=myuser
export spring_datasource_password=mypass
export spring_datasource_driver_class_name="org.postgresql.Driver"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1290">以下示例显示如何使用命令行参数定义MySQL数据库连接</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">java -jar spring-cloud-dataflow-server-local/target/spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar \
    --spring.datasource.url=jdbc:mysql://localhost:3306/mydb \
    --spring.datasource.username=<user> \
    --spring.datasource.password=<password> \
    --spring.datasource.driver-class-name=org.mariadb.jdbc.Driver &amp;</password></user></code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1291">以下示例显示如何使用命令行参数定义PostgreSQL数据库连接：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">java -jar spring-cloud-dataflow-server-local/target/spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar \
    --spring.datasource.url=jdbc:postgresql://localhost:5432/mydb \
    --spring.datasource.username=<user> \
    --spring.datasource.password=<password> \
    --spring.datasource.driver-class-name=org.postgresql.Driver &amp;</password></user></code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1292">以下示例显示如何使用命令行参数定义HSQLDB数据库连接：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">java -jar spring-cloud-dataflow-server-local/target/spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar \
    --spring.datasource.url=jdbc:hsqldb://localhost:9001/mydb \
    --spring.datasource.username=SA \
    --spring.datasource.driver-class-name=org.hsqldb.jdbc.JDBCDriver &amp;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1293">
如果您希望使用外部H2数据库实例而不是嵌入Spring Cloud Data Flow的实例，请将<code i="176">spring.dataflow.embedded.database.enabled</code>属性设置为false。</font><font o="1294">如果<code i="177">spring.dataflow.embedded.database.enabled</code>设置为false或者将h2以外的数据库指定为数据源，则嵌入式数据库不会启动。
</font></td>
</tr>
</tbody></table>
</div>
<div class="sect2">
<h3 id="_disabling_database_schema_creation_and_migration_strategies">19.1.<font o="1296">禁用数据库架构创建和迁移策略</font></h3>
<div class="paragraph">
<p><font o="1297">您可以控制数据流是否在启动时引导数据库。</font><font o="1298">在大多数生产环境中，您可能无法获得足够的权限。</font><font o="1299">如果是这种情况，您可以通过将属性<code i="178">spring.cloud.dataflow.rdbms.initialize.enable</code>设置为<code i="179">false</code>来禁用它。</font><font o="1300">可以在<code i="180">spring-cloud-dataflow-core/src/main/resources/</code>文件夹下找到服务器用于引导数据库的脚本。</font></p>
</div>
<div class="paragraph">
<p><font o="1301">对于新安装，运行位于<code i="181">/schemas</code>和<code i="182">/migrations.1.x.x</code>下的相应数据库脚本，对于版本<code i="183">1.2.0</code>的升级，您只需运行<code i="184">/migrations.1.x.x</code>脚本。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_adding_a_custom_jdbc_driver">19.2.<font o="1303">添加自定义JDBC驱动程序</font></h3>
<div class="paragraph">
<p><font o="1304">要为数据库添加自定义驱动程序（例如，Oracle），您应该重建数据流服务器并将依赖项添加到Maven <code i="185">pom.xml</code>文件。</font><font o="1305">由于每个目标平台都有一个Spring Cloud Data Flow服务器，因此您需要为每个平台修改相应的maven <code i="186">pom.xml</code>。</font><font o="1306">每个服务器版本的每个GitHub存储库中都有标记。</font></p>
</div>
<div class="paragraph">
<p><font o="1307">要为本地服务器实现添加自定义JDBC驱动程序依赖项：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="1308">选择与要重建的服务器版本对应的标记并克隆github存储库。</font></p>
</li>
<li>
<p><font o="1309">编辑spring-cloud-dataflow-server-local / pom.xml，并在<code i="187">dependencies</code>部分中添加所需数据库驱动程序的依赖项。</font><font o="1310">在以下示例中，已选择Oracle驱动程序：</font></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
...
  &lt;dependency&gt;
    &lt;groupId&gt;com.oracle.jdbc&lt;/groupId&gt;
    &lt;artifactId&gt;ojdbc8&lt;/artifactId&gt;
    &lt;version&gt;12.2.0.1&lt;/version&gt;
  &lt;/dependency&gt;
...
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p><font o="1311">构建应用程序，如</font><a href="#building"><font o="1311">构建Spring Cloud Data Flow中所述</font></a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><font o="1312">您还可以通过向dataflow-server.yml文件添加必要的属性来重建服务器时提供默认值，如以下PostgreSQL示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/mydb
    username: myuser
    password: mypass
    driver-class-name:org.postgresql.Driver</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-deployer"><font o="1313">20.当地部署人员</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1314">您可以使用Data Flow Local服务器部署程序的以下配置属性来自定义应用程序的部署方式：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-properties" data-lang="properties">spring.cloud.deployer.local.workingDirectoriesRoot=java.io.tmpdir # Directory in which all created processes will run and create log files.

spring.cloud.deployer.local.deleteFilesOnExit=true # Whether to delete created files and directories on JVM exit.

spring.cloud.deployer.local.envVarsToInherit=TMP,LANG,LANGUAGE,"LC_.*. # Array of regular expression patterns for environment variables that are passed to launched applications.

spring.cloud.deployer.local.javaCmd=java # Command to run java.

spring.cloud.deployer.local.shutdownTimeout=30 # Max number of seconds to wait for app shutdown.

spring.cloud.deployer.local.javaOpts= # The Java options to pass to the JVM

spring.cloud.deployer.local.freeDiskSpacePercentage=5 # The target percentage of free disk space to always aim for when cleaning downloaded resources (typically via the local maven repository). Specify as an integer greater than zero and less than 100. Default is 5.</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="1315">数据流本地服务器本身从其默认值覆盖<code i="188">spring.cloud.deployer.local.freeDiskSpacePercentage</code>到<code i="189">0</code>。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1316">部署应用程序时，您还可以设置以<code i="190">deployer.&lt;name of application&gt;</code>为前缀的部署程序属性。</font><font o="1317">例如，要在<code i="191">ticktock</code>流中为时间应用程序设置Java选项，请使用以下流部署属性。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; stream create --name ticktock --definition "time --server.port=9000 | log"
dataflow:&gt; stream deploy --name ticktock --properties "deployer.time.local.javaOpts=-Xmx2048m -Dtest=foo"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1318">为方便起见，您可以设置<code i="192">deployer.memory</code>属性以设置Java选项<code i="193">-Xmx</code>，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; stream deploy --name ticktock --properties "deployer.time.memory=2048m"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1319">在部署时，如果在<code i="195">deployer.&lt;app&gt;.local.javaOpts</code>属性中指定<code i="194">-Xmx</code>选项以及<code i="196">deployer.&lt;app&gt;.local.memory</code>选项的值，则<code i="197">javaOpts</code>属性中的值具有优先权。</font><font o="1320">此外，部署应用程序时设置的<code i="198">javaOpts</code>属性优先于数据流服务器的<code i="199">spring.cloud.deployer.local.javaOpts</code>属性。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-maven"><font o="1321">21. Maven</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1322">如果要覆盖特定的maven配置属性（远程存储库，代理和其他）或在代理后面运行数据流服务器，则需要在启动数据流服务器时将这些属性指定为命令行参数，如下所示例：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar --maven.localRepository=mylocal
--maven.remote-repositories.repo1.url=https://repo1
--maven.remote-repositories.repo1.auth.username=user1
--maven.remote-repositories.repo1.auth.password=pass1
--maven.remote-repositories.repo1.snapshot-policy.update-policy=daily
--maven.remote-repositories.repo1.snapshot-policy.checksum-policy=warn
--maven.remote-repositories.repo1.release-policy.update-policy=never
--maven.remote-repositories.repo1.release-policy.checksum-policy=fail
--maven.remote-repositories.repo2.url=https://repo2
--maven.remote-repositories.repo2.policy.update-policy=always
--maven.remote-repositories.repo2.policy.checksum-policy=fail
--maven.proxy.host=proxy1
--maven.proxy.port=9010 --maven.proxy.auth.username=proxyuser1
--maven.proxy.auth.password=proxypass1</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1323">默认情况下，协议设置为<code i="200">http</code>。</font><font o="1324">如果代理不需要用户名和密码，则可以省略auth属性。</font><font o="1325">此外，maven <code i="201">localRepository</code>默认设置为<code i="202">${user.home}/.m2/repository/</code>。</font><font o="1326">如前面的示例所示，可以指定远程存储库及其身份验证（如果需要）。</font><font o="1327">如果远程存储库位于代理后面，则可以指定代理属性，如上例所示。</font></p>
</div>
<div class="paragraph">
<p><font o="1328">可以为每个远程存储库配置指定存储库策略，如上例所示。</font><font o="1329">密钥<code i="203">policy</code>适用于<code i="204">snapshot</code>和<code i="205">release</code>存储库策略。</font></p>
</div>
<div class="paragraph">
<p><font o="1330">您可以参考</font><a href="javascript:;"><font o="1330">Repository策略</font></a><font o="1330">以获取支持的存储库策略列表。</font></p>
</div>
<div class="paragraph">
<p><font o="1331">由于它们是Spring Boot <code i="206">@ConfigurationProperties</code>，您还可以将它们指定为环境变量，例如<code i="207">MAVEN_REMOTE_REPOSITORIES_REPO1_URL</code>。</font><font o="1332">另一个常见选项是通过设置<code i="208">SPRING_APPLICATION_JSON</code>环境变量来设置属性。</font><font o="1333">以下示例显示了JSON的结构：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ SPRING_APPLICATION_JSON='{ "maven": { "local-repository": null,
"remote-repositories": { "repo1": { "url": "https://repo1", "auth": { "username": "repo1user", "password": "repo1pass" } }, "repo2": { "url": "https://repo2" } },
"proxy": { "host": "proxyhost", "port": 9018, "auth": { "username": "proxyuser", "password": "proxypass" } } } }' java -jar spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-logging"><font o="1334">22.本地数据流服务器日志记录配置</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1335">Spring Cloud Data Flow <code i="209">local</code>服务器配置为使用<code i="210">RollingFileAppender</code>进行日志记录。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">logging:
  config: classpath:logback-scdf-local.xml</pre>
</div>
</div>
<div class="paragraph">
<p><font o="1336">默认情况下，日志文件配置为使用：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>&lt;property name="LOG_FILE" value="${LOG_FILE:-${LOG_PATH:-${LOG_TEMP:-${java.io.tmpdir:-/tmp}}}/spring-cloud-dataflow-server-local}"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1337">使用<code i="211">RollingPolicy</code>的logback配置：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">&lt;appender name="FILE"
			  class="ch.qos.logback.core.rolling.RollingFileAppender"&gt;
		&lt;file&gt;${LOG_FILE}.log&lt;/file&gt;
		&lt;rollingPolicy
				class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy"&gt;
			&lt;!-- daily rolling --&gt;
			&lt;fileNamePattern&gt;${LOG_FILE}.${LOG_FILE_ROLLING_FILE_NAME_PATTERN:-%d{yyyy-MM-dd}}.%i.gz&lt;/fileNamePattern&gt;
			&lt;maxFileSize&gt;${LOG_FILE_MAX_SIZE:-100MB}&lt;/maxFileSize&gt;
			&lt;maxHistory&gt;${LOG_FILE_MAX_HISTORY:-30}&lt;/maxHistory&gt;
			&lt;totalSizeCap&gt;${LOG_FILE_TOTAL_SIZE_CAP:-500MB}&lt;/totalSizeCap&gt;
		&lt;/rollingPolicy&gt;
		&lt;encoder&gt;
			&lt;pattern&gt;${FILE_LOG_PATTERN}&lt;/pattern&gt;
		&lt;/encoder&gt;
	&lt;/appender&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><font o="1338">要检查当前Spring Cloud Data Flow服务器<code i="213">local</code>服务器的<code i="212">java.io.tmpdir</code>，</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>jinfo &lt;pid&gt; | grep "java.io.tmpdir"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1339">如果您想更改或覆盖任何属性<code i="214">LOG_FILE</code>，<code i="215">LOG_PATH</code>，<code i="216">LOG_TEMP</code>，<code i="217">LOG_FILE_MAX_SIZE</code>，<code i="218">LOG_FILE_MAX_HISTORY</code>和<code i="219">LOG_FILE_TOTAL_SIZE_CAP</code>，请将它们设置为系统属性。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-skipper"><font o="1340">23.船长</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1341">要使用Stream更新和回滚等功能，Data Flow Server会委托Skipper服务器来管理Stream的生命周期。</font><font o="1342">将配置属性<code i="220">spring.cloud.skipper.client.serverUri</code>设置为Skipper的位置，例如</font></p>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar --spring.cloud.skipper.client.serverUri=http://192.51.100.1:7577/api --spring.cloud.dataflow.features.skipper-enabled=true</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-security"><font o="1344">24.安全</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1345">默认情况下，数据流服务器是不安全的，并在未加密的HTTP连接上运行。</font><font o="1346">您可以通过启用HTTPS并要求客户端使用以下任一方法进行身份验证来保护您的REST端点以及数据流仪表板：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javascript:;"><font o="1347">OAuth 2.0</font></a></p>
</li>
<li>
<p><font o="1348">传统认证（包括基本认证）</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1349">下图显示了Spring Cloud Data Flow服务器的身份验证选项：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-authentication-options.png" alt="验证选项">
</div>
<div class="title"><font o="1350">图5.身份验证选项</font></div>
</div>
<div class="paragraph">
<p><font o="1351">选择传统身份验证时，Spring Cloud Data Flow服务器是主要身份验证点，使用Spring Security。</font><font o="1352">选择此选项后，用户需要通过选择所需的身份验证后备存储来进一步定义其首选身份验证机制，该存储可以是以下选项之一：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#configuration-security-single-user-authentication"><font o="1353">单用户身份验证</font></a></p>
</li>
<li>
<p><a href="#configuration-security-ldap-authentication"><font o="1354">LDAP身份验证</font></a></p>
</li>
<li>
<p><a href="#configuration-security-file-based-authentication"><font o="1355">基于文件的身份验证</font></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1356">在传统身份验证或OAuth2之间进行选择时，请记住这两个选项是互斥的。</font><font o="1357">有关更详细的讨论，请参阅以下部分。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="1358">默认情况下，REST端点（管理，管理和运行状况）以及仪表板UI不需要经过身份验证的访问。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect2">
<h3 id="configuration-security-enabling-https">24.1.<font o="1360">启用HTTPS</font></h3>
<div class="paragraph">
<p><font o="1361">默认情况下，仪表板，管理和运行状况端点使用HTTP作为传输。</font><font o="1362">您可以通过在<code i="221">application.yml</code>中为配置添加证书来切换到HTTPS，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">server:
  port: 8443                                         <i class="conum" data-value="1"></i><b>(1)</b>
  ssl:
    key-alias: yourKeyAlias                          <i class="conum" data-value="2"></i><b>(2)</b>
    key-store: path/to/keystore                      <i class="conum" data-value="3"></i><b>(3)</b>
    key-store-password: yourKeyStorePassword         <i class="conum" data-value="4"></i><b>(4)</b>
    key-password: yourKeyPassword                    <i class="conum" data-value="5"></i><b>(5)</b>
    trust-store: path/to/trust-store                 <i class="conum" data-value="6"></i><b>(6)</b>
    trust-store-password: yourTrustStorePassword     <i class="conum" data-value="7"></i><b>(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="1363">由于默认端口为<code i="222">9393</code>，您可以选择将端口更改为更常见的HTTPs典型端口。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><font o="1364">密钥存储在密钥库中的别名（或名称）。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><font o="1365">密钥库文件的路径。</font><font o="1366">也可以使用类路径前缀指定类路径资源 - 例如：<code i="223">classpath:path/to/keystore</code>。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><font o="1367">密钥库的密码。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><font o="1368">密钥的密码。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><font o="1369">信任库文件的路径。</font><font o="1370">也可以使用类路径前缀指定类路径资源 - 例如：<code i="224">classpath:path/to/trust-store</code></font></td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td><font o="1371">信任存储的密码。</font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1372">
如果启用了HTTPS，它将完全替换HTTP作为REST端点和数据流仪表板交互的协议。</font><font o="1373">普通HTTP请求将失败。</font><font o="1374">因此，请确保相应地配置Shell。
</font></td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="configuration-security-self-signed-certificates">24.1.1.<font o="1376">使用自签名证书</font></h4>
<div class="paragraph">
<p><font o="1377">出于测试目的或在开发期间，创建自签名证书可能会很方便。</font><font o="1378">要开始，请执行以下命令以创建证书：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ keytool -genkey -alias dataflow -keyalg RSA -keystore dataflow.keystore \
          -validity 3650 -storetype JKS \
          -dname "CN=localhost, OU=Spring, O=Pivotal, L=Kailua-Kona, ST=HI, C=US"  <i class="conum" data-value="1"></i><b>(1)</b>
          -keypass dataflow -storepass dataflow</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="1379"><code i="225">CN</code>是这里的重要参数。</font><font o="1380">它应该与您尝试访问的域匹配 - 例如，<code i="226">localhost</code>。</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1381">然后将以下行添加到<code i="227">application.yml</code>文件中：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">server:
  port: 8443
  ssl:
    enabled: true
    key-alias: dataflow
    key-store: "/your/path/to/dataflow.keystore"
    key-store-type: jks
    key-store-password: dataflow
    key-password: dataflow</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1382">这就是数据流服务器所需的全部内容。</font><font o="1383">启动服务器后，您应该能够在<code i="228"><a href="javascript:;" class="bare">localhost:8443/</a></code>访问它。</font><font o="1384">由于这是一个自签名证书，您应该在浏览器中发出警告，您需要忽略该警告。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-security-self-signed-certificates-shell">24.1.2.<font o="1386">自签证书和壳牌</font></h4>
<div class="paragraph">
<p><font o="1387">默认情况下，自签名证书是shell的问题，并且必须执行其他步骤才能使shell使用自签名证书。</font><font o="1388">有两种选择：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1389">将自签名证书添加到JVM信任库。</font></p>
</li>
<li>
<p><font o="1390">跳过证书验证。</font></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_adding_the_self_signed_certificate_to_the_jvm_truststore"><font o="1391">将自签名证书添加到JVM信任库</font></h5>
<div class="paragraph">
<p><font o="1392">为了使用JVM信任库选项，我们需要从密钥库导出以前创建的证书，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ keytool -export -alias dataflow -keystore dataflow.keystore -file dataflow_cert -storepass dataflow</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1393">接下来，我们需要创建一个shell可以使用的信任库，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ keytool -importcert -keystore dataflow.truststore -alias dataflow -storepass dataflow -file dataflow_cert -noprompt</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1394">现在，您已准备好使用以下JVM参数启动数据流Shell：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -Djavax.net.ssl.trustStorePassword=dataflow \
       -Djavax.net.ssl.trustStore=/path/to/dataflow.truststore \
       -Djavax.net.ssl.trustStoreType=jks \
       -jar spring-cloud-dataflow-shell-1.7.3.RELEASE.jar</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="小费"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="1395">如果您在通过SSL建立连接时遇到问题，可以通过使用<code i="229">javax.net.debug</code> JVM参数并将其设置为<code i="230">ssl</code>来启用其他日志记录。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1396">不要忘记使用以下内容定位数据流服务器：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; dataflow config server https://localhost:8443/</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_skipping_certificate_validation"><font o="1397">跳过证书验证</font></h5>
<div class="paragraph">
<p><font o="1398">或者，您也可以通过提供可选的命令行参数<code i="231">--dataflow.skip-ssl-validation=true</code>来绕过认证验证。</font></p>
</div>
<div class="paragraph">
<p><font o="1399">如果设置此命令行参数，则shell将接受任何（自签名）SSL证书。</font></p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="1400">如果可能，您应该避免使用此选项。</font><font o="1401">禁用信任管理器会破坏SSL的目的，使您容易受到中间人攻击。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuration-security-basic-authentication">24.2.<font o="1403">传统认证</font></h3>
<div class="paragraph">
<p><font o="1404">使用传统身份验证时，Spring Cloud Data Flow是唯一的身份验证提供程序。</font><font o="1405">在这种情况下，Data Flow REST API用户将使用
 </font><a href="javascript:;"><font o="1405">基本身份验证</font></a><font o="1405"> 
来访问端点。</font></p>
</div>
<div class="paragraph">
<p><font o="1406">使用该选项时，用户可以选择三个后备存储来获取身份验证详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><font></font></strong><font o="1407">通过设置Spring Boot属性进行</font><strong><font o="1407">单用户身份验证</font></strong></p>
</li>
<li>
<p><strong><font></font></strong><font o="1408">使用Yaml文件为多个用户进行</font><strong><font o="1408">基于文件的身份验证</font></strong></p>
</li>
<li>
<p><strong><font o="1409">Ldap身份验证</font></strong></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="configuration-security-single-user-authentication">24.2.1.<font o="1411">单用户身份验证</font></h4>
<div class="paragraph">
<p><font o="1412">这是最简单的选项，可模拟默认Spring Boot用户体验的行为。</font><font o="1413">可以通过设置环境变量或将以下内容添加到<code i="232">application.yml</code>来启用它：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">security:
  basic:
    enabled: true                                                     <i class="conum" data-value="1"></i><b>(1)</b>
    realm: Spring Cloud Data Flow                                     <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="1414">启用基本身份验证。</font><font o="1415">必须设置为true才能启用安全性。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><font o="1416">（可选）基本身份验证的领域。</font><font o="1417">如果没有明确设置，则默认为<code i="233">Spring</code>。</font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1418">
当前版本的Chrome不显示该领域。</font><font o="1419">有关更多信息，</font><font o="1419">请参阅以下
 </font><a href="javascript:;"><font o="1419">Chromium问题单</font></a><font o="1419">。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1420">在此用例中，底层Spring Boot使用自动生成的密码自动创建名为<code i="234">user</code>的用户，该密码在启动时打印到控制台。</font></p>
</div>
<div class="paragraph">
<p><font o="1421">使用此设置，生成的用户将分配所有主要角色，如下所示：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1422">视图</font></p>
</li>
<li>
<p><font o="1423">创建</font></p>
</li>
<li>
<p><font o="1424">管理</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1425">下图显示了控制台中显示的默认Spring Boot用户凭据。</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-security-default-user.png" alt="默认的Spring Boot用户凭据">
</div>
<div class="title"><font o="1426">图6.默认的Spring Boot用户凭据</font></div>
</div>
<div class="paragraph">
<p><font o="1427">您可以通过设置以下属性来自定义用户：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>security.user.name=user # Default user name.
security.user.password= # Password for the default user name. A random password is logged on startup by default.
security.user.role=VIEW,CREATE,MANAGE # Granted roles for the default user name.</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1428">
请注意基本身份验证和注销的固有问题：浏览器缓存凭据，只需浏览到应用程序页面即可重新登录。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1429">当然，您也可以通过设置系统属性，环境变量或命令行参数来传递凭据，因为这是标准的Spring Boot行为。</font><font o="1430">例如，在以下示例中，命令行参数用于指定用户凭据：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar\
    --security.basic.enabled=true \
    --security.user.name=test \
    --security.user.password=pass \
    --security.user.role=VIEW</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1431">如果您需要定义多个基于文件的用户帐户，请</font><a href="#configuration-security-file-based-authentication"><font o="1431">查看基于文件的身份验证</font></a><font o="1431">。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-security-file-based-authentication">24.2.2.<font o="1433">基于文件的身份验证</font></h4>
<div class="paragraph">
<p><font o="1434">默认情况下，Spring Boot允许您仅指定一个用户。</font><font o="1435">Spring Cloud数据流还支持在配置文件中列出多个用户。</font><font o="1436">必须为每个用户分配密码和一个或多个角色。</font><font o="1437">以下示例显示了其他用户的创建：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">security:
  basic:
    enabled: true
    realm: Spring Cloud Data Flow
spring:
  cloud:
    dataflow:
      security:
        authentication:
          file:
            enabled: true                                                 <i class="conum" data-value="1"></i><b>(1)</b>
            users:                                                        <i class="conum" data-value="2"></i><b>(2)</b>
              bob: bobspassword, ROLE_MANAGE                              <i class="conum" data-value="3"></i><b>(3)</b>
              alice: alicepwd, ROLE_VIEW, ROLE_CREATE</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="1438">启用基于文件的身份验证。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><font o="1439">这是用户名到密码的yaml地图。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><font o="1440">每个映射<code i="235">value</code>由相应的密码和角色组成，以逗号分隔。</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="configuration-security-ldap-authentication">24.2.3.<font o="1442">LDAP身份验证</font></h4>
<div class="paragraph">
<p><font o="1443">Spring Cloud Data Flow还支持对LDAP（轻量级目录访问协议）服务器的身份验证，为以下模式提供支持：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1444">直接绑定</font></p>
</li>
<li>
<p><font o="1445">搜索并绑定</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1446">激活LDAP身份验证选项后，将关闭默认的单用户模式。</font></p>
</div>
<div class="paragraph">
<p><font o="1447">在直接绑定模式下，使用用户名的占位符为用户的可分辨名称（DN）定义模式。</font><font o="1448">身份验证过程通过替换占位符并使用它来针对LDAP服务器对用户进行身份验证以及提供的密码来派生用户的可分辨名称。</font><font o="1449">您可以按如下方式设置LDAP直接绑定：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">security:
  basic:
    enabled: true
    realm: Spring Cloud Data Flow
spring:
  cloud:
    dataflow:
      security:
        authentication:
          ldap:
            enabled: true                                                 <i class="conum" data-value="1"></i><b>(1)</b>
            url: ldap://ldap.example.com:3309                             <i class="conum" data-value="2"></i><b>(2)</b>
            userDnPattern: uid={0},ou=people,dc=example,dc=com            <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="1450">启用LDAP身份验证</font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><font o="1451">LDAP服务器的URL</font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><font o="1452">用于对服务器进行身份验证的可分辨名称（DN）模式</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1453">搜索和绑定模式涉及以匿名方式或使用固定帐户连接到LDAP服务器，根据用户名搜索身份验证用户的可分辨名称，然后使用结果值和提供的密码绑定到LDAP服务器。</font><font o="1454">此选项配置如下：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">security:
  basic:
    enabled: true
    realm: Spring Cloud Data Flow
spring:
  cloud:
    dataflow:
      security:
        authentication:
          ldap:
            enabled: true                                                 <i class="conum" data-value="1"></i><b>(1)</b>
            url: ldap://localhost:10389                                   <i class="conum" data-value="2"></i><b>(2)</b>
            managerDn: uid=admin,ou=system                                <i class="conum" data-value="3"></i><b>(3)</b>
            managerPassword: secret                                       <i class="conum" data-value="4"></i><b>(4)</b>
            userSearchBase: ou=otherpeople,dc=example,dc=com              <i class="conum" data-value="5"></i><b>(5)</b>
            userSearchFilter: uid={0}                                     <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="1455">启用LDAP集成</font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><font o="1456">LDAP服务器的URL</font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><font o="1457">如果不支持匿名搜索，则对LDAP服务器进行身份验证的DN（可选，需要与下一个选项一起使用）</font></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><font o="1458">如果不支持匿名搜索，则为LDAP服务器进行身份验证的密码（可选，与先前选项一起使用）</font></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><font o="1459">搜索身份验证用户DN的基础（用于限制搜索范围）</font></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><font o="1460">验证用户的DN的搜索过滤器</font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="小费"></i>
</td>
<td class="content"><font o="1461">
有关详细信息，另请参阅</font><font o="1461">
Spring Security参考指南</font><font o="1461">的
 </font><a href="javascript:;"><font o="1461">LDAP身份验证</font></a><font o="1461">章节。
</font></td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="_ldap_role_mapping"><font o="1462">LDAP角色映射</font></h5>
<div class="paragraph">
<p><font o="1463">默认情况下，从Ldap检索的角色名称需要与Spring Cloud Data Flow中角色的名称匹配。</font><font o="1464">但是，也可以显式提供LDAP角色和Spring Cloud Data Flow角色之间的映射。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">security:
  basic:
    enabled: true
    realm: Spring Cloud Data Flow
spring:
  cloud:
    dataflow:
      security:
        authentication:
          ldap:
            enabled: true
            url: ldap://localhost:10389
            managerDn: uid=admin,ou=system
            managerPassword: secret
            userSearchBase: ou=otherpeople,dc=example,dc=com
            userSearchFilter: uid={0}
            roleMappings:                                                 <i class="conum" data-value="1"></i><b>(1)</b>
              ROLE_MANAGE: foo-manage                                     <i class="conum" data-value="2"></i><b>(2)</b>
              ROLE_VIEW: bar-view
              ROLE_CREATE: foo-manage</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="1465">启用显式角色映射支持</font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><font o="1466">启用角色映射支持后，必须为所有3个Spring Cloud Data Flow角色</font><strong><font o="1466">ROLE_MANAGE</font></strong><font o="1466">，</font><strong><font o="1466">ROLE_VIEW</font></strong><font o="1466">，</font><strong><font o="1466">ROLE_CREATE</font></strong><font o="1466">提供映射</font><font o="1466">。</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_ldap_transport_security"><font o="1467">LDAP传输安全性</font></h5>
<div class="paragraph">
<p><font o="1468">连接到LDAP服务器时，通常（在LDAP世界中）有两个选项可以安全地建立与LDAP服务器的连接：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1469">LDAP over SSL（LDAPs）</font></p>
</li>
<li>
<p><font o="1470">启动传输层安全性（启动TLS在</font><a href="javascript:;"><font o="1470">RFC2830中</font></a><font o="1470">定义</font><font o="1470">）</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1471">从Spring Cloud Data Flow 1.1.0开始，只支持开箱即用的LDAP。</font><font o="1472">使用官方证书时，无需通过LDAP连接LDAP服务器进行特殊配置。</font><font o="1473">您只需将url格式更改为</font><strong><font o="1473">ldaps</font></strong><font o="1473"> - 例如：<code i="236">ldaps://localhost:636</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="1474">对于自签名证书，Spring Cloud Data Flow服务器的设置会稍微复杂一些。</font><font o="1475">该设置与</font><a href="#configuration-security-self-signed-certificates"><font o="1475">使用自签名证书</font></a><font o="1475">非常相似
 </font><font o="1475">（请先阅读），Spring Cloud Data Flow需要引用trustStore才能使用自签名证书。</font></p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="1476">
虽然在开发和测试期间很有用，但永远不要在生产中使用自签名证书！
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1477">最终，您必须提供一组系统属性，以便在启动服务器时引用trustStore及其凭据，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -Djavax.net.ssl.trustStorePassword=dataflow \
       -Djavax.net.ssl.trustStore=/path/to/dataflow.truststore \
       -Djavax.net.ssl.trustStoreType=jks \
       -jar spring-cloud-starter-dataflow-server-local-1.7.3.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1478">如前所述，安全连接到LDAP服务器的另一个选项是Start TLS。</font><font o="1479">在LDAP世界中，技术上甚至认为LDAP不赞成使用Start TLS。</font><font o="1480">但是，Spring Cloud Data Flow目前不支持此选项。</font></p>
</div>
<div class="paragraph">
<p><font o="1481">请按照以下</font><a href="javascript:;"><font o="1481">问题跟踪器票据</font></a><font o="1481">来跟踪其实施情况。</font><font o="1482">您可能还需要查看有关</font><a href="javascript:;"><font o="1482">自定义DirContext身份验证处理</font></a><font o="1482">的Spring LDAP参考文档章节以
 </font><font o="1482">获取更多详细信息。</font></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuration-security-authentication-via-shell">24.2.4.<font o="1484">Shell身份验证</font></h4>
<div class="paragraph">
<p><font o="1485">使用传统身份验证与数据流Shell时，通常使用命令行参数提供用户名和密码，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar target/spring-cloud-dataflow-shell-1.7.3.RELEASE.jar  \
  --dataflow.username=myuser                                          \   <i class="conum" data-value="1"></i><b>(1)</b>
  --dataflow.password=mysecret                                            <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="1486">如果启用了身份验证，则必须提供用户名。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><font o="1487">如果未提供密码，则shell会提示输入密码。</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1488">或者，您也可以从shell中定位数据流服务器，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">server-unknown:&gt;dataflow config server
  --uri  http://localhost:9393                                        \   <i class="conum" data-value="1"></i><b>(1)</b>
  --username myuser                                                   \   <i class="conum" data-value="2"></i><b>(2)</b>
  --password mysecret                                                 \   <i class="conum" data-value="3"></i><b>(3)</b>
  --skip-ssl-validation  true                                         \   <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="1489">可选，默认为</font><a href="javascript:;" class="bare"><font o="1489">localhost：9393</font></a><font o="1489">。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><font o="1490">如果启用安全性，则必须提供。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><font o="1491">如果启用了安全性，并且未提供密码，则会提示用户输入密码。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><font o="1492">可选，忽略证书错误（使用自签名证书时）。</font><font o="1493">谨慎使用！</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1494">下图显示了连接和验证数据流服务器的典型shell命令：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-security-shell-target.png" alt="在Shell中使用数据流服务器进行目标和身份验证">
</div>
<div class="title"><font o="1495">图7.使用Shell中的数据流服务器进行目标和身份验证</font></div>
</div>
</div>
<div class="sect3">
<h4 id="customizing-authorization">24.2.5.<font o="1497">自定义授权</font></h4>
<div class="paragraph">
<p><font o="1498">前面的内容涉及身份验证 - 即如何评估用户的身份。</font><font o="1499">无论选择</font><font o="1499">何种</font><font o="1499">选项，您还可以自定义</font><strong><font o="1499">授权</font></strong><font o="1499"> - 即谁可以做什么。</font></p>
</div>
<div class="paragraph">
<p><font o="1500">默认方案使用三个角色来保护</font><font o="1500">
Spring Cloud Data Flow公开</font><font o="1500">的</font><a href="#api-guide"><font o="1500">REST端点</font></a><font o="1500">：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><font o="1501">ROLE_VIEW</font></strong><font o="1501">用于检索状态的任何内容</font></p>
</li>
<li>
<p><strong><font></font></strong><font o="1502">任何涉及创建，删除或改变系统状态的</font><strong><font o="1502">ROLE_CREATE</font></strong></p>
</li>
<li>
<p><strong><font o="1503">ROLE_MANAGE</font></strong><font o="1503">用于启动管理端点</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1504">所有这些默认值都在<code i="237">dataflow-server-defaults.yml</code>中指定，它是Spring Cloud Data Flow核心模块的一部分。</font><font o="1505">尽管如此，如果需要，您可以覆盖它们 - 例如，在<code i="238">application.yml</code>中。</font><font o="1506">配置采用YAML列表的形式（因为某些规则可能优先于其他规则）。</font><font o="1507">因此，您需要复制并粘贴整个列表并根据您的需要进行定制（因为无法合并列表）。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1508">
请始终参考您的<code i="239">application.yml</code>版本，因为以下代码段可能已过时。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1509">默认规则如下：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">spring:
  cloud:
    dataflow:
      security:
        authorization:
          enabled: true
          rules:
            # Metrics

            - GET    /metrics/streams                =&gt; hasRole('ROLE_VIEW')

            # About

            - GET    /about                          =&gt; hasRole('ROLE_VIEW')

            # Metrics

            - GET    /metrics/**                     =&gt; hasRole('ROLE_VIEW')
            - DELETE /metrics/**                     =&gt; hasRole('ROLE_CREATE')

            # Boot Endpoints

            - GET    /management/**                  =&gt; hasRole('ROLE_MANAGE')

            # Apps

            - GET    /apps                           =&gt; hasRole('ROLE_VIEW')
            - GET    /apps/**                        =&gt; hasRole('ROLE_VIEW')
            - DELETE /apps/**                        =&gt; hasRole('ROLE_CREATE')
            - POST   /apps                           =&gt; hasRole('ROLE_CREATE')
            - POST   /apps/**                        =&gt; hasRole('ROLE_CREATE')

            # Completions

            - GET /completions/**                    =&gt; hasRole('ROLE_CREATE')

            # Job Executions &amp; Batch Job Execution Steps &amp;&amp; Job Step Execution Progress

            - GET    /jobs/executions                =&gt; hasRole('ROLE_VIEW')
            - PUT    /jobs/executions/**             =&gt; hasRole('ROLE_CREATE')
            - GET    /jobs/executions/**             =&gt; hasRole('ROLE_VIEW')

            # Batch Job Instances

            - GET    /jobs/instances                 =&gt; hasRole('ROLE_VIEW')
            - GET    /jobs/instances/*               =&gt; hasRole('ROLE_VIEW')

            # Running Applications

            - GET    /runtime/apps                   =&gt; hasRole('ROLE_VIEW')
            - GET    /runtime/apps/**                =&gt; hasRole('ROLE_VIEW')

            # Stream Definitions

            - GET    /streams/definitions            =&gt; hasRole('ROLE_VIEW')
            - GET    /streams/definitions/*          =&gt; hasRole('ROLE_VIEW')
            - GET    /streams/definitions/*/related  =&gt; hasRole('ROLE_VIEW')
            - POST   /streams/definitions            =&gt; hasRole('ROLE_CREATE')
            - DELETE /streams/definitions/*          =&gt; hasRole('ROLE_CREATE')
            - DELETE /streams/definitions            =&gt; hasRole('ROLE_CREATE')

            # Stream Deployments

            - DELETE /streams/deployments/*          =&gt; hasRole('ROLE_CREATE')
            - DELETE /streams/deployments            =&gt; hasRole('ROLE_CREATE')
            - POST   /streams/deployments/*          =&gt; hasRole('ROLE_CREATE')

            # Stream Validations

            - GET /streams/validation/               =&gt; hasRole('ROLE_VIEW')
            - GET /streams/validation/*              =&gt; hasRole('ROLE_VIEW')

            # Task Definitions

            - POST   /tasks/definitions              =&gt; hasRole('ROLE_CREATE')
            - DELETE /tasks/definitions/*            =&gt; hasRole('ROLE_CREATE')
            - GET    /tasks/definitions              =&gt; hasRole('ROLE_VIEW')
            - GET    /tasks/definitions/*            =&gt; hasRole('ROLE_VIEW')

            # Task Executions

            - GET    /tasks/executions               =&gt; hasRole('ROLE_VIEW')
            - GET    /tasks/executions/*             =&gt; hasRole('ROLE_VIEW')
            - POST   /tasks/executions               =&gt; hasRole('ROLE_CREATE')
            - DELETE /tasks/executions/*             =&gt; hasRole('ROLE_CREATE')

            # Task Schedules

            - GET    /tasks/schedules                =&gt; hasRole('ROLE_VIEW')
            - GET    /tasks/schedules/*              =&gt; hasRole('ROLE_VIEW')
            - POST   /tasks/schedules                =&gt; hasRole('ROLE_CREATE')
            - DELETE /tasks/schedules/*              =&gt; hasRole('ROLE_CREATE')

            # Task Validations

            - GET    /tasks/validation/               =&gt; hasRole('ROLE_VIEW')
            - GET    /tasks/validation/*              =&gt; hasRole('ROLE_VIEW')

            # Tools

            - POST   /tools/**                       =&gt; hasRole('ROLE_CREATE')</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1510">每行的格式如下：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">HTTP_METHOD URL_PATTERN '=&gt;' SECURITY_ATTRIBUTE</pre>
</div>
</div>
<div class="paragraph">
<p><font o="1511">哪里</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1512">HTTP_METHOD是一种http方法，大写情况</font></p>
</li>
<li>
<p><font o="1513">URL_PATTERN是一种Ant样式的URL模式</font></p>
</li>
<li>
<p><font o="1514">SECURITY_ATTRIBUTE是一个SpEL表达式。</font><font o="1515">请参阅</font><a href="javascript:;"><font o="1515">基于表达式的访问控制</font></a><font o="1515">。</font></p>
</li>
<li>
<p><font o="1516">每个由一个或几个空白字符（空格，制表符等）分隔的字符串</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1517">请注意，上面确实是一个YAML列表，而不是一个映射（因此在每行的开头使用' - '破折号），它位于<code i="240">spring.cloud.dataflow.security.authorization.rules</code>键下。</font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="小费"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="1518">如果您只对身份验证感兴趣而不是授权（例如，每个用户都可以访问所有端点），那么您也可以设置<code i="241">spring.cloud.dataflow.security.authorization.enabled=false</code>。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1519">如果通过设置安全性属性来使用基本安全性配置，则为用户设置角色很重要，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">java -jar spring-cloud-dataflow-server-local/target/spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar \
    --security.basic.enabled=true \
    --security.user.name=test \
    --security.user.password=pass \
    --security.user.role=VIEW</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="authorization-shell-and-dashboard">24.2.6.<font o="1521">授权 -  Shell和Dashboard行为</font></h4>
<div class="paragraph">
<p><font o="1522">启用授权后，仪表板和shell将具有角色感知功能，这意味着，根据分配的角色，并非所有功能都可见。</font></p>
</div>
<div class="paragraph">
<p><font o="1523">例如，用户没有必要角色的shell命令被标记为不可用。</font></p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="1524">目前，shell的<code i="242">help</code>命令列出了不可用的命令。</font><font o="1525">请跟踪以下问题：</font><a href="javascript:;" class="bare"><font o="1525">github.com/spring-projects/spring-shell/issues/115</font></a></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1526">同样，对于仪表板，UI不显示未授权用户的页面或页面元素。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="ldap-authorization-and-roles">24.2.7.<font o="1528">使用LDAP授权</font></h4>
<div class="paragraph">
<p><font o="1529">配置LDAP进行身份验证时，您还可以将<code i="243">group-role-attribute</code>与<code i="244">group-search-base</code>和<code i="245">group-search-filter</code>一起指定。</font></p>
</div>
<div class="paragraph">
<p><font o="1530">组角色属性包含角色的名称。</font><font o="1531">如果未指定，则默认填充<code i="246">ROLE_MANAGE</code>角色。</font></p>
</div>
<div class="paragraph">
<p><font o="1532">有关详细信息，请参阅</font><font o="1532">Spring Security参考指南中的</font><a href="javascript:;"><font o="1532">配置LDAP服务器</font></a><font o="1532">。</font></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuration-security-oauth2">24.3.<font o="1534">OAuth 2.0</font></h3>
<div class="paragraph">
<p><a href="javascript:;"><font o="1535">OAuth 2.0</font></a><font o="1535">允许您将Spring Cloud数据流集成到单点登录（SSO）环境中。</font><font o="1536">使用以下OAuth2授权类型：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><font o="1537">授权码</font></strong><font o="1537">：用于GUI（浏览器）集成。</font><font o="1538">访问者将重定向到您的OAuth服务以进行身份​​验证</font></p>
</li>
<li>
<p><strong><font o="1539">密码</font></strong><font o="1539">：由shell（以及REST集成）使用，因此访问者可以使用用户名和密码登录</font></p>
</li>
<li>
<p><strong><font o="1540">客户端凭据</font></strong><font o="1540">：直接从OAuth提供程序检索访问令牌，并使用Authorization HTTP标头将其传递到数据流服务器</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1541">可以通过两种方式访问​​REST端点：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><font o="1542">基本身份验证</font></strong><font o="1542">，使用封面下的密码授予类型对您的OAuth2服务进行身份验证</font></p>
</li>
<li>
<p><strong><font o="1543">访问令牌</font></strong><font o="1543">，使用封面下的客户端凭据授予类型</font></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1544">
设置身份验证时，强烈建议您也启用HTTPS，尤其是在生产环境中。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1545">您可以通过将以下内容添加到<code i="247">application.yml</code>或通过设置环境变量来启用OAuth2身份验证：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">security:
  oauth2:
    client:
      client-id: myclient                                             <i class="conum" data-value="1"></i><b>(1)</b>
      client-secret: mysecret
      access-token-uri: http://127.0.0.1:9999/oauth/token
      user-authorization-uri: http://127.0.0.1:9999/oauth/authorize
    resource:
      user-info-uri: http://127.0.0.1:9999/me</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="1546">在OAuth配置部分中提供客户端ID可激活OAuth2安全性</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1547">您可以使用curl验证基本身份验证是否正常工作，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl -u myusername:mypassword http://localhost:9393/ -H 'Accept: application/json'</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1548">因此，您应该看到可用REST端点的列表。</font></p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="1549">
请注意，使用web浏览器访问根URL并启用安全性时，您将被重定向到仪表板UI。</font><font o="1550">要查看REST端点列表，请指定<code i="248">application/json</code>。</font><font o="1551">另外，请务必使用Postman（Chrome）或RESTClient（Firefox）等工具添加Accept标头。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1552">除基本身份验证外，您还可以提供访问令牌以访问REST Api。</font><font o="1553">为了实现这一点，您首先要从OAuth2提供程序检索OAuth2访问令牌，然后使用</font><strong><font o="1553">Authorization</font></strong><font o="1553"> Http标头</font><font o="1553">将该访问令牌传递给REST Api </font><font o="1553">：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>$ curl -H "Authorization: Bearer &lt;ACCESS_TOKEN&gt;" http://localhost:9393/ -H 'Accept: application/json'</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="configuration-security-oauth2-authorization">24.3.1.<font o="1555">OAuth REST端点授权</font></h4>
<div class="paragraph">
<p><font o="1556">OAuth2身份验证选项使用与</font><a href="#configuration-security-basic-authentication"><font o="1556">传统身份验证</font></a><font o="1556">选项</font><font o="1556">相同的授权规则
 </font><font o="1556">。</font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="小费"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="1557">授权规则在<code i="249">dataflow-server-defaults.yml</code>（Spring Cloud Data Flow核心模块的一部分）中定义。</font><font o="1558">有关更多详细信息，</font><font o="1558">请参阅有关</font><a href="#customizing-authorization"><font o="1558">自定义授权</font></a><font o="1558">的章节
 </font><font o="1558">。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1559">由于安全角色的确定是特定于环境的，因此默认情况下，Spring Cloud Data Flow会使用<code i="250">DefaultDataflowAuthoritiesExtractor</code>类将所有角色分配给经过身份验证的OAuth2用户。</font></p>
</div>
<div class="paragraph">
<p><font o="1560">您可以通过提供扩展Spring Security OAuth的<code i="251">AuthoritiesExtractor</code>接口的自己的Spring bean定义来自定义该行为。</font><font o="1561">在这种情况下，自定义bean定义优先于Spring Cloud Data Flow提供的默认定义。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-security-oauth2-shell">24.3.2.<font o="1563">使用Spring Cloud Data Flow Shell进行OAuth身份验证</font></h4>
<div class="paragraph">
<p><font o="1564">使用命令行管理程序时，可以通过用户名和密码或通过指定</font><em><font o="1564">credentials-provider</font></em><font o="1564">命令</font><font o="1564">来提供</font><em><font o="1564">凭据</font></em><font o="1564">。</font></p>
</div>
<div class="paragraph">
<p><font o="1565">如果您的OAuth2提供程序支持</font><em><font o="1565">密码</font></em><font o="1565">授予类型，则可以使用以下命令启动
 </font><em><font o="1565">数据流Shell</font></em><font o="1565">：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar spring-cloud-dataflow-shell-1.7.3.RELEASE.jar \
  --dataflow.uri=http://localhost:9393 \
  --dataflow.username=my_username --dataflow.password=my_password</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1566">
请记住，启用Spring Cloud Data Flow身份验证后，</font><font o="1566">如果要通过用户名/密码身份验证使用命令行管理程序</font><font o="1566">，则底层OAuth2提供程序</font><strong><font o="1566">必须</font></strong><font o="1566">支持</font><em><font o="1566">密码</font></em><font o="1566"> OAuth2授权类型。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1567">在数据流Shell中，您还可以使用以下命令提供凭据：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow config server --uri http://localhost:9393 --username my_username --password my_password</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1568">成功定位后，您应该看到以下输出：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;dataflow config info
dataflow config info

╔═══════════╤═══════════════════════════════════════╗
║Credentials│[username='my_username, password=****']║
╠═══════════╪═══════════════════════════════════════╣
║Result     │                                       ║
║Target     │http://localhost:9393                  ║
╚═══════════╧═══════════════════════════════════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1569">或者，您可以指定</font><em><font o="1569">credentials-provider</font></em><font o="1569">命令以直接传入承载令牌，而不是提供用户名和密码。</font><font o="1570">这可以在shell中运行，也可以在启动Shell时提供<code i="252">--dataflow.credentials-provider-command</code>命令行参数。</font></p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="1571">使用</font><em><font o="1571">credentials-provider</font></em><font o="1571">命令时，请注意您的指定命令</font><strong><font o="1571">必须</font></strong><font o="1571">返回</font><em><font o="1571">Bearer令牌</font></em><font o="1571">（以</font><em><font o="1571">Bearer</font></em><font o="1571">为前缀的访问令牌</font><font o="1571">）。</font><font o="1572">例如，在Unix环境中，可以使用以下简单命令：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar spring-cloud-dataflow-shell-1.7.3.RELEASE.jar \
  --dataflow.uri=http://localhost:9393 \
  --dataflow.credentials-provider-command="echo Bearer 123456789"</code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="_oauth2_authentication_examples">24.3.3.<font o="1574">OAuth2身份验证示例</font></h4>
<div class="paragraph">
<p><font o="1575">本节提供以下身份验证示例：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#oauth2-examples-local"><font o="1576">本地OAuth2服务器</font></a></p>
</li>
<li>
<p><a href="#oauth2-examples-github"><font o="1577">使用GitHub进行身份验证</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="oauth2-examples-local"><font o="1578">本地OAuth2服务器</font></h5>
<div class="paragraph">
<p><font o="1579">使用</font><a href="javascript:;"><font o="1579">Spring Security OAuth</font></a><font o="1579">，您可以使用以下简单注释轻松创建自己的OAuth2服务器：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@EnableResourceServer</code></p>
</li>
<li>
<p><code>@EnableAuthorizationServer</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1580">可以在以下位置找到工作示例应用程序：</font></p>
</div>
<div class="paragraph">
<p><a href="javascript:;"><font o="1581">https://github.com/ghillert/oauth-test-server/</font></a></p>
</div>
<div class="paragraph">
<p><font o="1582">克隆项目并使用相应的客户端ID和客户端密钥配置Spring Cloud数据流。</font><font o="1583">然后构建并启动项目。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="oauth2-examples-github"><font o="1584">使用GitHub进行身份验证</font></h5>
<div class="paragraph">
<p><font o="1585">如果您想使用现有的OAuth2提供程序，以下是GitHub的示例。</font><font o="1586">首先，您需要在GitHub帐户下注册一个新的应用程序：</font></p>
</div>
<div class="paragraph">
<p><a href="javascript:;"><font o="1587">https://github.com/settings/developers</font></a></p>
</div>
<div class="paragraph">
<p><font o="1588">在本地运行默认版本的Spring Cloud Data Flow时，您的GitHub配置应如下图所示：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-security-github.png" alt="为GitHub注册OAuth应用程序">
</div>
<div class="title"><font o="1589">图8.为GitHub注册OAuth应用程序</font></div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1590">
对于授权回调URL，请输入Spring Cloud Data Flow的登录URL  - 例如，<code i="253"><a href="javascript:;" class="bare">localhost:9393/login</a></code>。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1591">使用GitHub相关的客户端ID和密钥配置Spring Cloud Data Flow，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">security:
  oauth2:
    client:
      client-id: your-github-client-id
      client-secret: your-github-client-secret
      access-token-uri: https://github.com/login/oauth/access_token
      user-authorization-uri: https://github.com/login/oauth/authorize
    resource:
      user-info-uri: https://api.github.com/user</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="1592">
GitHub不支持OAuth2密码授予类型。</font><font o="1593">因此，您不能将Spring Cloud Data Flow Shell与GitHub结合使用。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_securing_the_spring_boot_management_endpoints">24.4.<font o="1595">保护Spring Boot管理端点</font></h3>
<div class="paragraph">
<p><font o="1596">启用安全性时，还请确保</font><a href="javascript:;"><font o="1596">Spring Boot HTTP管理端点</font></a><font o="1596"> 
也是安全的。</font><font o="1597">您可以通过将以下内容添加到<code i="254">application.yml</code>来为管理端点启用安全性：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml">management:
  contextPath: /management
  security:
    enabled: true</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="1598">
如果未明确启用管理端点的安全性，则最终可能会有不安全的REST端点，尽管<code i="255">security.basic.enabled</code>设置为<code i="256">true</code>。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-monitoring-management"><font o="1599">25.监测和管理</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1600">Spring Cloud Data Flow服务器是Spring Boot 1.5应用程序，包括</font><a href="javascript:;"><font o="1600">Actuator库</font></a><font o="1600">，它添加了几个生产就绪功能，以帮助您监视和管理您的应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="1601">Actuator库在上下文路径<code i="257">/management</code>下添加HTTP端点，这是可用管理端点的发现页面。</font><font o="1602">例如，有一个显示应用程序运行状况信息的<code i="258">health</code>端点和一个列出Spring <code i="260">ConfigurableEnvironment</code>属性的<code i="259">env</code>。</font><font o="1603">默认情况下，只能访问运行状况和应用程序信息端点。</font><font o="1604">其他端点被认为是敏感的，需要</font><a href="javascript:;"><font o="1604">通过配置明确启用</font></a><font o="1604">。</font><font o="1605">如果启用敏感端点，则还应</font><a href="#configuration-security"><font o="1605">保护数据流服务器的端点，</font></a><font o="1605">以便不会无意中向未经身份验证的用户公开信息。</font><font o="1606">默认情况下，本地数据流服务器已禁用安全性，因此所有执行器端点均可用。</font></p>
</div>
<div class="paragraph">
<p><font o="1607">数据流服务器需要关系数据库，如果启用了分析功能切换，则还需要Redis服务器。</font><font o="1608">如果需要</font><font o="1608">，数据流服务器会自动配置</font><a href="javascript:;"><font o="1608">DataSourceHealthIndicator</font></a><font o="1608">和</font><a href="javascript:;"><font o="1608">RedisHealthIndicator</font></a><font o="1608">。</font><font o="1609">这两个服务的运行状况通过<code i="261">health</code>端点合并到服务器的整体运行状况。</font></p>
</div>
<div class="sect2">
<h3 id="configuration-monitoring-deployed-applications">25.1.<font o="1611">监控已部署的流应用程序</font></h3>
<div class="paragraph">
<p><font o="1612">Spring Cloud Data Flow部署的流应用程序可以基于Spring Boot 1.5或Spring Boot 2.0。</font><font o="1613">两个版本都包含几个用于监视生产中的应用程序的功能 </font><font o="1614">但是，Spring Boot 1.x和2.x以及Spring Cloud Stream 1.x和2.x在实施监控方面存在差异。</font><font o="1615">由于Spring Cloud Data Flow支持部署1.x和2.x应用程序，因此我们将单独介绍这两种情况。</font></p>
</div>
<div class="paragraph">
<p><font o="1616">1.x和2.x应用程序的共同点是Spring Cloud Stream应用程序可以配置为将度量标准发布到消息传递中间件目标。</font><font o="1617">的</font><a href="javascript:;"><font o="1617">Spring Cloud Data Flow度量收集器</font></a><font o="1617">所预订到该目标并聚集度量成基于流的图。</font><font o="1618">Metrics Collector 2.0服务器支持从仅包含Boot 1.x或2.x应用程序的流以及包含Boot版本混合的流中收集度量标准。</font><font o="1619">数据流UI通过HTTP查询Metrics收集器，以显示每个已部署应用程序旁边的消息速率。</font></p>
</div>
<div class="paragraph">
<p><font o="1620">下图显示了使用Spring Cloud Stream度量标准发布者，度量标准收集器和数据流服务器时的体系结构：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-metrics-arch.png" alt="Spring Cloud数据流度量架构">
</div>
<div class="title"><font o="1621">图9. Spring Cloud Data Flow度量架构</font></div>
</div>
<div class="sect3">
<h4 id="_using_the_metrics_collector">25.1.1.<font o="1623">使用Metrics Collector</font></h4>
<div class="paragraph">
<p><font o="1624">Metrics Collector有两个版本，一个基于Spring Boot 1.0的1.0版本，它了解如何聚合来自Spring Boot 1.x应用程序的指标和基于Spring Boot 2.0的2.0版本，它们了解如何聚合来自Spring Boot 1.x和2.x的指标。</font><font o="1625">Rabbit和Kafka有一个Metrics Collector服务器。</font><font o="1626">您可以在其</font><a href="javascript:;"><font o="1626">项目页面</font></a><font o="1626">上找到有关下载和运行Metrics Collector的更多信息</font><font o="1626">。</font></p>
</div>
<div class="paragraph">
<p><font o="1627">数据流服务器属性：<code i="262">spring.cloud.dataflow.metrics.collector.uri</code>引用Metrics Collector的URI。</font><font o="1628">例如，如果在端口<code i="263">8080</code>上本地运行Metrics Collector，则启动本地数据流服务器以引用Metrics Collector。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar --spring.cloud.dataflow.metrics.collector.uri=http://localhost:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1629">可以使用需要用户名和密码的“基本”身份验证来保护Metrics Collector。</font><font o="1630">要设置用户名和密码，请在启动数据流服务器时使用属性<code i="264">spring.cloud.dataflow.metrics.collector.username</code>和<code i="265">spring.cloud.dataflow.metrics.collector.password</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="1631">设置属性<code i="266">spring.cloud.stream.bindings.applicationMetrics.destination</code>时，将发布每个应用程序的度量标准。</font><font o="1632">使用目标名称<code i="267">metrics</code>是一个不错的选择，因为Metrics Collector默认订阅该名称。</font></p>
</div>
<div class="paragraph">
<p><font o="1633">由于希望Data Flow部署的所有流应用程序都能发出指标，因此设置属性非常普遍：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.bindings.applicationMetrics.destination=metrics</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1634">在Data Flow服务器上，您可以在一个中心位置配置对度量标准发布的支持。</font></p>
</div>
<div class="paragraph">
<p><font o="1635">使用目标名称<code i="268">metrics</code>是一个不错的选择，因为Metrics Collector默认订阅该名称，当然，可以根据需要将其覆盖为与默认值不同。</font></p>
</div>
<div class="paragraph">
<p><font o="1636">配置度量目标的下一个最常用方法是使用部署属性。</font><font o="1637">以下示例显示了使用App Starters <code i="270">time</code>和<code i="271">log</code>应用程序的<code i="269">ticktock</code>流：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">app register --name time --type source --uri maven://org.springframework.cloud.stream.app:time-source-rabbit:1.2.0.RELEASE

app register --name log --type sink --uri maven://org.springframework.cloud.stream.app:log-sink-rabbit:1.2.0.RELEASE

stream create --name foostream --definition "time | log"

stream deploy --name foostream --properties "app.*.spring.cloud.stream.bindings.applicationMetrics.destination=metrics"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1638">Metrics Collector以JSON格式公开HTTP端点<code i="272">/collector/metrics</code>下的聚合度量标准。</font><font o="1639">数据流服务器以两种不同的方式访问此端点。</font><font o="1640">第一种是通过公开<code i="273">/metrics/streams</code> HTTP端点作为Metrics Collector端点的代理。</font><font o="1641">当在SCDF的Flo上覆盖消息速率时，UI可以访问它，它是流媒体管道的可视化表示。</font><font o="1642">还可以通过带有消息速率的<code i="276">runtime apps</code>命令来访问<code i="275">Runtime</code>选项卡和shell中公开的数据流<code i="274">/runtime/apps</code>端点。</font></p>
</div>
<div class="paragraph">
<p><font o="1643">下图显示了在UI的Streams选项卡中显示的消息速率：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-metrics-message-rates.png" alt="流消息率">
</div>
<div class="title"><font o="1644">图10.流消息速率</font></div>
</div>
<div class="paragraph">
<p><font o="1645">部署应用程序时，数据流设置<code i="277">spring.cloud.stream.metrics.properties</code>属性，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">spring.cloud.stream.metrics.properties=spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1646">这些键的值用作执行聚合的标记。</font><font o="1647">对于2.x应用程序，这些键值直接映射到</font><a href="javascript:;"><font o="1647">Micrometer库中的</font></a><font o="1647">标签</font><font o="1647">。</font><font o="1648">属性<code i="278">spring.cloud.application.guid</code>可用于跟踪生成度量标准的特定应用程序实例。</font><font o="1649"><code i="279">guid</code>值取决于平台。</font></p>
</div>
<div class="paragraph">
<p><font o="1650">数据流还设置用于控制导出哪些度量标准值的应用程序属性。</font><font o="1651">对于1.x应用程序，属性为<code i="280">spring.metrics.export.triggers.application.includes</code>，默认值如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">spring.metrics.export.triggers.application.includes=integration**</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1652">对于2.x应用程序，属性为<code i="281">spring.cloud.stream.metrics.meter-filter</code>且没有默认值，因此将导出所有度量标准。</font></p>
</div>
<div class="paragraph">
<p><font o="1653">请注意，数据流UI仅显示瞬时输入和输出通道消息速率。</font><font o="1654">数据流不提供自己的实现来存储和可视化历史指标数据，而是与现有的监控系统集成。</font><font o="1655">对于Boot 1.x，支持将度量标准发送到应用程序日志和</font><a href="javascript:;"><font o="1655">Datadog</font></a><font o="1655">。</font><font o="1656">对于Boot 2.x，指标由</font><a href="javascript:;"><font o="1656">Micrometer库</font></a><font o="1656">提供</font><font o="1656">支持，</font><a href="javascript:;"><font o="1656">Micrometer库</font></a><font o="1656">提供各种</font><a href="javascript:;"><font o="1656">监控系统</font></a><font o="1656">。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_spring_boot_2_x">25.1.2.<font o="1658">Spring Boot 2.x</font></h4>
<div class="paragraph">
<p><font o="1659">我们开发了一个示例应用程序，展示如何使用千分尺库修改<code i="282">time</code>和<code i="283">log</code>应用程序并将指标导出到InfluxDB。</font><font o="1660">还提供Grafana前端。</font><font o="1661">这是一个WIP，因此请查看</font><a href="javascript:;"><font o="1661">Spring Cloud Data Flow Samples Repository</font></a><font o="1661">以获取最新状态。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_spring_boot_1_x">25.1.3.<font o="1663">Spring Boot 1.x</font></h4>
<div class="paragraph">
<p><font o="1664">每个部署的应用程序都包含</font><a href="javascript:;"><font o="1664">web端点，</font></a><font o="1664">用于监视流和任务应用程序并与之交互。</font></p>
</div>
<div class="paragraph">
<p><font o="1665">特别是，<code i="284">/metrics</code> </font><a href="javascript:;"><font o="1665">端点</font></a><font o="1665">包含HTTP请求的计数器和计量器，系统度量标准，如JVM统计信息，数据源度量标准和消息通道度量标准。</font><font o="1666">Spring Boot允许您</font><font o="1666">通过注册<code i="286">PublicMetrics</code>接口的实现或通过与</font><a href="javascript:;"><font o="1666">Dropwizard的</font></a><font o="1666">集成</font><a href="javascript:;"><font o="1666">将您自己的度量添加</font></a><font o="1666">到<code i="285">/metrics</code>端点</font><font o="1666">。</font><a href="javascript:;"><font></font></a><font></font></p>
</div>
<div class="paragraph">
<p><font o="1667">Spring Boot接口<code i="287">MetricWriter</code>和<code i="288">Exporter</code>用于将度量数据发送到可以显示和分析它们的位置。</font><font o="1668">Spring Boot中有实现将指标导出到Redis，Open TSDB，Statsd和JMX。</font></p>
</div>
<div class="paragraph">
<p><font o="1669">一些额外的Spring项目支持将度量数据发送到外部系统：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javascript:;"><font o="1670">Spring Cloud Data Flow Metrics</font></a><font o="1670">提供写入日志的<code i="289">LogMetricWriter</code>。</font></p>
</li>
<li>
<p><a href="javascript:;"><font o="1671">Spring Cloud Data Flow Metrics Datadog Metrics</font></a><font o="1671">提供写入</font><a href="javascript:;"><font o="1671">Datadog的</font></a><font o="1671"> <code i="290">DatadogMetricWriter</code> </font><font o="1671">。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1672">要使用此功能，您需要构建Stream应用程序，并使用您要使用的MetricWriter实现的附加pom依赖项。</font><font o="1673">要自定义“开箱即用”流应用程序，请使用</font><a href="javascript:;"><font o="1673">Spring Cloud Stream Initializr</font></a><font o="1673">生成项目，然后修改pom。</font><font o="1674">Data Flow Metrics项目页面上的文档提供了入门所需的其他信息。</font></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_about_configuration"><font o="1675">26.关于配置</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1676">Spring Cloud Data Flow关于Restful API结果包含显示名称，版本，以及（如果指定）包含Spring Cloud Data Flow的每个主要依赖项的URL。</font><font o="1677">结果（如果已启用）还包含shell依赖项的sha1和/或sha256校验和值。</font><font o="1678">通过设置以下属性，可以配置为每个依赖项返回的信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1679">spring.cloud.dataflow.version-info.spring-cloud-dataflow-core.name：用于核心的名称。</font></p>
</li>
<li>
<p><font o="1680">spring.cloud.dataflow.version-info.spring-cloud-dataflow-core.version：用于核心的版本。</font></p>
</li>
<li>
<p><font o="1681">spring.cloud.dataflow.version-info.spring-cloud-dataflow-dashboard.name：用于仪表板的名称。</font></p>
</li>
<li>
<p><font o="1682">spring.cloud.dataflow.version-info.spring-cloud-dataflow-dashboard.version：用于仪表板的版本。</font></p>
</li>
<li>
<p><font o="1683">spring.cloud.dataflow.version-info.spring-cloud-dataflow-implementation.name：用于实现的名称。</font></p>
</li>
<li>
<p><font o="1684">spring.cloud.dataflow.version-info.spring-cloud-dataflow-implementation.version：用于实现的版本。</font></p>
</li>
<li>
<p><font o="1685">spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.name：用于shell的名称。</font></p>
</li>
<li>
<p><font o="1686">spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.version：用于shell的版本。</font></p>
</li>
<li>
<p><font o="1687">spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.url：用于下载shell依赖项的URL。</font></p>
</li>
<li>
<p><font o="1688">spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.checksum-sha1：与shell依赖关系信息一起返回的sha1校验和值。</font></p>
</li>
<li>
<p><font o="1689">spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.checksum-sha256：与shell依赖关系信息一起返回的sha256校验和值。</font></p>
</li>
<li>
<p><font o="1690">spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.checksum-sha1-url：如果未指定<code i="291">spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.checksum-sha1</code>，SCDF将使用此URL指定的文件内容作为校验和。</font></p>
</li>
<li>
<p><font o="1691">spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.checksum-sha256-url：如果未指定<code i="292">spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.checksum-sha256</code>，则SCDF使用此URL指定的文件内容作为校验和。</font></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_enabling_shell_checksum_values">26.1.<font o="1693">启用S​​hell Checksum值</font></h3>
<div class="paragraph">
<p><font o="1694">默认情况下，不会显示shell依赖项的校验和值。</font><font o="1695">如果需要启用此功能，请将<code i="293">spring.cloud.dataflow.version-info.dependency-fetch.enabled</code>属性设置为true。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_reserved_values_for_urls">26.2.<font o="1697">URL的保留值</font></h3>
<div class="paragraph">
<p><font o="1698">您可以在URL中插入保留值（用花括号括起来），以确保链接是最新的：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1699">存储库：如果使用数据流的构建快照，里程碑或候选发布版，则存储库引用repo-spring-io存储库。</font><font o="1700">否则，它指的是Maven Central。</font></p>
</li>
<li>
<p><font o="1701">version：插入jar / pom的版本。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1702">例如，如果您使用的是Spring Cloud Data Flow Shell的1.2.3.RELEASE版本，则<code i="294"><a href="javascript:;" class="bare">myrepository/org/springframework/cloud/spring-cloud-dataflow-shell/{version}/spring-cloud-dataflow-shell-{version}.jar</a></code>会生成<code i="295"><a href="javascript:;" class="bare">myrepository/org/springframework/cloud/spring-cloud-dataflow-shell/1.2.3.RELEASE/spring-cloud-dataflow-shell-1.2.3.RELEASE.jar</a></code></font></p>
</div>
</div>
</div>
</div>
<h1 id="shell" class="sect0"><font o="1703">Shell</font></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p><font o="1704">本节介绍了启动shell的选项以及与shell如何处理SpEL表达式的空格，引号和解释相关的更高级功能。</font><a href="#spring-cloud-dataflow-stream-intro"><font o="1705">Stream DSL</font></a><font o="1705">和</font><a href="#spring-cloud-dataflow-composed-tasks"><font o="1705">Composed Task DSL</font></a><font o="1705">的入门章节
 </font><font o="1705">是最常见的shell命令使用的好地方。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="shell-options"><font o="1706">27. Shell选项</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1707">shell建立在</font><a href="javascript:;"><font o="1707">Spring Shell</font></a><font o="1707">项目</font><font o="1707">之上</font><font o="1707">。</font><font o="1708">有Spring Shell通用的命令行选项和一些特定于数据流的命令行选项。</font><font o="1709">shell采用以下命令行选项</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-bash" data-lang="bash">unix:&gt;java -jar spring-cloud-dataflow-shell-1.7.3.RELEASE.jar --help
Data Flow Options:
  --dataflow.uri=<uri>                              Address of the Data Flow Server [default: http://localhost:9393].
  --dataflow.username=<user>                        Username of the Data Flow Server [no default].
  --dataflow.password=<password>                    Password of the Data Flow Server [no default].
  --dataflow.credentials-provider-command=<command></command> Executes an external command which must return an
                                                    OAuth Bearer Token (Access Token prefixed with 'Bearer '),
                                                    e.g. 'Bearer 12345'), [no default].
  --dataflow.skip-ssl-validation=<true|false>       Accept any SSL certificate (even self-signed) [default: no].
  --dataflow.proxy.uri=<proxy-uri>                  Address of an optional proxy server to use [no default].
  --dataflow.proxy.username=<proxy-username>        Username of the proxy server (if required by proxy server) [no default].
  --dataflow.proxy.password=<proxy-password>        Password of the proxy server (if required by proxy server) [no default].
  --spring.shell.historySize=<size>                 Default size of the shell log file [default: 3000].
  --spring.shell.commandFile=<file>                 Data Flow Shell executes commands read from the file(s) and then exits.
  --help                                            This message.</file></size></proxy-password></proxy-username></proxy-uri></true|false></password></user></uri></code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1710"><code i="296">spring.shell.commandFile</code>选项可用于指向包含所有shell命令的现有文件，以部署一个或多个相关的流和任务。</font><br><font o="1711">
还支持多个文件执行，它们应该以逗号分隔的字符串传递：</font><br></p>
</div>
<div class="paragraph">
<p><code>--spring.shell.commandFile=file1.txt,file2.txt</code></p>
</div>
<div class="paragraph">
<p><font o="1712">在创建一些脚本以帮助自动部署时，这非常有用。</font></p>
</div>
<div class="paragraph">
<p><font o="1713">此外，以下shell命令有助于将复杂脚本模块化为多个独立文件：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt;script --file &lt;YOUR_AWESOME_SCRIPT&gt;</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="shell-commands"><font o="1714">28.列出可用命令</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1715">在命令提示符下键入<code i="297">help</code>会列出所有可用命令。</font><font o="1716">大多数命令都用于数据流功能，但有一些是通用的。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">! - Allows execution of operating system (OS) commands
clear - Clears the console
cls - Clears the console
date - Displays the local date and time
exit - Exits the shell
http get - Make GET request to http endpoint
http post - POST data to http endpoint
quit - Exits the shell
system properties - Shows the shell's properties
version - Displays shell version</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1717">将命令的名称添加到<code i="298">help</code>会显示有关如何调用命令的其他信息。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;help stream create
Keyword:                   stream create
Description:               Create a new stream definition
 Keyword:                  ** default **
 Keyword:                  name
   Help:                   the name to give to the stream
   Mandatory:              true
   Default if specified:   '__NULL__'
   Default if unspecified: '__NULL__'

 Keyword:                  definition
   Help:                   a stream definition, using the DSL (e.g. "http --port=9000 | hdfs")
   Mandatory:              true
   Default if specified:   '__NULL__'
   Default if unspecified: '__NULL__'

 Keyword:                  deploy
   Help:                   whether to deploy the stream immediately
   Mandatory:              false
   Default if specified:   'true'
   Default if unspecified: 'false'</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="shell-tab-completion"><font o="1718">29.标签完成</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1719">通过在前导<code i="300">--</code>后按<code i="299">TAB</code>键，可以在shell中完成shell命令选项。</font><font o="1720">例如，在<code i="302">stream create --</code>之后按<code i="301">TAB</code>会导致</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;stream create --
stream create --definition    stream create --name</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1721">如果您键入<code i="303">--de</code>然后点击制表符，则会展开<code i="304">--definition</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="1722">对于应用程序或任务属性，还可以在流或组合任务DSL表达式中使用选项卡完成。</font><font o="1723">您还可以使用<code i="305">TAB</code>获取流DSL表达式中的提示，以获取可用的源，处理器或接收器。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="shell-white-space"><font o="1724">30.白色空间和报价规则</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1725">如果参数值包含空格或<code i="306">|</code>字符，则只需引用它们。</font><font o="1726">以下示例将SpEL表达式（应用于它遇到的任何数据）传递给转换处理器：</font></p>
</div>
<div class="paragraph">
<p><code>transform --expression='new StringBuilder(payload).reverse()'</code></p>
</div>
<div class="paragraph">
<p><font o="1727">如果参数值需要嵌入单引号，请使用两个单引号，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>scan --query='Select * from /Customers where name=''Smith'''</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="dsl-quotes-escaping">30.1.<font o="1729">行情和逃避</font></h3>
<div class="paragraph">
<p><font o="1730">有一个Spring基于Shell的客户端与数据流服务器通信，负责</font><strong><font o="1730">解析</font></strong><font o="1730"> DSL。</font><font o="1731">反过来，应用程序可能具有依赖于嵌入式语言的应用程序属性，例如</font><strong><font o="1731">Spring表达式语言</font></strong><font o="1731">。</font></p>
</div>
<div class="paragraph">
<p><font o="1732">shell，Data Flow DSL解析器和SpEL有关于它们如何处理引号以及语法转义如何工作的规则。</font><font o="1733">当组合在一起时，可能会出现混淆。</font><font o="1734">本节介绍适用的规则，并提供在涉及所有三个组件时可能遇到的最复杂情况的示例。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="title"><font o="1735">它并不总是那么复杂</font></div>
<div class="paragraph">
<p><font o="1736">如果不使用数据流shell（例如，直接使用REST API）或者应用程序属性不是SpEL表达式，则转义规则更简单。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="_shell_rules">30.1.1.<font o="1738">壳牌规则</font></h4>
<div class="paragraph">
<p><font o="1739">可以说，引用时最复杂的组件是shell。</font><font o="1740">但规则可以非常简单地列出：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1741">shell命令由键（<code i="307">--something</code>）和相应的值组成。</font><font o="1742">但是，有一种特殊的无键映射，稍后将对此进行描述。</font></p>
</li>
<li>
<p><font o="1743">值通常不能包含空格，因为空格是命令的默认分隔符。</font></p>
</li>
<li>
<p><font o="1744">通过用引号（单个（<code i="308">'</code>）或双（<code i="309">"</code>）引号）包围值，可以添加空格。</font></p>
</li>
<li>
<p><font o="1745">不应再次引用在部署属性（例如<code i="310">deployment &lt;stream-name&gt; --properties " …​"</code>）内传递的值。</font></p>
</li>
<li>
<p><font o="1746">如果用引号括起来，则值可以通过在其前面添加反斜杠（<code i="311">\</code>）来嵌入相同类型的文字引号。</font></p>
</li>
<li>
<p><font o="1747">可以使用其他转义，例如<code i="312">\t</code>，<code i="313">\n</code>，<code i="314">\r</code>，<code i="315">\f</code>和<code i="316">\uxxxx</code>形式的unicode转义。</font></p>
</li>
<li>
<p><font o="1748">无密钥映射以特殊方式处理，因此它不需要引用来包含空格。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1749">例如，shell支持<code i="317">!</code>命令来执行本机shell命令。</font><font o="1750"><code i="318">!</code>接受单个无密钥参数。</font><font o="1751">这就是以下工作的原因：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">dataflow:&gt;! rm something</pre>
</div>
</div>
<div class="paragraph">
<p><font o="1752">这里的参数是整个<code i="319">rm something</code>字符串，它按原样传递给底层shell。</font></p>
</div>
<div class="paragraph">
<p><font o="1753">作为另一个示例，以下命令严格等效，参数值为<code i="320">something</code>（不带引号）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">dataflow:&gt;stream destroy something
dataflow:&gt;stream destroy --name something
dataflow:&gt;stream destroy "something"
dataflow:&gt;stream destroy --name "something"</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_property_files_rules">30.1.2.<font o="1755">属性文件规则</font></h4>
<div class="paragraph">
<p><font o="1756">从文件加载属性时放宽规则。</font><font o="1757">*需要转义属性文件（Java和YAML）中使用的特殊字符。</font><font o="1758">例如<code i="321">\</code>应替换为<code i="322">\\</code>，'/ t`替换为<code i="323">\\t</code>等等。</font><font o="1759">*对于Java属性文件（<code i="324">--propertiesFile</code> &lt;FILE_PATH&gt; .properties），属性值不应该用引号括起来！</font><font o="1760">即使它们包含空格也不需要它。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">filter.expression=payload &gt; 5</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1761">但是，对于YAML属性文件（<code i="325">--propertiesFile</code> &lt;FILE_PATH&gt; .yaml），值必须用双引号括起来。</font></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">app:
    filter:
        filter:
            expression: "payload &gt; 5"</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dsl_parsing_rules">30.1.3.<font o="1763">DSL解析规则</font></h4>
<div class="paragraph">
<p><font o="1764">在解析器级别（即，在流或任务定义的主体内），规则如下：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1765">通常会解析选项值，直到第一个空格字符。</font></p>
</li>
<li>
<p><font o="1766">它们可以由文字字符串组成，但用单引号或双引号括起来。</font></p>
</li>
<li>
<p><font o="1767">要嵌入这样的引用，请使用所需类型的两个连续引号。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1768">因此，在以下示例中，过滤器应用程序的<code i="326">--expression</code>选项的值在语义上是等效的：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">filter --expression=payload&gt;5
filter --expression="payload&gt;5"
filter --expression='payload&gt;5'
filter --expression='payload &gt; 5'</pre>
</div>
</div>
<div class="paragraph">
<p><font o="1769">可以说，最后一个更具可读性。</font><font o="1770">这得益于周围的报价。</font><font o="1771">实际表达式为<code i="327">payload &gt; 5</code>（不带引号）。</font></p>
</div>
<div class="paragraph">
<p><font o="1772">现在，假设我们想要测试字符串消息。</font><font o="1773">如果我们想要将有效负载与SpEL文字字符串<code i="328">"something"</code>进行比较，我们可以使用以下内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">filter --expression=payload=='something'           <i class="conum" data-value="1"></i><b>(1)</b>
filter --expression='payload == ''something'''     <i class="conum" data-value="2"></i><b>(2)</b>
filter --expression='payload == "something"'       <i class="conum" data-value="3"></i><b>(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="1774">这是有效的，因为没有空格。</font><font o="1775">但是，它不是很清晰。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><font o="1776">这使用单引号来保护整个参数。</font><font o="1777">因此，实际的单引号需要加倍。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><font o="1778">SpEL使用单引号或双引号识别字符串文字，因此最后一种方法可以说是最具可读性的。</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1779">请注意，前面的示例将在shell之外考虑（例如，直接调用REST API时）。</font><font o="1780">当在shell中输入时，很可能整个流定义本身都在双引号内，需要对其进行转义。</font><font o="1781">然后整个例子变成如下：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">dataflow:&gt;stream create something --definition "http | filter --expression=payload='something' | log"

dataflow:&gt;stream create something --definition "http | filter --expression='payload == ''something''' | log"

dataflow:&gt;stream create something --definition "http | filter --expression='payload == \"something\"' | log"</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_spel_syntax_and_spel_literals">30.1.4.<font o="1783">SpEL语法和SpEL文字</font></h4>
<div class="paragraph">
<p><font o="1784">拼图的最后一部分是关于SpEL表达式。</font><font o="1785">许多应用程序接受将被解释为SpEL表达式的选项，并且如上所述，字符串文字也以特殊方式处理。</font><font o="1786">规则如下：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1787">文字可以用单引号或双引号括起来。</font></p>
</li>
<li>
<p><font o="1788">引号需要加倍才能嵌入字面引用。</font><font o="1789">双引号内的单引号不需要特殊处理，反之亦然。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1790">作为最后一个示例，假设您要使用</font><a href="javascript:;"><font o="1790">转换处理器</font></a><font o="1790">。</font><font o="1791">此处理器接受<code i="329">expression</code>选项，该选项是SpEL表达式。</font><font o="1792">它将根据传入消息进行评估，默认值为<code i="330">payload</code>（它不会触发消息有效负载）。</font></p>
</div>
<div class="paragraph">
<p><font o="1793">重要的是要理解以下陈述是等效的：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">transform --expression=payload
transform --expression='payload'</pre>
</div>
</div>
<div class="paragraph">
<p><font o="1794">但是，它们与以下内容不同（以及它们的变体）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">transform --expression="'payload'"
transform --expression='''payload'''</pre>
</div>
</div>
<div class="paragraph">
<p><font o="1795">第一个系列评估消息有效负载，而后面的示例评估为文字字符串<code i="331">payload</code>，（同样，没有引号）。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_putting_it_all_together">30.1.5.<font o="1797">把它放在一起</font></h4>
<div class="paragraph">
<p><font o="1798">作为最后一个完整的示例，考虑如何通过在数据流shell的上下文中创建流来强制将所有消息转换为字符串文字<code i="332">hello world</code>：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">dataflow:&gt;stream create something --definition "http | transform --expression='''hello world''' | log" <i class="conum" data-value="1"></i><b>(1)</b>

dataflow:&gt;stream create something --definition "http | transform --expression='\"hello world\"' | log" <i class="conum" data-value="2"></i><b>(2)</b>

dataflow:&gt;stream create something --definition "http | transform --expression=\"'hello world'\" | log" <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="1799">在第一行中，字符串周围有单引号（在数据流解析器级别），但它们需要加倍，因为它们在字符串文字内（由等号后面的第一个单引号启动）。</font></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><font o="1800">第二行和第三行分别使用单引号和双引号来包含数据流解析器级别的整个字符串。</font><font o="1801">因此，可以在字符串内使用其他类型的引用。</font><font o="1802">但是整个事情都在shell的<code i="333">--definition</code>参数内，它使用双引号。</font><font o="1803">因此，双引号被转义（在shell级别）</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
<h1 id="spring-cloud-dataflow-streams" class="sect0"><font o="1804">流</font></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p><font o="1805">本节详细介绍了如何创建Streams，它们是</font><a href="javascript:;"><font o="1805">Spring Cloud Stream</font></a><font o="1805">应用程序的</font><font o="1805">集合
 </font><font o="1805">。</font><font o="1806">它涵盖了创建和部署Streams等主题。</font></p>
</div>
<div class="paragraph">
<p><font o="1807">如果您刚开始使用Spring Cloud Data Flow，则</font><font o="1807">在深入了解本节之前</font><font o="1807">，您应该阅读“
 </font><a href="#getting-started"><font o="1807">入门指南”</font></a><font o="1807">。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-stream-intro"><font o="1808">31.简介</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1809">Stream是一组长期存在的</font><a href="javascript:;"><font o="1809">Spring Cloud Stream</font></a><font o="1809">应用程序，它们通过消息传递中间件相互通信。</font><font o="1810">基于文本的DSL定义了应用程序之间的配置和数据流。</font><font o="1811">虽然为您提供了许多应用程序来实现常见用例，但您通常会创建一个自定义Spring Cloud Stream应用程序来实现自定义业务逻辑。</font></p>
</div>
<div class="paragraph">
<p><font o="1812">Stream的一般生命周期是：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="1813">注册申请。</font></p>
</li>
<li>
<p><font o="1814">创建流定义。</font></p>
</li>
<li>
<p><font o="1815">部署流。</font></p>
</li>
<li>
<p><font o="1816">取消部署或销毁流。</font></p>
</li>
<li>
<p><font o="1817">流中的升级或Rollack应用程序。</font></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><font o="1818">如果使用Skipper，则可以在Stream中升级或回滚应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="1819">部署流有两种选择：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1820">使用部署到单个平台的Data Flow Server实现。</font></p>
</li>
<li>
<p><font o="1821">配置数据流服务器以将部署委派给名为</font><a href="javascript:;"><font o="1821">Skipper</font></a><font o="1821">的Spring Cloud生态系统中的新服务器</font><font o="1821">。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1822">使用第一个选项时，您可以使用本地数据流服务器将流部署到本地计算机，Cloud Foundry的数据流服务器将流部署到Cloud Foundry上的单个组织和空间。</font><font o="1823">同样，您可以使用Kuberenetes的数据流服务器将流部署到Kubernetes集群上的单个命名空间。</font><font o="1824">有关</font><font o="1824">数据流服务器实现的列表，</font><font o="1824">请参见</font><a href="javascript:;"><font o="1824">Spring Cloud Data Flow项目页面</font></a><font o="1824">。</font></p>
</div>
<div class="paragraph">
<p><font o="1825">使用第二个选项时，您可以配置Skipper将应用程序部署到一个或多个Cloud Foundry组织和空间，Kubernetes集群上的一个或多个名称空间或本地计算机。</font><font o="1826">使用Skipper在数据流中部署流时，您可以指定在部署时使用哪个平台。</font><font o="1827">Skipper还为数据流提供了对已部署流进行更新的能力。</font><font o="1828">可以通过多种方式更新流中的应用程序，但最常见的示例之一是使用新的自定义业务逻辑升级处理器应用程序，同时仅保留现有的源和接收器应用程序。</font></p>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-stream-intro-dsl">31.1.<font o="1830">流管道DSL</font></h3>
<div class="paragraph">
<p><font o="1831">使用基于unix的</font><a href="javascript:;"><font o="1831">Pipeline语法</font></a><font o="1831">定义流</font><font o="1831">。</font><font o="1832">语法使用竖线，也称为“管道”来连接多个命令。</font><font o="1833">Unix中的命令<code i="334">ls -l | grep key | less</code>获取<code i="335">ls -l</code>进程的输出并将其传递给<code i="336">grep key</code>进程的输入。</font><font o="1834"><code i="337">grep</code>的输出又被发送到<code i="338">less</code>进程的输入。</font><font o="1835">每个<code i="339">|</code>符号将左侧命令的标准输出连接到右侧命令的标准输入。</font><font o="1836">数据从左到右流过管道。</font></p>
</div>
<div class="paragraph">
<p><font o="1837">在数据流中，Unix命令由</font><a href="javascript:;"><font o="1837">Spring Cloud Stream</font></a><font o="1837">应用程序</font><font o="1837">替换</font><font o="1837">，每个管道符号表示通过消息中间件（例如RabbitMQ或Apache Kafka）连接应用程序的输入和输出。</font></p>
</div>
<div class="paragraph">
<p><font o="1838">每个Spring Cloud Stream应用程序都以简单名称注册。</font><font o="1839">注册过程指定可以获取应用程序的位置（例如，在Maven Repository或Docker注册表中）。</font><font o="1840">您可以在本</font><a href="#spring-cloud-dataflow-register-stream-apps"><font o="1840">节中</font></a><font o="1840">找到有关如何注册Spring Cloud Stream应用程序的更多信息</font><font o="1840">。</font><font o="1841">在数据流中，我们将Spring Cloud Stream应用程序分类为源，处理器或接收器。</font></p>
</div>
<div class="paragraph">
<p><font o="1842">举一个简单的例子，考虑从HTTP Source写入文件接收器的数据集合。</font><font o="1843">使用DSL，流描述是：</font></p>
</div>
<div class="paragraph">
<p><code>http | file</code></p>
</div>
<div class="paragraph">
<p><font o="1844">涉及某些处理的流将表示为：</font></p>
</div>
<div class="paragraph">
<p><code>http | filter | transform | file</code></p>
</div>
<div class="paragraph">
<p><font o="1845">可以使用shell的<code i="340">stream create</code>命令创建流定义，如以下示例所示：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; stream create --name httpIngest --definition "http | file"</code></p>
</div>
<div class="paragraph">
<p><font o="1846">Stream DSL传入<code i="341">--definition</code>命令选项。</font></p>
</div>
<div class="paragraph">
<p><font o="1847">流定义的部署是通过shell的<code i="342">stream deploy</code>命令完成的。</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; stream deploy --name ticktock</code></p>
</div>
<div class="paragraph">
<p><font o="1848">“ </font><a href="#getting-started"><font o="1848">入门”</font></a><font o="1848">部分介绍了如何启动服务器以及如何启动和使用Spring Cloud Data Flow shell。</font></p>
</div>
<div class="paragraph">
<p><font o="1849">请注意，shell调用数据流服务器的REST API。</font><font o="1850">有关直接向服务器发出HTTP请求的更多信息，请参阅</font><a href="#api-guide"><font o="1850">REST API指南</font></a><font o="1850">。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-stream-app-dsl">31.2.<font o="1852">流应用程序DSL</font></h3>
<div class="paragraph">
<p><font o="1853">上一节中描述的Stream Pipeline DSL自动设置每个Spring Cloud Stream应用程序的输入和输出绑定属性。</font><font o="1854">这可以完成，因为Spring Cloud Stream应用程序中只有一个输入和/或输出目标，它使用<code i="343">Source</code>，<code i="344">Processor</code>或<code i="345">Sink</code>提供的绑定接口。</font><font o="1855">但是，Spring Cloud Stream应用程序可以定义自定义绑定接口，如下所示</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">public interface Barista {

    @Input
    SubscribableChannel orders();

    @Output
    MessageChannel hotDrinks();

    @Output
    MessageChannel coldDrinks();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1856">或者在创建Kafka Streams应用程序时很常见，</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">interface KStreamKTableBinding {

    @Input
    KStream&lt;?, ?&gt; inputStream();

    @Input
    KTable&lt;?, ?&gt; inputTable();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1857">在具有多个输入和输出绑定的这些情况下，数据流无法对从一个应用程序到另一个应用程序的数据流做出任何假设。</font><font o="1858">因此，开发人员需要将绑定属性设置为“连接”应用程序。</font><font o="1859">该</font><strong><font o="1859">流应用DSL</font></strong><font o="1859">使用<code i="346">double pipe</code>，而不是<code i="347">pipe symbol</code>，以表明数据流不应该配置应用程序的结合特性。</font><font o="1860">将<code i="348">||</code>视为'并行'的含义。</font><font o="1861">例如：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; stream create --definition "orderGeneratorApp || baristaApp || hotDrinkDeliveryApp || coldDrinkDeliveryApp" --name myCafeStream</code></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1862">
打破变革！</font><font o="1863">SCDF Local，Cloud Foundry 1.7.0到1.7.2和SCDF Kubernetes 1.7.0到1.7.1的版本使用<code i="349">comma</code>字符作为应用程序之间的分隔符。</font><font o="1864">这导致了传统Stream DSL的重大变化。</font><font o="1865">虽然不理想，但改变分隔符特性被认为是对现有用户影响最小的最佳解决方案。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1866">此流中有四个应用程序。</font><font o="1867">baristaApp有两个输出目标，<code i="350">hotDrinks</code>和<code i="351">coldDrinks</code>分别由<code i="352">hotDrinkDeliveryApp</code>和<code i="353">coldDrinkDeliveryApp</code>使用。</font><font o="1868">部署此流时，您需要设置绑定属性，以便<code i="354">baristaApp</code>将热饮消息发送到<code i="355">hotDrinkDeliveryApp</code>目的地，并将冷饮消息发送到<code i="356">coldDrinkDeliveryApp</code>目的地。</font><font o="1869">例如</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">app.baristaApp.spring.cloud.stream.bindings.hotDrinks.destination=hotDrinksDest
app.baristaApp.spring.cloud.stream.bindings.coldDrinks.destination=coldDrinksDest
app.hotDrinkDeliveryApp.spring.cloud.stream.bindings.input.destination=hotDrinksDest
app.coldDrinkDeliveryApp.spring.cloud.stream.bindings.input.destination=coldDrinksDest</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1870">如果要使用使用者组，则需要分别在生产者和使用者应用程序上设置Spring Cloud Stream应用程序属性<code i="357">spring.cloud.stream.bindings.&lt;channelName&gt;.producer.requiredGroups</code>和<code i="358">spring.cloud.stream.bindings.&lt;channelName&gt;.group</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="1871">Stream Application DSL的另一个常见用例是部署一个http网关应用程序，该应用程序向Kafka或RabbitMQ应用程序发送同步请求/回复消息。</font><font o="1872">在这种情况下，http网关应用程序和Kafka或RabbitMQ应用程序都可以是不使用Spring Cloud Stream库的Spring Integration应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="1873">也可以使用Stream应用程序DSL部署单个应用程序。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_application_properties">31.3.<font o="1875">应用属性</font></h3>
<div class="paragraph">
<p><font o="1876">每个应用程序都使用属性来定制其行为。</font><font o="1877">例如，<code i="359">http</code>源模块公开<code i="360">port</code>设置，允许从默认值更改数据提取端口。</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; stream create --definition "http --port=8090 | log" --name myhttpstream</code></p>
</div>
<div class="paragraph">
<p><font o="1878">此<code i="361">port</code>属性实际上与标准Spring Boot <code i="362">server.port</code>属性相同。</font><font o="1879">数据流添加了使用简写形式<code i="363">port</code>而不是<code i="364">server.port</code>的功能。</font><font o="1880">也可以指定longhand版本，如以下示例所示：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; stream create --definition "http --server.port=8000 | log" --name myhttpstream</code></p>
</div>
<div class="paragraph">
<p><font o="1881">有关</font><a href="#spring-cloud-dataflow-stream-app-whitelisting"><font o="1881">白名单应用程序属性</font></a><font o="1881">的部分将更详细地讨论此简写行为</font><font o="1881">。</font><font o="1882">如果已</font><a href="#spring-cloud-dataflow-stream-app-metadata-artifact"><font o="1882">注册应用程序属性元数据</font></a><font o="1882">，则可以在键入<code i="365">--</code>后使用shell中的选项卡完成来获取候选属性名称列表。</font></p>
</div>
<div class="paragraph">
<p><font o="1883">shell为应用程序属性提供了Tab键完成。</font><font o="1884">shell命令<code i="366">app info --name &lt;appName&gt; --type &lt;appType&gt;</code>为所有支持的属性提供了附加文档。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1885">
支持的流<code i="367">&lt;appType&gt;</code>可能性包括：源，处理器和接收器。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-stream-lifecycle"><font o="1886">32.流生命周期</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="1887">在“经典”模式下，流的生命周期经历以下阶段：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#spring-cloud-dataflow-register-stream-apps"><font o="1888">注册流应用程序</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-dataflow-create-stream"><font o="1889">创建流</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-dataflow-deploy-stream"><font o="1890">部署流</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-dataflow-destroy-stream"><font o="1891">销毁流</font></a><font o="1891">或</font><a href="#spring-cloud-dataflow-undeploy-stream"><font o="1891">取消部署流</font></a></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-register-stream-apps">32.1.<font o="1893">注册流应用程序</font></h3>
<div class="paragraph">
<p><font o="1894">您可以使用Spring Cloud Data Flow Shell <code i="368">app register</code>命令在App Registry中注册Stream App。</font><font o="1895">您必须提供唯一的名称，应用程序类型和可以解析为应用程序工件的URI。</font><font o="1896">对于类型，请指定<code i="369">source</code>，<code i="370">processor</code>，<code i="371">sink</code>或<code i="372">app</code>。</font><font o="1897">以下是<code i="373">source</code>，<code i="374">processor</code>和<code i="375">sink</code>的一些示例：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;app register --name mysource --type source --uri maven://com.example:mysource:0.0.1-SNAPSHOT

dataflow:&gt;app register --name myprocessor --type processor --uri file:///Users/example/myprocessor-1.2.3.jar

dataflow:&gt;app register --name mysink --type sink --uri http://example.com/mysink-2.0.1.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1898">提供带有<code i="376">maven</code>方案的URI时，格式应符合以下条件：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>maven://&lt;groupId&gt;:&lt;artifactId&gt;[:&lt;extension&gt;[:&lt;classifier&gt;]]:&lt;version&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1899">例如，如果您要注册使用RabbitMQ绑定器构建的<code i="377">http</code>和<code i="378">log</code>应用程序的快照版本，则可以执行以下操作：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;app register --name http --type source --uri maven://org.springframework.cloud.stream.app:http-source-rabbit:1.2.1.BUILD-SNAPSHOT
dataflow:&gt;app register --name log --type sink --uri maven://org.springframework.cloud.stream.app:log-sink-rabbit:1.2.1.BUILD-SNAPSHOT</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1900">如果您想一次注册多个应用程序，可以将它们存储在属性文件中，其中键的格式为<code i="379">&lt;type&gt;.&lt;name&gt;</code>，值为URI。</font></p>
</div>
<div class="paragraph">
<p><font o="1901">例如，如果您要注册使用RabbitMQ绑定器构建的<code i="380">http</code>和<code i="381">log</code>应用程序的快照版本，则可以在属性文件中包含以下内容（例如，<code i="382">stream-apps.properties</code> ）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>source.http=maven://org.springframework.cloud.stream.app:http-source-rabbit:1.2.1.BUILD-SNAPSHOT
sink.log=maven://org.springframework.cloud.stream.app:log-sink-rabbit:1.2.1.BUILD-SNAPSHOT</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1902">然后要批量导入应用程序，请使用<code i="383">app import</code>命令并使用<code i="384">--uri</code>开关提供属性文件的位置，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;app import --uri file:///&lt;YOUR_FILE_LOCATION&gt;/stream-apps.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1903">使用<code i="385">--type app</code>注册应用程序与注册<code i="386">source</code>，<code i="387">processor</code>或<code i="388">sink</code>相同。</font><font o="1904">类型<code i="389">app</code>的应用程序仅允许在Stream Application DSL中使用，它使用逗号而不是DSL中的管道符号，并指示数据流不配置应用程序的Spring Cloud Stream绑定属性。</font><font o="1905">使用<code i="390">--type app</code>注册的应用程序不必是Spring Cloud Stream应用程序，它可以是任何Spring Boot应用程序。</font><font o="1906">有关</font><font o="1906">使用此应用程序类型的更多信息，</font><font o="1906">请参阅</font><a href="#spring-cloud-dataflow-stream-app-dsl"><font o="1906">Stream Application DSL简介</font></a><font o="1906">。</font></p>
</div>
<div class="sect3">
<h4 id="supported-apps-and-tasks">32.1.1.<font o="1908">注册支持的应用和任务</font></h4>
<div class="paragraph">
<p><font o="1909">为方便起见，我们为所有现成的流和任务/批处理应用程序启动程序提供了带有application-URI（适用于maven和docker）的静态文件。</font><font o="1910">您可以指向此文件并批量导入所有应用程序URI。</font><font o="1911">否则，如前所述，您可以单独注册它们，也可以拥有自己的自定义属性文件，其中只包含所需的应用程序URI。</font><font o="1912">但是，建议在自定义属性文件中包含所需应用程序URI的“聚焦”列表。</font></p>
</div>
<div class="paragraph">
<p><font o="1913">下表列出了基于Spring Boot 1.5.x的可用流应用程序启动器的bit.ly链接：</font></p>
</div>
<table class="tableblock frame-topbot grid-all spread">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="1914">神器类型</font></th>
<th class="tableblock halign-left valign-top"><font o="1915">稳定释放</font></th>
<th class="tableblock halign-left valign-top"><font o="1916">SNAPSHOT发布</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">RabbitMQ + Maven</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Celsius-SR3-stream-applications-rabbit-maven</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Celsius-BUILD-SNAPSHOT-stream-applications-rabbit-maven</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">RabbitMQ + Docker</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Celsius-SR3-stream-applications-rabbit-docker</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Celsius-BUILD-SNAPSHOT-stream-applications-rabbit-docker</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Kafka 0.10 + Maven</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Celsius-SR3-stream-applications-kafka-10-maven</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Celsius-BUILD-SNAPSHOT-stream-applications-kafka-10-maven</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Kafka 0.10 + Docker</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Celsius-SR3-stream-applications-kafka-10-docker</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Celsius-BUILD-SNAPSHOT-stream-applications-kafka-10-docker</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><font o="1917">下表列出了基于Spring Boot 2.0.x的可用流应用程序启动器的bit.ly链接：</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1918">
App Starter执行器端点默认是安全的。</font><font o="1919">您可以通过使用属性<code i="391">app.*.spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration</code>部署流来禁用安全性。</font><font o="1920">在Kubernetes上，请参阅</font><a href="javascript:;"><font o="1920">Liveness和</font></a><font o="1920"> readyiness </font><a href="javascript:;"><font o="1920">探针</font></a><font o="1920">部分</font><a href="javascript:;"><font o="1920">，</font></a><font o="1920">以配置执行器端点的安全性。
</font></td>
</tr>
</tbody></table>
</div>
<table class="tableblock frame-topbot grid-all spread">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="1921">神器类型</font></th>
<th class="tableblock halign-left valign-top"><font o="1922">稳定释放</font></th>
<th class="tableblock halign-left valign-top"><font o="1923">SNAPSHOT发布</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">RabbitMQ + Maven</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Darwin-SR3-stream-applications-rabbit-maven</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Darwin-BUILD-SNAPSHOT-stream-applications-rabbit-maven</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">RabbitMQ + Docker</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Darwin-SR3-stream-applications-rabbit-docker</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Darwin-BUILD-SNAPSHOT-stream-applications-rabbit-docker</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Kafka 0.11 and above + Maven</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Darwin-SR3-stream-applications-kafka-maven</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Darwin-BUILD-SNAPSHOT-stream-applications-kafka-maven</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Kafka 0.11 and above + Docker</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Darwin-SR3-stream-applications-kafka-docker</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Darwin-BUILD-SNAPSHOT-stream-applications-kafka-docker</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><font o="1924">下表列出了可用的任务应用程序启动器：</font></p>
</div>
<table class="tableblock frame-topbot grid-all spread">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="1925">神器类型</font></th>
<th class="tableblock halign-left valign-top"><font o="1926">稳定释放</font></th>
<th class="tableblock halign-left valign-top"><font o="1927">SNAPSHOT发布</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Maven</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Clark-SR1-task-applications-maven</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Clark-BUILD-SNAPSHOT-task-applications-maven</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Docker</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Clark-SR1-task-applications-docker</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Clark-BUILD-SNAPSHOT-task-applications-docker</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><font o="1928">您可以在</font><a href="javascript:;"><font o="1928">Task App Starters Project页面</font></a><font o="1928">和相关参考文档中</font><font o="1928">找到有关可用任务启动器的更多信息</font><font o="1928">。</font><font o="1929">有关可用流启动器的更多信息，请查看</font><a href="javascript:;"><font o="1929">Stream App Starters项目页面</font></a><font o="1929"> 
和相关参考文档。</font></p>
</div>
<div class="paragraph">
<p><font o="1930">例如，如果您想要批量注册使用Kafka活页夹构建的所有现成的流应用程序，可以使用以下命令：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ dataflow:&gt;app import --uri http://bit.ly/Darwin-SR3-stream-applications-kafka-maven</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1931">或者，您可以使用Rabbit绑定器注册所有流应用程序，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ dataflow:&gt;app import --uri http://bit.ly/Darwin-SR3-stream-applications-rabbit-maven</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1932">您还可以传递<code i="392">--local</code>选项（默认为<code i="393">true</code>）以指示是否应在shell进程本身内解析属性文件位置。</font><font o="1933">如果应从数据流服务器进程解析位置，请指定<code i="394">--local false</code>。</font></p>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-warning" title="警告"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="1934">使用<code i="395">app register</code>或<code i="396">app import</code>时，如果应用程序已使用提供的名称和类型进行了注册，则默认情况下不会覆盖该应用程序。</font><font o="1935">如果您要覆盖预先存在的应用程序坐标，请包含<code i="397">--force</code>选项。</font></p>
</div>
<div class="paragraph">
<p><font o="1936">但是，请注意，一旦下载，应用程序可以根据资源位置在数据流服务器上本地缓存。</font><font o="1937">如果资源位置没有改变（即使实际资源</font><em><font o="1937">字节</font></em><font o="1937">可能不同），则不会重新下载。</font><font o="1938">另一方面，当使用<code i="398">maven://</code>资源时，使用常量位置仍可能绕过缓存（如果使用<code i="399">-SNAPSHOT</code>版本）。</font></p>
</div>
<div class="paragraph">
<p><font o="1939">此外，如果已经部署了流并使用某个版本的已注册应用程序，那么（强制）重新注册其他应用程序将无效，直到再次部署该流。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1940">
在某些情况下，资源在服务器端解析。</font><font o="1941">在其他情况下，URI将传递到解析它的运行时容器实例。</font><font o="1942">有关更多详细信息，请参阅每个数据流服务器的特定文档。
</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="spring-cloud-dataflow-stream-app-whitelisting">32.1.2.<font o="1944">白名单应用程序属性</font></h4>
<div class="paragraph">
<p><font o="1945">流和任务应用程序是Spring Boot应用程序，它们知道许多</font><a href="#spring-cloud-dataflow-global-properties"><font o="1945">Common Application Properties</font></a><font o="1945">，例如<code i="400">server.port</code>，但也有一些属性系列，例如前缀为<code i="401">spring.jmx</code>和<code i="402">logging</code>的属性。</font><font o="1946">在创建自己的应用程序时，您应该将属性列入白名单，以便在通过TAB完成或在下拉框中显示选项时，shell和UI可以首先将它们显示为主要属性。</font></p>
</div>
<div class="paragraph">
<p><font o="1947">要将应用程序属性列入白名单，请在<code i="404">META-INF</code>资源目录中创建名为<code i="403">spring-configuration-metadata-whitelist.properties</code>的文件。</font><font o="1948">可以在此文件中使用两个属性键。</font><font o="1949">第一个键名为<code i="405">configuration-properties.classes</code>。</font><font o="1950">该值是以逗号分隔的完全限定的<code i="406">@ConfigurationProperty</code>类名列表。</font><font o="1951">第二个键是<code i="407">configuration-properties.names</code>，其值是以逗号分隔的属性名称列表。</font><font o="1952">这可以包含属性的全名，例如<code i="408">server.port</code>，或部分名称，以将属性名称列入白名单，例如<code i="409">spring.jmx</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="1953">该</font><a href="javascript:;"><font o="1953">Spring Cloud Stream应用程序启动器</font></a><font o="1953">是寻找使用示例的好地方。</font><font o="1954">以下示例来自文件接收器的<code i="410">spring-configuration-metadata-whitelist.properties</code>文件：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>configuration-properties.classes=org.springframework.cloud.stream.app.file.sink.FileSinkProperties</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1955">如果我们还要将<code i="411">server.port</code>添加为白名单，它将成为以下行：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>configuration-properties.classes=org.springframework.cloud.stream.app.file.sink.FileSinkProperties
configuration-properties.names=server.port</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="1956">确保添加“spring-boot-configuration-processor”作为可选依赖项，以生成属性的配置元数据文件。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;
    &lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="spring-cloud-dataflow-stream-app-metadata-artifact">32.1.3.<font o="1958">创建和使用专用元数据工件</font></h4>
<div class="paragraph">
<p><font o="1959">通过创建元数据伴随工件，您可以更进一步描述流或任务应用程序支持的主要属性。</font><font o="1960">此jar文件仅包含有关配置属性元数据的Spring引导JSON文件和上一节中描述的白名单文件。</font></p>
</div>
<div class="paragraph">
<p><font o="1961">以下示例显示了规范<code i="412">log</code>接收器的此类工件的内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ jar tvf log-sink-rabbit-1.2.1.BUILD-SNAPSHOT-metadata.jar
373848 META-INF/spring-configuration-metadata.json
   174 META-INF/spring-configuration-metadata-whitelist.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1962">请注意，<code i="413">spring-configuration-metadata.json</code>文件非常大。</font><font o="1963">这是因为它包含</font><font o="1963">运行时可用于<code i="414">log</code>接收器</font><font o="1963">的</font><em><font o="1963">所有</font></em><font o="1963">属性</font><font o="1963">的串联</font><font o="1963">（其中一些来自<code i="415">spring-boot-actuator.jar</code>，其中一些来自<code i="416">spring-boot-autoconfigure.jar</code>，更多来自<code i="417">spring-cloud-starter-stream-sink-log.jar</code> }， 等等）。</font><font o="1964">数据流总是依赖于所有这些属性，即使伴随工件不可用，但这里所有属性都已合并到一个文件中。</font></p>
</div>
<div class="paragraph">
<p><font o="1965">为了帮助你（你不想尝试手工制作这个巨大的JSON文件），你可以在你的构建中使用以下插件：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
 	&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
 	&lt;artifactId&gt;spring-cloud-app-starter-metadata-maven-plugin&lt;/artifactId&gt;
 	&lt;executions&gt;
 		&lt;execution&gt;
 			&lt;id&gt;aggregate-metadata&lt;/id&gt;
 			&lt;phase&gt;compile&lt;/phase&gt;
 			&lt;goals&gt;
 				&lt;goal&gt;aggregate-metadata&lt;/goal&gt;
 			&lt;/goals&gt;
 		&lt;/execution&gt;
 	&lt;/executions&gt;
 &lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="1966">
此插件除了创建单个JSON文件的<code i="418">spring-boot-configuration-processor</code>之外。</font><font o="1967">一定要配置两者。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1968">配套工件的好处包括：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="1969">更轻松。</font><font o="1970">（伴随工件通常为几千字节，而不是实际应用程序的兆字节。）因此，它们下载速度更快，允许在使用时提供更快的反馈，例如<code i="419">app info</code>或仪表板UI。</font></p>
</li>
<li>
<p><font o="1971">由于更轻，因此当元数据是所需的唯一信息时，它们可用于资源受限的环境（例如PaaS）。</font></p>
</li>
<li>
<p><font o="1972">对于不直接处理Spring Boot uber jar的环境（例如，基于Docker的运行时，如Kubernetes或Cloud Foundry），这是提供有关应用程序支持的属性的元数据的唯一方法。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="1973">但请记住，在处理超级罐时，这完全是可选的。</font><font o="1974">超级jar本身也包含其中的元数据。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_using_the_companion_artifact">32.1.4.<font o="1976">使用Companion Artifact</font></h4>
<div class="paragraph">
<p><font o="1977">一旦掌握了伴随工件，就需要让系统了解它，以便可以使用它。</font></p>
</div>
<div class="paragraph">
<p><font o="1978">使用<code i="420">app register</code>注册单个应用程序时，可以在shell中使用可选的<code i="421">--metadata-uri</code>选项，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;app register --name log --type sink
    --uri maven://org.springframework.cloud.stream.app:log-sink-kafka-10:1.2.1.BUILD-SNAPSHOT
    --metadata-uri maven://org.springframework.cloud.stream.app:log-sink-kafka-10:jar:metadata:1.2.1.BUILD-SNAPSHOT</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="1979">使用<code i="422">app import</code>命令注册多个文件时，除了每个<code i="424">&lt;type&gt;.&lt;name&gt;</code>行之外，该文件还应包含<code i="423">&lt;type&gt;.&lt;name&gt;.metadata</code>行。</font><font o="1980">严格来说，这样做是可选的（如果有些应用程序有，但有些应用程序没有，它可以工作），但这是最好的做法。</font></p>
</div>
<div class="paragraph">
<p><font o="1981">以下示例显示了一个Dockerized应用程序，其中元数据工件托管在Maven存储库中（通过<code i="425">http://</code>或<code i="426">file://</code>检索它同样可行）。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-properties" data-lang="properties">...
source.http=docker:springcloudstream/http-source-rabbit:latest
source.http.metadata=maven://org.springframework.cloud.stream.app:http-source-rabbit:jar:metadata:1.2.1.BUILD-SNAPSHOT
...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="custom-applications">32.1.5.<font o="1983">创建定制应用程序</font></h4>
<div class="paragraph">
<p><font o="1984">虽然可以使用开箱即用的源，处理器，接收器应用程序，但您可以扩展这些应用程序或编写自定义</font><a href="javascript:;"><font o="1984">Spring Cloud Stream</font></a><font o="1984">应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="1985">使用</font><a href="javascript:;"><font o="1985">Spring Initializr</font></a><font o="1985">创建Spring Cloud Stream应用程序的过程</font><font o="1985">在Spring Cloud Stream </font><a href="javascript:;"><font o="1985">文档中</font></a><font o="1985">有详细</font><a href="javascript:;"><font o="1985">说明</font></a><font o="1985">。</font><font o="1986">可以将多个绑定器包括到应用程序中。</font><font o="1987">如果这样做，请参阅</font><a href="#passing_producer_consumer_properties"><font o="1987">传递Spring Cloud Stream属性</font></a><font o="1987">中的说明以了解如何配置它们。</font></p>
</div>
<div class="paragraph">
<p><font o="1988">为了支持属性白名单，在Spring Cloud Data Flow中运行的Spring Cloud Stream应用程序可能包含Spring Boot <code i="427">configuration-processor</code>作为可选依赖项，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
  &lt;!-- other dependencies --&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;
    &lt;optional&gt;true&lt;/optional&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="1989">确保POM中包含<code i="428">spring-boot-maven-plugin</code>。</font><font o="1990">该插件是创建使用Spring Cloud Data Flow注册的可执行jar所必需的。</font><font o="1991">Spring Initialzr在生成的POM中包含插件。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="1992">创建自定义应用程序后，可以按注册</font><a href="#spring-cloud-dataflow-register-stream-apps"><font o="1992">流应用程序</font></a><font o="1992">中的说明进行</font><a href="#spring-cloud-dataflow-register-stream-apps"><font o="1992">注册</font></a><font o="1992">。</font></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-create-stream">32.2.<font o="1994">创建流</font></h3>
<div class="paragraph">
<p><font o="1995">Spring Cloud Data Flow服务器公开了一个完整的RESTful API来管理流定义的生命周期，但最简单的方法是通过Spring Cloud Data Flow shell。</font><font o="1996">按照“ </font><a href="#getting-started"><font o="1996">入门”</font></a><font o="1996">部分</font><font o="1996">中的说明启动shell </font><font o="1996">。</font></p>
</div>
<div class="paragraph">
<p><font o="1997">在流定义的帮助下创建新流。</font><font o="1998">定义是从简单的DSL构建的。</font><font o="1999">例如，考虑如果我们执行以下shell命令会发生什么：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt; stream create --definition "time | log" --name ticktock</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2000">这定义了一个名为<code i="429">ticktock</code>的流，它基于DSL表达式<code i="430">time | log</code>。</font><font o="2001">DSL使用“管道”符号（<code i="431">|</code>）将源连接到接收器。</font></p>
</div>
<div class="sect3">
<h4 id="_application_properties_2">32.2.1.<font o="2003">申请Properties</font></h4>
<div class="paragraph">
<p><font o="2004">应用程序属性是与流中的每个应用程序关联的属性。</font><font o="2005">部署应用程序时，应用程序属性将通过命令行参数或环境变量应用于应用程序，具体取决于基础部署实现。</font></p>
</div>
<div class="paragraph">
<p><font o="2006">以下流可以在创建流时定义应用程序属性：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; stream create --definition "time | log" --name ticktock</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2007">shell命令<code i="432">app info --name &lt;appName&gt; --type &lt;appType&gt;</code>显示应用程序的白名单应用程序属性。</font><font o="2008">有关属性白</font><a href="#spring-cloud-dataflow-stream-app-whitelisting"><font o="2008">名单的</font></a><font o="2008">更多信息，请参阅</font><a href="#spring-cloud-dataflow-stream-app-whitelisting"><font o="2008">白名单应用程序属性</font></a></p>
</div>
<div class="paragraph">
<p><font o="2009">以下清单显示了<code i="433">time</code>应用的white_listed属性：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; app info --name time --type source
╔══════════════════════════════╤══════════════════════════════╤══════════════════════════════╤══════════════════════════════╗
║         Option Name          │         Description          │           Default            │             Type             ║
╠══════════════════════════════╪══════════════════════════════╪══════════════════════════════╪══════════════════════════════╣
║trigger.time-unit             │The TimeUnit to apply to delay│&lt;none&gt;                        │java.util.concurrent.TimeUnit ║
║                              │values.                       │                              │                              ║
║trigger.fixed-delay           │Fixed delay for periodic      │1                             │java.lang.Integer             ║
║                              │triggers.                     │                              │                              ║
║trigger.cron                  │Cron expression value for the │&lt;none&gt;                        │java.lang.String              ║
║                              │Cron Trigger.                 │                              │                              ║
║trigger.initial-delay         │Initial delay for periodic    │0                             │java.lang.Integer             ║
║                              │triggers.                     │                              │                              ║
║trigger.max-messages          │Maximum messages per poll, -1 │1                             │java.lang.Long                ║
║                              │means infinity.               │                              │                              ║
║trigger.date-format           │Format for the date value.    │&lt;none&gt;                        │java.lang.String              ║
╚══════════════════════════════╧══════════════════════════════╧══════════════════════════════╧══════════════════════════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2010">以下清单显示了<code i="434">log</code>应用的白名单属性：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; app info --name log --type sink
╔══════════════════════════════╤══════════════════════════════╤══════════════════════════════╤══════════════════════════════╗
║         Option Name          │         Description          │           Default            │             Type             ║
╠══════════════════════════════╪══════════════════════════════╪══════════════════════════════╪══════════════════════════════╣
║log.name                      │The name of the logger to use.│&lt;none&gt;                        │java.lang.String              ║
║log.level                     │The level at which to log     │&lt;none&gt;                        │org.springframework.integratio║
║                              │messages.                     │                              │n.handler.LoggingHandler$Level║
║log.expression                │A SpEL expression (against the│payload                       │java.lang.String              ║
║                              │incoming message) to evaluate │                              │                              ║
║                              │as the logged message.        │                              │                              ║
╚══════════════════════════════╧══════════════════════════════╧══════════════════════════════╧══════════════════════════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2011"><code i="435">time</code>和<code i="436">log</code>应用程序的应用程序属性可以在创建<code i="437">stream</code>时指定，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; stream create --definition "time --fixed-delay=5 | log --level=WARN" --name ticktock</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2012">请注意，在前面的示例中，为应用<code i="440">time</code>和<code i="441">log</code>定义的<code i="438">fixed-delay</code>和<code i="439">level</code>属性是shell完成提供的“'short-form'”属性名称。</font><font o="2013">这些“'短格式'”属性名称仅适用于列入白名单的属性。</font><font o="2014">在所有其他情况下，只应使用完全限定的属性名称。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="spring-cloud-dataflow-global-properties">32.2.2.<font o="2016">共同申请Properties</font></h4>
<div class="paragraph">
<p><font o="2017">除了通过DSL进行配置之外，Spring Cloud Data Flow还提供了一种机制，用于为其启动的所有流应用程序设置公共属性。</font><font o="2018">这可以通过在启动服务器时添加前缀为<code i="442">spring.cloud.dataflow.applicationProperties.stream</code>的属性来完成。</font><font o="2019">执行此操作时，服务器将所有不带前缀的属性传递给它启动的实例。</font></p>
</div>
<div class="paragraph">
<p><font o="2020">例如，通过使用以下选项启动数据流服务器，可以将所有已启动的应用程序配置为使用特定的Kafka代理：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>--spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.kafka.binder.brokers=192.168.1.100:9092
--spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.kafka.binder.zkNodes=192.168.1.100:2181</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2021">这样做会导致属性<code i="443">spring.cloud.stream.kafka.binder.brokers</code>和<code i="444">spring.cloud.stream.kafka.binder.zkNodes</code>传递给所有已启动的应用程序。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2022">
使用此机制配置的Properties优先级低于流部署属性。</font><font o="2023">如果在流部署时指定具有相同键的属性（例如，<code i="445">app.http.spring.cloud.stream.kafka.binder.brokers</code>覆盖公共属性），则会覆盖它们。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-deploy-stream">32.3.<font o="2025">部署流</font></h3>
<div class="paragraph">
<p><font o="2026">本节介绍在Spring Cloud Data Flow服务器负责部署流时如何部署流。</font><font o="2027">以下部分“ </font><a href="#spring-cloud-dataflow-stream-lifecycle-skipper"><font o="2027">Stream Lifecycle with Skipper</font></a><font o="2027"> ”涵盖了Spring Cloud Data Flow服务器委派给Skipper进行流部署时的新部署和升级功能。</font><font o="2028">部署属性如何应用于Stream部署的两种方法的描述。</font></p>
</div>
<div class="paragraph">
<p><font o="2029">给出<code i="446">ticktock</code>流定义：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; stream create --definition "time | log" --name ticktock</code></p>
</div>
<div class="paragraph">
<p><font o="2030">要部署流，请使用以下shell命令：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; stream deploy --name ticktock</code></p>
</div>
<div class="paragraph">
<p><font o="2031">数据流服务器将<code i="447">time</code>和<code i="448">log</code>解析为maven坐标，并使用它们启动流的<code i="449">time</code>和<code i="450">log</code>应用程序，如下面的清单所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>2016-06-01 09:41:21.728  INFO 79016 --- [nio-9393-exec-6] o.s.c.d.spi.local.LocalAppDeployer       : deploying app ticktock.log instance 0
   Logs will be in /var/folders/wn/8jxm_tbd1vj28c8vj37n900m0000gn/T/spring-cloud-dataflow-912434582726479179/ticktock-1464788481708/ticktock.log
2016-06-01 09:41:21.914  INFO 79016 --- [nio-9393-exec-6] o.s.c.d.spi.local.LocalAppDeployer       : deploying app ticktock.time instance 0
   Logs will be in /var/folders/wn/8jxm_tbd1vj28c8vj37n900m0000gn/T/spring-cloud-dataflow-912434582726479179/ticktock-1464788481910/ticktock.time</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2032">在前面的示例中，时间源每秒将当前时间作为消息发送，并且日志接收器使用日志记录框架输出它。</font><font o="2033">您可以尾随<code i="451">stdout</code>日志（后缀为<code i="452">&lt;instance&gt;</code>）。</font><font o="2034">日志文件位于数据流服务器日志输出中显示的目录中，如下面的清单所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>$ tail -f /var/folders/wn/8jxm_tbd1vj28c8vj37n900m0000gn/T/spring-cloud-dataflow-912434582726479179/ticktock-1464788481708/ticktock.log/stdout_0.log
2016-06-01 09:45:11.250  INFO 79194 --- [  kafka-binder-] log.sink    : 06/01/16 09:45:11
2016-06-01 09:45:12.250  INFO 79194 --- [  kafka-binder-] log.sink    : 06/01/16 09:45:12
2016-06-01 09:45:13.251  INFO 79194 --- [  kafka-binder-] log.sink    : 06/01/16 09:45:13</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2035">您还可以通过在创建流时传递<code i="453">--deploy</code>标志来一步创建和部署流，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt; stream create --definition "time | log" --name ticktock --deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2036">但是，在实际用例中，一步创建和部署流并不常见。</font><font o="2037">原因是当您使用<code i="454">stream deploy</code>命令时，您可以传入定义如何将应用程序映射到平台的属性（例如，要使用的容器的内存大小，每个应用程序的数量到运行，以及是否启用数据分区功能）。</font><font o="2038">Properties还可以覆盖在创建流时设置的应用程序属性。</font><font o="2039">接下来的部分将详细介绍此功能。</font></p>
</div>
<div class="sect3">
<h4 id="_deployment_properties">32.3.1.<font o="2041">部署Properties</font></h4>
<div class="paragraph">
<p><font o="2042">部署流时，您可以指定属于两个组的属性：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2043">Properties控制应用程序如何部署到目标平台。</font><font o="2044">这些属性使用<code i="455">deployer</code>前缀，称为<code i="456">deployer</code>属性。</font></p>
</li>
<li>
<p><font o="2045">Properties设置应用程序属性或覆盖在流创建期间设置的应用程序属性，并称为<code i="457">application</code>属性。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="2046"><code i="458">deployer</code>属性的语法是<code i="459">deployer.&lt;app-name&gt;.&lt;short-property-name&gt;=&lt;value&gt;</code>，<code i="460">application</code>属性<code i="461">app.&lt;app-name&gt;.&lt;property-name&gt;=&lt;value&gt;</code>的语法。</font><font o="2047">通过shell传递部署属性时使用此语法。</font><font o="2048">您也可以在YAML文件中指定它们，本文稍后将对此进行讨论。</font></p>
</div>
<div class="paragraph">
<p><font o="2049">下表显示了在部署应用程序时设置<code i="462">deployer</code>和<code i="463">application</code>属性之间的行为差​​异。</font></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"><font o="2050">申请Properties</font></th>
<th class="tableblock halign-left valign-top"><font o="2051">部署员Properties</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><strong>Example Syntax</strong></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>app.filter.expression=something</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>deployer.filter.count=3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><strong>What the application "sees"</strong></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>expression=something</code> or, if <code>expression</code> is one of the whitelisted properties, <code>&lt;some-prefix&gt;.expression=something</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Nothing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><strong>What the deployer "sees"</strong></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Nothing</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>spring.cloud.deployer.count=3</code>. The <code>spring.cloud.deployer</code> prefix is automatically and always prepended to the property name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><strong>Typical usage</strong></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Passing/Overriding application properties, passing Spring Cloud Stream binder or partitioning properties</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Setting the number of instances, memory, disk, and others</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="_passing_instance_count"><font o="2052">传递实例计数</font></h5>
<div class="paragraph">
<p><font o="2053">如果您希望在流中有多个应用程序实例，则可以使用<code i="465">deploy</code>命令包含名为<code i="464">count</code>的部署程序属性：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; stream deploy --name ticktock --properties "deployer.time.count=3"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2054">请注意，<code i="466">count</code>是底层部署者使用的保留属性名称。</font><font o="2055">因此，如果应用程序还具有名为<code i="467">count</code>的自定义属性，则在流部署期间以“短格式”形式指定时不支持该属性，因为它可能与实例<code i="468">count</code> deployer属性冲突。</font><font o="2056">相反，作为自定义应用程序属性的<code i="469">count</code>可以在流部署期间以其完全限定的形式（例如，<code i="470">app.something.somethingelse.count</code>）指定，或者可以使用“短格式”或完全限定的表单来指定在流创建期间，它作为app属性处理。</font></p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="2057">
请参阅</font><a href="#spring-cloud-dataflow-stream-dsl-labels"><font o="2057">在流中使用标签</font></a><font o="2057">。
</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_inline_versus_file_based_properties"><font o="2058">内联与基于文件的Properties</font></h5>
<div class="paragraph">
<p><font o="2059">使用Spring Cloud Data Flow Shell时，有两种方法可以提供部署属性：</font><strong><font o="2059">内联</font></strong><font o="2059">或通过</font><strong><font o="2059">文件引用</font></strong><font o="2059">。</font><font o="2060">这两种方式都是排他性的。</font></p>
</div>
<div class="paragraph">
<p><font o="2061">内联属性使用<code i="471">--properties</code> shell选项和列表属性作为逗号分隔的键=值对列表，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">stream deploy foo
    --properties "deployer.transform.count=2,app.transform.producer.partitionKeyExpression=payload"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2062">文件引用使用<code i="472">--propertiesFile</code>选项并将其指向本地<code i="473">.properties</code>，<code i="474">.yaml</code>或<code i="475">.yml</code>文件（即，驻留在运行shell的计算机的文件系统中的文件）。</font><font o="2063">作为<code i="476">.properties</code>文件读取，正常规则适用（ISO 8859-1编码，<code i="477">=</code>，<code i="478">&lt;space&gt;</code>或<code i="479">:</code>分隔符等），但我们建议使用<code i="480">=</code>作为键值对分隔符，用于一致性。</font><font o="2064">以下示例显示了使用<code i="482">--propertiesFile</code>选项的<code i="481">stream deploy</code>命令：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">stream deploy something --propertiesFile myprops.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2065">假设<code i="483">myprops.properties</code>包含以下属性：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>deployer.transform.count=2
app.transform.producer.partitionKeyExpression=payload</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2066">这两个属性都作为<code i="484">something</code>流的部署属性传递。</font></p>
</div>
<div class="paragraph">
<p><font o="2067">如果使用YAML作为部署属性的格式，请在部署流时使用<code i="485">.yaml</code>或<code i="486">.yml</code>文件扩展，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">stream deploy foo --propertiesFile myprops.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2068">在这种情况下，<code i="487">myprops.yaml</code>文件可能包含以下内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>deployer:
  transform:
    count: 2
app:
  transform:
    producer:
      partitionKeyExpression: payload</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_passing_application_properties"><font o="2069">传递应用程序属性</font></h5>
<div class="paragraph">
<p><font o="2070">部署流时也可以指定应用程序属性。</font><font o="2071">在部署期间指定时，可以将这些应用程序属性指定为“短格式”属性名称（适用于列入白名单的属性）或完全限定的属性名称。</font><font o="2072">应用程序属性应具有前缀<code i="488">app.&lt;appName/label&gt;</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="2073">例如，请考虑以下stream命令：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; stream create --definition "time | log" --name ticktock</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2074">通过使用“短格式”属性名称，还可以使用应用程序属性部署precedig示例中的流，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream deploy ticktock --properties "app.time.fixed-delay=5,app.log.level=ERROR"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2075">请考虑以下示例：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">stream create ticktock --definition "a: time | b: log"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2076">使用app标签时，应用程序属性可以定义如下：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">stream deploy ticktock --properties "app.a.fixed-delay=4,app.b.level=ERROR"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="passing_producer_consumer_properties"><font o="2077">传递Spring Cloud Stream属性</font></h5>
<div class="paragraph">
<p><font o="2078">Spring Cloud Data Flow为流中的应用程序设置<code i="489">required</code> Spring Cloud Stream属性。</font><font o="2079">最重要的是，<code i="490">spring.cloud.stream.bindings.&lt;input/output&gt;.destination</code>是内部设置的应用程序绑定。</font></p>
</div>
<div class="paragraph">
<p><font o="2080">如果要覆盖任何Spring Cloud Stream属性，可以使用部署属性进行设置。</font></p>
</div>
<div class="paragraph">
<p><font o="2081">例如，请考虑以下流定义：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; stream create --definition "http | transform --expression=payload.getValue('hello').toUpperCase() | log" --name ticktock</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2082">如果每个应用程序的类路径中有多个可用的绑定器，并且为每个部署选择了绑定器，则可以使用特定的Spring Cloud Stream属性部署流，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream deploy ticktock --properties "app.time.spring.cloud.stream.bindings.output.binder=kafka,app.transform.spring.cloud.stream.bindings.input.binder=kafka,app.transform.spring.cloud.stream.bindings.output.binder=rabbit,app.log.spring.cloud.stream.bindings.input.binder=rabbit"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2083">
建议不要覆盖目标名称，因为Spring Cloud Data Flow内部负责设置此属性。
</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="_passing_per_binding_producer_and_consumer_properties"><font o="2084">传递每个绑定生产者和消费者Properties</font></h5>
<div class="paragraph">
<p><font o="2085">Spring Cloud Stream应用程序可以基于<code i="491">per-binding</code>设置生产者和消费者属性。</font><font o="2086">虽然Spring Cloud Data Flow支持为每个绑定生成器属性指定简写符号，例如<code i="492">partitionKeyExpression</code>和<code i="493">partitionKeyExtractorClass</code>（如</font><a href="#passing_stream_partition_properties"><font o="2086">传递流分区Properties中所述</font></a><font o="2086">），但所有受支持的Spring Cloud Stream生成器/消费者属性也可以直接设置为应用的Spring Cloud Stream属性。</font></p>
</div>
<div class="paragraph">
<p><font o="2087">可以为<code i="494">inbound</code>通道名称设置消费者属性，前缀为<code i="495">app.[app/label name].spring.cloud.stream.bindings.&lt;channelName&gt;.consumer.</code>。</font><font o="2088">可以为<code i="496">outbound</code>通道名称设置生产者属性，前缀为<code i="497">app.[app/label name].spring.cloud.stream.bindings.&lt;channelName&gt;.producer.</code>。</font><font o="2089">请考虑以下示例：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; stream create --definition "time | log" --name ticktock</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2090">可以使用producer和consumer属性部署流，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream deploy ticktock --properties "app.time.spring.cloud.stream.bindings.output.producer.requiredGroups=myGroup,app.time.spring.cloud.stream.bindings.output.producer.headerMode=raw,app.log.spring.cloud.stream.bindings.input.consumer.concurrency=3,app.log.spring.cloud.stream.bindings.input.consumer.maxAttempts=5"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2091">特定于<code i="498">binder</code>的生产者和消费者属性也可以以类似的方式指定，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream deploy ticktock --properties "app.time.spring.cloud.stream.rabbit.bindings.output.producer.autoBindDlq=true,app.log.spring.cloud.stream.rabbit.bindings.input.consumer.transacted=true"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="passing_stream_partition_properties"><font o="2092">通过流分区Properties</font></h5>
<div class="paragraph">
<p><font o="2093">流处理中的一种常见模式是在数据流传输时对数据进行分区。</font><font o="2094">这需要部署消息应用程序的多个实例并使用基于内容的路由，以便具有给定键（在运行时确定）的消息始终路由到同一个应用程序实例。</font><font o="2095">您可以在流部署期间传递分区属性，以声明方式配置分区策略，以将每条消息路由到特定的使用者实例。</font></p>
</div>
<div class="paragraph">
<p><font o="2096">以下列表显示了部署分区流的变体：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><font o="2097">app。[app / label name] .producer.partitionKeyExtractorClass</font></strong><font o="2097">：<code i="499">PartitionKeyExtractorStrategy</code>的类名（默认值：<code i="500">null</code>）</font></p>
</li>
<li>
<p><strong><font o="2098">app。[app / label name] .producer.partitionKeyExpression</font></strong><font o="2098">：根据消息评估的SpEL表达式，用于确定分区键。</font><font o="2099">仅在<code i="501">partitionKeyExtractorClass</code>为空时适用。</font><font o="2100">如果两者都为null，则不对应用程序进行分区（默认值：<code i="502">null</code>）</font></p>
</li>
<li>
<p><strong><font o="2101">app。[app / label name] .producer.partitionSelectorClass</font></strong><font o="2101">：<code i="503">PartitionSelectorStrategy</code>的类名（默认值：<code i="504">null</code>）</font></p>
</li>
<li>
<p><strong><font o="2102">app。[app / label name] .producer.partitionSelectorExpression</font></strong><font o="2102">：根据分区键计算的SpEL表达式，用于确定消息路由到的分区索引。</font><font o="2103">最终分区索引是模数<code i="505">[nextModule].count</code>的返回值（整数）。</font><font o="2104">如果类和表达式都为null，则底层绑定器的默认值<code i="506">PartitionSelectorStrategy</code>将应用于键（默认值：<code i="507">null</code>）</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="2105">总之，如果应用程序的计数&gt; 1且前一个应用程序的<code i="508">partitionKeyExtractorClass</code>或<code i="509">partitionKeyExpression</code>（<code i="510">partitionKeyExtractorClass</code>优先），则会对其进行分区。</font><font o="2106">提取分区键时，通过调用<code i="511">partitionSelectorClass</code>（如果存在）或<code i="512">partitionSelectorExpression % partitionCount</code>来确定分区的应用程序实例。</font><font o="2107">对于RabbitMQ，<code i="513">partitionCount</code>是应用程序计数，或者在Kafka的情况下，是主题的基础分区计数。</font></p>
</div>
<div class="paragraph">
<p><font o="2108">如果既不存在<code i="514">partitionSelectorClass</code>也不存在<code i="515">partitionSelectorExpression</code>，则结果为<code i="516">key.hashCode() % partitionCount</code>。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="passing_content_type_properties"><font o="2109">传递应用程序内容类型属性</font></h5>
<div class="paragraph">
<p><font o="2110">在流定义中，您可以指定必须将应用程序的输入或输出转换为其他类型。</font><font o="2111">您可以使用<code i="517">inputType</code>和<code i="518">outputType</code>属性分别指定传入数据和传出数据的内容类型。</font></p>
</div>
<div class="paragraph">
<p><font o="2112">例如，请考虑以下流：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;stream create tuple --definition "http | filter --inputType=application/x-spring-tuple
 --expression=payload.hasFieldName('hello') | transform --expression=payload.getValue('hello').toUpperCase()
 | log" --deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2113"><code i="519">http</code>应用程序需要以JSON格式发送数据，<code i="520">filter</code>应用程序接收JSON数据并将其作为Spring元组进行处理。</font><font o="2114">为此，我们使用过滤器应用程序上的<code i="521">inputType</code>属性将数据转换为预期的Spring元组格式。</font><font o="2115"><code i="522">transform</code>应用程序处理元组数据并将处理后的数据发送到下游<code i="523">log</code>应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="2116">请考虑以下将一些数据发送到<code i="524">http</code>应用程序的示例：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">dataflow:&gt;http post --data {"hello":"world","something":"somethingelse"} --contentType application/json --target http://localhost:&lt;http-port&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><font o="2117">在日志应用程序中，您会看到如下内容：</font></p>
</div>
<div class="paragraph">
<p><code>INFO 18745 --- [transform.tuple-1] log.sink : WORLD</code></p>
</div>
<div class="paragraph">
<p><font o="2118">根据应用程序的链接方式，内容类型转换可以在上游应用程序中指定为<code i="525">--outputType</code>，也可以在下游应用程序中指定为<code i="526">--inputType</code>。</font><font o="2119">例如，在上面的流中，不是在'transform'应用程序上指定要转换的<code i="527">--inputType</code>，而是也可以在'http'应用程序上指定选项<code i="528">--outputType=application/x-spring-tuple</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="2120">有关消息转换和消息转换器的完整列表，请参阅Spring Cloud Stream </font><a href="javascript:;"><font o="2120">文档</font></a><font o="2120">。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="_overriding_application_properties_during_stream_deployment"><font o="2121">在流部署期间覆盖应用程序Properties</font></h5>
<div class="paragraph">
<p><font o="2122">部署期间定义的应用程序属性将覆盖在流创建期间定义的相同属性。</font></p>
</div>
<div class="paragraph">
<p><font o="2123">例如，以下流具有在流创建期间定义的应用程序属性：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; stream create --definition "time --fixed-delay=5 | log --level=WARN" --name ticktock</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2124">要覆盖这些应用程序属性，可以在部署期间指定新属性值，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream deploy ticktock --properties "app.time.fixed-delay=4,app.log.level=ERROR"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-destroy-stream">32.4.<font o="2126">摧毁一条小溪</font></h3>
<div class="paragraph">
<p><font o="2127">您可以通过从shell发出<code i="529">stream destroy</code>命令来删除流，如下所示：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; stream destroy --name ticktock</code></p>
</div>
<div class="paragraph">
<p><font o="2128">如果部署了流，则在删除流定义之前将取消部署它。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-undeploy-stream">32.5.<font o="2130">取消部署流</font></h3>
<div class="paragraph">
<p><font o="2131">通常，您希望停止流但保留名称和定义以供将来使用。</font><font o="2132">在这种情况下，您可以按名称<code i="530">undeploy</code>输入流。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt; stream undeploy --name ticktock
dataflow:&gt; stream deploy --name ticktock</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2133">您可以稍后发出<code i="531">deploy</code>命令以重新启动它。</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; stream deploy --name ticktock</code></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-validate-stream">32.6.<font o="2135">验证流</font></h3>
<div class="paragraph">
<p><font o="2136">有时，流定义中包含的一个或多个应用程序在其注册中包含无效的URI。</font><font o="2137">这可能是由于在应用注册时输入的URI无效或应用程序已从用于绘制应用程序的存储库中删除而导致的。</font><font o="2138">要验证流中包含的所有应用程序是否可解析，用户可以使用<code i="532">validate</code>命令。</font><font o="2139">例如：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream validate ticktock
╔═══════════╤═════════════════╗
║Stream Name│Stream Definition║
╠═══════════╪═════════════════╣
║ticktock   │time | log       ║
╚═══════════╧═════════════════╝


ticktock is a valid stream.
╔═══════════╤═════════════════╗
║ App Name  │Validation Status║
╠═══════════╪═════════════════╣
║source:time│valid            ║
║sink:log   │valid            ║
╚═══════════╧═════════════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2140">在上面的示例中，用户验证了他们的ticktock流。</font><font o="2141">我们看到<code i="533">source:time</code>和<code i="534">sink:log</code>都是有效的。</font><font o="2142">现在让我们看看如果我们有一个带有无效URI的注册应用程序的流定义会发生什么。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream validate bad-ticktock
╔════════════╤═════════════════╗
║Stream Name │Stream Definition║
╠════════════╪═════════════════╣
║bad-ticktock│bad-time | log   ║
╚════════════╧═════════════════╝


bad-ticktock is an invalid stream.
╔═══════════════╤═════════════════╗
║   App Name    │Validation Status║
╠═══════════════╪═════════════════╣
║source:bad-time│invalid          ║
║sink:log       │valid            ║
╚═══════════════╧═════════════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2143">在这种情况下，Spring Cloud Data Flow表示流是无效的，因为source：bad-time具有无效的URI。</font></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-stream-lifecycle-skipper"><font o="2144">33.船长生命周期与船长</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2145">如果您以“skipper”模式运行，则可以使用Stream的其他生命周期阶段。</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#spring-cloud-dataflow-streams-skipper-upgrading"><font></font></a><font o="2146">Stream中的</font><a href="#spring-cloud-dataflow-streams-skipper-upgrading"><font o="2146">升级</font></a><font o="2146">或</font><a href="#spring-cloud-dataflow-streams-skipper-rollback"><font o="2146">回滚</font></a><font o="2146">应用程序。</font><font o="2147">（船长模式）</font></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="javascript:;"><font o="2148">Skipper</font></a><font o="2148">是一种服务器，您可以在多个云平台上发现Spring Boot应用程序并管理其生命周期。</font></p>
</div>
<div class="paragraph">
<p><font o="2149">Skipper中的应用程序捆绑为包含应用程序资源位置，应用程序属性和部署属性的包。</font><font o="2150">您可以认为Skipper软件包与<code i="535">apt-get</code>或<code i="536">brew</code>等工具中的软件包类似。</font></p>
</div>
<div class="paragraph">
<p><font o="2151">当Data Flow部署Stream时，它将生成一个包并将其上传到Skipper，代表Stream中的应用程序。</font><font o="2152">在Stream中升级或回滚应用程序的后续命令将传递给Skipper。</font><font o="2153">此外，Stream定义是从包中进行反向设计的，Stream的状态也被委托给Skipper。</font></p>
</div>
<div class="sect2">
<h3 id="_register_a_versioned_stream_app">33.1.<font o="2155">注册Versioned Stream应用程序</font></h3>
<div class="paragraph">
<p><font o="2156">Skipper扩展了</font><em><a href="#spring-cloud-dataflow-register-stream-apps"><font o="2156">Register a Stream App</font></a></em><font o="2156"> 
生命周期，支持多版本流应用程序。</font><font o="2157">这允许使用部署属性在运行时升级或回滚这些应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="2158">使用<code i="537">app register</code>命令注册版本化的流应用程序。</font><font o="2159">您必须提供可以解析为应用程序工件的唯一名称，应用程序类型和URI。</font><font o="2160">对于类型，请指定“source”，“processor”或“sink”。</font><font o="2161">该版本是从URI解析的。</font><font o="2162">这里有一些例子：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;app register --name mysource --type source --uri maven://com.example:mysource:0.0.1
dataflow:&gt;app register --name mysource --type source --uri maven://com.example:mysource:0.0.2
dataflow:&gt;app register --name mysource --type source --uri maven://com.example:mysource:0.0.3

dataflow:&gt;app list --id source:mysource
╔═══╤══════════════════╤═════════╤════╤════╗
║app│      source      │processor│sink│task║
╠═══╪══════════════════╪═════════╪════╪════╣
║   │&gt; mysource-0.0.1 &lt;│         │    │    ║
║   │mysource-0.0.2    │         │    │    ║
║   │mysource-0.0.3    │         │    │    ║
╚═══╧══════════════════╧═════════╧════╧════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2163">应用程序URI应符合以下架构格式之一：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2164">maven架构</font></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">maven://&lt;groupId&gt;:&lt;artifactId&gt;[:&lt;extension&gt;[:&lt;classifier&gt;]]:&lt;version&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2165">http架构</font></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">http://&lt;web-path&gt;/&lt;artifactName&gt;-&lt;version&gt;.jar</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2166">文件架构</font></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">file:///&lt;local-path&gt;/&lt;artifactName&gt;-&lt;version&gt;.jar</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2167">docker schema</font></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">docker:&lt;docker-image-path&gt;/&lt;imageName&gt;:&lt;version&gt;</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2168">
URI <code i="538">&lt;version&gt;</code>部分对于版本化的流应用程序是必需的
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="2169">可以为相同的应用程序注册多个版本（例如，相同的名称和类型），但只能将一个版本设置为默认值。</font><font o="2170">默认版本用于部署Streams。</font></p>
</div>
<div class="paragraph">
<p><font o="2171">第一次注册应用程序时，它将被标记为默认值。</font><font o="2172">可以使用<code i="539">app default</code>命令更改默认应用程序版本：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;app default --id source:mysource --version 0.0.2
dataflow:&gt;app list --id source:mysource
╔═══╤══════════════════╤═════════╤════╤════╗
║app│      source      │processor│sink│task║
╠═══╪══════════════════╪═════════╪════╪════╣
║   │mysource-0.0.1    │         │    │    ║
║   │&gt; mysource-0.0.2 &lt;│         │    │    ║
║   │mysource-0.0.3    │         │    │    ║
╚═══╧══════════════════╧═════════╧════╧════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2173"><code i="540">app list --id &lt;type:name&gt;</code>命令列出给定流应用程序的所有版本。</font></p>
</div>
<div class="paragraph">
<p><font o="2174"><code i="541">app unregister</code>命令具有可选的<code i="542">--version</code>参数，用于指定要取消注册的应用程序版本。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;app unregister --name mysource --type source --version 0.0.1
dataflow:&gt;app list --id source:mysource
╔═══╤══════════════════╤═════════╤════╤════╗
║app│      source      │processor│sink│task║
╠═══╪══════════════════╪═════════╪════╪════╣
║   │&gt; mysource-0.0.2 &lt;│         │    │    ║
║   │mysource-0.0.3    │         │    │    ║
╚═══╧══════════════════╧═════════╧════╧════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2175">如果未指定<code i="543">--version</code>，则取消注册默认版本。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="2176">流中的所有应用程序都应为要部署的流设置默认版本。</font><font o="2177">否则，在部署期间，它们将被视为未注册的应用程序。</font><font o="2178">使用<code i="544">app default</code>设置默认值。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">app default --id source:mysource --version 0.0.3
dataflow:&gt;app list --id source:mysource
╔═══╤══════════════════╤═════════╤════╤════╗
║app│      source      │processor│sink│task║
╠═══╪══════════════════╪═════════╪════╪════╣
║   │mysource-0.0.2    │         │    │    ║
║   │&gt; mysource-0.0.3 &lt;│         │    │    ║
╚═══╧══════════════════╧═════════╧════╧════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2179"><code i="545">stream deploy</code>需要设置默认的应用版本。</font><font o="2180"><code i="546">stream update</code>和<code i="547">stream rollback</code>命令虽然可以使用所有（默认和非默认）注册的应用程序版本。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream create foo --definition "mysource | log"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2181">这将使用默认的mysource版本（0.0.3）创建流。</font><font o="2182">然后我们可以将版本更新为0.0.2，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream update foo --properties version.mysource=0.0.2</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="2183">只有预先注册的应用程序可用于<code i="548">deploy</code>，<code i="549">update</code>或<code i="550">rollback</code>一个流。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="2184">尝试将<code i="551">mysource</code>更新为版本<code i="552">0.0.1</code>（未注册）将失败！</font></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-stream-lifecycle-skipper-create">33.2.<font o="2186">创建和部署流</font></h3>
<div class="paragraph">
<p><font o="2187">您可以通过两个步骤使用Skipper创建和部署流：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="2188">创建流定义。</font></p>
</li>
<li>
<p><font o="2189">部署流。</font></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><font o="2190">以下示例显示了两个步骤：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; stream create --name httptest --definition "http --server.port=9000 | log"
dataflow:&gt; stream deploy --name httptest</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2191"><code i="553">stream info</code>命令显示有关流的有用信息，包括部署属性，如下例所示（及其输出）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream info httptest
╔══════════════════════════════╤══════════════════════════════╤════════════════════════════╗
║             Name             │             DSL              │          Status            ║
╠══════════════════════════════╪══════════════════════════════╪════════════════════════════╣
║httptest                      │http --server.port=9000 | log │deploying                   ║
╚══════════════════════════════╧══════════════════════════════╧════════════════════════════╝

Stream Deployment properties: {
  "log" : {
    "spring.cloud.deployer.indexed" : "true",
    "spring.cloud.deployer.group" : "httptest",
    "maven://org.springframework.cloud.stream.app:log-sink-rabbit" : "1.1.0.RELEASE"
  },
  "http" : {
    "spring.cloud.deployer.group" : "httptest",
    "maven://org.springframework.cloud.stream.app:http-source-rabbit" : "1.1.0.RELEASE"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2192"><code i="555">stream deploy</code>命令有一个重要的可选命令参数（称为<code i="554">--platformName</code>）。</font><font o="2193">可以将Skipper配置为部署到多个平台。</font><font o="2194">Skipper预先配置了一个名为<code i="556">default</code>的平台，该平台将应用程序部署到运行Skipper的本地计算机。</font><font o="2195">命令行参数<code i="557">--platformName</code>的默认值为<code i="558">default</code>。</font><font o="2196">如果您通常部署到一个平台，则在安装Skipper时，您可以覆盖<code i="559">default</code>平台的配置。</font><font o="2197">否则，将<code i="560">platformName</code>指定为<code i="561">stream platform-list</code>命令返回的值之一。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-stream-lifecycle-skipper-update">33.3.<font o="2199">更新流</font></h3>
<div class="paragraph">
<p><font o="2200">要更新流，请使用命令<code i="562">stream update</code>作为命令参数<code i="563">--properties</code>或<code i="564">--propertiesFile</code>。</font><font o="2201">您可以使用与使用或不使用Skipper部署流时相同的格式将值传递给这些命令参数。</font><font o="2202">使用Skipper时有一个重要的新顶级前缀，即<code i="565">version</code>。</font><font o="2203">如果部署了流<code i="566">http | log</code>，并且在部署时注册的<code i="567">log</code>版本为<code i="568">1.1.0.RELEASE</code>，则以下命令将更新流以使用日志应用程序的<code i="569">1.2.0.RELEASE</code>。</font><font o="2204">在使用特定版本的应用程序更新流之前，我们需要确保该应用程序已使用该版本注册。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;app register --name log --type sink --uri maven://org.springframework.cloud.stream.app:log-sink-rabbit:1.2.0.RELEASE
Successfully registered application 'sink:log'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream update --name httptest --properties version.log=1.2.0.RELEASE</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content">
<div class="paragraph">
<p><font o="2205">只有预先注册的应用程序版本可用于<code i="570">deploy</code>，<code i="571">update</code>或<code i="572">rollback</code>流。</font></p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="2206">要验证部署属性和更新的版本，我们可以使用<code i="573">stream info</code>，如下图所示（及其输出）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream info httptest
╔══════════════════════════════╤══════════════════════════════╤════════════════════════════╗
║             Name             │             DSL              │          Status            ║
╠══════════════════════════════╪══════════════════════════════╪════════════════════════════╣
║httptest                      │http --server.port=9000 | log │deploying                   ║
╚══════════════════════════════╧══════════════════════════════╧════════════════════════════╝

Stream Deployment properties: {
  "log" : {
    "spring.cloud.deployer.indexed" : "true",
    "spring.cloud.deployer.count" : "1",
    "spring.cloud.deployer.group" : "httptest",
    "maven://org.springframework.cloud.stream.app:log-sink-rabbit" : "1.2.0.RELEASE"
  },
  "http" : {
    "spring.cloud.deployer.group" : "httptest",
    "maven://org.springframework.cloud.stream.app:http-source-rabbit" : "1.1.0.RELEASE"
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-stream-lifecycle-skipper-force-update">33.4.<font o="2208">强制更新流</font></h3>
<div class="paragraph">
<p><font o="2209">升级流时，即使没有更改应用程序或部署属性，也可以使用<code i="574">--force</code>选项部署当前部署的应用程序的新实例。</font><font o="2210">当应用程序本身在启动时获取配置信息时，例如从Spring Cloud Config Server获取配置信息时，需要此行为。</font><font o="2211">您可以使用选项<code i="575">--app-names</code>指定要强制升级的应用程序。</font><font o="2212">如果未指定任何应用程序名称，则将强制升级所有应用程序。</font><font o="2213">您可以将<code i="576">--force</code>和<code i="577">--app-names</code>选项与<code i="578">--properties</code>或<code i="579">--propertiesFile</code>选项一起指定。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_stream_versions">33.5.<font o="2215">流版本</font></h3>
<div class="paragraph">
<p><font o="2216">Skipper保留已部署的流的历史记录。</font><font o="2217">更新流后，将有第二个版本的流。</font><font o="2218">您可以使用命令<code i="580">stream history --name &lt;name-of-stream&gt;</code>查询版本的历史记录。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream history --name httptest
╔═══════╤════════════════════════════╤════════╤════════════╤═══════════════╤════════════════╗
║Version│        Last updated        │ Status │Package Name│Package Version│  Description   ║
╠═══════╪════════════════════════════╪════════╪════════════╪═══════════════╪════════════════╣
║2      │Mon Nov 27 22:41:16 EST 2017│DEPLOYED│httptest    │1.0.0          │Upgrade complete║
║1      │Mon Nov 27 22:40:41 EST 2017│DELETED │httptest    │1.0.0          │Delete complete ║
╚═══════╧════════════════════════════╧════════╧════════════╧═══════════════╧════════════════╝</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_stream_manifests">33.6.<font o="2220">流清单</font></h3>
<div class="paragraph">
<p><font o="2221">在替换所有值之后，Skipper会保留所有应用程序，其应用程序属性及其部署属性的“清单”。</font><font o="2222">这代表了部署到平台的最终状态。</font><font o="2223">您可以使用以下命令查看Stream的任何版本的清单：</font></p>
</div>
<div class="paragraph">
<p><code>stream manifest --name &lt;name-of-stream&gt; --releaseVersion &lt;optional-version&gt;</code></p>
</div>
<div class="paragraph">
<p><font o="2224">如果未指定<code i="581">--releaseVersion</code>，则返回上一版本的清单。</font></p>
</div>
<div class="paragraph">
<p><font o="2225">以下示例显示了清单的用法：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream manifest --name httptest</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2226">使用该命令会产生以下输出：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yaml" data-lang="yaml"># Source: log.yml
apiVersion: skipper.spring.io/v1
kind: SpringCloudDeployerApplication
metadata:
  name: log
spec:
  resource: maven://org.springframework.cloud.stream.app:log-sink-rabbit
  version: 1.2.0.RELEASE
  applicationProperties:
    spring.metrics.export.triggers.application.includes: integration**
    spring.cloud.dataflow.stream.app.label: log
    spring.cloud.stream.metrics.key: httptest.log.${spring.cloud.application.guid}
    spring.cloud.stream.bindings.input.group: httptest
    spring.cloud.stream.metrics.properties: spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*
    spring.cloud.dataflow.stream.name: httptest
    spring.cloud.dataflow.stream.app.type: sink
    spring.cloud.stream.bindings.input.destination: httptest.http
  deploymentProperties:
    spring.cloud.deployer.indexed: true
    spring.cloud.deployer.group: httptest
    spring.cloud.deployer.count: 1

---
# Source: http.yml
apiVersion: skipper.spring.io/v1
kind: SpringCloudDeployerApplication
metadata:
  name: http
spec:
  resource: maven://org.springframework.cloud.stream.app:http-source-rabbit
  version: 1.2.0.RELEASE
  applicationProperties:
    spring.metrics.export.triggers.application.includes: integration**
    spring.cloud.dataflow.stream.app.label: http
    spring.cloud.stream.metrics.key: httptest.http.${spring.cloud.application.guid}
    spring.cloud.stream.bindings.output.producer.requiredGroups: httptest
    spring.cloud.stream.metrics.properties: spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*
    server.port: 9000
    spring.cloud.stream.bindings.output.destination: httptest.http
    spring.cloud.dataflow.stream.name: httptest
    spring.cloud.dataflow.stream.app.type: source
  deploymentProperties:
    spring.cloud.deployer.group: httptest</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2227">大多数部署和应用程序属性由Data Flow设置，以使应用程序能够相互通信并使用标识标签发送应用程序指标。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-stream-lifecycle-skipper-rollback">33.7.<font o="2229">回滚流</font></h3>
<div class="paragraph">
<p><font o="2230">您可以使用命令<code i="582">stream rollback</code>回滚到以前版本的流。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream rollback --name httptest</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2231">可选的<code i="583">--releaseVersion</code>命令参数添加了流的版本。</font><font o="2232">如果未指定，则回滚将转到上一个流版本。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_application_count">33.8.<font o="2234">申请数量</font></h3>
<div class="paragraph">
<p><font o="2235">应用程序计数是系统的动态属性。</font><font o="2236">如果由于在运行时进行扩展，要升级的应用程序运行了5个实例，则会部署5个升级后的应用程序实例。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_skipper_s_upgrade_strategy">33.9.<font o="2238">船长的升级策略</font></h3>
<div class="paragraph">
<p><font o="2239">船长有一个简单的“红/黑”升级策略。</font><font o="2240">它使用与当前运行版本一样多的实例来部署新版本的应用程序，并检查应用程序的<code i="584">/health</code>端点。</font><font o="2241">如果新应用程序的运行状况良好，则取消部署先前的应用程序。</font><font o="2242">如果新应用程序的运行状况不佳，则取消部署所有新应用程序，并且认为升级不成功。</font></p>
</div>
<div class="paragraph">
<p><font o="2243">升级策略不是滚动升级，因此如果应用程序的五个应用程序正在运行，那么在晴天情况下，五个新应用程序也会在取消部署旧版本之前运行。</font></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stream_dsl"><font o="2244">34.流DSL</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2245">本节介绍Stream DSL简介中未涵盖的</font><a href="#spring-cloud-dataflow-stream-intro-dsl"><font o="2245">Stream DSL的</font></a><font o="2245">其他功能</font><font o="2245">。</font></p>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-stream-dsl-tap">34.1.<font o="2247">点按一个流</font></h3>
<div class="paragraph">
<p><font o="2248">可以在流中的各个生产者端点处创建抽头。</font><font o="2249">对于如以下示例中定义的流，可以在<code i="585">http</code>，<code i="586">step1</code>和<code i="587">step2</code>的输出处创建抽头：</font></p>
</div>
<div class="paragraph">
<p><code>stream create --definition "http | step1: transform --expression=payload.toUpperCase() | step2: transform --expression=payload+'!' | log" --name mainstream --deploy</code></p>
</div>
<div class="paragraph">
<p><font o="2250">要创建充当另一个流上的“点按”的流，需要为点按流指定<code i="588">source destination name</code>。</font><font o="2251">源目标名称的语法如下：</font></p>
</div>
<div class="paragraph">
<p><code>:&lt;streamName&gt;.&lt;label/appName&gt;</code></p>
</div>
<div class="paragraph">
<p><font o="2252">要在前面的流中的<code i="589">http</code>输出处创建一个点按，源目标名称为<code i="590">mainstream.http</code>要在上面的流中的第一个转换应用的输出处创建一个点击，源目标名称为<code i="591">mainstream.step1</code></font></p>
</div>
<div class="paragraph">
<p><font o="2253">点击流DSL类似于以下内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>stream create --definition ":mainstream.http &gt; counter" --name tap_at_http --deploy

stream create --definition ":mainstream.step1 &gt; jdbc" --name tap_at_step1_transformer --deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2254">请注意目标名称前的冒号（<code i="592">:</code>）前缀。</font><font o="2255">冒号让解析器将其识别为目标名称而不是应用程序名称。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-stream-dsl-labels">34.2.<font o="2257">在流中使用标签</font></h3>
<div class="paragraph">
<p><font o="2258">当流由多个具有相同名称的应用组成时，必须使用标签进行限定：<code i="593">stream create --definition "http | firstLabel: transform --expression=payload.toUpperCase() | secondLabel: transform --expression=payload+'!' | log" --name myStreamWithLabels --deploy</code></font></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-stream-dsl-named-destinations">34.3.<font o="2260">命名目的地</font></h3>
<div class="paragraph">
<p><font o="2261">您可以使用命名目标，而不是引用源或接收器应用程序。</font><font o="2262">命名目标对应于中间件代理（Rabbit，Kafka和其他）中的特定目标名称。</font><font o="2263">使用<code i="594">|</code>符号时，应用程序通过数据流服务器创建的消息中间件目标名称相互连接。</font><font o="2264">与Unix类比一致，可以使用小于（<code i="595">&lt;</code>）和大于（<code i="596">&gt;</code>）字符重定向标准输入和输出。</font><font o="2265">要指定目标的名称，请在其前面加冒号（<code i="597">:</code>）。</font><font o="2266">例如，以下流的目标名称位于<code i="598">source</code>位置：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt;stream create --definition ":myDestination &gt; log" --name ingest_from_broker --deploy</code></p>
</div>
<div class="paragraph">
<p><font o="2267">此流从位于代理的名为<code i="599">myDestination</code>的目标接收消息，并将其连接到<code i="600">log</code>应用程序。</font><font o="2268">您还可以创建使用来自同一命名目标的数据的其他流。</font></p>
</div>
<div class="paragraph">
<p><font o="2269">以下流的目标名称位于<code i="601">sink</code>位置：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt;stream create --definition "http &gt; :myDestination" --name ingest_to_broker --deploy</code></p>
</div>
<div class="paragraph">
<p><font o="2270">也可以在流中的代理处连接两个不同的目标（<code i="602">source</code>和<code i="603">sink</code>位置），如以下示例所示：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt;stream create --definition ":destination1 &gt; :destination2" --name bridge_destinations --deploy</code></p>
</div>
<div class="paragraph">
<p><font o="2271">在前面的流中，目标（<code i="604">destination1</code>和<code i="605">destination2</code>）都位于代理中。</font><font o="2272">消息通过连接它们的<code i="606">bridge</code>应用程序从源目标流向接收器目标。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-stream-dsl-fanin-fanout">34.4.<font o="2274">扇入和扇出</font></h3>
<div class="paragraph">
<p><font o="2275">通过使用命名目标，您可以支持扇入和扇出用例。</font><font o="2276">扇入用例是指多个源都将数据发送到同一命名目标时，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>s3 &gt; :data
ftp &gt; :data
http &gt; :data</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2277">上面的示例将数据有效负载从Amazon S3，FTP和HTTP源定向到名为<code i="607">data</code>的同一命名目标。</font><font o="2278">然后，使用以下DSL表达式创建的其他流将来自这三个源的所有数据发送到文件接收器：</font></p>
</div>
<div class="paragraph">
<p><code>:data &gt; file</code></p>
</div>
<div class="paragraph">
<p><font o="2279">扇出用例是指基于某些仅在运行时已知的信息确定流的目标。</font><font o="2280">在这种情况下，</font><a href="javascript:;"><font o="2280">路由器应用程序</font></a><font o="2280">可用于指定如何将传入消息定向到N个命名目标之一。</font></p>
</div>
<div class="paragraph">
<p><font o="2281">还提供了一个很好的</font><a href="javascript:;"><font o="2281">视频，</font></a><font o="2281">显示了扇入和扇出行为。</font></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-stream-java-dsl"><font o="2282">35.流Java DSL</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2283">您可以使用<code i="608">spring-cloud-dataflow-rest-client</code>模块提供的基于Java的DSL，而不是使用shell来创建和部署流。</font><font o="2284">Java DSL是<code i="609">DataFlowTemplate</code>类的一个方便的包装器，可以以编程方式创建和部署流。</font></p>
</div>
<div class="paragraph">
<p><font o="2285">首先，您需要将以下依赖项添加到项目中，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
	&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
	&lt;artifactId&gt;spring-cloud-dataflow-rest-client&lt;/artifactId&gt;
	&lt;version&gt;1.7.3.RELEASE&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2286">
可以在</font><a href="javascript:;"><font o="2286">Spring Cloud Data Flow样本Repository中</font></a><font o="2286">找到完整的样本</font><font o="2286">。
</font></td>
</tr>
</tbody></table>
</div>
<div class="sect2">
<h3 id="_overview">35.1.<font o="2288">概观</font></h3>
<div class="paragraph">
<p><font o="2289">Java DSL核心的类是<code i="610">StreamBuilder</code>，<code i="611">StreamDefinition</code>，<code i="612">Stream</code>，<code i="613">StreamApplication</code>和<code i="614">DataFlowTemplate</code>。</font><font o="2290">入口点是<code i="616">Stream</code>上的<code i="615">builder</code>方法，它采用<code i="617">DataFlowTemplate</code>的实例。</font><font o="2291">要创建<code i="618">DataFlowTemplate</code>的实例，您需要提供数据流服务器的<code i="619">URI</code>位置。</font></p>
</div>
<div class="paragraph">
<p><font o="2292">Spring Boot <code i="620">StreamBuilder</code>和<code i="621">DataFlowTemplate</code>的自动配置也可用。</font><a href="javascript:;"><font o="2293">DataFlowClientProperties中</font></a><font o="2293">的属性</font><font o="2293">可用于配置与数据流服务器的连接。</font><font o="2294">开始使用的共同属性是<code i="622">spring.cloud.dataflow.client.uri</code></font></p>
</div>
<div class="paragraph">
<p><font o="2295">请考虑以下示例，使用<code i="623">definition</code>样式。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-java" data-lang="java">URI dataFlowUri = URI.create("http://localhost:9393");
DataFlowOperations dataFlowOperations = new DataFlowTemplate(dataFlowUri);
dataFlowOperations.appRegistryOperations().importFromResource(
                     "http://bit.ly/Darwin-SR3-stream-applications-rabbit-maven", true);
StreamDefinition streamDefinition = Stream.builder(dataFlowOperations)
                                      .name("ticktock")
                                      .definition("time | log")
                                      .create();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2296"><code i="624">create</code>方法返回<code i="625">StreamDefinition</code>的实例，表示已创建但未部署的Stream。</font><font o="2297">这称为<code i="626">definition</code>样式，因为它为流定义采用单个字符串，与shell中的相同。</font><font o="2298">如果尚未在数据流服务器中注册应用程序，则可以使用<code i="627">DataFlowOperations</code>类进行注册。</font><font o="2299">使用<code i="628">StreamDefinition</code>实例，您可以使用<code i="629">deploy</code>或<code i="630">destory</code>流的方法。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">Stream stream = streamDefinition.deploy();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2300"><code i="631">Stream</code>实例提供<code i="632">getStatus</code>，<code i="633">destroy</code>和<code i="634">undeploy</code>方法来控制和查询流。</font><font o="2301">如果要立即部署流，则无需创建<code i="635">StreamDefinition</code>类型的单独局部变量。</font><font o="2302">您可以将调用链接在一起，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-java" data-lang="java">Stream stream = Stream.builder(dataFlowOperations)
                  .name("ticktock")
                  .definition("time | log")
                  .create()
                  .deploy();</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2303">重载<code i="636">deploy</code>方法以获取<code i="637">java.util.Map</code>部署属性。</font></p>
</div>
<div class="paragraph">
<p><font o="2304"><code i="638">StreamApplication</code>类用于'流畅的'Java DSL风格，将在下一节中讨论。</font><font o="2305"><code i="639">StreamBuilder</code>类从方法<code i="640">Stream.builder(dataFlowOperations)</code>返回。</font><font o="2306">在较大的应用程序中，通常将<code i="641">StreamBuilder</code>的单个实例创建为Spring <code i="642">@Bean</code>并在整个应用程序中共享它。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_java_dsl_styles">35.2.<font o="2308">Java DSL样式</font></h3>
<div class="paragraph">
<p><font o="2309">Java DSL提供两种样式来创建Streams。</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2310"><code i="643">definition</code>样式保留了在shell中使用管道和过滤文本DSL的感觉。</font><font o="2311">在设置流名称后使用<code i="644">definition</code>方法选择此样式 - 例如，<code i="645">Stream.builder(dataFlowOperations).name("ticktock").definition(&lt;definition goes here&gt;)</code>。</font></p>
</li>
<li>
<p><font o="2312"><code i="646">fluent</code>样式允许您通过传入<code i="647">StreamApplication</code>的实例将源，处理器和接收器链接在一起。</font><font o="2313">在设置流名称后使用<code i="648">source</code>方法选择此样式 - 例如，<code i="649">Stream.builder(dataFlowOperations).name("ticktock").source(&lt;stream application instance goes here&gt;)</code>。</font><font o="2314">然后，将<code i="650">processor()</code>和<code i="651">sink()</code>方法链接在一起以创建流定义。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="2315">为了演示这两种样式，我们提供了一个使用这两种方法的简单流。</font><font o="2316">您可以在</font><a href="javascript:;"><font o="2316">Spring Cloud Data Flow样本Repository中</font></a><font o="2316">找到完整的入门</font><a href="javascript:;"><font o="2316">示例</font></a><font o="2316">。</font></p>
</div>
<div class="paragraph">
<p><font o="2317">以下示例演示了定义方法：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-java" data-lang="java">public void definitionStyle() throws Exception{

  Map&lt;String, String&gt; deploymentProperties = createDeploymentProperties();

  Stream woodchuck = Stream.builder(dataFlowOperations)
          .name("woodchuck")
          .definition("http --server.port=9900 | splitter --expression=payload.split(' ') | log")
          .create()
          .deploy(deploymentProperties);

  waitAndDestroy(woodchuck)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2318">以下示例演示了流畅的方法：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-java" data-lang="java">private void fluentStyle(DataFlowOperations dataFlowOperations) throws InterruptedException {

  logger.info("Deploying stream.");

  Stream woodchuck = builder
    .name("woodchuck")
    .source(source)
    .processor(processor)
    .sink(sink)
    .create()
    .deploy();

  waitAndDestroy(woodchuck);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2319"><code i="652">waitAndDestroy</code>方法使用<code i="653">getStatus</code>方法轮询流的状态，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-java" data-lang="java">private void waitAndDestroy(Stream stream) throws InterruptedException {

  while(!stream.getStatus().equals("deployed")){
    System.out.println("Wating for deployment of stream.");
    Thread.sleep(5000);
  }

  System.out.println("Letting the stream run for 2 minutes.");
  // Let the stream run for 2 minutes
  Thread.sleep(120000);

  System.out.println("Destroying stream");
  stream.destroy();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2320">使用定义样式时，部署属性以与使用shell相同的方式指定为<code i="654">java.util.Map</code>。</font><font o="2321"><code i="655">createDeploymentProperties</code>方法定义如下：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-java" data-lang="java">private Map&lt;String, String&gt; createDeploymentProperties() {
  DeploymentPropertiesBuilder propertiesBuilder = new DeploymentPropertiesBuilder();
  propertiesBuilder.memory("log", 512);
  propertiesBuilder.count("log",2);
  propertiesBuilder.put("app.splitter.producer.partitionKeyExpression", "payload");
  return propertiesBuilder.build();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2322">在这种情况下，除了为日志应用程序设置deployer属性<code i="656">count</code>之外，还会在部署时覆盖应用程序属性。</font><font o="2323">使用流畅样式时，使用方法<code i="657">addDeploymentProperty</code>（例如，<code i="658">new StreamApplication("log").addDeploymentProperty("count", 2)</code>）添加部署属性，并且不需要使用<code i="659">deployer.&lt;app_name&gt;</code>为属性添加前缀。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2324">
要创建和部署流，您需要确保首先在DataFlow服务器中注册了相应的应用程序。</font><font o="2325">尝试创建或部署包含未知应用程序的流会引发异常。</font><font o="2326">您可以使用<code i="660">DataFlowTemplate</code>注册您的申请，如下所示：
</font></td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-java" data-lang="java">dataFlowOperations.appRegistryOperations().importFromResource(
            "http://bit.ly/Darwin-SR3-stream-applications-rabbit-maven", true);</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2327">Stream应用程序也可以是应用程序中的bean，这些bean在其他类中注入以创建Streams。</font><font o="2328">构造Spring应用程序的方法有很多，但一种方法是让<code i="661">@Configuration</code>类定义<code i="662">StreamBuilder</code>和<code i="663">StreamApplications</code>，如下例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-java" data-lang="java">@Configuration
public class StreamConfiguration {

  @Bean
  public StreamBuilder builder() {
    return Stream.builder(new DataFlowTemplate(URI.create("http://localhost:9393")));
  }

  @Bean
  public StreamApplication httpSource(){
    return new StreamApplication("http");
  }

  @Bean
  public StreamApplication logSink(){
    return new StreamApplication("log");
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2329">然后在另一个类中，您可以<code i="664">@Autowire</code>这些类并部署流。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-java" data-lang="java">@Component
public class MyStreamApps {

  @Autowired
  private StreamBuilder streamBuilder;

  @Autowired
  private StreamApplication httpSource;

  @Autowired
  private StreamApplication logSink;


  public void deploySimpleStream() {
    Stream simpleStream = streamBuilder.name("simpleStream")
                            .source(httpSource)
                            .sink(logSink)
                            .create()
                            .deploy();
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2330">此样式允许您跨多个Streams共享<code i="665">StreamApplications</code>。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_using_the_deploymentpropertiesbuilder">35.3.<font o="2332">使用DeploymentPropertiesBuilder</font></h3>
<div class="paragraph">
<p><font o="2333">无论您选择何种样式，<code i="666">deploy(Map&lt;String, String&gt; deploymentProperties)</code>方法都可以自定义流的部署方式。</font><font o="2334">我们通过使用构建器样式更容易创建具有属性的映射，以及为某些属性创建静态方法，因此您无需记住此类属性的名称。</font><font o="2335">如果您采用前面的<code i="667">createDeploymentProperties</code>示例，则可以将其重写为：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-java" data-lang="java">private Map&lt;String, String&gt; createDeploymentProperties() {
	return new DeploymentPropertiesBuilder()
		.count("log", 2)
		.memory("log", 512)
		.put("app.splitter.producer.partitionKeyExpression", "payload")
		.build();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2336">此实用程序类旨在帮助创建Map并添加一些方法来帮助定义预定义的属性。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_deploying_using_skipper">35.4.<font o="2338">使用Skipper进行部署</font></h3>
<div class="paragraph">
<p><font o="2339">如果您希望使用Skipper部署流，则需要将某些属性传递给特定于基于Skipper的部署的服务器，例如选择目标平台。</font><font o="2340"><code i="668">SkipperDeploymentPropertiesBuilder</code>为您提供<code i="669">DeploymentPropertiesBuilder</code>中的所有属性，并添加了Skipper所需的属性。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-java" data-lang="java">private Map&lt;String, String&gt; createDeploymentProperties() {
	return new SkipperDeploymentPropertiesBuilder()
		.count("log", 2)
		.memory("log", 512)
		.put("app.splitter.producer.partitionKeyExpression", "payload")
		.platformName("pcf")
		.build();
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-stream-multi-binder"><font o="2341">36.使用多个Binder配置流应用程序</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2342">在某些情况下，当流需要连接到不同的消息传递中间件配置时，流可以将其应用程序绑定到多个spring cloud流绑定器。</font><font o="2343">在这些情况下，确保使用其活页夹配置正确配置应用程序非常重要。</font><font o="2344">例如，支持Kafka和Rabbit绑定器的多绑定器转换器是以下流中的处理器：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>http | multibindertransform --expression=payload.toUpperCase() | log</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2345">
在上面的示例中，您将编写自己的multibindertransform应用程序。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="2346">在此流中，每个应用程序通过以下方式连接到消息传递中间件：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="2347">HTTP源将事件发送到RabbitMQ（<code i="670">rabbit1</code>）。</font></p>
</li>
<li>
<p><font o="2348">多Binder变换处理器从RabbitMQ（<code i="671">rabbit1</code>）接收事件，并将处理后的事件发送到Kafka（<code i="672">kafka1</code>）。</font></p>
</li>
<li>
<p><font o="2349">日志接收器从Kafka（<code i="673">kafka1</code>）接收事件。</font></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><font o="2350">这里，<code i="674">rabbit1</code>和<code i="675">kafka1</code>是spring cloud流应用程序属性中给出的绑定器名称。</font><font o="2351">基于此设置，应用程序在其类路径中具有以下具有适当配置的绑定器：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2352">HTTP：Rabbit绑定器</font></p>
</li>
<li>
<p><font o="2353">变换：Kafka和Rabbit两个绑定器</font></p>
</li>
<li>
<p><font o="2354">记录：Kafka粘合剂</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="2355">可以在应用程序本身中设置spring-cloud-stream <code i="676">binder</code>配置属性。</font><font o="2356">如果不是，则在部署流时可以通过<code i="677">deployment</code>属性传递它们，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream create --definition "http | multibindertransform --expression=payload.toUpperCase() | log" --name mystream

dataflow:&gt;stream deploy mystream --properties "app.http.spring.cloud.stream.bindings.output.binder=rabbit1,app.multibindertransform.spring.cloud.stream.bindings.input.binder=rabbit1,
app.multibindertransform.spring.cloud.stream.bindings.output.binder=kafka1,app.log.spring.cloud.stream.bindings.input.binder=kafka1"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2357">可以通过部署属性指定任何绑定器配置属性来覆盖它们。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-stream-examples"><font o="2358">37.例子</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2359">本章包括以下示例：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#spring-cloud-dataflow-simple-stream"><font o="2360">简单的流处理</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-dataflow-stream-partitions"><font o="2361">有状态流处理</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-dataflow-stream-app-types"><font o="2362">其他源和接收器应用程序类型</font></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="2363">您可以在“ </font><a href="#dataflow-samples"><font o="2363">样本</font></a><font o="2363"> ”一章中</font><font o="2363">找到更多样本的链接</font><font o="2363">。</font></p>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-simple-stream">37.1.<font o="2365">简单的流处理</font></h3>
<div class="paragraph">
<p><font o="2366">作为简单处理步骤的示例，我们可以使用以下流定义将HTTP发布数据的有效负载转换为大写：<code i="678">http | transform --expression=payload.toUpperCase() | log</code></font></p>
</div>
<div class="paragraph">
<p><font o="2367">要创建此流，请在shell中输入以下命令</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt; stream create --definition "http --server.port=9000 | transform --expression=payload.toUpperCase() | log" --name mystream --deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2368">以下示例使用shell命令发布一些数据：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt; http post --target http://localhost:9000 --data "hello"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2369">前面的示例在日志中生成大写的“HELLO”，如下所示：</font></p>
</div>
<div class="paragraph">
<p><code>2016-06-01 09:54:37.749 INFO 80083 --- [ kafka-binder-] log.sink : HELLO</code></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-stream-partitions">37.2.<font o="2371">有状态流处理</font></h3>
<div class="paragraph">
<p><font o="2372">为了演示数据分区功能，以下列表部署了一个以Kafka作为绑定器的流：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;stream create --name words --definition "http --server.port=9900 | splitter --expression=payload.split(' ') | log"
Created new stream 'words'

dataflow:&gt;stream deploy words --properties "app.splitter.producer.partitionKeyExpression=payload,deployer.log.count=2"
Deployed stream 'words'

dataflow:&gt;http post --target http://localhost:9900 --data "How much wood would a woodchuck chuck if a woodchuck could chuck wood"
&gt; POST (text/plain;Charset=UTF-8) http://localhost:9900 How much wood would a woodchuck chuck if a woodchuck could chuck wood
&gt; 202 ACCEPTED</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2373">然后，您应该在服务器日志中看到以下内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>2016-06-05 18:33:24.982  INFO 58039 --- [nio-9393-exec-9] o.s.c.d.spi.local.LocalAppDeployer       : deploying app words.log instance 0
   Logs will be in /var/folders/c3/ctx7_rns6x30tq7rb76wzqwr0000gp/T/spring-cloud-dataflow-694182453710731989/words-1465176804970/words.log
2016-06-05 18:33:24.988  INFO 58039 --- [nio-9393-exec-9] o.s.c.d.spi.local.LocalAppDeployer       : deploying app words.log instance 1
   Logs will be in /var/folders/c3/ctx7_rns6x30tq7rb76wzqwr0000gp/T/spring-cloud-dataflow-694182453710731989/words-1465176804970/words.log</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2374">查看<code i="679">words.log instance 0</code>日志时，您应该看到以下内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>2016-06-05 18:35:47.047  INFO 58638 --- [  kafka-binder-] log.sink                                 : How
2016-06-05 18:35:47.066  INFO 58638 --- [  kafka-binder-] log.sink                                 : chuck
2016-06-05 18:35:47.066  INFO 58638 --- [  kafka-binder-] log.sink                                 : chuck</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2375">查看<code i="680">words.log instance 1</code>日志时，您应该看到以下内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>2016-06-05 18:35:47.047  INFO 58639 --- [  kafka-binder-] log.sink                                 : much
2016-06-05 18:35:47.066  INFO 58639 --- [  kafka-binder-] log.sink                                 : wood
2016-06-05 18:35:47.066  INFO 58639 --- [  kafka-binder-] log.sink                                 : would
2016-06-05 18:35:47.066  INFO 58639 --- [  kafka-binder-] log.sink                                 : a
2016-06-05 18:35:47.066  INFO 58639 --- [  kafka-binder-] log.sink                                 : woodchuck
2016-06-05 18:35:47.067  INFO 58639 --- [  kafka-binder-] log.sink                                 : if
2016-06-05 18:35:47.067  INFO 58639 --- [  kafka-binder-] log.sink                                 : a
2016-06-05 18:35:47.067  INFO 58639 --- [  kafka-binder-] log.sink                                 : woodchuck
2016-06-05 18:35:47.067  INFO 58639 --- [  kafka-binder-] log.sink                                 : could
2016-06-05 18:35:47.067  INFO 58639 --- [  kafka-binder-] log.sink                                 : wood</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2376">此示例显示包含相同单词的有效内容拆分将路由到同一应用程序实例。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-stream-app-types">37.3.<font o="2378">其他源和接收器应用程序类型</font></h3>
<div class="paragraph">
<p><font o="2379">这个例子显示了一些更复杂的东西：换掉<code i="681">time</code>源代码。</font><font o="2380">另一种受支持的源类型是<code i="682">http</code>，它接受​​通过HTTP POST提取的数据。</font><font o="2381">请注意，<code i="683">http</code>源接受来自数据流服务器的不同端口上的数据（默认为8080）。</font><font o="2382">默认情况下，端口是随机分配的。</font></p>
</div>
<div class="paragraph">
<p><font o="2383">要使用<code i="684">http</code>源创建流但仍使用相同的<code i="685">log</code>接收器，我们会将</font><a href="#spring-cloud-dataflow-simple-stream"><font o="2383">Simple Stream Processing</font></a><font o="2383">示例中</font><font o="2383">的原始命令更改</font><font o="2383">为以下内容：</font></p>
</div>
<div class="paragraph">
<p><font o="2384">`dataflow：&gt; stream create --definition“http | log”--name myhttpstream --deploy</font></p>
</div>
<div class="paragraph">
<p><font o="2385">上述命令从服务器生成以下输出：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>2016-06-01 09:47:58.920  INFO 79016 --- [io-9393-exec-10] o.s.c.d.spi.local.LocalAppDeployer       : deploying app myhttpstream.log instance 0
   Logs will be in /var/folders/wn/8jxm_tbd1vj28c8vj37n900m0000gn/T/spring-cloud-dataflow-912434582726479179/myhttpstream-1464788878747/myhttpstream.log
2016-06-01 09:48:06.396  INFO 79016 --- [io-9393-exec-10] o.s.c.d.spi.local.LocalAppDeployer       : deploying app myhttpstream.http instance 0
   Logs will be in /var/folders/wn/8jxm_tbd1vj28c8vj37n900m0000gn/T/spring-cloud-dataflow-912434582726479179/myhttpstream-1464788886383/myhttpstream.http</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2386">请注意，在我们实际发布一些数据之前，我们没有看到任何其他输出（通过使用shell命令）。</font><font o="2387">要查看http源正在侦听的随机分配的端口，请运行以下命令：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; runtime apps</code></p>
</div>
<div class="paragraph">
<p><font o="2388">您应该看到相应的<code i="686">http</code>源具有<code i="687">url</code>属性，其中包含正在侦听的主机和端口信息。</font><font o="2389">您现在可以发布到该URL，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt; http post --target http://localhost:1234 --data "hello"
dataflow:&gt; http post --target http://localhost:1234 --data "goodbye"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2390">然后，流将数据从http源汇集到日志接收器实现的输出日志，产生类似于以下内容的输出：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>2016-06-01 09:50:22.121  INFO 79654 --- [  kafka-binder-] log.sink    : hello
2016-06-01 09:50:26.810  INFO 79654 --- [  kafka-binder-] log.sink    : goodbye</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2391">我们还可以更改接收器实现。</font><font o="2392">您可以将输出传递给文件（<code i="688">file</code>），hadoop（<code i="689">hdfs</code>）或任何其他可用的接收器应用程序。</font><font o="2393">您还可以定义自己的应用程序。</font></p>
</div>
</div>
</div>
</div>
<h1 id="spring-cloud-dataflow-streams-skipper" class="sect0"><font o="2394">带船长的流</font></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p><font></font><a href="#spring-cloud-dataflow-stream-lifecycle-skipper"><font o="2395">带有Skipper</font></a><font o="2395">的</font><a href="#spring-cloud-dataflow-stream-lifecycle-skipper"><font o="2395">Stream Lifecycle</font></a><font o="2395">部分涵盖了Skipper在Spring Cloud Data Flow中的整体角色。</font></p>
</div>
<div class="paragraph">
<p><font o="2396">本节是“ </font><a href="#getting-started-deploying-streams-spring-cloud-dataflow"><font o="2396">部署流”的</font></a><font o="2396">入门部分的延续，</font><font o="2396">并展示了如何使用本地数据流服务器和Skipper更新和回滚Streams。</font><font o="2397">“ </font><a href="#getting-started"><font o="2397">入门</font></a><font o="2397"> ”一章从部署了Stream <code i="690">httptest</code>开始。</font><font o="2398">本章将继续“入门”一章的结尾。</font><font o="2399">Stream包含两个应用程序，<code i="691">http</code>源和<code i="692">log</code>接收器。</font><font o="2400">如果执行Unix <code i="693">jps</code>命令，则可以看到正在运行的两个java进程，如下面的清单所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ jps | grep rabbit
12643 log-sink-rabbit-1.1.0.RELEASE.jar
12645 http-source-rabbit-1.2.0.RELEASE.jar</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-streams-skipper-upgrading"><font o="2401">38.升级</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2402">在我们开始将log-sink版本升级到1.2.0.RELEASE之前，我们必须在app注册表中注册该版本。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;app register --name log --type sink --uri maven://org.springframework.cloud.stream.app:log-sink-rabbit:1.2.0.RELEASE
Successfully registered application 'sink:log'</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2403">由于我们使用的是本地服务器，因此我们需要将端口设置为与当前运行的日志接收器的值9000不同的值（9002），以避免冲突。</font><font o="2404">我们在此时，我们将日志级别更新为<code i="694">ERROR</code>。</font><font o="2405">为此，我们创建了一个名为<code i="695">local-log-update.yml</code>的YAML文件，其中包含以下内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-yml" data-lang="yml">version:
  log: 1.2.0.RELEASE
app:
  log:
    server.port: 9002
    log.level: ERROR</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2406">现在我们更新Stream，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; stream update --name httptest --propertiesFile /home/mpollack/local-log-update.yml
Update request has been sent for the stream 'httptest'</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2407">通过执行Unix <code i="696">jps</code>命令，您可以看到两个java进程正在运行，但现在日志应用程序是版本1.2.0.RELEASE，如下面的清单所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ jps | grep rabbit
22034 http-source-rabbit-1.2.0.RELEASE.jar
22031 log-sink-rabbit-1.1.0.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2408">现在您可以查看Skipper服务器的日志文件。</font><font o="2409">为此，请使用以下命令：</font></p>
</div>
<div class="paragraph">
<p><font o="2410"><code i="697">cd</code>到目录<code i="698">/tmp/spring-cloud-dataflow-5262910238261867964/httptest-1511749222274/httptest.log-v2</code>和<code i="699">tail -f stdout_0.log</code></font></p>
</div>
<div class="paragraph">
<p><font o="2411">您应该看到类似于以下内容的日志条目：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-bash" data-lang="bash">INFO 12591 --- [  StateUpdate-1] o.s.c.d.spi.local.LocalAppDeployer       : Deploying app with deploymentId httptest.log-v2 instance 0.
   Logs will be in /tmp/spring-cloud-dataflow-5262910238261867964/httptest-1511749222274/httptest.log-v2
INFO 12591 --- [  StateUpdate-1] o.s.c.s.s.d.strategies.HealthCheckStep   : Waiting for apps in release httptest-v2 to be healthy.
INFO 12591 --- [  StateUpdate-1] o.s.c.s.s.d.s.HandleHealthCheckStep      : Release httptest-v2 has been DEPLOYED
INFO 12591 --- [  StateUpdate-1] o.s.c.s.s.d.s.HandleHealthCheckStep      : Apps in release httptest-v2 are healthy.</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2412">现在，您可以将消息发送到端口<code i="700">9000</code>的http源，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; http post --target http://localhost:9000 --data "hello world upgraded"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2413">现在，日志消息处于错误级别，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">ERROR 22311 --- [http.httptest-1] log-sink  : hello world upgraded</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2414">如果查询应用程序的<code i="701">/info</code>端点，您还可以看到它的版本为<code i="702">1.2.0.RELEASE</code>，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl http://localhost:9002/info
{"app":{"description":"Spring Cloud Stream Log Sink Rabbit Binder Application","name":"log-sink-rabbit","version":"1.2.0.RELEASE"}}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_force_upgrade_of_a_stream">38.1.<font o="2416">强制升级流</font></h3>
<div class="paragraph">
<p><font o="2417">升级流时，即使没有更改应用程序或部署属性， -  force选项也可用于部署当前部署的应用程序的新实例。</font><font o="2418">当应用程序本身在启动时获取配置信息时，例如从Spring Cloud Config Server获取配置信息时，需要此行为。</font><font o="2419">您可以使用选项--app-names指定要强制升级的应用程序。</font><font o="2420">如果未指定任何应用程序名称，则将强制升级所有应用程序。</font><font o="2421">您可以将--force和--app-names选项与--properties或--propertiesFile选项一起指定。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_overriding_properties_during_stream_update">38.2.<font o="2423">在Stream更新期间覆盖属性</font></h3>
<div class="paragraph">
<p><font o="2424">在流更新期间传递的属性将添加到同一流的现有属性之上。</font></p>
</div>
<div class="paragraph">
<p><font o="2425">例如，部署流<code i="703">ticktock</code>时没有任何显式属性，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream create --name ticktock --definition "time | log --name=mylogger"
Created new stream 'ticktock'

dataflow:&gt;stream deploy --name ticktock
Deployment request has been sent for stream 'ticktock'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream manifest --name ticktock
"apiVersion": "skipper.spring.io/v1"
"kind": "SpringCloudDeployerApplication"
"metadata":
  "name": "time"
"spec":
  "resource": "maven://org.springframework.cloud.stream.app:time-source-rabbit"
  "resourceMetadata": "maven://org.springframework.cloud.stream.app:time-source-rabbit:jar:metadata:1.3.1.RELEASE"
  "version": "1.3.1.RELEASE"
  "applicationProperties":
    "spring.metrics.export.triggers.application.includes": "integration**"
    "spring.cloud.dataflow.stream.app.label": "time"
    "spring.cloud.stream.metrics.key": "ticktock.time.${spring.cloud.application.guid}"
    "spring.cloud.stream.bindings.output.producer.requiredGroups": "ticktock"
    "spring.cloud.stream.metrics.properties": "spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*"
    "spring.cloud.stream.bindings.output.destination": "ticktock.time"
    "spring.cloud.dataflow.stream.name": "ticktock"
    "spring.cloud.dataflow.stream.app.type": "source"
  "deploymentProperties":
    "spring.cloud.deployer.group": "ticktock"
---
"apiVersion": "skipper.spring.io/v1"
"kind": "SpringCloudDeployerApplication"
"metadata":
  "name": "log"
"spec":
  "resource": "maven://org.springframework.cloud.stream.app:log-sink-rabbit"
  "resourceMetadata": "maven://org.springframework.cloud.stream.app:log-sink-rabbit:jar:metadata:1.3.1.RELEASE"
  "version": "1.3.1.RELEASE"
  "applicationProperties":
    "spring.metrics.export.triggers.application.includes": "integration**"
    "spring.cloud.dataflow.stream.app.label": "log"
    "spring.cloud.stream.metrics.key": "ticktock.log.${spring.cloud.application.guid}"
    "spring.cloud.stream.bindings.input.group": "ticktock"
    "log.name": "mylogger"
    "spring.cloud.stream.metrics.properties": "spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*"
    "spring.cloud.dataflow.stream.name": "ticktock"
    "spring.cloud.dataflow.stream.app.type": "sink"
    "spring.cloud.stream.bindings.input.destination": "ticktock.time"
  "deploymentProperties":
    "spring.cloud.deployer.group": "ticktock"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2426">在第二次更新中，我们尝试为<code i="704">log</code> application <code i="705">foo2=bar2</code>添加新属性。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream update --name ticktock --properties app.log.foo2=bar2
Update request has been sent for the stream 'ticktock'

dataflow:&gt;stream manifest --name ticktock
"apiVersion": "skipper.spring.io/v1"
"kind": "SpringCloudDeployerApplication"
"metadata":
  "name": "time"
"spec":
  "resource": "maven://org.springframework.cloud.stream.app:time-source-rabbit"
  "resourceMetadata": "maven://org.springframework.cloud.stream.app:time-source-rabbit:jar:metadata:1.3.1.RELEASE"
  "version": "1.3.1.RELEASE"
  "applicationProperties":
    "spring.metrics.export.triggers.application.includes": "integration**"
    "spring.cloud.dataflow.stream.app.label": "time"
    "spring.cloud.stream.metrics.key": "ticktock.time.${spring.cloud.application.guid}"
    "spring.cloud.stream.bindings.output.producer.requiredGroups": "ticktock"
    "spring.cloud.stream.metrics.properties": "spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*"
    "spring.cloud.stream.bindings.output.destination": "ticktock.time"
    "spring.cloud.dataflow.stream.name": "ticktock"
    "spring.cloud.dataflow.stream.app.type": "source"
  "deploymentProperties":
    "spring.cloud.deployer.group": "ticktock"
---
"apiVersion": "skipper.spring.io/v1"
"kind": "SpringCloudDeployerApplication"
"metadata":
  "name": "log"
"spec":
  "resource": "maven://org.springframework.cloud.stream.app:log-sink-rabbit"
  "resourceMetadata": "maven://org.springframework.cloud.stream.app:log-sink-rabbit:jar:metadata:1.3.1.RELEASE"
  "version": "1.3.1.RELEASE"
  "applicationProperties":
    "spring.metrics.export.triggers.application.includes": "integration**"
    "spring.cloud.dataflow.stream.app.label": "log"
    "spring.cloud.stream.metrics.key": "ticktock.log.${spring.cloud.application.guid}"
    "spring.cloud.stream.bindings.input.group": "ticktock"
    "log.name": "mylogger"
    "spring.cloud.stream.metrics.properties": "spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*"
    "spring.cloud.dataflow.stream.name": "ticktock"
    "spring.cloud.dataflow.stream.app.type": "sink"
    "foo2": "bar2" <i class="conum" data-value="1"></i><b>(1)</b>
    "spring.cloud.stream.bindings.input.destination": "ticktock.time"
  "deploymentProperties":
    "spring.cloud.deployer.count": "1"
    "spring.cloud.deployer.group": "ticktock"

dataflow:&gt;stream list
╔═══════════╤══════════════════════════════════════════╤═════════════════════════════════════════╗
║Stream Name│            Stream Definition             │                 Status                  ║
╠═══════════╪══════════════════════════════════════════╪═════════════════════════════════════════╣
║ticktock   │time | log --log.name=mylogger --foo2=bar2│The stream has been successfully deployed║
╚═══════════╧══════════════════════════════════════════╧═════════════════════════════════════════╝</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="2427">属性<code i="706">foo2=bar2</code>适用于<code i="707">log</code>应用程序。</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="2428">现在，当我们向<code i="709">log</code>应用程序添加另一个属性<code i="708">foo3=bar3</code>时，此新属性将添加到流<code i="710">ticktock</code>的现有属性之上。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream update --name ticktock --properties app.log.foo3=bar3
Update request has been sent for the stream 'ticktock'

dataflow:&gt;stream manifest --name ticktock
"apiVersion": "skipper.spring.io/v1"
"kind": "SpringCloudDeployerApplication"
"metadata":
  "name": "time"
"spec":
  "resource": "maven://org.springframework.cloud.stream.app:time-source-rabbit"
  "resourceMetadata": "maven://org.springframework.cloud.stream.app:time-source-rabbit:jar:metadata:1.3.1.RELEASE"
  "version": "1.3.1.RELEASE"
  "applicationProperties":
    "spring.metrics.export.triggers.application.includes": "integration**"
    "spring.cloud.dataflow.stream.app.label": "time"
    "spring.cloud.stream.metrics.key": "ticktock.time.${spring.cloud.application.guid}"
    "spring.cloud.stream.bindings.output.producer.requiredGroups": "ticktock"
    "spring.cloud.stream.metrics.properties": "spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*"
    "spring.cloud.stream.bindings.output.destination": "ticktock.time"
    "spring.cloud.dataflow.stream.name": "ticktock"
    "spring.cloud.dataflow.stream.app.type": "source"
  "deploymentProperties":
    "spring.cloud.deployer.group": "ticktock"
---
"apiVersion": "skipper.spring.io/v1"
"kind": "SpringCloudDeployerApplication"
"metadata":
  "name": "log"
"spec":
  "resource": "maven://org.springframework.cloud.stream.app:log-sink-rabbit"
  "resourceMetadata": "maven://org.springframework.cloud.stream.app:log-sink-rabbit:jar:metadata:1.3.1.RELEASE"
  "version": "1.3.1.RELEASE"
  "applicationProperties":
    "spring.metrics.export.triggers.application.includes": "integration**"
    "spring.cloud.dataflow.stream.app.label": "log"
    "spring.cloud.stream.metrics.key": "ticktock.log.${spring.cloud.application.guid}"
    "spring.cloud.stream.bindings.input.group": "ticktock"
    "log.name": "mylogger"
    "spring.cloud.stream.metrics.properties": "spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*"
    "spring.cloud.dataflow.stream.name": "ticktock"
    "spring.cloud.dataflow.stream.app.type": "sink"
    "foo2": "bar2" <i class="conum" data-value="1"></i><b>(1)</b>
    "spring.cloud.stream.bindings.input.destination": "ticktock.time"
    "foo3": "bar3" <i class="conum" data-value="1"></i><b>(1)</b>
  "deploymentProperties":
    "spring.cloud.deployer.count": "1"
    "spring.cloud.deployer.group": "ticktock"</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="2429"><code i="711">foo3=bar3</code>与<code i="713">log</code>应用程序的现有<code i="712">foo2=bar2</code>一起添加。</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="2430">我们仍然可以覆盖现有属性，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream update --name ticktock --properties app.log.foo3=bar4
Update request has been sent for the stream 'ticktock'

dataflow:&gt;stream manifest ticktock
"apiVersion": "skipper.spring.io/v1"
"kind": "SpringCloudDeployerApplication"
"metadata":
  "name": "time"
"spec":
  "resource": "maven://org.springframework.cloud.stream.app:time-source-rabbit"
  "resourceMetadata": "maven://org.springframework.cloud.stream.app:time-source-rabbit:jar:metadata:1.3.1.RELEASE"
  "version": "1.3.1.RELEASE"
  "applicationProperties":
    "spring.metrics.export.triggers.application.includes": "integration**"
    "spring.cloud.dataflow.stream.app.label": "time"
    "spring.cloud.stream.metrics.key": "ticktock.time.${spring.cloud.application.guid}"
    "spring.cloud.stream.bindings.output.producer.requiredGroups": "ticktock"
    "spring.cloud.stream.metrics.properties": "spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*"
    "spring.cloud.stream.bindings.output.destination": "ticktock.time"
    "spring.cloud.dataflow.stream.name": "ticktock"
    "spring.cloud.dataflow.stream.app.type": "source"
  "deploymentProperties":
    "spring.cloud.deployer.group": "ticktock"
---
"apiVersion": "skipper.spring.io/v1"
"kind": "SpringCloudDeployerApplication"
"metadata":
  "name": "log"
"spec":
  "resource": "maven://org.springframework.cloud.stream.app:log-sink-rabbit"
  "resourceMetadata": "maven://org.springframework.cloud.stream.app:log-sink-rabbit:jar:metadata:1.3.1.RELEASE"
  "version": "1.3.1.RELEASE"
  "applicationProperties":
    "spring.metrics.export.triggers.application.includes": "integration**"
    "spring.cloud.dataflow.stream.app.label": "log"
    "spring.cloud.stream.metrics.key": "ticktock.log.${spring.cloud.application.guid}"
    "spring.cloud.stream.bindings.input.group": "ticktock"
    "log.name": "mylogger"
    "spring.cloud.stream.metrics.properties": "spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*"
    "spring.cloud.dataflow.stream.name": "ticktock"
    "spring.cloud.dataflow.stream.app.type": "sink"
    "foo2": "bar2" <i class="conum" data-value="1"></i><b>(1)</b>
    "spring.cloud.stream.bindings.input.destination": "ticktock.time"
    "foo3": "bar4" <i class="conum" data-value="1"></i><b>(1)</b>
  "deploymentProperties":
    "spring.cloud.deployer.count": "1"
    "spring.cloud.deployer.group": "ticktock"</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="2431">属性<code i="714">foo3</code>被替换为新值`bar4`，现有属性<code i="715">foo2=bar2</code>仍然存在。</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_stream_history">38.3.<font o="2433">流历史</font></h3>
<div class="paragraph">
<p><font o="2434">在下面的示例中，可以通过运行<code i="716">stream history</code>命令来查看流的历史记录，如图所示（及其输出）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream history --name httptest
╔═══════╤════════════════════════════╤════════╤════════════╤═══════════════╤════════════════╗
║Version│        Last updated        │ Status │Package Name│Package Version│  Description   ║
╠═══════╪════════════════════════════╪════════╪════════════╪═══════════════╪════════════════╣
║2      │Mon Nov 27 22:41:16 EST 2017│DEPLOYED│httptest    │1.0.0          │Upgrade complete║
║1      │Mon Nov 27 22:40:41 EST 2017│DELETED │httptest    │1.0.0          │Delete complete ║
╚═══════╧════════════════════════════╧════════╧════════════╧═══════════════╧════════════════╝</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_stream_manifest">38.4.<font o="2436">流清单</font></h3>
<div class="paragraph">
<p><font o="2437">清单是一个YAML文档，表示部署到平台的最终状态。</font><font o="2438">您可以使用<code i="717">stream manifest --name &lt;name-of-stream&gt; --releaseVersion &lt;optional-version&gt;</code>命令查看任何流版本的清单。</font><font o="2439">如果未指定<code i="718">--releaseVersion</code>，则返回上一版本的清单。</font><font o="2440">以下清单显示了典型的<code i="719">stream manifest</code>命令及其输出：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream manifest --name httptest

---
# Source: log.yml
apiVersion: skipper.spring.io/v1
kind: SpringCloudDeployerApplication
metadata:
  name: log
spec:
  resource: maven://org.springframework.cloud.stream.app:log-sink-rabbit
  version: 1.2.0.RELEASE
  applicationProperties:
    spring.metrics.export.triggers.application.includes: integration**
    spring.cloud.dataflow.stream.app.label: log
    spring.cloud.stream.metrics.key: httptest.log.${spring.cloud.application.guid}
    spring.cloud.stream.bindings.input.group: httptest
    spring.cloud.stream.metrics.properties: spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*
    spring.cloud.dataflow.stream.name: httptest
    spring.cloud.dataflow.stream.app.type: sink
    spring.cloud.stream.bindings.input.destination: httptest.http
  deploymentProperties:
    spring.cloud.deployer.indexed: true
    spring.cloud.deployer.group: httptest
    spring.cloud.deployer.count: 1

---
# Source: http.yml
apiVersion: skipper.spring.io/v1
kind: SpringCloudDeployerApplication
metadata:
  name: http
spec:
  resource: maven://org.springframework.cloud.stream.app:http-source-rabbit
  version: 1.2.0.RELEASE
  applicationProperties:
    spring.metrics.export.triggers.application.includes: integration**
    spring.cloud.dataflow.stream.app.label: http
    spring.cloud.stream.metrics.key: httptest.http.${spring.cloud.application.guid}
    spring.cloud.stream.bindings.output.producer.requiredGroups: httptest
    spring.cloud.stream.metrics.properties: spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*
    server.port: 9000
    spring.cloud.stream.bindings.output.destination: httptest.http
    spring.cloud.dataflow.stream.name: httptest
    spring.cloud.dataflow.stream.app.type: source
  deploymentProperties:
    spring.cloud.deployer.group: httptest</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2441">大多数部署和应用程序属性都是由Data Flow设置的，以便使应用程序能够相互通信并使用标识标签发送应用程序指标。</font></p>
</div>
<div class="paragraph">
<p><font o="2442">如果将此YAML文档与<code i="720">--releaseVersion=1</code>的文档进行比较，您将看到日志应用程序版本的差异。</font></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-streams-skipper-rollback"><font o="2443">39.回滚</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2444">要返回到先前版本的流，请使用<code i="721">stream rollback</code>命令，如下所示（显示其输出）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream rollback --name httptest
Rollback request has been sent for the stream 'httptest'</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2445">通过执行Unix <code i="722">jps</code>命令，您可以看到两个java进程正在运行，但现在日志应用程序又返回到1.1.0.RELEASE。</font><font o="2446">http源进程保持不变。</font><font o="2447">以下清单显示了<code i="723">jps</code>命令和典型输出：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ jps | grep rabbit
22034 http-source-rabbit-1.2.0.RELEASE.jar
23939 log-sink-rabbit-1.1.0.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2448">现在使用以下命令查看skipper服务器的日志文件：</font></p>
</div>
<div class="paragraph">
<p><font o="2449"><code i="724">cd</code>到目录<code i="725">/tmp/spring-cloud-dataflow-3784227772192239992/httptest-1511755751505/httptest.log-v3</code>和<code i="726">tail -f stdout_0.log</code></font></p>
</div>
<div class="paragraph">
<p><font o="2450">您应该看到类似于以下内容的日志条目：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-bash" data-lang="bash">INFO 21487 --- [  StateUpdate-2] o.s.c.d.spi.local.LocalAppDeployer       : Deploying app with deploymentId httptest.log-v3 instance 0.
   Logs will be in /tmp/spring-cloud-dataflow-3784227772192239992/httptest-1511755751505/httptest.log-v3
INFO 21487 --- [  StateUpdate-2] o.s.c.s.s.d.strategies.HealthCheckStep   : Waiting for apps in release httptest-v3 to be healthy.
INFO 21487 --- [  StateUpdate-2] o.s.c.s.s.d.s.HandleHealthCheckStep      : Release httptest-v3 has been DEPLOYED
INFO 21487 --- [  StateUpdate-2] o.s.c.s.s.d.s.HandleHealthCheckStep      : Apps in release httptest-v3 are healthy.</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2451">现在将消息发送到端口<code i="727">9000</code>的http源，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; http post --target http://localhost:9000 --data "hello world upgraded"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2452">日志接收器中的日志消息现在返回到信息错误级别，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">INFO 23939 --- [http.httptest-1] log-sink  : hello world rollback</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2453"><code i="728">history</code>命令现在显示已部署流的第三个版本，如下所示（及其输出）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream history --name httptest
╔═══════╤════════════════════════════╤════════╤════════════╤═══════════════╤════════════════╗
║Version│        Last updated        │ Status │Package Name│Package Version│  Description   ║
╠═══════╪════════════════════════════╪════════╪════════════╪═══════════════╪════════════════╣
║3      │Mon Nov 27 23:01:13 EST 2017│DEPLOYED│httptest    │1.0.0          │Upgrade complete║
║2      │Mon Nov 27 22:41:16 EST 2017│DELETED │httptest    │1.0.0          │Delete complete ║
║1      │Mon Nov 27 22:40:41 EST 2017│DELETED │httptest    │1.0.0          │Delete complete ║
╚═══════╧════════════════════════════╧════════╧════════════╧═══════════════╧════════════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2454">如果查看版本3的清单，可以看到它显示了日志接收器的版本1.1.0.RELEASE。</font></p>
</div>
</div>
</div>
<h1 id="streams-dev-guide" class="sect0"><font o="2455">流开发者指南</font></h1>
<div class="openblock partintro">
<div class="content"><font o="2456">
本节介绍如何在本地计算机上创建，测试和运行Spring Cloud Stream应用程序。</font><font o="2457">它还显示了如何将这些应用程序映射到Spring Cloud Data Flow并进行部署。
</font></div>
</div>
<div class="sect1">
<h2 id="streams-dev-guide-prebuilt-apps"><font o="2458">40.预建应用程序</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2459">该</font><a href="javascript:;"><font o="2459">Spring Cloud Stream应用启动器</font></a><font o="2459">项目提供了可以开始使用的时候了很多应用。</font><font o="2460">例如，有一个HTTP源应用程序，它接收发布到HTTP端点的消息，并将数据发布到消息传递中间件。</font><font o="2461">每个现有应用程序有三种变体，每种变体对应支持的每种类型的消息传递中间件。</font><font o="2462">当前支持的消息传递中间件系统是RabbitMQ，Apache Kafka 0.9和Apache Kafka 0.10。</font><font o="2463">所有应用程序都基于</font><a href="javascript:;"><font o="2463">Spring Boot</font></a><font o="2463">和</font><a href="javascript:;"><font o="2463">Spring Cloud Stream</font></a><font o="2463">。</font></p>
</div>
<div class="paragraph">
<p><font o="2464">应用程序将作为Maven工件和Docker镜像发布。</font><font o="2465">对于GA版本，Maven工件发布到Maven central和</font><a href="javascript:;"><font o="2465">Spring Release Repository</font></a><font o="2465">。</font><font o="2466">里程碑和快照版本分别发布到</font><a href="javascript:;"><font o="2466">Spring里程碑</font></a><font o="2466">和</font><a href="javascript:;"><font o="2466">Spring快照</font></a><font o="2466">存储库。</font><font o="2467">Docker镜像被推送到</font><a href="javascript:;"><font o="2467">Docker Hub</font></a><font o="2467">。</font></p>
</div>
<div class="paragraph">
<p><font o="2468">我们在示例中使用Maven工件。</font><font o="2469">承载预构建应用程序的GA工件的Spring Repository的根位置是</font><a href="javascript:;" class="bare"><font o="2469">repo.spring.io/release/org/springframework/cloud/stream/app/</font></a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="streams-dev-guiderunning-prebuilt-apps"><font o="2470">41.运行预建应用程序</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2471">在此示例中，我们使用RabbitMQ作为消息传递中间件。</font><font o="2472">按照</font><a href="javascript:;"><font o="2472">rabbitmq.com</font></a><font o="2472">上的</font><a href="javascript:;"><font o="2472">说明</font></a><font o="2472">为您的平台。</font><font o="2473">然后安装</font><a href="javascript:;"><font o="2473">管理插件</font></a><font o="2473">。</font></p>
</div>
<div class="paragraph">
<p><font o="2474">我们将首先使用<code i="729">java -jar</code>将HTTP源应用程序和日志接收器作为独立应用程序运行。</font><font o="2475">这两个应用程序使用RabbitMQ进行通信。</font></p>
</div>
<div class="paragraph">
<p><font o="2476">下载每个示例应用程序，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">wget https://repo.spring.io/libs-release/org/springframework/cloud/stream/app/http-source-rabbit/1.3.1.RELEASE//http-source-rabbit-1.3.1.RELEASE.jar

wget https://repo.spring.io/release/org/springframework/cloud/stream/app/log-sink-rabbit/1.3.1.RELEASE/log-sink-rabbit-1.3.1.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2477">这些是Spring Boot应用程序，包括</font><a href="javascript:;"><font o="2477">Spring Boot Actuator</font></a><font o="2477">和</font><a href="javascript:;"><font o="2477">Spring Security Starter</font></a><font o="2477">。</font><font o="2478">您可以指定</font><a href="javascript:;"><font o="2478">常用的Spring Boot属性</font></a><font o="2478">来配置每个应用程序。</font><a href="javascript:;"><font o="2479">Spring应用程序启动程序</font></a><font o="2479">的</font><a href="javascript:;"><font o="2479">文档</font></a><font o="2479">中列出了特定于每个应用程序的属性</font><font o="2479">- 例如，</font><a href="javascript:;"><font o="2479">HTTP源</font></a><font o="2479">和</font><a href="javascript:;"><font o="2479">日志接收器</font></a></p>
</div>
<div class="paragraph">
<p><font o="2480">现在您可以运行http源应用程序。</font><font o="2481">只是为了好玩，使用系统属性传递一些Boot应用程序选项，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">java -Dserver.port=8123 -Dhttp.path-pattern=/data -Dspring.cloud.stream.bindings.output.destination=sensorData -jar http-source-rabbit-1.3.1.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2482"><code i="730">server.port</code>属性来自Spring Boot Web支持，<code i="731">http.path-pattern</code>属性来自HTTP源应用程序</font><a href="javascript:;"><font o="2482">HttpSourceProperties</font></a><font o="2482">。</font><font o="2483">HTTP源应用程序现在正在路径<code i="732">/data</code>下的端口8123上进行侦听。</font></p>
</div>
<div class="paragraph">
<p><font o="2484"><code i="733">spring.cloud.stream.bindings.output.destination</code>属性来自Spring Cloud Stream库，是源和接收器之间共享的消息传递目标的名称。</font><font o="2485">此属性中的字符串<code i="734">sensorData</code>是Spring Integration通道的名称，其内容将发布到消息传递中间件。</font></p>
</div>
<div class="paragraph">
<p><font o="2486">现在，您可以运行日志接收器应用程序并将日志记录级别更改为WARN，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">java -Dlog.level=WARN -Dspring.cloud.stream.bindings.input.destination=sensorData -jar log-sink-rabbit-1.3.1.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2487"><code i="735">log.level</code>属性来自日志接收器应用程序</font><a href="javascript:;"><font o="2487">LogSinkProperties</font></a><font o="2487">。</font></p>
</div>
<div class="paragraph">
<p><font o="2488">属性<code i="736">spring.cloud.stream.bindings.input.destination</code>的值设置为<code i="737">sensorData</code>，以便源和接收器应用程序可以相互通信。</font></p>
</div>
<div class="paragraph">
<p><font o="2489">您可以使用以下<code i="738">curl</code>命令将数据发送到<code i="739">http</code>应用程序：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">curl -H "Content-Type: application/json" -X POST -d '{"id":"1","temperature":"100"}' http://localhost:8123/data</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2490">然后，日志接收器应用程序显示以下输出：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">2017-03-17 15:30:17.825  WARN 22710 --- [_qquaYekbQ0nA-1] log-sink                                 : {"id":"1","temperature":"100"}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_custom_processor_application"><font o="2491">42.定制处理器应用程序</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2492">现在，您可以创建并测试对HTTP源的输出执行某些处理的应用程序，然后将数据发送到日志接收器。</font><font o="2493">然后，您可以使用</font><a href="javascript:;"><font o="2493">处理器</font></a><font o="2493">便捷类，该类具有入站通道和出站通道。</font></p>
</div>
<div class="paragraph">
<p><font o="2494">为此：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="2495">访问</font><a href="javascript:;"><font o="2495">Spring Initialzr</font></a><font o="2495">网站。</font></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><font o="2496">创建一个新的Maven项目，其</font><strong><font o="2496">组</font></strong><font o="2496">名为<code i="740">io.spring.stream.sample</code>，</font><strong><font o="2496">工件</font></strong><font o="2496">名称为<code i="741">transformer</code>。</font></p>
</li>
<li>
<p><font o="2497">在“依赖关系”文本框中，键入<code i="742">stream</code>以选择Spring Cloud Stream依赖关系。</font></p>
</li>
<li>
<p><font o="2498">在“依赖关系”文本框中，键入<code i="743">kafka</code>或<code i="744">rabbit</code>并选择要使用的中间件。</font></p>
</li>
<li>
<p><font o="2499">单击“ </font><strong><font o="2499">生成项目”</font></strong><font o="2499">按钮</font></p>
</li>
</ol>
</div>
</li>
<li>
<p><font o="2500">解压缩项目并将项目带入您喜欢的IDE中。</font></p>
</li>
<li>
<p><font o="2501">在<code i="745">io.spring.stream.sample</code>包中创建一个名为Transformer的类，其中包含以下内容：</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">package io.spring.stream.sample;

import org.springframework.cloud.stream.annotation.EnableBinding;
import org.springframework.cloud.stream.annotation.Output;
import org.springframework.cloud.stream.annotation.StreamListener;
import org.springframework.cloud.stream.messaging.Processor;
import org.springframework.messaging.handler.annotation.Payload;

import java.util.HashMap;
import java.util.Map;

@EnableBinding(Processor.class)
public class Transformer {

    @StreamListener(Processor.INPUT)
    @Output(Processor.OUTPUT)
    public Map&lt;String, Object&gt; transform(@Payload Map&lt;String, Object&gt; doc) {
        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();
        map.put("sensor_id", doc.getOrDefault("id", "-1"));
        map.put("temp_val", doc.getOrDefault("temperature", "-999"));
        return map;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2502">此处理器正在执行的所有操作是更改映射中键的名称，并提供默认值（如果不存在）。</font></p>
</div>
</li>
<li>
<p><font o="2503">打开<code i="746">TransformerApplicationTests</code>类（已经存在）并为<code i="747">Transformer</code>类创建一个简单的单元测试，如以下示例所示：</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">package io.spring.stream.sample;


import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import java.util.HashMap;
import java.util.Map;

import static org.assertj.core.api.Assertions.assertThat;
import static org.assertj.core.api.Assertions.entry;

@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
public class TransformerApplicationTests {

    @Autowired
    private Transformer transformer;

    @Test
    public void simpleTest() {
        Map&lt;String, Object&gt; resultMap = transformer.transform(createInputData());
        assertThat(resultMap).hasSize(2)
                .contains(entry("sensor_id", "1"))
                .contains(entry("temp_val", "100"));
    }

    private Map&lt;String, Object&gt; createInputData() {
        HashMap&lt;String, Object&gt; inputData = new HashMap&lt;&gt;();
        inputData.put("id", "1");
        inputData.put("temperature", "100");
        return inputData;
    }
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><font o="2504">在变换器项目的根目录中执行<code i="748">./mvnw clean package</code>会在<code i="750">target</code>目录下生成工件<code i="749">transformer-0.0.1-SNAPSHOT.jar</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="2505">现在您可以运行所有三个应用程序，如下面的清单所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">java -Dserver.port=8123 \
     -Dhttp.path-pattern=/data \
     -Dspring.cloud.stream.bindings.output.destination=sensorData \
     -jar http-source-rabbit-1.3.1.RELEASE.jar

java -Dserver.port=8090 \
 -Dspring.cloud.stream.bindings.input.destination=sensorData \
 -Dspring.cloud.stream.bindings.output.destination=normalizedSensorData \
 -jar transformer-0.0.1-SNAPSHOT.jar

java -Dlog.level=WARN \
     -Dspring.cloud.stream.bindings.input.destination=normalizedSensorData \
     -jar log-sink-rabbit-1.3.1.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2506">现在您可以将一些内容发布到http源应用程序，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">curl -H "Content-Type: application/json" -X POST -d '{"id":"2","temperature":"200"}' http://localhost:8123/data</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2507">前面的<code i="751">curl</code>命令导致日志接收器显示以下输出：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">2017-03-24 16:09:42.726  WARN 7839 --- [Raj4gYSoR_6YA-1] log-sink                                 : {sensor_id=2, temp_val=200}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_improving_the_quality_of_service"><font o="2508">43.提高服务质量</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2509">如果没有其他配置，生成数据的RabbitMQ应用程序将创建持久的主题交换。</font><font o="2510">同样，使用数据的RabbitMQ应用程序会创建一个匿名自动删除队列。</font><font o="2511">如果生产者应用程序在使用者应用程序之前启动，则这可能导致生成器不存储和转发消息。</font><font o="2512">即使交换是持久的，也需要有一个绑定到交换的持久队列，以便存储消息以供以后使用。</font></p>
</div>
<div class="paragraph">
<p><font o="2513">要预先创建持久队列并将它们绑定到交换，生成器应用程序应设置<code i="752">spring.cloud.stream.bindings.&lt;channelName&gt;.producer.requiredGroups</code>属性。</font><font o="2514"><code i="753">requiredGroups</code>属性接受以逗号分隔的组列表，生产者必须确保消息传递，即使它们在创建后启动也是如此。</font><font o="2515">然后，使用者应用程序应指定要从持久队列中使用的<code i="754">spring.cloud.stream.bindings.&lt;channelName&gt;.group</code>属性。</font><font o="2516">两个属性的逗号分隔的组列表通常应该匹配。
</font><a href="javascript:;"><font o="2517">消费者群体</font></a><font o="2517">也是消费应用程序的多个实例可以参与与同一消费者群体的其他成员的竞争消费者关系的手段。</font></p>
</div>
<div class="paragraph">
<p><font o="2518">以下清单显示了共享相同组的多个应用程序：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">java -Dserver.port=8123 \
     -Dhttp.path-pattern=/data \
     -Dspring.cloud.stream.bindings.output.destination=sensorData \
     -Dspring.cloud.stream.bindings.output.producer.requiredGroups=sensorDataGroup \
     -jar http-source-rabbit-1.3.1.RELEASE.jar

java -Dserver.port=8090 \
     -Dspring.cloud.stream.bindings.input.destination=sensorData \
     -Dspring.cloud.stream.bindings.input.group=sensorDataGroup \
     -Dspring.cloud.stream.bindings.output.destination=normalizedSensorData \
     -Dspring.cloud.stream.bindings.output.producer.requiredGroups=normalizedSensorDataGroup \
     -jar transformer-0.0.1-SNAPSHOT.jar

java -Dlog.level=WARN \
     -Dspring.cloud.stream.bindings.input.destination=normalizedSensorData \
     -Dspring.cloud.stream.bindings.input.group=normalizedSensorDataGroup \
     -jar log-sink-rabbit-1.3.1.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2519">和以前一样，将数据发布到<code i="755">http</code>源会在接收器中生成相同的日志消息。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mapping_applications_onto_data_flow"><font o="2520">44.将应用程序映射到数据流</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2521">Spring Cloud Data Flow（SCDF）通过引入流的概念，提供了一种更高级别的方法来创建这组三个Spring Cloud Stream应用程序。</font><font o="2522">通过使用类Unix管道和过滤DSL来定义流。</font><font o="2523">每个应用程序首先使用简单名称注册，例如<code i="756">http</code>，<code i="757">transformer</code>和<code i="758">log</code>（对于我们在此示例中使用的应用程序）。</font><font o="2524">连接这三个应用程序的流DSL是<code i="759">http | transformer | log</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="2525">Spring Cloud Data Flow有服务器和shell组件。</font><font o="2526">通过shell，您可以轻松地在名称下注册应用程序，还可以创建和部署流。</font><font o="2527">您还可以使用JavaDSL执行相同的操作。</font><font o="2528">但是，我们在本章的示例中使用shell。</font></p>
</div>
<div class="paragraph">
<p><font o="2529">在shell应用程序中，使用以下命令注册本地计算机上的jar文件。</font><font o="2530">在此示例中，<code i="760">http</code>和<code i="761">log</code>应用程序位于<code i="762">/home/mpollack/temp/dev</code>目录中，<code i="763">transformer</code>应用程序位于<code i="764">/home/mpollack/dev-marketing/transformer/target</code>目录中。</font></p>
</div>
<div class="paragraph">
<p><font o="2531">以下命令注册三个应用程序：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;app register --type source --name http --uri file://home/mpollack/temp/dev/http-source-rabbit-1.2.0.BUILD-SNAPSHOT.jar

dataflow:&gt;app register --type processor --name transformer --uri file://home/mpollack/dev-marketing/transformer/target/transformer-0.0.1-SNAPSHOT.jar

dataflow:&gt;app register --type sink --name log --uri file://home/mpollack/temp/dev/log-sink-rabbit-1.1.1.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2532">现在，您可以使用以下命令创建流定义并进行部署：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">stream create --name httpIngest --definition "http --server.port=8123 --path-pattern=/data | transformer --server.port=8090 | log --level=WARN" --deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2533">然后，在shell中，您可以查询流列表，如下所示（带输出）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream list
╔═══════════╤════════════════════════════════════════════════════════════════════════════════════════════════╤═════════╗
║Stream Name│                                       Stream Definition                                        │ Status  ║
╠═══════════╪════════════════════════════════════════════════════════════════════════════════════════════════╪═════════╣
║httpIngest │http --server.port=8123 --path-pattern=/data | transformer --server.port=8090 | log --level=WARN│Deploying║
╚═══════════╧════════════════════════════════════════════════════════════════════════════════════════════════╧═════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2534">最后，您可以看到状态列说<code i="765">Deployed</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="2535">在服务器日志中，您可以看到类似于以下内容的输出：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">2017-03-24 17:12:44.071  INFO 9829 --- [nio-9393-exec-6] o.s.c.d.spi.local.LocalAppDeployer       : deploying app httpIngest.log instance 0
   Logs will be in /tmp/spring-cloud-dataflow-4401025649434774446/httpIngest-1490389964038/httpIngest.log
2017-03-24 17:12:44.153  INFO 9829 --- [nio-9393-exec-6] o.s.c.d.spi.local.LocalAppDeployer       : deploying app httpIngest.transformer instance 0
   Logs will be in /tmp/spring-cloud-dataflow-4401025649434774446/httpIngest-1490389964143/httpIngest.transformer
2017-03-24 17:12:44.285  INFO 9829 --- [nio-9393-exec-6] o.s.c.d.spi.local.LocalAppDeployer       : deploying app httpIngest.http instance 0
   Logs will be in /tmp/spring-cloud-dataflow-4401025649434774446/httpIngest-1490389964264/httpIngest.http</pre>
</div>
</div>
<div class="paragraph">
<p><font o="2536">您可以转到每个目录以查看每个应用程序的日志。</font><font o="2537">在RabbitMQ管理控制台中，您可以看到两个交换和两个持久队列。</font></p>
</div>
<div class="paragraph">
<p><font o="2538">SCDF服务器已通过<code i="766">requiredGroups</code>和<code i="767">group</code>属性为每个应用程序配置了输入和输出目标，如前一个示例中明确指出的那样。</font></p>
</div>
<div class="paragraph">
<p><font o="2539">现在您可以将一些内容发布到http源应用程序，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">curl -H "Content-Type: application/json" -X POST -d '{"id":"1","temperature":"100"}' http://localhost:8123/data</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2540">在日志接收器的stdout_0.log文件上使用<code i="768">tail</code>命令，然后显示类似于以下列表的输出：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">2017-03-24 17:29:55.280  WARN 11302 --- [er.httpIngest-1] log-sink                                 : {sensor_id=4, temp_val=400}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2541">如果访问应用程序的Boot actuator端点，则可以看到SCDF为目标名称，使用者组和requiredGroups配置属性所做的约定，如下面的清单所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash"># for the http source
"spring.cloud.stream.bindings.output.producer.requiredGroups": "httpIngest",
"spring.cloud.stream.bindings.output.destination": "httpIngest.http",
"spring.cloud.application.group": "httpIngest",


# For the transformer
"spring.cloud.stream.bindings.input.group": "httpIngest",
"spring.cloud.stream.bindings.output.producer.requiredGroups": "httpIngest",


"spring.cloud.stream.bindings.output.destination": "httpIngest.transformer",
"spring.cloud.stream.bindings.input.destination": "httpIngest.http",
"spring.cloud.application.group": "httpIngest",

# for the log sink
"spring.cloud.stream.bindings.input.group": "httpIngest",
"spring.cloud.stream.bindings.input.destination": "httpIngest.transformer",
"spring.cloud.application.group": "httpIngest",</code></pre>
</div>
</div>
</div>
</div>
<h1 id="spring-cloud-dataflow-task" class="sect0"><font o="2542">任务</font></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p><font o="2543">本节详细介绍了如何使用</font><a href="javascript:;"><font o="2543">Spring Cloud Task</font></a><font o="2543">。</font><font o="2544">它涵盖了创建和运行任务应用程序等主题。</font></p>
</div>
<div class="paragraph">
<p><font o="2545">如果您刚开始使用Spring Cloud Data Flow，则</font><font o="2545">在深入了解本节之前</font><font o="2545">，您应该阅读“ </font><a href="#getting-started"><font o="2545">入门指南</font></a><font o="2545"> ”。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-task-intro"><font o="2546">45.导言</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2547">任务按需执行流程。</font><font o="2548">在Spring Cloud Task的情况下，任务是</font><font o="2548">使用<code i="769">@EnableTask</code>注释</font><font o="2548">的</font><a href="javascript:;"><font o="2548">Spring Boot</font></a><font o="2548">应用程序。</font><font o="2549">用户启动执行特定过程的任务，一旦完成，任务就结束。</font><font o="2550">与流定义最多只能有一个部署的流不同，可以同时多次启动单个任务定义。</font><font o="2551">任务的一个示例是Spring Boot应用程序，它将数据从JDBC存储库导出到HDFS实例。</font><font o="2552">任务记录关系数据库中的开始时间和结束时间以及引导退出代码。</font><font o="2553">任务实现基于</font><a href="javascript:;"><font o="2553">Spring Cloud Task</font></a><font o="2553">项目。</font></p>
</div>
<div class="sect2">
<h3 id="_application_properties_3">45.1.<font o="2555">应用属性</font></h3>
<div class="paragraph">
<p><font o="2556">每个应用程序都使用属性来定制其行为。</font><font o="2557">例如，<code i="770">timestamp</code>任务<code i="771">format</code>设置建立的输出格式与默认值不同。</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; task create --definition "timestamp --format=\"yyyy\"" --name printTimeStamp</code></p>
</div>
<div class="paragraph">
<p><font o="2558">此<code i="772">timestamp</code>属性实际上与timestamp应用程序指定的<code i="773">timestamp.format</code>属性相同。</font><font o="2559">数据流添加了使用简写形式<code i="774">format</code>而不是<code i="775">timestamp.format</code>的功能。</font><font o="2560">也可以指定longhand版本，如以下示例所示：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; task create --definition "timestamp --timestamp.format=\"yyyy\"" --name printTimeStamp</code></p>
</div>
<div class="paragraph">
<p><font o="2561">有关</font><a href="#spring-cloud-dataflow-stream-app-whitelisting"><font o="2561">白名单应用程序属性</font></a><font o="2561">的部分将更详细地讨论此简写行为</font><font o="2561">。</font><font o="2562">如果已</font><a href="#spring-cloud-dataflow-stream-app-metadata-artifact"><font o="2562">注册应用程序属性元数据</font></a><font o="2562">，则可以在键入<code i="776">--</code>后使用shell中的选项卡完成来获取候选属性名称列表。</font></p>
</div>
<div class="paragraph">
<p><font o="2563">shell为应用程序属性提供了Tab键完成。</font><font o="2564">shell命令<code i="777">app info --name &lt;appName&gt; --type &lt;appType&gt;</code>为所有支持的属性提供了附加文档。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2565">
支持的任务<code i="778">&lt;appType&gt;</code>是任务。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_lifecycle_of_a_task"><font o="2566">46.任务的生命周期</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2567">在深入了解创建任务的细节之前，我们需要了解Spring Cloud Data Flow上下文中任务的典型生命周期：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#spring-cloud-dataflow-create-task-apps"><font o="2568">创建任务应用程序</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-dataflow-register-task-apps"><font o="2569">注册任务应用程序</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-dataflow-create-task-definition"><font o="2570">创建任务定义</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-dataflow-task-launch"><font o="2571">启动任务</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-dataflow-task-review-executions"><font o="2572">检查任务执行</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-dataflow-task-definition-destroying"><font o="2573">销毁任务定义</font></a></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-create-task-apps">46.1.<font o="2575">创建任务应用程序</font></h3>
<div class="paragraph">
<p><font o="2576">虽然Spring Cloud Task确实提供了许多开箱即用的应用程序（在</font><a href="javascript:;"><font o="2576">spring-cloud-task-app-starters</font></a><font o="2576">），但大多数任务应用程序都需要自定义开发。</font><font o="2577">要创建自定义任务应用程序：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="2578">使用</font><a href="javascript:;"><font o="2578">Spring初始化</font></a><font o="2578">程序创建一个新项目，确保选择以下启动器：</font></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><font o="2579"><code i="779">Cloud Task</code>：这种依赖是<code i="780">spring-cloud-starter-task</code>。</font></p>
</li>
<li>
<p><font o="2580"><code i="781">JDBC</code>：这种依赖是<code i="782">spring-jdbc</code>的首发。</font></p>
</li>
</ol>
</div>
</li>
<li>
<p><font o="2581">在新项目中，创建一个新类作为主类，如下所示：</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">@EnableTask
@SpringBootApplication
public class MyTask {

    public static void main(String[] args) {
		SpringApplication.run(MyTask.class, args);
	}
}</code></pre>
</div>
</div>
</li>
<li>
<p><font o="2582">使用此类，您的应用程序中需要一个或多个<code i="783">CommandLineRunner</code>或<code i="784">ApplicationRunner</code>实现。</font><font o="2583">您可以实现自己的，也可以使用Spring Boot提供的那些（例如，有一个用于运行批处理作业）。</font></p>
</li>
<li>
<p><font o="2584">使用Spring Boot将应用程序打包到超级jar中是通过标准</font><a href="javascript:;"><font o="2584">Spring Boot约定完成的</font></a><font o="2584">。</font><font o="2585">可以如下所述注册和部署打包的应用程序。</font></p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_task_database_configuration">46.1.1.<font o="2587">任务数据库配置</font></h4>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="警告"></i>
</td>
<td class="content"><font o="2588">
启动任务应用程序时，请确保Spring Cloud Data Flow正在使用的数据库驱动程序也是对任务应用程序的依赖关系。</font><font o="2589">例如，如果您的Spring Cloud Data Flow设置为使用Postgresql，请确保任务应用程序还将Postgresql作为依赖项。
</font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="小费"></i>
</td>
<td class="content"><font o="2590">
当您在外部运行任务（即从命令行）并且希望Spring Cloud Data Flow在其UI中显示TaskExecutions时，请确保在两者之间共享公共数据源设置。</font><font o="2591">默认情况下，Spring Cloud Task使用本地H2实例，执行将记录到Spring Cloud Data Flow使用的数据库中。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-register-task-apps">46.2.<font o="2593">注册任务应用程序</font></h3>
<div class="paragraph">
<p><font o="2594">您可以使用Spring Cloud Data Flow Shell <code i="785">app register</code>命令在App Registry中注册Task App。</font><font o="2595">您必须提供可以解析为应用程序工件的唯一名称和URI。</font><font o="2596">对于类型，请指定“任务”。</font><font o="2597">以下列表显示了三个示例：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;app register --name task1 --type task --uri maven://com.example:mytask:1.0.2

dataflow:&gt;app register --name task2 --type task --uri file:///Users/example/mytask-1.0.2.jar

dataflow:&gt;app register --name task3 --type task --uri http://example.com/mytask-1.0.2.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2598">提供带有<code i="786">maven</code>方案的URI时，格式应符合以下条件：</font></p>
</div>
<div class="paragraph">
<p><code>maven://&lt;groupId&gt;:&lt;artifactId&gt;[:&lt;extension&gt;[:&lt;classifier&gt;]]:&lt;version&gt;</code></p>
</div>
<div class="paragraph">
<p><font o="2599">如果您想一次注册多个应用程序，可以将它们存储在属性文件中，其中键的格式为<code i="787">&lt;type&gt;.&lt;name&gt;</code>，值为URI。</font><font o="2600">例如，以下列表将是有效的属性文件：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>task.foo=file:///tmp/foo-1.2.1.BUILD-SNAPSHOT.jar
task.bar=file:///tmp/bar-1.2.1.BUILD-SNAPSHOT.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2601">然后，您可以使用<code i="788">app import</code>命令并使用<code i="789">--uri</code>选项提供属性文件的位置，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>app import --uri file:///tmp/task-apps.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2602">为方便起见，我们为所有开箱即用的Task app-starters提供了带有application-URI（适用于maven和docker）的静态文件。</font><font o="2603">您可以指向此文件并批量导入所有应用程序URI。</font><font o="2604">否则，如本章前面所述，您可以单独注册它们，也可以拥有自己的自定义属性文件，其中只包含所需的应用程序URI。</font><font o="2605">但是，建议在自定义属性文件中包含所需应用程序URI的“聚焦”列表。</font></p>
</div>
<div class="paragraph">
<p><font o="2606">下表列出了可用的静态属性文件：</font></p>
</div>
<table class="tableblock frame-topbot grid-all spread">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="2607">神器类型</font></th>
<th class="tableblock halign-left valign-top"><font o="2608">稳定释放</font></th>
<th class="tableblock halign-left valign-top"><font o="2609">SNAPSHOT发布</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Maven</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Clark-GA-task-applications-maven</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Clark-BUILD-SNAPSHOT-task-applications-maven</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Docker</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Clark-GA-task-applications-docker</a></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><a href="javascript:;" class="bare">bit.ly/Clark-BUILD-SNAPSHOT-task-applications-docker</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><font o="2610">例如，如果要批量注册所有现成的任务应用程序，可以使用以下命令执行此操作：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;app import --uri http://bit.ly/Clark-GA-task-applications-maven</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2611">您还可以传递<code i="790">--local</code>选项（默认为<code i="791">TRUE</code>）以指示是否应在shell进程本身内解析属性文件位置。</font><font o="2612">如果应从数据流服务器进程解析位置，请指定<code i="792">--local false</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="2613">使用<code i="793">app register</code>或<code i="794">app import</code>时，如果任务应用程序已使用提供的名称注册，则默认情况下不会覆盖它。</font><font o="2614">如果要覆盖预先存在的任务应用程序，请包含<code i="795">--force</code>选项。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2615">
在某些情况下，资源在服务器端解析。</font><font o="2616">在其他情况下，URI将传递到解析它的运行时容器实例。</font><font o="2617">有关更多详细信息，请参阅每个数据流服务器的特定文档。
</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-create-task-definition">46.3.<font o="2619">创建任务定义</font></h3>
<div class="paragraph">
<p><font o="2620">您可以通过提供定义名称以及适用于任务执行的属性，从任务应用程序创建任务定义。</font><font o="2621">可以通过RESTful API或shell来创建任务定义。</font><font o="2622">要使用shell创建任务定义，请使用<code i="796">task create</code>命令创建任务定义，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;task create mytask --definition "timestamp --format=\"yyyy\""
Created new task 'mytask'</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2623">可以通过RESTful API或shell获取当前任务定义的列表。</font><font o="2624">要使用shell获取任务定义列表，请使用<code i="797">task list</code>命令。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-task-launch">46.4.<font o="2626">启动任务</font></h3>
<div class="paragraph">
<p><font o="2627">可以通过RESTful API或shell启动adhoc任务。</font><font o="2628">要通过shell启动临时任务，请使用<code i="798">task launch</code>命令，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;task launch mytask
 Launched task 'mytask'</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2629">启动任务时，可以在启动任务时设置需要作为命令行参数传递给任务应用程序的任何属性，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;task launch mytask --arguments "--server.port=8080 --custom=value"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2630">
参数需要作为<code i="799">space</code>分隔值传递。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="2631">可以使用<code i="801">--properties</code>选项传入适用于<code i="800">TaskLauncher</code>本身的附加属性。</font><font o="2632">此选项的格式是以逗号分隔的属性字符串，前缀为<code i="802">app.&lt;task definition name&gt;.&lt;property&gt;</code>。</font><font o="2633">Properties作为应用程序属性传递给<code i="803">TaskLauncher</code>。</font><font o="2634">由实现来决定如何将它们传递到实际的任务应用程序中。</font><font o="2635">如果属性的前缀为<code i="804">deployer</code>而不是<code i="805">app</code>，则将其作为部署属性传递给<code i="806">TaskLauncher</code>，其含义可能是<code i="807">TaskLauncher</code>特定于实现。</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt;task launch mytask --properties "deployer.timestamp.custom1=value1,app.timestamp.custom2=value2"</code></p>
</div>
<div class="sect3">
<h4 id="_common_application_properties">46.4.1.<font o="2637">常见的应用属性</font></h4>
<div class="paragraph">
<p><font o="2638">除了通过DSL进行配置外，Spring Cloud Data Flow还提供了一种机制，用于为其启动的所有任务应用程序设置公共属性。</font><font o="2639">这可以通过在启动服务器时添加前缀为<code i="808">spring.cloud.dataflow.applicationProperties.task</code>的属性来完成。</font><font o="2640">执行此操作时，服务器将所有不带前缀的属性传递给它启动的实例。</font></p>
</div>
<div class="paragraph">
<p><font o="2641">例如，通过使用以下选项启动数据流服务器，可以将所有已启动的应用程序配置为使用属性<code i="809">prop1</code>和<code i="810">prop2</code>：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>--spring.cloud.dataflow.applicationProperties.task.prop1=value1
--spring.cloud.dataflow.applicationProperties.task.prop2=value2</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2642">这会将属性<code i="811">prop1=value1</code>和<code i="812">prop2=value2</code>传递给所有已启动的应用程序。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2643">
使用此机制配置的Properties优先级低于任务部署属性。</font><font o="2644">如果在任务启动时指定了具有相同键的属性，则会覆盖它们（例如，<code i="813">app.trigger.prop2</code>会覆盖公共属性）。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-task-limit-concurrent-executions">46.5.<font o="2646">限制并发任务启动的数量</font></h3>
<div class="paragraph">
<p><font o="2647">Spring Cloud Data Flow允许用户建立最大并发运行任务数，以防止IaaS /硬件资源饱和。</font><font o="2648">可以通过设置<code i="814">spring.cloud.dataflow.task.maximum-concurrent-tasks</code>属性来配置此限制。</font><font o="2649">默认情况下，它设置为<code i="815">20</code>。</font><font o="2650">如果并发运行的任务数等于或大于<code i="816">spring.cloud.dataflow.task.maximum-concurrent-tasks</code>设置的值，则下一个任务启动请求将被拒绝，并且将通过RESTful API，Shell或UI返回警告消息。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-task-review-executions">46.6.<font o="2652">检查任务执行</font></h3>
<div class="paragraph">
<p><font o="2653">启动任务后，任务的状态将存储在关系数据库中。</font><font o="2654">该州包括：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2655">任务名称</font></p>
</li>
<li>
<p><font o="2656">开始时间</font></p>
</li>
<li>
<p><font o="2657">时间结束</font></p>
</li>
<li>
<p><font o="2658">退出代码</font></p>
</li>
<li>
<p><font o="2659">退出消息</font></p>
</li>
<li>
<p><font o="2660">上次更新时间</font></p>
</li>
<li>
<p><font o="2661">参数</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="2662">用户可以通过RESTful API或shell检查其任务执行的状态。</font><font o="2663">要通过shell显示最新的任务执行，请使用<code i="817">task execution list</code>命令。</font></p>
</div>
<div class="paragraph">
<p><font o="2664">要获取仅一个任务定义的任务执行列表，请添加<code i="818">--name</code>和任务定义名称，例如<code i="819">task execution list --name foo</code>。</font><font o="2665">要检索任务执行的完整详细信息，请使用带有任务执行ID的<code i="820">task execution status</code>命令，例如<code i="821">task execution status --id 549</code>。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-task-definition-destroying">46.7.<font o="2667">销毁任务定义</font></h3>
<div class="paragraph">
<p><font o="2668">销毁任务定义会从定义存储库中删除定义。</font><font o="2669">这可以通过RESTful API或shell来完成。</font><font o="2670">要通过shell销毁任务，请使用<code i="822">task destroy</code>命令，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;task destroy mytask
 Destroyed task 'mytask'</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2671">先前为定义启动的任务的任务执行信息保留在任务存储库中。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2672">
这不会停止此定义的任何当前正在执行的任务。</font><font o="2673">相反，它从数据库中删除任务定义。
</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-dataflow-validate-task">46.8.<font o="2675">验证任务</font></h3>
<div class="paragraph">
<p><font o="2676">有时，任务定义中包含的一个或多个应用程序在其注册中包含无效的URI。</font><font o="2677">这可能是由于在应用注册时输入的URI无效，或者应用程序已从用于绘制应用程序的存储库中删除。</font><font o="2678">要验证任务中包含的所有应用程序是否可解析，用户可以使用<code i="823">validate</code>命令。</font><font o="2679">例如：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;task validate time-stamp
╔══════════╤═══════════════╗
║Task Name │Task Definition║
╠══════════╪═══════════════╣
║time-stamp│timestamp      ║
╚══════════╧═══════════════╝


time-stamp is a valid task.
╔═══════════════╤═════════════════╗
║   App Name    │Validation Status║
╠═══════════════╪═════════════════╣
║task:timestamp │valid            ║
╚═══════════════╧═════════════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2680">在上面的示例中，用户验证了他们的时间戳任务。</font><font o="2681">我们看到<code i="824">task:timestamp</code> app有效。</font><font o="2682">现在让我们看看如果我们有一个带有无效URI的注册应用程序的流定义会发生什么。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;task validate bad-timestamp
╔═════════════╤═══════════════╗
║  Task Name  │Task Definition║
╠═════════════╪═══════════════╣
║bad-timestamp│badtimestamp   ║
╚═════════════╧═══════════════╝


bad-timestamp is an invalid task.
╔══════════════════╤═════════════════╗
║     App Name     │Validation Status║
╠══════════════════╪═════════════════╣
║task:badtimestamp │invalid          ║
╚══════════════════╧═════════════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2683">在这种情况下，Spring Cloud Data Flow表示任务无效，因为task：badtimestamp具有无效的URI。</font></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-task-events"><font o="2684">47.订阅任务/批次Events</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2685">您还可以在启动任务时使用各种任务和批处理事件。</font><font o="2686">如果启用任务以生成任务或批处理事件（具有附加依赖项<code i="825">spring-cloud-task-stream</code>，并且在Kafka作为绑定程序<code i="826">spring-cloud-stream-binder-kafka</code>的情况下），则在任务生命周期期间发布这些事件。</font><font o="2687">默认情况下，代理（Rabbit，Kafka和其他）上发布的事件的目标名称是事件名称本身（例如：<code i="827">task-events</code>，<code i="828">job-execution-events</code>等） 。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;task create myTask --definition "myBatchJob"
dataflow:&gt;stream create task-event-subscriber1 --definition ":task-events &gt; log" --deploy
dataflow:&gt;task launch myTask</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2688">您可以通过在启动任务时指定显式名称来控制这些事件的目标名称，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt;stream create task-event-subscriber2 --definition ":myTaskEvents &gt; log" --deploy
dataflow:&gt;task launch myTask --properties "app.myBatchJob.spring.cloud.stream.bindings.task-events.destination=myTaskEvents"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2689">下表列出了代理上的默认任务和批处理事件和目标名称：</font></p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="2690">表1.任务和批处理事件目标</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><strong>Event</strong></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><strong>Destination</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Task events</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>task-events</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Job Execution events</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>job-execution-events</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Step Execution events</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>step-execution-events</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Item Read events</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>item-read-events</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Item Process events</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>item-process-events</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Item Write events</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>item-write-events</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Skip events</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>skip-events</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-composed-tasks"><font o="2691">48.组成的任务</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2692">Spring Cloud Data Flow允许用户创建有向图，其中图的每个节点都是任务应用程序。</font><font o="2693">这是通过使用DSL进行组合任务来完成的。</font><font o="2694">可以通过RESTful API，Spring Cloud Data Flow Shell或Spring Cloud Data Flow UI创建组合任务。</font></p>
</div>
<div class="sect2">
<h3 id="_configuring_the_composed_task_runner">48.1.<font o="2696">配置组合任务运行器</font></h3>
<div class="paragraph">
<p><font o="2697">组合任务通过名为</font><a href="javascript:;"><font o="2697">Composed Task Runner</font></a><font o="2697">的任务应用程序执行</font><font o="2697">。</font></p>
</div>
<div class="sect3">
<h4 id="_registering_the_composed_task_runner">48.1.1.<font o="2699">注册Composed Task Runner</font></h4>
<div class="paragraph">
<p><font o="2700">默认情况下，Composed Task Runner应用程序未注册Spring Cloud Data Flow。</font><font o="2701">因此，要启动组合任务，我们必须首先将Composed Task Runner注册为具有Spring Cloud Data Flow的应用程序，如下所示：</font></p>
</div>
<div class="paragraph">
<p><code>app register --name composed-task-runner --type task --uri maven://org.springframework.cloud.task.app:composedtaskrunner-task:&lt;DESIRED_VERSION&gt;</code></p>
</div>
<div class="paragraph">
<p><font o="2702">您还可以配置Spring Cloud Data Flow以使用组合任务运行器的其他任务定义名称。</font><font o="2703">这可以通过将<code i="829">spring.cloud.dataflow.task.composedTaskRunnerName</code>属性设置为您选择的名称来完成。</font><font o="2704">然后，您可以使用您使用该属性设置的名称注册组合任务运行器应用程序。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_the_composed_task_runner_2">48.1.2.<font o="2706">配置组合任务运行器</font></h4>
<div class="paragraph">
<p><font o="2707">Composed Task Runner应用程序具有<code i="830">dataflow.server.uri</code>属性，用于验证和启动子任务。</font><font o="2708">默认为<code i="831"><a href="javascript:;" class="bare">localhost:9393</a></code>。</font><font o="2709">如果运行分布式Spring Cloud Data Flow服务器，就像在Cloud Foundry，YARN或Kubernetes上部署服务器一样，则需要提供可用于访问服务器的URI。</font><font o="2710">您可以在启动组合任务时为Composed Task Runner应用程序提供此<code i="832">dataflow.server.uri</code>属性，也可以在启动时为Spring Cloud Data Flow服务器提供<code i="833">spring.cloud.dataflow.server.uri</code>属性。</font><font o="2711">对于后一种情况，在启动组合任务时会自动设置<code i="834">dataflow.server.uri</code> Composed Task Runner应用程序属性。</font></p>
</div>
<div class="paragraph">
<p><font o="2712">在某些情况下，您可能希望通过Task Launcher接收器执行Composed Task Runner的实例。</font><font o="2713">在这种情况下，您必须配置Composed Task Runner以使用Spring Cloud Data Flow实例正在使用的相同数据源。</font><font o="2714">通过使用<code i="836">commandlineArguments</code>或<code i="837">environmentProperties</code>开关，使用<code i="835">TaskLaunchRequest</code>设置数据源属性。</font><font o="2715">这是因为Composed Task Runner监视<code i="838">task_executions</code>表以检查它正在运行的任务的状态。</font><font o="2716">使用表中的信息，它确定了如何导航图表。</font></p>
</div>
<div class="sect4">
<h5 id="_configuration_options"><font o="2717">配置选项</font></h5>
<div class="paragraph">
<p><font o="2718">ComposedTaskRunner任务具有以下选项：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><font o="2719">increment-instance-enabled</font></strong><font o="2719"> 
允许在不更改参数的情况下重新执行单个ComposedTaskRunner实例。</font><font o="2720">默认值为false，这意味着ComposedTaskRunner实例只能使用给定的参数集执行一次，如果为true则可以重新执行。</font><font o="2721">（布尔值，默认值：false）。</font><font o="2722">ComposedTaskRunner使用</font><a href="javascript:;"><font o="2722">Spring Batch</font></a><font o="2722">构建</font><font o="2722">，因此在成功执行时，批处理作业被认为是完成的。</font><font o="2723">要多次启动相同的ComposedTaskRunner定义，必须将<code i="839">increment-instance-enabled</code>属性设置为true或更改每次启动的定义参数。</font></p>
</li>
<li>
<p><strong><font o="2724">interval-time-between-checks</font></strong><font o="2724"> 
在检查数据库以查看任务是否已完成之前，ComposedTaskRunner将等待的时间量（</font><strong><font o="2724">毫秒）</font></strong><font o="2724">。</font><font o="2725">（整数，默认值：10000）。</font><font o="2726">ComposedTaskRunner使用数据存储区来确定每个子任务的状态。</font><font o="2727">此间隔向ComposedTaskRunner指示它应检查其子任务的状态的频率。</font></p>
</li>
<li>
<p><strong><font o="2728">max-wait-time</font></strong><font o="2728"> 
在执行Composed任务失败之前，单个步骤可以运行的最大时间（以毫秒为单位）（整数，默认值：0）。</font><font o="2729">确定在CTR终止失败之前允许每个子任务运行的最长时间。</font><font o="2730">默认值<code i="840">0</code>表示没有超时。</font></p>
</li>
<li>
<p><strong><font o="2731">split-thread-allow-core-thread-timeout</font></strong><font o="2731"> 
指定是否允许拆分核心线程超时。</font><font o="2732">默认为false; </font><font o="2733">（Boolean，default：false）设置控制核心线程是否可以超时的策略，如果在保持活动时间内没有任务到达则终止，在新任务到达时根据需要进行替换。</font></p>
</li>
<li>
<p><strong><font o="2734">split-thread-core-pool-size</font></strong><font o="2734"> 
Split的核心池大小。</font><font o="2735">默认值为1; </font><font o="2736">（整数，默认值：1）拆分中包含的每个子任务都需要一个线程才能执行。</font><font o="2737">因此，例如：<code i="841">&lt;AAA || BBB || CCC&gt; &amp;&amp; &lt;DDD || EEE&gt;</code>这样的定义需要拆分线程 - 核心池大小为3.这是因为最大的拆分包含3个子任务。</font><font o="2738">计数为2表示<code i="842">AAA</code>和<code i="843">BBB</code>并行运行，但CCC会等到<code i="844">AAA</code>或<code i="845">BBB</code>完成才能运行。</font><font o="2739">然后<code i="846">DDD</code>和<code i="847">EEE</code>并行运行。</font></p>
</li>
<li>
<p><strong><font o="2740">split-thread-keep-alive-seconds</font></strong><font o="2740"> 
Split的线程保持活动秒数。</font><font o="2741">默认值为60.（整数，默认值：60）如果池当前具有多个corePoolSize线程，则多余线程如果空闲时间超过keepAliveTime则终止。</font></p>
</li>
<li>
<p><strong><font o="2742">split-thread-max-pool-size</font></strong><font o="2742"> 
Split的最大池大小。</font><font o="2743">默认值为{@code Integer.MAX_VALUE}（整数，默认值：&lt;无&gt;）。</font><font o="2744">建立线程池允许的最大线程数。</font></p>
</li>
<li>
<p><strong><font o="2745">split-thread-queue-capacity</font></strong><font o="2745"> 
Split的BlockingQueue容量。</font><font o="2746">默认值为{@code Integer.MAX_VALUE}。</font><font o="2747">（整数，默认值：&lt;无&gt;）</font></p>
<div class="ulist">
<ul>
<li>
<p><font o="2748">如果运行的corePoolSize线程少于corePoolSize，则Executor总是更喜欢添加新线程而不是排队。</font></p>
</li>
<li>
<p><font o="2749">如果corePoolSize或更多线程正在运行，则Executor总是更喜欢排队请求而不是添加新线程。</font></p>
</li>
<li>
<p><font o="2750">如果请求无法排队，则会创建一个新线程，除非它超过maximumPoolSize，在这种情况下，该任务将被拒绝。</font></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><font o="2751">split-thread-wait-for-tasks-to-complete-on-shutdown</font></strong><font o="2751"> 
是否</font><strong><font o="2751">在关机</font></strong><font o="2751">时等待计划任务完成，不中断正在运行的任务并执行队列中的所有任务。</font><font o="2752">默认为false; </font><font o="2753">（布尔值，默认值：false）</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="2754">注意当使用上面的选项作为环境变量时，转换为大写，删除短划线字符并替换为下划线字符。</font><font o="2755">例如：increment-instance-enabled将为INCREMENT_INSTANCE_ENABLED。</font></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_lifecycle_of_a_composed_task">48.2.<font o="2757">组合任务的生命周期</font></h3>
<div class="paragraph">
<p><font o="2758">组合任务的生命周期有三个部分：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#spring-cloud-data-flow-composed-task-creating"><font o="2759">创建组合任务</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-data-flow-composed-task-stopping"><font o="2760">停止组合任务</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-data-flow-composed-task-restarting"><font o="2761">重新启动组合任务</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="spring-cloud-data-flow-composed-task-creating">48.2.1.<font o="2763">创建组合任务</font></h4>
<div class="paragraph">
<p><font o="2764">通过task create命令创建任务定义时，将使用组合任务的DSL，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>dataflow:&gt; app register --name timestamp --type task --uri maven://org.springframework.cloud.task.app:timestamp-task:&lt;DESIRED_VERSION&gt;
dataflow:&gt; app register --name mytaskapp --type task --uri file:///home/tasks/mytask.jar
dataflow:&gt; task create my-composed-task --definition "mytaskapp &amp;&amp; timestamp"
dataflow:&gt; task launch my-composed-task</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2765">在前面的示例中，我们假设我们的组合任务要使用的应用程序尚未注册。</font><font o="2766">因此，在前两个步骤中，我们注册了两个任务应用程序。</font><font o="2767">然后，我们使用<code i="848">task create</code>命令创建我们的组合任务定义。</font><font o="2768">上例中的组合任务DSL在启动时运行mytaskapp，然后运行时间戳应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="2769">但在我们启动<code i="849">my-composed-task</code>定义之前，我们可以查看为我们生成的Spring Cloud Data Flow。</font><font o="2770">这可以通过执行task list命令来完成，如下图所示（包括其输出）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;task list
╔══════════════════════════╤══════════════════════╤═══════════╗
║        Task Name         │   Task Definition    │Task Status║
╠══════════════════════════╪══════════════════════╪═══════════╣
║my-composed-task          │mytaskapp &amp;&amp; timestamp│unknown    ║
║my-composed-task-mytaskapp│mytaskapp             │unknown    ║
║my-composed-task-timestamp│timestamp             │unknown    ║
╚══════════════════════════╧══════════════════════╧═══════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2771">在该示例中，Spring Cloud Data Flow创建了三个任务定义，一个用于构成我们的组合任务（<code i="850">my-composed-task-mytaskapp</code>和<code i="851">my-composed-task-timestamp</code>）的每个应用程序以及组合任务（<code i="852">my-composed-task</code>）定义。</font><font o="2772">我们还看到，子任务的每个生成的名称都由组合任务的名称和应用程序的名称组成，用短划线<code i="853">-</code>分隔（如在</font><em><font o="2772">my- </font></em> <code>-</code> <em><font o="2772">composed </font></em><em><font o="2772">-task </font></em><em><font o="2772">mytaskapp中</font></em><font o="2772">）。</font></p>
</div>
<div class="sect4">
<h5 id="_task_application_parameters"><font o="2773">任务应用参数</font></h5>
<div class="paragraph">
<p><font o="2774">组成组合任务定义的任务应用程序也可以包含参数，如以下示例所示：</font></p>
</div>
<div class="paragraph">
<p><code>dataflow:&gt; task create my-composed-task --definition "mytaskapp --displayMessage=hello &amp;&amp; timestamp --format=YYYY"</code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_launching_a_composed_task">48.2.2.<font o="2776">启动组合任务</font></h4>
<div class="paragraph">
<p><font o="2777">启动组合任务的方式与启动独立任务的方式相同，如下所示：</font></p>
</div>
<div class="paragraph">
<p><code>task launch my-composed-task</code></p>
</div>
<div class="paragraph">
<p><font o="2778">启动任务后，假设所有任务都成功完成，您可以在执行<code i="854">task execution list</code>时看到三个任务执行，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;task execution list
╔══════════════════════════╤═══╤════════════════════════════╤════════════════════════════╤═════════╗
║        Task Name         │ID │         Start Time         │          End Time          │Exit Code║
╠══════════════════════════╪═══╪════════════════════════════╪════════════════════════════╪═════════╣
║my-composed-task-timestamp│713│Wed Apr 12 16:43:07 EDT 2017│Wed Apr 12 16:43:07 EDT 2017│0        ║
║my-composed-task-mytaskapp│712│Wed Apr 12 16:42:57 EDT 2017│Wed Apr 12 16:42:57 EDT 2017│0        ║
║my-composed-task          │711│Wed Apr 12 16:42:55 EDT 2017│Wed Apr 12 16:43:15 EDT 2017│0        ║
╚══════════════════════════╧═══╧════════════════════════════╧════════════════════════════╧═════════╝</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2779">在前面的示例中，我们看到<code i="855">my-compose-task</code>已启动，并且它还按顺序启动了其他任务。</font><font o="2780">所有这些都以<code i="856">Exit Code</code> <code i="857">0</code>成功执行。</font></p>
</div>
<div class="sect4">
<h5 id="_passing_properties_to_the_child_tasks"><font o="2781">将属性传递给子任务</font></h5>
<div class="paragraph">
<p><font o="2782">要在任务启动时在组合任务图中设置子任务的属性，可以使用以下格式<code i="858">app.&lt;composed task definition name&gt;.&lt;child task app name&gt;.&lt;property&gt;</code>。</font><font o="2783">使用以下Composed Task定义作为示例：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt; task create my-composed-task --definition "mytaskapp  &amp;&amp; mytimestamp"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2784">要让mytaskapp显示“HELLO”并将mytimestamp timestamp格式设置为“YYYY”以进行Composed Task定义，您将使用以下任务启动格式：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">task launch my-composed-task --properties "app.my-composed-task.mytaskapp.displayMessage=HELLO,app.my-composed-task.mytimestamp.timestamp.format=YYYY"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2785">与应用程序属性类似，也可以使用格式格式<code i="860">deployer.&lt;composed task definition name&gt;.&lt;child task app name&gt;.&lt;deployer-property&gt;</code>为子任务设置<code i="859">deployer</code>属性。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">task launch my-composed-task --properties "deployer.my-composed-task.mytaskapp.memory=2048m,app.my-composed-task.mytimestamp.timestamp.format=HH:mm:ss"
Launched task 'a1'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_passing_arguments_to_the_composed_task_runner"><font o="2786">将参数传递给组合任务运行器</font></h5>
<div class="paragraph">
<p><font o="2787">可以使用<code i="861">--arguments</code>选项传递组合任务运行器的命令行参数。</font></p>
</div>
<div class="paragraph">
<p><font o="2788">例如：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;task create my-composed-task --definition "&lt;aaa: timestamp || bbb: timestamp&gt;"
Created new task 'my-composed-task'

dataflow:&gt;task launch my-composed-task --arguments "--increment-instance-enabled=true --max-wait-time=50000 --split-thread-core-pool-size=4" --properties "app.my-composed-task.bbb.timestamp.format=dd/MM/yyyy HH:mm:ss"
Launched task 'my-composed-task'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_exit_statuses"><font o="2789">退出状态</font></h5>
<div class="paragraph">
<p><font o="2790">以下列表显示了如何为每个步骤执行后的组合任务中包含的每个步骤（任务）设置“退出状态”：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2791">如果<code i="862">TaskExecution</code>具有<code i="863">ExitMessage</code>，则用作<code i="864">ExitStatus</code>。</font></p>
</li>
<li>
<p><font o="2792">如果不存在<code i="865">ExitMessage</code>并且<code i="866">ExitCode</code>设置为零，则该步骤的<code i="867">ExitStatus</code>为<code i="868">COMPLETED</code>。</font></p>
</li>
<li>
<p><font o="2793">如果不存在<code i="869">ExitMessage</code>并且<code i="870">ExitCode</code>设置为任何非零数字，则步骤的<code i="871">ExitStatus</code>为<code i="872">FAILED</code>。</font></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_destroying_a_composed_task">48.2.3.<font o="2795">破坏组合任务</font></h4>
<div class="paragraph">
<p><font o="2796">用于销毁独立任务的命令与用于销毁组合任务的命令相同。</font><font o="2797">唯一的区别是销毁组合任务也会破坏与之相关的子任务。</font><font o="2798">以下示例显示使用<code i="873">destroy</code>命令之前和之后的任务列表：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;task list
╔══════════════════════════╤══════════════════════╤═══════════╗
║        Task Name         │   Task Definition    │Task Status║
╠══════════════════════════╪══════════════════════╪═══════════╣
║my-composed-task          │mytaskapp &amp;&amp; timestamp│COMPLETED  ║
║my-composed-task-mytaskapp│mytaskapp             │COMPLETED  ║
║my-composed-task-timestamp│timestamp             │COMPLETED  ║
╚══════════════════════════╧══════════════════════╧═══════════╝
...
dataflow:&gt;task destroy my-composed-task
dataflow:&gt;task list
╔═════════╤═══════════════╤═══════════╗
║Task Name│Task Definition│Task Status║
╚═════════╧═══════════════╧═══════════╝</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="spring-cloud-data-flow-composed-task-stopping">48.2.4.<font o="2800">停止组合任务</font></h4>
<div class="paragraph">
<p><font o="2801">如果需要停止组合任务执行，您可以通过以下方式执行：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2802">RESTful API</font></p>
</li>
<li>
<p><font o="2803">Spring Cloud Data Flow仪表板</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="2804">要通过仪表板停止组合任务，请选择“作业”选项卡，然后单击要停止的作业执行旁边的“停止”按钮。</font></p>
</div>
<div class="paragraph">
<p><font o="2805">当前正在运行的子任务完成时，将停止组合任务运行。</font><font o="2806">与组合任务停止时运行的子任务关联的步骤标记为<code i="874">STOPPED</code>以及组合任务作业执行。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="spring-cloud-data-flow-composed-task-restarting">48.2.5.<font o="2808">重新启动组合任务</font></h4>
<div class="paragraph">
<p><font o="2809">如果组合任务在执行期间失败并且组合任务的状态为<code i="875">FAILED</code>，则可以重新启动任务。</font><font o="2810">你可以通过以下方式这样做：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2811">RESTful API</font></p>
</li>
<li>
<p><font o="2812">贝壳</font></p>
</li>
<li>
<p><font o="2813">Spring Cloud Data Flow仪表板</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="2814">要通过shell重新启动组合任务，请使用相同的参数启动任务。</font><font o="2815">要通过仪表板重新启动组合任务，请选择“作业”选项卡，然后单击要重新启动的作业执行旁边的“重新启动”按钮。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2816">
重新启动已停止的组合任务作业（通过Spring Cloud Data Flow仪表板或RESTful API）重新启动<code i="876">STOPPED</code>子任务，然后按指定的顺序启动剩余的（未启动的）子任务。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_composed_tasks_dsl"><font o="2817">49.组成的任务DSL</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2818">组合任务可以通过三种方式运行：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#spring-cloud-data-flow-conditional-execution"><font o="2819">条件执行</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-data-flow-transitional-execution"><font o="2820">过渡执行</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-data-flow-split-execution"><font o="2821">拆分执行</font></a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="spring-cloud-data-flow-conditional-execution">49.1.<font o="2823">条件执行</font></h3>
<div class="paragraph">
<p><font o="2824">使用双符号符号（<code i="877">&amp;&amp;</code>）表示条件执行。</font><font o="2825">这使得序列中的每个任务仅在前一个任务成功完成时启动，如以下示例所示：</font></p>
</div>
<div class="paragraph">
<p><code>task create my-composed-task --definition "task1 &amp;&amp; task2"</code></p>
</div>
<div class="paragraph">
<p><font o="2826">当启动名为<code i="878">my-composed-task</code>的组合任务时，它会启动名为<code i="879">task1</code>的任务，如果成功完成，则启动名为<code i="880">task2</code>的任务。</font><font o="2827">如果<code i="881">task1</code>失败，则<code i="882">task2</code>不会启动。</font></p>
</div>
<div class="paragraph">
<p><font o="2828">您还可以使用Spring Cloud Data Flow仪表板创建条件执行，方法是使用设计器拖放所需的应用程序并将它们连接在一起以创建有向图，如下图所示：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-ctr-conditional-executi.png" alt="组合任务条件执行">
</div>
<div class="title"><font o="2829">图11.条件执行</font></div>
</div>
<div class="paragraph">
<p><font o="2830">上图是使用Spring Cloud Data Flow仪表板创建的有向图的屏幕截图。</font><font o="2831">您可以看到图中包含条件执行的四个组件：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2832">开始图标：所有有向图都从此符号开始。</font><font o="2833">只有一个。</font></p>
</li>
<li>
<p><font o="2834">任务图标：表示有向图中的每个任务。</font></p>
</li>
<li>
<p><font o="2835">结束图标：表示有向图的终止。</font></p>
</li>
<li>
<p><font o="2836">实线箭头：表示以下各项之间的流条件执行流程：</font></p>
<div class="ulist">
<ul>
<li>
<p><font o="2837">两个应用程序</font></p>
</li>
<li>
<p><font o="2838">启动控制节点和应用程序。</font></p>
</li>
<li>
<p><font o="2839">应用程序和结束控制节点。</font></p>
</li>
</ul>
</div>
</li>
<li>
<p><font o="2840">结束图标：所有有向图都以此符号结束。</font></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="小费"></i>
</td>
<td class="content"><font o="2841">
通过单击“定义”选项卡上组合任务定义旁边的“详细信息”按钮，可以查看有向图的图表。
</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-data-flow-transitional-execution">49.2.<font o="2843">过渡执行</font></h3>
<div class="paragraph">
<p><font o="2844">DSL支持对有向图执行期间所进行的转换进行细粒度控制。</font><font o="2845">通过基于前一任务的退出状态提供相等的条件来指定转换。</font><font o="2846">任务转换由以下符号<code i="883">-&gt;</code>表示。</font></p>
</div>
<div class="sect3">
<h4 id="_basic_transition">49.2.1.<font o="2848">基本过渡</font></h4>
<div class="paragraph">
<p><font o="2849">基本过渡如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>task create my-transition-composed-task --definition "foo 'FAILED' -&gt; bar 'COMPLETED' -&gt; baz"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2850">在前面的示例中，<code i="884">foo</code>将启动，如果它的退出状态为<code i="885">FAILED</code>，则<code i="886">bar</code>任务将启动。</font><font o="2851">如果<code i="887">foo</code>的退出状态为<code i="888">COMPLETED</code>，则会启动<code i="889">baz</code>。</font><font o="2852"><code i="890">foo</code>返回的所有其他状态均无效，任务将正常终止。</font></p>
</div>
<div class="paragraph">
<p><font o="2853">使用Spring Cloud Data Flow仪表板创建相同的“<code i="891">basic transition</code>”将类似于以下图像：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-ctr-transition-basic.png" alt="组合任务基本过渡">
</div>
<div class="title"><font o="2854">图12.基本过渡</font></div>
</div>
<div class="paragraph">
<p><font o="2855">上图是在Spring Cloud Data Flow仪表板中创建的有向图的屏幕截图。</font><font o="2856">请注意，有两种不同类型的连接器：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2857">虚线：表示从应用程序到可能的目标应用程序之一的转换。</font></p>
</li>
<li>
<p><font o="2858">实线：连接条件执行中的应用程序或应用程序与控制节点之间的连接（开始或结束）。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="2859">要创建过渡连接器：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="2860">创建转换时，使用连接器将应用程序链接到每个可能的目标。</font></p>
</li>
<li>
<p><font o="2861">完成后，转到每个连接并通过单击选择它。</font></p>
</li>
<li>
<p><font o="2862">出现一个螺栓图标。</font></p>
</li>
<li>
<p><font o="2863">单击该图标。</font></p>
</li>
<li>
<p><font o="2864">输入该连接器所需的退出状态。</font></p>
</li>
<li>
<p><font o="2865">该连接器的实线变为虚线。</font></p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_transition_with_a_wildcard">49.2.2.<font o="2867">转换为通配符</font></h4>
<div class="paragraph">
<p><font o="2868">通过DSL支持转换支持通配符，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>task create my-transition-composed-task --definition "foo 'FAILED' -&gt; bar '*' -&gt; baz"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2869">在前面的示例中，<code i="892">foo</code>将启动，如果它的退出状态为<code i="893">FAILED</code>，则<code i="894">bar</code>任务将启动。</font><font o="2870">对于除<code i="896">FAILED</code>之外的任何退出状态<code i="895">foo</code>，<code i="897">baz</code>将启动。</font></p>
</div>
<div class="paragraph">
<p><font o="2871">使用Spring Cloud Data Flow仪表板创建相同的“带通配符的转换”将类似于以下图像：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-ctr-transition-basic-wi.png" alt="使用通配符组合任务基本过渡">
</div>
<div class="title"><font o="2872">图13.使用通配符的基本过渡</font></div>
</div>
</div>
<div class="sect3">
<h4 id="_transition_with_a_following_conditional_execution">49.2.3.<font o="2874">通过以下条件执行进行转换</font></h4>
<div class="paragraph">
<p><font o="2875">只要不使用通配符，转换后可以进行条件执行，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>task create my-transition-conditional-execution-task --definition "foo 'FAILED' -&gt; bar 'UNKNOWN' -&gt; baz &amp;&amp; qux &amp;&amp; quux"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2876">在前面的示例中，<code i="898">foo</code>将启动，如果它的退出状态为<code i="899">FAILED</code>，则<code i="900">bar</code>任务将启动。</font><font o="2877">如果<code i="901">foo</code>的退出状态为<code i="902">UNKNOWN</code>，则会启动<code i="903">baz</code>。</font><font o="2878">对于除<code i="905">FAILED</code>或<code i="906">UNKNOWN</code>以外的任何退出状态<code i="904">foo</code>，<code i="907">qux</code>将启动，并且在成功完成后，<code i="908">quux</code>将启动。</font></p>
</div>
<div class="paragraph">
<p><font o="2879">使用Spring Cloud Data Flow仪表板创建相同的“条件执行转换”将类似于以下图像：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-ctr-transition-conditio.png" alt="具有条件执行的组合任务转换">
</div>
<div class="title"><font o="2880">图14.使用条件执行的转换</font></div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2881">
在此图中，我们看到将<code i="909">foo</code>应用程序连接到目标应用程序的虚线（过渡），但是连接<code i="910">foo</code>，<code i="911">qux</code>和<code i="912">quux</code>之间的条件执行的实线。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spring-cloud-data-flow-split-execution">49.3.<font o="2883">拆分执行</font></h3>
<div class="paragraph">
<p><font o="2884">拆分允许组合任务中的多个任务并行运行。</font><font o="2885">它通过使用尖括号（<code i="913">&lt;&gt;</code>）来表示要并行运行的任务和流。</font><font o="2886">这些任务和流由双管<code i="914">||</code>符号分隔，如以下示例所示：</font></p>
</div>
<div class="paragraph">
<p><code>task create my-split-task --definition "&lt;foo || bar || baz&gt;"</code></p>
</div>
<div class="paragraph">
<p><font o="2887">上面的示例并行启动任务<code i="915">foo</code>，<code i="916">bar</code>和<code i="917">baz</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="2888">使用Spring Cloud Data Flow仪表板创建相同的“拆分执行”将类似于以下图像：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-ctr-split.png" alt="组合任务拆分">
</div>
<div class="title"><font o="2889">图15.拆分</font></div>
</div>
<div class="paragraph">
<p><font o="2890">使用任务DSL，用户也可以连续执行多个拆分组，如以下示例所示：</font></p>
</div>
<div class="paragraph">
<p><font o="2891">`task create my-split-task --definition“&lt;foo || bar || baz&gt; &amp;&amp; &lt;qux || quux&gt;”'</font></p>
</div>
<div class="paragraph">
<p><font o="2892">在前面的示例中，任务<code i="918">foo</code>，<code i="919">bar</code>和<code i="920">baz</code>并行启动。</font><font o="2893">一旦完成，则任务<code i="921">qux</code>和<code i="922">quux</code>并行启动。</font><font o="2894">完成后，组合任务结束。</font><font o="2895">但是，如果<code i="923">foo</code>，<code i="924">bar</code>或<code i="925">baz</code>失败，则包含<code i="926">qux</code>和<code i="927">quux</code>的拆分不会启动。</font></p>
</div>
<div class="paragraph">
<p><font o="2896">使用Spring Cloud Data Flow仪表板创建相同的“具有多个组的拆分”将类似于以下图像：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-ctr-multiple-splits.png" alt="组合任务拆分">
</div>
<div class="title"><font o="2897">图16.作为条件执行的一部分拆分</font></div>
</div>
<div class="paragraph">
<p><font o="2898">请注意，在连接两个连续的分割时，设计者会插入一个<code i="928">SYNC</code>控制节点。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2899">
拆分中使用的任务不应设置其<code i="929">ExitMessage</code>。</font><font o="2900">设置<code i="930">ExitMessage</code>仅用于</font><a href="#spring-cloud-data-flow-transitional-execution"><font o="2900">过渡</font></a><font o="2900">。
</font></td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="_split_containing_conditional_execution">49.3.1.<font o="2902">拆分包含条件执行</font></h4>
<div class="paragraph">
<p><font o="2903">拆分也可以在尖括号内进行条件执行，如以下示例所示：</font></p>
</div>
<div class="paragraph">
<p><code>task create my-split-task --definition "&lt;foo &amp;&amp; bar || baz&gt;"</code></p>
</div>
<div class="paragraph">
<p><font o="2904">在前面的示例中，我们看到<code i="931">foo</code>和<code i="932">baz</code>并行启动。</font><font o="2905">但是，<code i="933">bar</code>在<code i="934">foo</code>成功完成之前不会启动。</font></p>
</div>
<div class="paragraph">
<p><font o="2906">使用Spring Cloud Data Flow仪表板创建相同的“<code i="935">split containing conditional execution</code>”类似于以下图像：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-ctr-split-contains-cond.png" alt="组合任务与条件执行分离">
</div>
<div class="title"><font o="2907">图17.使用条件执行进行拆分</font></div>
</div>
</div>
<div class="sect3">
<h4 id="_establishing_the_proper_thread_count_for_splits">49.3.2.<font o="2909">为拆分建立正确的线程计数</font></h4>
<div class="paragraph">
<p><font o="2910">拆分中包含的每个子任务都需要一个线程才能执行。</font><font o="2911">要正确设置此选项，您需要查看图形并计算具有最大子任务数的拆分，这将是您需要使用的线程数。</font><font o="2912">要设置线程计数，请使用split-thread-core-pool-size属性（默认为1）。</font><font o="2913">因此，例如：<code i="936">&lt;AAA || BBB || CCC&gt; &amp;&amp; &lt;DDD || EEE&gt;</code>这样的定义需要拆分线程 - 核心池大小为3.这是因为最大的拆分包含3个子任务。</font><font o="2914">计数为2表示<code i="937">AAA</code>和<code i="938">BBB</code>并行运行，但CCC会等到<code i="939">AAA</code>或<code i="940">BBB</code>完成才能运行。</font><font o="2915">然后<code i="941">DDD</code>和<code i="942">EEE</code>并行运行。</font></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-launch-tasks-from-stream"><font o="2916">50.从流中启动任务</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2917">您可以使用其中一个可用的<code i="943">task-launcher</code>接收器从流中启动任务。</font><font o="2918">目前，<code i="944">task-launcher</code>接收器支持的平台是：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javascript:;"><font o="2919">当地的</font></a><font o="2919">，</font></p>
</li>
<li>
<p><a href="javascript:;">Cloud Foundry</a></p>
</li>
<li>
<p><a href="javascript:;"><font o="2921">Kubernetes</font></a></p>
</li>
<li>
<p><a href="javascript:;"><font o="2922">纱</font></a></p>
</li>
</ul>
</div>
<div class="admonitionblock caution">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-caution" title="警告"></i>
</td>
<td class="content"><font o="2923">
<code i="945">task-launcher-local</code>仅用于发展目的。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="2924"><code i="946">task-launcher</code>接收器需要</font><font o="2924">在其有效负载中</font><font o="2924">包含</font><a href="javascript:;"><font o="2924">TaskLaunchRequest</font></a><font o="2924">对象</font><font o="2924">的消息</font><font o="2924">。</font><font o="2925">从<code i="947">TaskLaunchRequest</code>对象，<code i="948">task-launcher</code>获取要启动的工件的URI，以及任务要使用的环境属性，命令行参数，部署属性和应用程序名称。</font></p>
</div>
<div class="paragraph">
<p><font o="2926">可以通过执行app register命令</font><font o="2926">将</font><a href="javascript:;"><font o="2926">task-launcher-local</font></a><font o="2926">添加到可用的接收器中，如下所示（对于Rabbit Binder，在这种情况下）：</font></p>
</div>
<div class="paragraph">
<p><code>app register --name task-launcher-local --type sink --uri maven://org.springframework.cloud.stream.app:task-launcher-local-sink-rabbit:jar:1.2.0.RELEASE</code></p>
</div>
<div class="paragraph">
<p><font o="2927">对于要启动的基于Maven的任务，<code i="949">task-launcher</code>应用程序负责下载工件。</font><font o="2928">您</font><strong><font o="2928">必须</font></strong><font o="2928">使用适当的</font><a href="javascript:;"><font o="2928">Maven Properties</font></a><font o="2928">配置配置<code i="950">task-launcher</code> </font><font o="2928">，例如<code i="951">--maven.remote-repositories.repo1.url=http://repo.spring.io/libs-milestone"</code>以解决工件（在这种情况下针对里程碑仓库）。</font><font o="2929">请注意，此存储库可能与用于注册<code i="952">task-launcher</code>应用程序本身的存储库不同。</font></p>
</div>
<div class="sect2">
<h3 id="_triggertask">50.1.<font o="2931">TriggerTask</font></h3>
<div class="paragraph">
<p><font o="2932">使用<code i="953">task-launcher</code>启动任务的一种方法是使用</font><a href="javascript:;"><font o="2932">triggertask</font></a><font o="2932">源。</font><font o="2933"><code i="954">triggertask</code>源会发出一条消息，其中包含<code i="955">TaskLaunchRequest</code>对象，其中包含所需的启动信息。</font><font o="2934">可以通过运行app register命令将<code i="956">triggertask</code>添加到可用的源中，如下所示（对于Rabbit Binder，在这种情况下）：</font></p>
</div>
<div class="paragraph">
<p><code>app register --type source --name triggertask --uri maven://org.springframework.cloud.stream.app:triggertask-source-rabbit:1.2.0.RELEASE</code></p>
</div>
<div class="paragraph">
<p><font o="2935">例如，要每60秒启动一次时间戳任务，流实现将如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>stream create foo --definition "triggertask --triggertask.uri=maven://org.springframework.cloud.task.app:timestamp-task:jar:1.2.0.RELEASE --trigger.fixed-delay=60 --triggertask.environment-properties='spring.datasource.url=jdbc:h2:tcp://localhost:19092/mem:dataflow,spring.datasource.username=sa' | task-launcher-local --maven.remote-repositories.repo1.url=http://repo.spring.io/libs-release" --deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2936">如果运行<code i="957">runtime apps</code>，则可以找到任务启动程序接收器的日志文件。</font><font o="2937">通过在该文件上使用<code i="958">tail</code>命令，可以找到已启动任务的日志文件。</font><font o="2938">设置<code i="959">triggertask.environment-properties</code>将数据流服务器的H2数据库建立为将记录任务执行的数据库。</font><font o="2939">然后，您可以使用shell命令<code i="960">task execution list</code>查看任务执行列表，如下所示，如下所示（及其输出）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;task execution list
╔════════════════════╤══╤════════════════════════════╤════════════════════════════╤═════════╗
║     Task Name      │ID│         Start Time         │          End Time          │Exit Code║
╠════════════════════╪══╪════════════════════════════╪════════════════════════════╪═════════╣
║timestamp-task_26176│4 │Tue May 02 12:13:49 EDT 2017│Tue May 02 12:13:49 EDT 2017│0        ║
║timestamp-task_32996│3 │Tue May 02 12:12:49 EDT 2017│Tue May 02 12:12:49 EDT 2017│0        ║
║timestamp-task_58971│2 │Tue May 02 12:11:50 EDT 2017│Tue May 02 12:11:50 EDT 2017│0        ║
║timestamp-task_13467│1 │Tue May 02 12:10:50 EDT 2017│Tue May 02 12:10:50 EDT 2017│0        ║
╚════════════════════╧══╧════════════════════════════╧════════════════════════════╧═════════╝</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tasklaunchrequest_transform">50.2.<font o="2941">TaskLaunchRequest变换</font></h3>
<div class="paragraph">
<p><font o="2942">使用<code i="961">task-launcher</code>启动任务的另一种方法是使用</font><a href="javascript:;"><font o="2942">Tasklaunchrequest-transform</font></a><font o="2942">处理器将消息有效负载转换为<code i="962">TaskLaunchRequest</code> </font><font o="2942">来创建流
 </font><font o="2942">。</font></p>
</div>
<div class="paragraph">
<p><font o="2943">可以通过执行app register命令将<code i="963">tasklaunchrequest-transform</code>添加到可用的处理器中，如下所示（对于Rabbit Binder，在这种情况下）：</font></p>
</div>
<div class="paragraph">
<p><code>app register --type processor --name tasklaunchrequest-transform --uri maven://org.springframework.cloud.stream.app:tasklaunchrequest-transform-processor-rabbit:1.2.0.RELEASE</code></p>
</div>
<div class="paragraph">
<p><font o="2944">以下示例显示了包含<code i="964">tasklaunchrequest-transform</code>的任务的创建：</font></p>
</div>
<div class="paragraph">
<p><code>stream create task-stream --definition "http --port=9000 | tasklaunchrequest-transform --uri=maven://org.springframework.cloud.task.app:timestamp-task:jar:1.2.0.RELEASE | task-launcher-local --maven.remote-repositories.repo1.url=http://repo.spring.io/libs-release"</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_launching_a_composed_task_from_a_stream">50.3.<font o="2946">从流中启动组合任务</font></h3>
<div class="paragraph">
<p><font o="2947">可以使用</font><a href="#spring-cloud-dataflow-launch-tasks-from-stream"><font o="2947">此处</font></a><font o="2947">讨论的<code i="965">task-launcher</code>接收器之一启动组合任务</font><font o="2947">。</font><font o="2948">由于我们直接使用<code i="966">ComposedTaskRunner</code>，因此我们需要在创建组合任务启动流之前设置它使用的任务定义。</font><font o="2949">假设我们想要创建以下组合任务定义：<code i="967">AAA &amp;&amp; BBB</code>。</font><font o="2950">第一步是创建任务定义，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>task create AAA --definition "timestamp"
task create BBB --definition "timestamp"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2951">现在我们已经准备好了组合任务定义所需的任务定义，我们需要创建一个启动<code i="968">ComposedTaskRunner</code>的流。</font><font o="2952">因此，在这种情况下，我们创建一个流</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="2953">每30秒发出一次消息的触发器</font></p>
</li>
<li>
<p><font o="2954">变压器，为收到的每条消息创建<code i="969">TaskLaunchRequest</code></font></p>
</li>
<li>
<p><font o="2955"><code i="970">task-launcher-local</code>接收器在我们的本地机器上启动<code i="971">ComposedTaskRunner</code></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="2956">该流应类似于以下内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>stream create ctr-stream --definition "time --fixed-delay=30 | tasklaunchrequest-transform --uri=maven://org.springframework.cloud.task.app:composedtaskrunner-task:&lt;current release&gt; --command-line-arguments='--graph=AAA&amp;&amp;BBB --increment-instance-enabled=true --spring.datasource.url=...' | task-launcher-local"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="2957">在前面的示例中，我们看到<code i="972">tasklaunchrequest-transform</code>正在建立两个主要组件：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><font o="2958">uri</font></strong><font o="2958">：使用的<code i="973">ComposedTaskRunner</code>的URI</font></p>
</li>
<li>
<p><strong><font o="2959">命令行参数</font></strong><font o="2959">：配置<code i="974">ComposedTaskRunner</code></font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="2960">目前，我们专注于启动<code i="975">ComposedTaskRunner</code>所需的配置：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><font o="2961">graph</font></strong><font o="2961">：这是由<code i="976">ComposedTaskRunner</code>执行的图表。</font><font o="2962">在这种情况下，它是<code i="977">AAA&amp;&amp;BBB</code>。</font></p>
</li>
<li>
<p><strong><font o="2963">increment-instance-enabled</font></strong><font o="2963">：这使<code i="978">ComposedTaskRunner</code>的每次执行都是唯一的。</font><font o="2964"><code i="979">ComposedTaskRunner</code>是使用</font><a href="javascript:;"><font o="2964">Spring Batch</font></a><font o="2964">构建的</font><font o="2964">。</font><font o="2965">因此，我们希望每次发布<code i="980">ComposedTaskRunner</code>时都有一个新的作业实例。</font><font o="2966">为此，我们将<code i="981">increment-instance-enabled</code>设置为<code i="982">true</code>。</font></p>
</li>
<li>
<p><strong><font o="2967">spring.datasource。</font></strong><font o="2968">*：Spring Cloud数据流使用的数据源，它允许用户跟踪<code i="983">ComposedTaskRunner</code>启动的任务和作业执行的状态。</font><font o="2969">此外，这使得<code i="984">ComposedTaskRunner</code>可以跟踪它启动的任务的状态并更新其状态。</font></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="2970">
可在</font><a href="javascript:;"><font o="2970">此处</font></a><font o="2970">找到<code i="985">ComposedTaskRunner</code>的版本
 </font><font o="2970">。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sharing-spring-cloud-dataflows-datastore-with-tasks"><font o="2971">51.与任务共享Spring Cloud Data Flow的数据存储</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="2972">正如在</font><a href="#spring-cloud-dataflow-task"><font o="2972">任务</font></a><font o="2972">文档Spring中</font><font o="2972">所讨论的，</font><font o="2972">云数据流允许用户查看Spring Cloud Task应用程序执行。</font><font o="2973">因此，在本节中，我们将讨论Task Application和Spring云数据流共享任务执行信息所需的内容。</font></p>
</div>
<div class="sect2">
<h3 id="_a_common_datastore_dependency">51.1.<font o="2975">通用DataStore依赖项</font></h3>
<div class="paragraph">
<p><font o="2976">Spring Cloud Data Flow支持许多</font><font o="2976">开箱即用的</font><font o="2976">数据库</font><a href="#rdbms"><font o="2976">类型</font></a><font o="2976">，因此所有用户通常要做的是声明<code i="986">spring_datasource_*</code>环境变量以建立需要的数据存储Spring Cloud Data Flow。</font><font o="2977">因此，您决定用于Spring Cloud Data Flow的任何数据库都要确保您的任务还在其<code i="987">pom.xml</code>或<code i="988">gradle.build</code>文件中包含该数据库依赖项。</font><font o="2978">如果任务应用程序中不存在Spring Cloud Data Flow使用的数据库依赖关系，则任务将失败并且不会记录任务执行。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_a_common_data_store">51.2.<font o="2980">通用数据存储</font></h3>
<div class="paragraph">
<p><font o="2981">Spring Cloud Data Flow并且您的任务应用程序必须访问同一数据存储区实例。</font><font o="2982">这样，任务应用程序记录的任务执行可以由Spring Cloud Data Flow读取，以在Shell和Dashboard视图中列出它们。</font><font o="2983">此外，任务应用程序必须具有Spring Cloud Data Flow使用的任务数据表的读写权限。</font></p>
</div>
<div class="paragraph">
<p><font o="2984">鉴于对Task应用程序和Spring Cloud Data Flow之间的Datasource依赖关系的理解，让我们回顾一下如何在各种Task Orchestration场景中应用它们。</font></p>
</div>
<div class="sect3">
<h4 id="_simple_task_launch">51.2.1.<font o="2986">简单的任务启动</font></h4>
<div class="paragraph">
<p><font o="2987">从Spring Cloud Data Flow启动任务时，数据流将其数据源属性（<code i="989">spring.datasource.url</code>，<code i="990">spring.datasource.driverClassName</code>，<code i="991">spring.datasource.username</code>，<code i="992">spring.datasource.password</code>）添加到正在启动的任务的应用程序属性中。</font><font o="2988">因此，任务应用程序将其任务执行信息记录到Spring Cloud Data Flow存储库。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_task_launcher_sink">51.2.2.<font o="2990">任务启动器接收器</font></h4>
<div class="paragraph">
<p><font o="2991">该</font><a href="javascript:;"><font o="2991">任务启动汇</font></a><font o="2991">允许通过流启动任务，讨论</font><a href="#spring-cloud-dataflow-launch-tasks-from-stream"><font o="2991">在这里</font></a><font o="2991">。</font><font o="2992">由于Task Launcher Sink启动的任务可能不希望它们的任务执行记录到与Spring Cloud Data Flow相同的数据存储区</font><font o="2992">
，因此Task Launcher Sink接收的</font><font o="2992">每个</font><a href="javascript:;"><font o="2992">TaskLaunchRequest</font></a><font o="2992">必须具有作为app属性或命令行参数建立的所需数据源信息。</font><font o="2993">既</font><a href="javascript:;"><font o="2993">TaskLaunchRequest-变换</font></a><font o="2993"> 
和</font><a href="javascript:;"><font o="2993">TriggerTask源</font></a><font o="2993">是源和一个处理器如何允许用户通过该应用属性或命令行参数设置的数据源属性的例子。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_composed_task_runner">51.2.3.<font o="2995">组成的任务运行器</font></h4>
<div class="paragraph">
<p><font o="2996">Spring Cloud Data Flow允许用户创建有向图，其中图的每个节点都是任务应用程序，这是通过
 </font><a href="javascript:;"><font o="2996">Composed Task Runner完成的</font></a><font o="2996">。</font><font o="2997">在这种情况下，应用于</font><a href="#datasource-simple-task-launch"><font o="2997">Simple Task Launch</font></a><font o="2997"> 
或</font><a href="#datasource-task-launcher-sink"><font o="2997">Task Launcher Sink</font></a><font o="2997">的规则也适用于组合</font><a href="#datasource-task-launcher-sink"><font o="2997">任务运行器</font></a><font o="2997">。</font><font o="2998">所有子应用程序还必须能够访问组合任务运行器正在使用的数据存储区。此外，所有子应用程序必须具有与其<code i="993">pom.xml</code>或<code i="994">gradle.build</code>文件中枚举的组合任务运行程序相同的数据库相关性。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_launching_a_task_externally_from_spring_cloud_data_flow">51.2.4.<font o="3000">从Spring Cloud Data Flow外部启动任务</font></h4>
<div class="paragraph">
<p><font o="3001">用户可能希望通过另一种方法（例如调度程序）启动Spring Cloud Task应用程序，但仍然通过Spring Cloud Data Flow跟踪任务执行。</font><font o="3002">只要任务应用程序遵守</font><a href="#a-common-datastore-dependency"><font o="3002">此处</font></a><font o="3002">和</font><a href="#a-common-datastore"><font o="3002">此处</font></a><font o="3002">指定的规则</font><font o="3002">，就可以执行</font><a href="#a-common-datastore"><font o="3002">此操作</font></a><font o="3002">。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="3003">
如果用户希望使用Spring Cloud Data Flow查看他们的
 </font><a href="javascript:;"><font o="3003">Spring Batch</font></a><font o="3003">作业，则用户必须确保他们的批处理应用程序使用<code i="995">@EnableTask</code>注释并遵循</font><a href="#a-common-datastore-dependency"><font o="3003">此处</font></a><font o="3003">和</font><a href="#a-common-datastore"><font o="3003">此处</font></a><font o="3003">列举的规则</font><font o="3003">。</font><font o="3004">更多信息可</font><a href="javascript:;"><font o="3004">在此处获得</font></a><font o="3004">。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-cloud-dataflow-schedule-launch-tasks"><font o="3005">52.安排任务</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3006">Spring Cloud Data Flow允许用户通过cron表达式安排任务的执行。</font><font o="3007">可以通过RESTful API或Spring Cloud Data Flow UI创建计划。</font></p>
</div>
<div class="sect2">
<h3 id="_the_scheduler">52.1.<font o="3009">调度程序</font></h3>
<div class="paragraph">
<p><font o="3010">Spring Cloud Data Flow将通过云平台上可用的调度代理安排其任务的执行。</font><font o="3011">使用Cloud Foundry平台Spring Cloud Data Flow时将使用</font><a href="javascript:;"><font o="3011">PCF调度程序</font></a><font o="3011">。</font><font o="3012">当使用Kubernetes，一个</font><a href="javascript:;"><font o="3012">的cronjob</font></a><font o="3012">将被使用。</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-scheduling-architecture.png" alt="调度程序架构概述">
</div>
<div class="title"><font o="3013">图18.架构概述</font></div>
</div>
</div>
<div class="sect2">
<h3 id="_enabling_scheduling">52.2.<font o="3015">启用计划</font></h3>
<div class="paragraph">
<p><font o="3016">默认情况下，Spring Cloud Data Flow会禁用调度功能。</font><font o="3017">要启用计划功能，必须将以下要素属性设置为<code i="996">true</code>：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>spring.cloud.dataflow.features.schedules-enabled</code></p>
</li>
<li>
<p><code>spring.cloud.dataflow.features.tasks-enabled</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_the_lifecycle_of_a_schedule">52.3.<font o="3019">附表的生命周期</font></h3>
<div class="paragraph">
<p><font o="3020">时间表的生命周期有两部分：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#spring-cloud-data-flow-schedule-scheduling"><font o="3021">安排任务执行</font></a></p>
</li>
<li>
<p><a href="#spring-cloud-data-flow-schedule-unscheduling"><font o="3022">删除计划</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="spring-cloud-data-flow-schedule-scheduling">52.3.1.<font o="3024">安排任务执行</font></h4>
<div class="paragraph">
<p><font o="3025">您可以通过以下方式安排任务执行：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3026">RESTful API</font></p>
</li>
<li>
<p><font o="3027">Spring Cloud Data Flow仪表板</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="3028">要从UI计划任务，请单击屏幕顶部的“任务”选项卡，这将转到“任务定义”屏幕。</font><font o="3029">然后，从要安排的任务定义中，单击与要安排的任务定义关联的“时钟”图标。</font><font o="3030">这将引导您进入<code i="997">Create Schedule(s)</code>屏幕，您将在其中为计划创建唯一名称并输入关联的cron表达式。</font><font o="3031">请记住，您始终可以为单个任务定义创建多个计划。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="spring-cloud-data-flow-schedule-unscheduling">52.3.2.<font o="3033">删除计划</font></h4>
<div class="paragraph">
<p><font o="3034">您可以通过以下方式删除计划：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3035">RESTful API</font></p>
</li>
<li>
<p><font o="3036">Spring Cloud Data Flow仪表板</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="3037">要通过仪表板删除计划，请选择“任务”选项卡下的“计划”选项卡，然后单击要删除的计划旁边的<code i="998">garbage can</code>图标。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="3038">
如果删除计划，则不会停止由计划代理运行的任何当前正在运行的任务。</font><font o="3039">它只能防止将来执行。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
<h1 id="task-dev-guide" class="sect0"><font o="3040">任务开发者指南</font></h1>
<div class="openblock partintro">
<div class="content"><font o="3041">
本节介绍如何在本地计算机上创建，测试和运行Spring Cloud Task应用程序。</font><font o="3042">它还显示了如何将这些应用程序映射到Spring Cloud Data Flow并进行部署。
</font></div>
</div>
<div class="sect1">
<h2 id="task-dev-guide-prebuilt-apps"><font o="3043">53.预建应用程序</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3044">该</font><a href="javascript:;"><font o="3044">Spring Cloud Task应用启动器</font></a><font o="3044">项目提供了可以开始使用的时候了很多应用。</font><font o="3045">例如，有一个时间戳应用程序将时间戳打印到控制台。</font><font o="3046">所有应用程序都基于</font><a href="javascript:;"><font o="3046">Spring Boot</font></a><font o="3046">和</font><a href="javascript:;"><font o="3046">Spring Cloud Task</font></a><font o="3046">。</font></p>
</div>
<div class="paragraph">
<p><font o="3047">应用程序将作为Maven工件和Docker镜像发布。</font><font o="3048">对于GA版本，Maven工件发布到Maven central和</font><a href="javascript:;"><font o="3048">Spring Release Repository</font></a><font o="3048">。</font><font o="3049">里程碑和快照版本分别发布到</font><a href="javascript:;"><font o="3049">Spring里程碑</font></a><font o="3049">和</font><a href="javascript:;"><font o="3049">Spring快照</font></a><font o="3049">存储库。</font><font o="3050">Docker镜像被推送到</font><a href="javascript:;"><font o="3050">Docker Hub</font></a></p>
</div>
<div class="paragraph">
<p><font o="3051">承载预构建应用程序的GA工件的Spring Repository的根位置是</font><a href="javascript:;" class="bare"><font o="3051">repo.spring.io/release/org/springframework/cloud/task/app/</font></a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="task-dev-guide-running-prebuilt-apps"><font o="3052">54.运行预建应用程序</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3053">您可以使用<code i="999">java -jar</code>运行时间戳应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="3054">要开始使用，请下载示例应用程序，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">wget https://repo.spring.io/libs-release/org/springframework/cloud/task/app/timestamp-task/1.3.0.RELEASE/timestamp-task-1.3.0.RELEASE.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="3055">该文件包含Spring Boot个应用程序，其中包含</font><a href="javascript:;"><font o="3055">Spring Boot Actuator</font></a><font o="3055">和</font><a href="javascript:;"><font o="3055">Spring Security Starter</font></a><font o="3055">。</font><font o="3056">您可以指定</font><a href="javascript:;"><font o="3056">常用的Spring Boot属性</font></a><font o="3056">来配置每个应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="3057">现在您可以运行时间戳应用程序，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">java -jar timestamp-task-1.3.0.RELEASE.jar --logging.level.org.springframework.cloud.task=DEBUG</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="3058">
使用<code i="1000">--logging.level.org.springframework.cloud.task=DEBUG</code>选项可以查看无法以其他方式写入控制台的输出。</font><font o="3059">因为Spring Cloud Task使用内存数据库来存储其结果（并且在运行结束时内存数据库被销毁），所以<code i="1001">DEBUG</code>选项是查看时间戳任务输出的唯一方法。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="3060">时间戳应用程序显示以下输出（在其他输出中）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">2018-03-12 13:45:14.583  INFO 4810 --- [           main] TimestampTaskConfiguration$TimestampTask : 2018-03-12 13:45:14.583
2018-03-12 13:45:14.609 DEBUG 4810 --- [           main] o.s.c.t.r.support.SimpleTaskRepository   : Updating: TaskExecution with executionId=1 with the following {exitCode=0, endTime=Mon Mar 12 13:45:14 CDT 2018, exitMessage='null', errorMessage='null'}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="3061">第一行显示Timestamp任务生成的时间戳。</font><font o="3062">第二行显示退出代码为0且没有错误。</font><font o="3063">如果发生错误，退出代码将不是0，<code i="1002">errorMessage</code>将显示抛出的异常。</font></p>
</div>
<div class="paragraph">
<p><font o="3064">如果打开了调试模式，则可以获得更多信息，如下所示（如果打开了调试模式，则会出现在时间戳之前）：</font></p>
</div>
<div class="paragraph">
<p><code>2018-03-14 13:47:16.659 DEBUG 78382 --- [ main] o.s.c.t.r.support.SimpleTaskRepository : Creating: TaskExecution{executionId=0, parentExecutionId=null, exitCode=null, taskName='application', startTime=Wed Mar 14 13:47:16 EDT 2018, endTime=null, exitMessage='null', externalExecutionId='null', errorMessage='null', arguments=[]}</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="task-dev-guide-building-timestamp-task"><font o="3065">55.构建时间戳任务</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3066">要构建自己的时间戳任务，请遵循以下每个过程：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#task-dev-guide-building-timestamp-task-from-initializr"><font o="3067">开发时间戳应用程序</font></a></p>
</li>
<li>
<p><a href="#task-dev-guide-building-timestamp-task-recording-error"><font o="3068">录制错误</font></a></p>
</li>
<li>
<p><a href="#task-dev-guide-building-timestamp-task-adding-pre-post-processing"><font o="3069">添加预处理和后处理</font></a></p>
</li>
<li>
<p><a href="#task-dev-guide-building-timestamp-task-bonus-adding-mysql"><font o="3070">添加MySQL数据库</font></a></p>
</li>
<li>
<p><a href="#task-dev-guide-building-timestamp-adding-tasks-to-dataflow"><font o="3071">使用数据流添加和启动Spring Cloud任务</font></a></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="task-dev-guide-building-timestamp-task-from-initializr"><font o="3072">56.开发时间戳应用程序</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3073">现在我们已经使用了预先构建的时间戳任务应用程序，让我们创建一个自己的应用程序。</font></p>
</div>
<div class="sect2">
<h3 id="task-dev-guide-creating-project">56.1.<font o="3075">使用Spring Initializr创建Spring任务项目</font></h3>
<div class="paragraph">
<p><font o="3076">现在让我们创建并测试一个将当前时间打印到控制台的应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="3077">为此：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="3078">访问</font><a href="javascript:;"><font o="3078">Spring Initialzr</font></a><font o="3078">网站。</font></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><font o="3079">创建一个新的Maven或Gradle项目，其</font><strong><font o="3079">组</font></strong><font o="3079">名为<code i="1003">io.spring.task.sample</code>，</font><strong><font o="3079">工件</font></strong><font o="3079">名称为<code i="1004">timestamp</code>。</font></p>
</li>
<li>
<p><font o="3080">在“依赖关系”文本框中，键入<code i="1005">task</code>以选择<code i="1006">Cloud Task</code>依赖关系。</font></p>
</li>
<li>
<p><font o="3081">在“依赖关系”文本框中，键入<code i="1007">jdbc</code>，然后选择<code i="1008">JDBC</code>依赖关系。</font></p>
</li>
<li>
<p><font o="3082">在“依赖关系”文本框中，键入<code i="1009">h2</code>，然后选择<code i="1010">H2</code>。</font><font o="3083">（或您最喜欢的数据库）</font></p>
</li>
<li>
<p><font o="3084">单击“ </font><strong><font o="3084">生成项目”</font></strong><font o="3084">按钮</font></p>
</li>
</ol>
</div>
</li>
<li>
<p><font o="3085">解压缩timestamp.zip文件并将项目导入您喜欢的IDE。</font></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="getting-started-writing-the-code">56.2.<font o="3087">编写代码</font></h3>
<div class="paragraph">
<p><font o="3088">要完成我们的应用程序，我们需要使用以下内容修改生成的<code i="1011">TimestampApplication</code>代码，以便它将启动任务。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">package io.spring.task.sample.timestamp;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;

import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.cloud.task.configuration.EnableTask;
import org.springframework.context.annotation.Bean;

@SpringBootApplication
@EnableTask
public class TimestampApplication {

	@Bean
	public CommandLineRunner commandLineRunner() {
		return new TimestampCommandLineRunner();
	}

	public static void main(String[] args) {
		SpringApplication.run(TimestampApplication.class, args);
	}

	public static class TimestampCommandLineRunner implements CommandLineRunner {

		@Override
		public void run(String... strings) throws Exception {
			DateFormat dateFormat = new SimpleDateFormat("YYYY-MM-dd HH:ss");
			System.out.println(dateFormat.format(new Date()));
		}
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="3089">所述</font><a href="javascript:;"><font o="3089">@EnableTask</font></a><font o="3089">注释设置<code i="1012">TaskRepository</code>存储关于任务执行的信息，如任务和退出代码的开始和结束时间。</font></p>
</div>
<div class="paragraph">
<p><font o="3090">在我们的演示中，<code i="1013">TaskRepository</code>使用嵌入式H2数据库来记录任务的结果。</font><font o="3091">这个H2嵌入式数据库不是生产环境的实用解决方案，因为一旦任务结束，H2数据库就会消失。</font><font o="3092">但是，为了快速入门体验，我们将在我们的示例中使用它，并在日志中回显该存储库中正在更新的内容。</font></p>
</div>
<div class="paragraph">
<p><font o="3093">所述</font><a href="javascript:;"><font o="3093">CommandLineRunner</font></a><font o="3093">是Spring Boot接口告诉引导在<code i="1014">run</code>方法来执行代码一次。</font><font o="3094">当我们的示例应用程序运行时，Spring Boot启动我们的<code i="1015">TimestampCommandLineRunner</code>并将我们的时间戳消息输出到标准输出。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="3095">
从<code i="1016">CommandLineRunner</code>或<code i="1017">ApplicationRunner</code>以外的机制（例如，使用<code i="1018">InitializingBean#afterPropertiesSet</code>）引导的任何处理都不会被Spring Cloud Task记录。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="3096">现在让我们打开<code i="1020">src/main/resources</code>中的<code i="1019">application.properties</code>文件并配置两个属性，即应用程序名称和日志记录。</font><font o="3097">应用程序名称也用作任务的名称。</font><font o="3098">日志记录级别设置为<code i="1021">DEBUG</code>，因此我们可以看到有关内部情况的更多信息。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>logging.level.org.springframework.cloud.task=DEBUG
spring.application.name=timestamp</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="getting-started-running-the-example">56.3.<font o="3100">运行示例</font></h3>
<div class="paragraph">
<p><font o="3101">此时，我们的应用程序应该工作。</font><font o="3102">由于此应用程序基于Spring Boot，因此我们可以从命令行使用来自应用程序根目录的<code i="1022">./mvnw spring-boot:run</code>运行它，如下图所示（及其输出）：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>$ ./mvnw clean spring-boot:run
....... . . .
....... . . . (Maven log output here)
....... . . .

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v2.0.3.RELEASE)

2018-07-26 12:01:47.236  INFO 93883 --- [           main] i.s.t.s.timestamp.TimestampApplication   : Starting TimestampApplication on Glenns-MacBook-Pro-2.local with PID 93883 (/Users/glennrenfro/project/timestamp/target/classes started by glennrenfro in /Users/glennrenfro/project/timestamp)
2018-07-26 12:01:47.241  INFO 93883 --- [           main] i.s.t.s.timestamp.TimestampApplication   : No active profile set, falling back to default profiles: default
2018-07-26 12:01:47.280  INFO 93883 --- [           main] s.c.a.AnnotationConfigApplicationContext : Refreshing org.spring<a href="email-protection.html" class="__cf_email__" data-cfemail="3d5b4f5c50584a524f56135e525349584549135c535352495c49545253137c535352495c495452537e52535b545a7c4d4d51545e5c495452537e5253495845497d">[email&#160;protected]</a>50b87e67: startup date [Thu Jul 26 12:01:47 EDT 2018]; root of context hierarchy
2018-07-26 12:01:47.989  INFO 93883 --- [           main] o.s.j.d.e.EmbeddedDatabaseFactory        : Starting embedded database: url='jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=false', username='sa'
2018-07-26 12:01:48.144 DEBUG 93883 --- [           main] o.s.c.t.c.SimpleTaskConfiguration        : Using org.springframework.cloud.task.configuration.DefaultTaskConfigurer TaskConfigurer
2018-07-26 12:01:48.145 DEBUG 93883 --- [           main] o.s.c.t.c.DefaultTaskConfigurer          : No EntityManager was found, using DataSourceTransactionManager
2018-07-26 12:01:48.227 DEBUG 93883 --- [           main] o.s.c.t.r.s.TaskRepositoryInitializer    : Initializing task schema for h2 database
2018-07-26 12:01:48.229  INFO 93883 --- [           main] o.s.jdbc.datasource.init.ScriptUtils     : Executing SQL script from class path resource [org/springframework/cloud/task/schema-h2.sql]
2018-07-26 12:01:48.261  INFO 93883 --- [           main] o.s.jdbc.datasource.init.ScriptUtils     : Executed SQL script from class path resource [org/springframework/cloud/task/schema-h2.sql] in 32 ms.
2018-07-26 12:01:48.407  INFO 93883 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup
2018-07-26 12:01:48.412  INFO 93883 --- [           main] o.s.c.support.DefaultLifecycleProcessor  : Starting beans in phase 0
2018-07-26 12:01:48.428 DEBUG 93883 --- [           main] o.s.c.t.r.support.SimpleTaskRepository   : Creating: TaskExecution{executionId=0, parentExecutionId=null, exitCode=null, taskName='timestamp', startTime=Thu Jul 26 12:01:48 EDT 2018, endTime=null, exitMessage='null', externalExecutionId='null', errorMessage='null', arguments=[]}
2018-07-26 12:01:48.439  INFO 93883 --- [           main] i.s.t.s.timestamp.TimestampApplication   : Started TimestampApplication in 1.464 seconds (JVM running for 4.233)
2018-07-26 12:48
2018-07-26 12:01:48.457 DEBUG 93883 --- [           main] o.s.c.t.r.support.SimpleTaskRepository   : Updating: TaskExecution with executionId=1 with the following {exitCode=0, endTime=Thu Jul 26 12:01:48 EDT 2018, exitMessage='null', errorMessage='null'}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="3103">前面的输出有三条我们感兴趣的行：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3104"><code i="1023">SimpleTaskRepository</code>记录了<code i="1024">TaskRepository</code>中条目的创建。</font></p>
</li>
<li>
<p><font o="3105">我们的<code i="1025">CommandLineRunner</code>的执行，由时间戳输出演示。</font></p>
</li>
<li>
<p><font o="3106"><code i="1026">SimpleTaskRepository</code>记录<code i="1027">TaskRepository</code>中任务的完成情况。</font></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="task-dev-guide-building-timestamp-task-recording-error">56.4.<font o="3108">录制错误</font></h3>
<div class="paragraph">
<p><font o="3109">现在我们有了一个工作任务，我们可以故意创建一个错误，以显示Spring Cloud Task如何处理错误。</font><font o="3110">为此：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="3111">打开<code i="1028">src/main/java/io/spring/task/sample/timestamp/TimestampApplication.java</code>并将以下行插入run方法：</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">throw new IllegalStateException("No Task For You!");</code></pre>
</div>
</div>
</li>
<li>
<p><font o="3112">从命令行运行<code i="1029">./mvnw clean spring-boot:run -DskipTests</code>。</font></p>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="3113">
我们必须添加<code i="1030">-DskipTests</code>，因为测试会捕获我们添加的Exception并阻止我们看到它。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="3114">现在我们可以看到我们在输出中添加的异常，作为带有堆栈跟踪的异常。</font><font o="3115">任务现在已捕获此异常并将其记录到数据库中。</font><font o="3116">这可以在控制台中看到，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>Updating: TaskExecution with executionId=1 with the following {exitCode=1, endTime=Wed Jul 25 12:42:15 EDT 2018, exitMessage='null', errorMessage='java.lang.IllegalStateException: Failed to execute CommandLineRunner
...</code></pre>
</div>
</div>
</li>
<li>
<p><font o="3117">删除或注释掉异常，以便下一课可以正常工作。</font></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="task-dev-guide-building-timestamp-task-adding-pre-post-processing">56.5.<font o="3119">添加预处理和后处理</font></h3>
<div class="paragraph">
<p><font o="3120">Spring Cloud Task包括在任务之前和之后运行其他处理的能力。</font><font o="3121">要将这两个功能添加到当前示例应用程序：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="3122">打开<code i="1031">src/main/java/io/spring/TimestampApplication.java</code>并将以下代码添加到TimestampCommandLineRunner：</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">@BeforeTask
public void beforeTask(TaskExecution taskExecution) {
  System. out.println("Before TASK");
}

@AfterTask
public void afterTask(TaskExecution taskExecution) {
  System. out.println("After TASK");
}</code></pre>
</div>
</div>
</li>
<li>
<p><font o="3123">从命令行运行<code i="1032">./mvnw clean spring-boot:run</code>。</font></p>
<div class="paragraph">
<p><font o="3124">现在输出包括打印<code i="1033">BEFORE TASK</code>和<code i="1034">AFTER TASK</code>的行。</font></p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="task-dev-guide-building-timestamp-task-bonus-adding-mysql">56.6.<font o="3126">添加MySQL数据库</font></h3>
<div class="paragraph">
<p><font o="3127">几乎总是，真实世界Spring Cloud Task需要使用持久性（而不是内存中）数据库。</font><font o="3128">在这个例子中，我们展示了如何将MySQL数据库（MariaDB）添加到我们的Task中。</font><font o="3129">为此：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="3130">打开<code i="1035">pom.xml</code>文件。</font></p>
</li>
<li>
<p><font o="3131">添加以下依赖项：</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.mariadb.jdbc&lt;/groupId&gt;
  &lt;artifactId&gt;mariadb-java-client&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</li>
<li>
<p><font o="3132">例如，从命令行设置MySql的数据库连接属性</font></p>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>export spring_datasource_url=jdbc:mysql://localhost:3306/practice
export spring_datasource_username=root
export spring_datasource_password=password
export spring_datasource_driverClassName=org.mariadb.jdbc.Driver</code></pre>
</div>
</div>
</li>
<li>
<p><font o="3133">从命令行运行<code i="1036">./mvnw clean spring-boot:run</code>。</font></p>
<div class="paragraph">
<p><font o="3134">如果检查数据库的内容，现在应该在<code i="1037">TASK_EXECUTION</code>表中看到该任务。</font></p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="task-dev-guide-building-timestamp-adding-tasks-to-dataflow"><font o="3135">57.使用数据流添加和启动Spring Cloud任务</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3136">本指南介绍了注册和启动Spring Cloud Task应用程序。</font><font o="3137">它包括以下程序：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#task-dev-guide-building-batch-task-creating-first-task"><font o="3138">注册并启动您的第一个任务</font></a></p>
</li>
<li>
<p><a href="#task-dev-guide-building-batch-task-creating-first-batch-task"><font o="3139">注册并启动您的第一个Spring Batch  - 任务</font></a></p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="task-dev-guide-building-batch-task-creating-first-task">57.1.<font o="3141">注册并启动您的第一个任务</font></h3>
<div class="paragraph">
<p><font o="3142">运行Spring Cloud Data Flow Server和Shell后，可以使用以下过程创建第一个任务：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="3143">通过Spring Cloud Data Flow Shell使用以下命令导入注册，注册一组基本任务：</font></p>
<div class="paragraph">
<p><code>app register --name timestamp --type task --uri maven://org.springframework.cloud.task.app:timestamp-task:1.3.0.RELEASE</code></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="3144">
此示例显示如何从Maven存储库注册任务。
</font></td>
</tr>
</tbody></table>
</div>
</li>
<li>
<p><font o="3145">通过在Spring Cloud Data Flow Shell中运行以下命令来验证时间戳任务应用程序是否已注册：</font></p>
<div class="paragraph">
<p><code>app list</code></p>
</div>
<div class="paragraph">
<p><font o="3146">应显示以下输出：</font></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="static/picture/dataflow-shell-app-list.png" alt="dataflow shell应用程序列表"></span></p>
</div>
</li>
<li>
<p><font o="3147">使用Spring Cloud Data Flow Shell中的以下命令创建使用时间戳任务的任务定义：</font></p>
<div class="paragraph">
<p><code>task create --name myStamp --definition "timestamp"</code></p>
</div>
<div class="paragraph">
<p><font o="3148">您应该看到一条消息“创建新任务'myStamp'”。</font></p>
</div>
</li>
<li>
<p><font o="3149">使用以下命令启动新任务：</font></p>
<div class="paragraph">
<p><code>task launch myStamp</code></p>
</div>
<div class="paragraph">
<p><font o="3150">您应该看到一条消息“启动任务`myStamp`”。</font></p>
</div>
</li>
<li>
<p><font o="3151">通过在Spring Cloud Data Flow Shell中运行以下命令来验证您的任务是否已成功运行：<code i="1038">task execution list</code></font></p>
<div class="paragraph">
<p><font o="3152">您应该看到类似于以下内容的输出：</font></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="static/picture/dataflow-task-execution-list-tim.png" alt="数据流任务执行列表时间戳"></span></p>
</div>
<div class="paragraph">
<p><font o="3153">退出代码0告诉我们该任务运行没有错误。</font></p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="task-dev-guide-building-batch-task-creating-first-batch-task">57.2.<font o="3155">注册并启动您的第一个Spring Batch  - 任务</font></h3>
<div class="paragraph">
<p><font o="3156">实质上，Batch-Task是一个包含<code i="1039">@EnableTask</code>注释的Spring Batch应用程序，用作Spring Batch应用程序使用Spring Cloud Task的指示符。</font><font o="3157">Spring Boot照顾我们的其余部分。</font></p>
</div>
<div class="paragraph">
<p><font o="3158">注册您的第一个Spring Batch任务：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="3159">在Spring Cloud Data Flow Shell中，使用以下命令注册Spring Batch任务应用程序：</font></p>
<div class="paragraph">
<p><code>app register --name batch-events --type task --uri maven://org.springframework.cloud.task.app:timestamp-batch-task:2.0.0.RELEASE</code></p>
</div>
</li>
<li>
<p><font o="3160">要验证您的应用程序是否已注册，请在Spring Cloud Data Flow Shell中运行以下命令：</font></p>
<div class="paragraph">
<p><code>app list</code></p>
</div>
<div class="paragraph">
<p><font o="3161">您应该看到类似于以下内容的输出：</font></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="static/picture/dataflow-app-list-batch-event.png" alt="数据流应用列表批处理事件"></span></p>
</div>
</li>
<li>
<p><font o="3162">通过运行以下命令，创建使用批处理事件任务的任务定义：</font></p>
<div class="paragraph">
<p><code>task create --name myBatchTask --definition "batch-events"</code></p>
</div>
<div class="paragraph">
<p><font o="3163">您应该看到一条消息“创建新任务'myBatchTask'”。</font></p>
</div>
</li>
<li>
<p><font o="3164">通过运行以下命令启动批处理任务：</font></p>
<div class="paragraph">
<p><code>task launch myBatchTask</code></p>
</div>
<div class="paragraph">
<p><font o="3165">您应该看到一条消息“启动任务`myBatchTask`”。</font></p>
</div>
</li>
<li>
<p><font o="3166">验证任务是否已运行，运行以下命令：</font></p>
<div class="paragraph">
<p><code>task execution list</code></p>
</div>
<div class="paragraph">
<p><font o="3167">您应该看到类似于以下内容的输出：</font></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="static/picture/dataflow-task-execution-list-bat.png" alt="数据流任务执行列表批处理事件"></span></p>
</div>
<div class="paragraph">
<p><font o="3168">我们现在可以验证该任务是否作为批处理作业。</font><font o="3169">在</font><a href="#task-dev-guide-building-batch-task-verify-batch-task"><font o="3169">接下来的章节</font></a><font o="3169">将介绍如何做到这一点。</font></p>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="task-dev-guide-building-batch-task-verify-batch-task">57.2.1.<font o="3171">验证您的任务是批处理</font></h4>
<div class="paragraph">
<p><font o="3172">创建并运行Batch-Task时，它既是Spring Cloud Task实例又是Spring Batch实例。</font><font o="3173">在上</font><a href="#task-dev-guide-building-batch-task-creating-first-batch-task"><font o="3173">一节中</font></a><font o="3173">，我们了解了如何验证您的第一个批处理任务是否作为一项任务。</font><font o="3174">本节逐步介绍如何验证它是否也作为批处理工作。</font><font o="3175">为此：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="3176">运行以下命令以查看已运行的作业列表：</font></p>
<div class="paragraph">
<p><code>job execution list</code></p>
</div>
<div class="paragraph">
<p><font o="3177">您应该看到类似于以下内容的输出：</font></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="static/picture/dataflow-job-execution-list.png" alt="数据流作业执行列表"></span></p>
</div>
</li>
<li>
<p><font o="3178">请注意ID列中的作业ID（在本例中，我们要查看<code i="1040">2</code>）。</font></p>
</li>
<li>
<p><font o="3179">要获取作业执行的详细信息，我们可以在以下命令中使用作业ID：</font></p>
<div class="paragraph">
<p><code>job execution display --id 1</code></p>
</div>
<div class="paragraph">
<p><font o="3180">您应该看到类似于以下内容的输出：</font></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="static/picture/dataflow-job-execution-details.png" alt="数据流作业执行细节"></span></p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="task-dev-guide-database-requirement"><font o="3181">58.在Spring Cloud Data Flow中运行任务的数据库要求</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3182">如前所述，Spring Cloud Task记录了每个任务执行到关系数据库的状态。</font><font o="3183">因此，当用户请求任务或批处理作业执行信息时，Spring Cloud Data Flow使用此记录的信息。</font><font o="3184">此外，Spring Batch和Spring Cloud Task提供允许Spring Cloud Data Flow传达某些开始或停止行为的功能。</font><font o="3185">一个示例是当用户使用Spring Cloud Data Flow UI停止Spring Batch应用程序执行时。</font></p>
</div>
</div>
</div>
<h1 id="dashboard" class="sect0"><font o="3186">仪表板</font></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p><font o="3187">本节介绍如何使用Spring Cloud Data Flow的仪表板。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dashboard-introduction"><font o="3188">59.简介</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3189">Spring Cloud Data Flow提供了一个基于浏览器的GUI，称为仪表板，用于管理以下信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><font o="3190">应用程序</font></strong><font o="3190">：“应用程序”选项卡列出所有可用的应用程序，并提供注册/取消注册它们的控件。</font></p>
</li>
<li>
<p><strong><font o="3191">运行时</font></strong><font o="3191">：“运行时”选项卡提供所有正在运行的应用程序的列表。</font></p>
</li>
<li>
<p><strong><font o="3192">Streams</font></strong><font o="3192">：Streams选项卡允许您列出，设计，创建，部署和销毁流定义。</font></p>
</li>
<li>
<p><strong><font o="3193">任务</font></strong><font o="3193">：“任务”选项卡允许您列出，创建，启动，计划和销毁任务定义。</font></p>
</li>
<li>
<p><strong><font o="3194">作业</font></strong><font o="3194">：“作业”选项卡允许您执行批处理作业相关的功能。</font></p>
</li>
<li>
<p><strong><font o="3195">分析</font></strong><font o="3195">：“分析”选项卡允许您为各种分析应用程序创建数据可视化。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="3196">在启动Spring Cloud Data Flow时，仪表板可在以下位置获得：</font></p>
</div>
<div class="paragraph">
<p><code><a href="javascript:;" class="bare">&lt;host&gt;:&lt;port&gt;/dashboard</a></code></p>
</div>
<div class="paragraph">
<p><font o="3197">例如，如果Spring Cloud Data Flow在本地运行，则仪表板在<code i="1041">http://localhost:9393/dashboard</code>处可用。</font></p>
</div>
<div class="paragraph">
<p><font o="3198">如果您已启用https，则仪表板将位于<code i="1042">https://localhost:9393/dashboard</code>。</font><font o="3199">如果您已启用安全性，则可在<code i="1043">http://localhost:9393/dashboard/#/login</code>处获得登录表单。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="3200">
默认的仪表板服务器端口为<code i="1044">9393</code>。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="3201">下图显示了Spring Cloud Data Flow仪表板的开始页面：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-dashboard-about.png" alt="Spring Cloud数据流仪表板">
</div>
<div class="title"><font o="3202">图19. Spring Cloud Data Flow仪表板</font></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dashboard-apps"><font o="3203">60.应用程序</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3204">仪表板的“应用程序”部分列出了所有可用的应用程序，并提供了注册和取消注册它们的控件（如果适用）。</font><font o="3205">可以使用批量导入应用程序操作一次导入多个应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="3206">下图显示了仪表板中可用应用程序的典型列表：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-available-apps-list.png" alt="可用应用程序列表">
</div>
<div class="title"><font o="3207">图20.可用应用程序列表</font></div>
</div>
<div class="sect2">
<h3 id="_bulk_import_of_applications">60.1.<font o="3209">批量导入应用程序</font></h3>
<div class="paragraph">
<p><font o="3210">批量导入应用程序页面提供了许多用于一次定义和导入一组应用程序的选项。</font><font o="3211">对于批量导入，应用程序定义应以属性样式表示，如下所示：</font></p>
</div>
<div class="paragraph">
<p><code>&lt;type&gt;.&lt;name&gt; = &lt;coordinates&gt;</code></p>
</div>
<div class="paragraph">
<p><font o="3212">以下示例显示了典型的应用程序定义：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code>task.timestamp=maven://org.springframework.cloud.task.app:timestamp-task:1.2.0.RELEASE
processor.transform=maven://org.springframework.cloud.stream.app:transform-processor-rabbit:1.2.0.RELEASE</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="3213">在批量导入页面的顶部，可以指定一个指向存储在别处的属性文件的URI，它应该包含如上例所示格式化的属性。</font><font o="3214">或者，通过使用标记为“Apps as Properties”的文本框，您可以直接列出每个属性字符串。</font><font o="3215">最后，如果属性存储在本地文件中，则“选择Properties文件”选项将打开本地文件浏览器以选择文件。</font><font o="3216">通过其中一个路径设置定义后，单击“导入”。</font></p>
</div>
<div class="paragraph">
<p><font o="3217">下图显示了批量导入应用程序页面：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-bulk-import-application.png" alt="批量导入应用程序">
</div>
<div class="title"><font o="3218">图21.批量导入应用程序</font></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dashboard-runtime"><font o="3219">61.运行时</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3220">Dashboard应用程序的Runtime部分显示所有正在运行的应用程序的列表。</font><font o="3221">对于每个运行时应用程序，将显示部署状态和已部署实例的数量。</font><font o="3222">单击App Id可以使用已使用的部署属性列表。</font></p>
</div>
<div class="paragraph">
<p><font o="3223">下图显示了正在使用的运行时选项卡的示例：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-runtime.png" alt="正在运行的应用程序列">
</div>
<div class="title"><font o="3224">图22.运行的应用程序列表</font></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dashboard-streams"><font o="3225">62.流</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3226">Streams选项卡有两个子选项卡：Definitions和Create Stream。</font><font o="3227">以下主题描述了如何使用每个主题：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#dashboard-stream-definitions"><font o="3228">使用流定义</font></a></p>
</li>
<li>
<p><a href="#dashboard-flo-streams-designer"><font o="3229">创建流</font></a></p>
</li>
<li>
<p><a href="#dashboard-stream-deploy"><font o="3230">部署流</font></a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="dashboard-stream-definitions">62.1.<font o="3232">使用流定义</font></h3>
<div class="paragraph">
<p><font o="3233">仪表板的Streams部分包含Definitions选项卡，该选项卡提供Stream定义列表。</font><font o="3234">您可以选择部署或取消部署这些流定义。</font><font o="3235">此外，您可以通过单击Destroy删除定义。</font><font o="3236">每行包含左侧的箭头，您可以单击该箭头以查看定义的直观表示。</font><font o="3237">将鼠标悬停在可视化表示中的框上会显示有关应用程序的更多详细信息，包括传递给它们的任何选项。</font></p>
</div>
<div class="paragraph">
<p><font o="3238">在以下屏幕截图中，<code i="1045">timer</code>流已展开以显示可视化表示：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-streams-list-definition.png" alt="流定义列表">
</div>
<div class="title"><font o="3239">图23.流定义列表</font></div>
</div>
<div class="paragraph">
<p><font o="3240">如果单击详细信息按钮，视图将更改为显示该流和任何相关流的可视化表示。</font><font o="3241">在前面的示例中，如果单击<code i="1046">timer</code>流的详细信息，则视图将更改为以下视图，该视图清楚地显示三个流之间的关系（其中两个流正在点击<code i="1047">timer</code>流）：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-stream-details.png" alt="流细节页面">
</div>
<div class="title"><font o="3242">图24.流详细信息页面</font></div>
</div>
</div>
<div class="sect2">
<h3 id="dashboard-flo-streams-designer">62.2.<font o="3244">创建流</font></h3>
<div class="paragraph">
<p><font o="3245">仪表板的Streams部分包括Create Stream选项卡，该选项卡使</font><a href="javascript:;"><font o="3245">Spring Flo</font></a><font o="3245">设计器</font><font o="3245">可用</font><font o="3245">：一个画布应用程序，它提供用于创建数据管道的交互式图形界面。</font></p>
</div>
<div class="paragraph">
<p><font o="3246">在此选项卡中，您可以：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3247">使用DSL，图形画布或两者创建，管理和可视化流管道</font></p>
</li>
<li>
<p><font o="3248">通过DSL编写管道，内容辅助和自动完成</font></p>
</li>
<li>
<p><font o="3249">在GUI中使用自动调整和网格布局功能，以实现更简单和交互式的管道组织</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="3250">您应该观看此</font><a href="javascript:;"><font o="3250">截屏视频</font></a><font o="3250">，其中突出显示了一些“Flo for Spring Cloud Data Flow”功能。</font><font o="3251">Spring Flo </font><a href="javascript:;"><font o="3251">wiki</font></a><font o="3251">包含有关核心Flo功能的更详细内容。</font></p>
</div>
<div class="paragraph">
<p><font o="3252">下图显示了正在使用的Flo设计器：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-flo-create-stream.png" alt="Flo for Spring Cloud Data Flo">
</div>
<div class="title"><font o="3253">图25. Spring Cloud Data Flow的Flo</font></div>
</div>
</div>
<div class="sect2">
<h3 id="dashboard-stream-deploy">62.3.<font o="3255">部署流</font></h3>
<div class="paragraph">
<p><font o="3256">流部署页面包括选项卡，这些选项卡提供了设置部署属性和部署流的不同方法。</font><font o="3257">以下屏幕截图显示了<code i="1048">foobar</code>（<code i="1049">time | log</code>）的流部署页面。</font></p>
</div>
<div class="paragraph">
<p><font o="3258">您可以使用以下命令定义部署属性：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3259">表单构建器选项卡：一个帮助您定义部署属性的构建器（部署程序，应用程序属性......）</font></p>
</li>
<li>
<p><font o="3260">自由文本选项卡：免费textarea（键/值对）</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="3261">您可以在两个视图之间切换，表单构建器提供更强大的输入验证。</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-stream-deploy-builder.png" alt="表单构建器">
</div>
<div class="title"><font o="3262">图26.下图显示了表单构建器</font></div>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-stream-deploy-freetext.png" alt="自由文本">
</div>
<div class="title"><font o="3263">图27.下图显示了自由文本中的相同属性</font></div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_fan_in_fan_out_streams">62.4.<font o="3265">创建扇入/扇出流</font></h3>
<div class="paragraph">
<p><font o="3266">在</font><a href="#spring-cloud-dataflow-stream-dsl-fanin-fanout"><font o="3266">Fan-in和Fan-out</font></a><font o="3266">章节</font><a href="#spring-cloud-dataflow-stream-dsl-fanin-fanout"><font o="3266">中，</font></a><font o="3266">您了解了我们如何使用</font><a href="#spring-cloud-dataflow-stream-dsl-named-destinations"><font o="3266">命名目标</font></a><font o="3266">支持扇入和扇出用例</font><font o="3266">。</font><font o="3267">UI还为命名目标提供专用支持：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-flo-create-stream-fanin.png" alt="扇入和扇出示例">
</div>
<div class="title"><font o="3268">图28. Spring Cloud Data Flow的Flo</font></div>
</div>
<div class="paragraph">
<p><font o="3269">在此示例中，我们将来自</font><em><font o="3269">HTTP Source</font></em><font o="3269">和</font><em><font o="3269">JDBC Source的</font></em><font o="3269">数据</font><font o="3269">发送到</font><em><font o="3269">sharedData</font></em><font o="3269">通道，</font><font o="3269">该
 </font><font o="3269">通道代表</font><strong><font o="3269">Fan-in</font></strong><font o="3269">用例。</font><font o="3270">另一方面，我们有一个</font><em><font o="3270">Cassandra Sink</font></em><font o="3270">和一个</font><font o="3270">订阅了</font><em><font o="3270">sharedData</font></em><font o="3270">通道</font><font o="3270">的</font><em><font o="3270">File Sink</font></em><font o="3270">，</font><font o="3270">它代表了一个</font><strong><font o="3270">扇出</font></strong><font o="3270">用例。</font><em><font></font></em><font></font><strong><font></font></strong><font></font></p>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_tap_stream">62.5.<font o="3272">创建点按流</font></h3>
<div class="paragraph">
<p><font o="3273">使用仪表板创建水龙头非常简单。</font><font o="3274">假设您有一个由</font><em><font o="3274">HTTP Source</font></em><font o="3274">和</font><em><font o="3274">File Sink</font></em><font o="3274">组成的流</font><font o="3274">，您希望利用该流来将数据发送到</font><em><font o="3274">JDBC Sink</font></em><font o="3274">。</font><font o="3275">为了创建tap流，只需将</font><em><font o="3275">HTTP Source</font></em><font o="3275">的输出连接器连接</font><font o="3275">到</font><em><font o="3275">JDBC Sink</font></em><font o="3275">。</font><font o="3276">连接将显示为虚线，表示您创建了一个点按流。</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-flo-create-tap-stream.png" alt="点按流示例">
</div>
<div class="title"><font o="3277">图29.创建Tap流</font></div>
</div>
<div class="paragraph">
<p><font o="3278">如果您没有为流提供名称，将自动命名</font><font o="3278">主流（</font><em><font o="3278">HTTP Source</font></em><font o="3278"> to </font><em><font o="3278">File Sink</font></em><font o="3278">）。</font><font o="3279">创建抽头流时，必须始终明确命名主流。</font><font o="3280">在上图中，主流名为</font><em><font o="3280">HTTP_INGEST</font></em><font o="3280">。</font></p>
</div>
<div class="paragraph">
<p><font o="3281">使用仪表板，您还可以将主流切换为辅助点按流。</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-flo-tap-stream-switch-t.png" alt="将点击流切换到主流">
</div>
<div class="title"><font o="3282">图30.将主流更改为辅助Tap流</font></div>
</div>
<div class="paragraph">
<p><font o="3283">只需将鼠标悬停在现有的主流上，即</font><em><font o="3283">HTTP Source</font></em><font o="3283">和</font><em><font o="3283">File Sink</font></em><font o="3283">之间的界限</font><font o="3283">。</font><font o="3284">将出现几个控制图标，通过单击标记为</font><em><font o="3284">切换到/从中点击</font></em><font o="3284">的图标</font><font o="3284">，可以将主流更改为点按流。</font><font o="3285">对点击流执行相同操作并将其切换到主流。</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-flo-tap-stream-switch-t1.png" alt="将抽头流切换到主流的最终结果">
</div>
<div class="title"><font o="3286">图31.切换主流的最终结果</font></div>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="小费"></i>
</td>
<td class="content"><font o="3287">
当直接与</font><a href="#spring-cloud-dataflow-stream-dsl-named-destinations"><font o="3287">命名目的地</font></a><font o="3287">交互时</font><font o="3287">，可以有“n”组合（输入/输出）。</font><font o="3288">这允许您创建涉及各种数据源和目标的复杂拓扑。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dashboard-tasks"><font o="3289">63.任务</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3290">仪表板的“任务”部分目前有三个选项卡：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#dashboard-tasks-apps"><font o="3291">应用</font></a></p>
</li>
<li>
<p><a href="#dashboard-task-definition"><font o="3292">定义</font></a></p>
</li>
<li>
<p><a href="#dashboard-tasks-executions"><font o="3293">处决</font></a></p>
</li>
<li>
<p><a href="#dashboard-task-scheduling"><font o="3294">调度</font></a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="dashboard-tasks-apps">63.1.<font o="3296">应用</font></h3>
<div class="paragraph">
<p><font o="3297">每个应用程序都将一个工作单元封装到一个可重用的组件中。</font><font o="3298">在数据流运行时环境中，应用程序允许用户为流和任务创建定义。</font><font o="3299">因此，“任务”部分中的“应用”选项卡允许用户创建任务定义。</font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="小费"></i>
</td>
<td class="content"><font o="3300">
您还可以使用此选项卡创建批处理作业。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="3301">下图显示了典型的任务应用列表：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-task-apps-list.png" alt="任务应用列表">
</div>
<div class="title"><font o="3302">图32.任务应用程序列表</font></div>
</div>
<div class="paragraph">
<p><font o="3303">在此屏幕上，您可以执行以下操作：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3304">查看详细信息，例如任务应用程序选项。</font></p>
</li>
<li>
<p><font o="3305">从相应的应用程序创建任务定义。</font></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_view_task_app_details">63.1.1.<font o="3307">查看任务应用详情</font></h4>
<div class="paragraph">
<p><font o="3308">在此页面上，您可以查看所选任务应用程序的详细信息，包括该应用程序的可用选项（属性）列表。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_task_definition">63.1.2.<font o="3310">创建任务定义</font></h4>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-task-definition-create.png" alt="任务应用列表">
</div>
</div>
<div class="paragraph">
<p><font o="3311">您必须至少为新定义提供名称。</font><font o="3312">您还可以选择指定在部署应用程序期间使用的各种属性。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="3313">
仅当选中“包含”复选框时，才会包含每个参数。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dashboard-task-definition">63.2.<font o="3315">定义</font></h3>
<div class="paragraph">
<p><font o="3316">此页面列出了数据流任务定义，并提供了启动或销毁这些任务的操作。</font><font o="3317">它还提供了一个快捷操作，用于通过简单文本输入定义一个或多个任务，由批量定义任务按钮指示。</font></p>
</div>
<div class="paragraph">
<p><font o="3318">下图显示了“定义”页面：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-task-definitions-list.png" alt="任务定义列表">
</div>
<div class="title"><font o="3319">图33.任务定义列表</font></div>
</div>
<div class="sect3">
<h4 id="_creating_composed_task_definitions">63.2.1.<font o="3321">创建组合任务定义</font></h4>
<div class="paragraph">
<p><font o="3322">仪表板包括“创建组合任务”选项卡，该选项卡提供用于创建组合任务的交互式图形界面。</font></p>
</div>
<div class="paragraph">
<p><font o="3323">在此选项卡中，您可以：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3324">使用DSL，图形画布或两者创建和可视化组合任务。</font></p>
</li>
<li>
<p><font o="3325">使用GUI中的自动调整和网格布局功能，可以更轻松地组织任务组织。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="3326">在“创建组合任务”屏幕上，您可以通过输入参数键和参数值来定义一个或多个任务参数。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="3327">
未键入任务参数。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="3328">下图显示了组合任务设计器：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-ctr-flo-tab.png" alt="组合任务设计师">
</div>
<div class="title"><font o="3329">图34.组合任务设计器</font></div>
</div>
</div>
<div class="sect3">
<h4 id="_launching_tasks">63.2.2.<font o="3331">启动任务</font></h4>
<div class="paragraph">
<p><font o="3332">创建任务定义后，可以通过仪表板启动任务。</font><font o="3333">为此，请单击“定义”选项卡，然后按<code i="1050">Launch</code>选择要启动的任务。</font></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dashboard-tasks-executions">63.3.<font o="3335">处决</font></h3>
<div class="paragraph">
<p><font o="3336">Executions选项卡显示当前正在运行和已完成的任务。</font></p>
</div>
<div class="paragraph">
<p><font o="3337">下图显示了Executions选项卡：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-task-executions-list.png" alt="任务执行列表">
</div>
<div class="title"><font o="3338">图35.任务执行列表</font></div>
</div>
</div>
<div class="sect2">
<h3 id="dashboard-tasks-execution-detail">63.4.<font o="3340">执行细节</font></h3>
<div class="paragraph">
<p><font o="3341">对于Executions页面上的每个任务执行，用户可以通过单击位于任务执行右侧的信息图标来检索有关特定执行的详细信息。</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-task-execution-detail.png" alt="任务执行列表">
</div>
</div>
<div class="paragraph">
<p><font o="3342">在此屏幕上，用户不仅可以查看“任务执行”页面中的信息，还可以查看：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3343">任务参数</font></p>
</li>
<li>
<p><font o="3344">外部执行ID</font></p>
</li>
<li>
<p><font o="3345">批处理作业指示符（指示任务执行是否包含Spring Batch个作业。）</font></p>
</li>
<li>
<p><font o="3346">作业执行ID链接（单击作业执行ID将转到该作业执行ID的</font><a href="#dashboard-job-executions-details"><font o="3346">作业执行详细信息</font></a><font o="3346">。）</font></p>
</li>
<li>
<p><font o="3347">任务执行持续时间</font></p>
</li>
<li>
<p><font o="3348">任务执行退出消息</font></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dashboard-jobs"><font o="3349">64.工作</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3350">仪表板的“作业”部分允许您检查批处理作业。</font><font o="3351">屏幕的主要部分提供了作业执行列表。</font><font o="3352">批处理作业是每个执行一个或多个批处理作业的任务。</font><font o="3353">每个作业执行都有对任务执行ID的引用（在Task Id列中）。</font></p>
</div>
<div class="paragraph">
<p><font o="3354">作业执行列表还显示基础作业定义的状态。</font><font o="3355">因此，如果已删除基础定义，则“状态”列中将显示“未找到定义”。</font></p>
</div>
<div class="paragraph">
<p><font o="3356">您可以为每个作业采取以下操作：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3357">重启（适用于失败的作业）。</font></p>
</li>
<li>
<p><font o="3358">停止（用于运行作业）。</font></p>
</li>
<li>
<p><font o="3359">查看执行细节。</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="3360">注意：单击停止按钮实际上会向正在运行的作业发送停止请求，该请求可能不会立即停止。</font></p>
</div>
<div class="paragraph">
<p><font o="3361">下图显示了Jobs页面：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-job-executions-list.png" alt="工作执行清单">
</div>
<div class="title"><font o="3362">图36.作业执行列表</font></div>
</div>
<div class="sect2">
<h3 id="dashboard-job-executions-details">64.1.<font o="3364">工作执行细节</font></h3>
<div class="paragraph">
<p><font o="3365">启动批处理作业后，“作业执行详细信息”页面将显示有关该作业的信息。</font></p>
</div>
<div class="paragraph">
<p><font o="3366">下图显示了“作业执行详细信息”页面：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-jobs-job-execution-deta.png" alt="工作执行细节">
</div>
<div class="title"><font o="3367">图37.作业执行细节</font></div>
</div>
<div class="paragraph">
<p><font o="3368">“作业执行详细信息”页面包含已执行步骤的列表。</font><font o="3369">您可以通过单击放大镜图标进一步深入了解每个步骤的执行细节。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="dashboard-job-executions-steps">64.2.<font o="3371">步骤执行细节</font></h3>
<div class="paragraph">
<p><font o="3372">“步骤执行详细信息”页面提供有关作业中单个步骤的信息。</font></p>
</div>
<div class="paragraph">
<p><font o="3373">下图显示了“步骤执行详细信息”页面：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-step-execution-history.png" alt="步骤执行历史">
</div>
<div class="title"><font o="3374">图38.步骤执行细节</font></div>
</div>
<div class="paragraph">
<p><font o="3375">在页面顶部，您可以看到相应步骤的进度指示器，并可选择刷新指示器。</font><font o="3376">提供链接以查看步骤执行历史。</font></p>
</div>
<div class="paragraph">
<p><font o="3377">“步骤执行详细信息”屏幕提供所有步骤执行上下文键/值对的完整列表。</font></p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="3378">
对于例外，“退出描述”字段包含其他错误信息。</font><font o="3379">但是，此字段最多可包含2500个字符。</font><font o="3380">因此，在长异常堆栈跟踪的情况下，可能会发生错误消息的修整。</font><font o="3381">发生这种情况时，请参阅服务器日志文件以获取更多详细信息。
</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="dashboard-job-executions-steps-progress">64.3.<font o="3383">步骤执行进度</font></h3>
<div class="paragraph">
<p><font o="3384">在此屏幕上，您可以看到有关当前步骤执行的进度条指示器。</font><font o="3385">在“步骤执行历史记录”下，您还可以查看与所选步骤关联的各种度量标准，例如持续时间，读取计数，写入计数等。</font></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dashboard-task-scheduling"><font o="3386">65.安排</font></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_creating_or_deleting_a_schedule_from_the_task_definition_s_page">65.1.<font o="3388">从“任务定义”页面创建或删除计划</font></h3>
<div class="paragraph">
<p><font o="3389">在“任务定义”页面中，用户可以创建或删除特定任务定义的计划。</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-scheduling-task-definit.png" alt="带有计划控制的任务定义">
</div>
<div class="title"><font o="3390">图39.带有Schedule控件的任务定义</font></div>
</div>
<div class="paragraph">
<p><font o="3391">在此屏幕上，您可以执行以下操作：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3392">用户可以单击时钟图标，这将带您进入“计划创建”屏幕。</font></p>
</li>
<li>
<p><font o="3393">用户可以单击右上方带有<code i="1051">x</code>的时钟图标来删除与任务定义关联的计划。</font></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_schedule">65.2.<font o="3395">创建计划</font></h3>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-scheduling-create.png" alt="为任务执行创建计划">
</div>
<div class="title"><font o="3396">图40.为任务执行创建计划</font></div>
</div>
<div class="paragraph">
<p><font o="3397">用户单击“任务定义”屏幕上的时钟图标后，Spring Cloud Data Flow将使用户进入“计划创建”屏幕。</font><font o="3398">在此屏幕上，用户可以建立计划名称，cron表达式以及建立在此计划启动任务时要使用的属性和参数。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_listing_available_schedules">65.3.<font o="3400">列出可用的计划</font></h3>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-scheduling-list.png" alt="列出可用的时间表">
</div>
<div class="title"><font o="3401">图41.列出可用计划</font></div>
</div>
<div class="paragraph">
<p><font o="3402">在此屏幕上，您可以执行以下操作：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3403">删除计划</font></p>
</li>
<li>
<p><font o="3404">获取时间表的详细信息</font></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dashboard-analytics"><font o="3405">66.分析</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3406">仪表板的“分析”页面为Spring Cloud Data Flow中提供的各种分析应用程序提供了以下数据可视化功能：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3407">计数器</font></p>
</li>
<li>
<p><font o="3408">场值计数器</font></p>
</li>
<li>
<p><font o="3409">总计数器</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font o="3410">例如，如果使用“ </font><a href="javascript:;"><font o="3410">计数器”</font></a><font o="3410">应用程序</font><font o="3410">创建流</font><font o="3410">，则可以从“仪表板”选项卡中创建相应的图形。</font><font o="3411">为此：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="3412">在<code i="1052">Metric Type</code>下，从选择框中选择<code i="1053">Counters</code>。</font></p>
</li>
<li>
<p><font o="3413">在<code i="1054">Stream</code>下，选择<code i="1055">tweetcount</code>。</font></p>
</li>
<li>
<p><font o="3414">在<code i="1056">Visualization</code>下，选择所需的图表选项<code i="1057">Bar Chart</code>。</font></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><font o="3415">使用右侧的图标，您可以向仪表板添加其他图表，重新排列已创建仪表板的顺序或删除数据可视化。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dashboard-auditing"><font o="3416">67.审计</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3417">仪表板的“审核”页面使您可以访问记录的审核事件。</font><font o="3418">目前的审计事件记录为：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3419">流</font></p>
<div class="ulist">
<ul>
<li>
<p><font o="3420">创建</font></p>
</li>
<li>
<p><font o="3421">删除</font></p>
</li>
<li>
<p><font o="3422">部署</font></p>
</li>
<li>
<p><font o="3423">取消部署</font></p>
</li>
</ul>
</div>
</li>
<li>
<p><font o="3424">任务</font></p>
<div class="ulist">
<ul>
<li>
<p><font o="3425">创建</font></p>
</li>
<li>
<p><font o="3426">删除</font></p>
</li>
<li>
<p><font o="3427">发射</font></p>
</li>
</ul>
</div>
</li>
<li>
<p><font o="3428">任务调度</font></p>
<div class="ulist">
<ul>
<li>
<p><font o="3429">创建计划</font></p>
</li>
<li>
<p><font o="3430">删除计划</font></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-audit-records-list.png" alt="列出可用的审核记录">
</div>
<div class="title"><font o="3431">图42.审计记录列表概述</font></div>
</div>
<div class="paragraph">
<p><font o="3432">通过单击“ </font><em><font o="3432">显示详细信息”</font></em><font o="3432">图标，您可以获得有关审核详细信息的更多详细信息：</font></p>
</div>
<div class="imageblock">
<div class="content">
<img src="static/picture/dataflow-audit-records-details.png" alt="单个审计记录的详细信息">
</div>
<div class="title"><font o="3433">图43.审计记录的列表详细信息</font></div>
</div>
<div class="paragraph">
<p><font o="3434">通常，审计提供以下信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3435">创建记录的时间是？</font></p>
</li>
<li>
<p><font o="3436">触发审核事件的用户名（如果启用了安全性）</font></p>
</li>
<li>
<p><font o="3437">审计操作（时间表，Stresm，任务）</font></p>
</li>
<li>
<p><font o="3438">执行的操作（创建，删除，部署，回滚，取消部署，更新）</font></p>
</li>
<li>
<p><font o="3439">相关ID，例如流/任务名称</font></p>
</li>
<li>
<p><font o="3440">审计数据</font></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><font></font><em><font o="3441">审计数据</font></em><font o="3441">属性的书面值</font><font o="3441">取决于执行的</font><em><font o="3441">审计操作</font></em><font o="3441">和</font><em><font o="3441">ActionType</font></em><font o="3441">。</font><font o="3442">例如，在创建计划时，任务定义的名称，任务定义属性，部署属性以及命令行参数将写入持久性存储。</font></p>
</div>
<div class="paragraph">
<p><font o="3443">在以</font><em><font o="3443">尽力服务的方式</font></em><font o="3443">保存审计记录之前，对敏感信息进行清理</font><font o="3443">。</font><font o="3444">正在检测以下任何键并且其敏感值被屏蔽：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3445">密码</font></p>
</li>
<li>
<p><font o="3446">秘密</font></p>
</li>
<li>
<p><font o="3447">键</font></p>
</li>
<li>
<p><font o="3448">代币</font></p>
</li>
<li>
<p><font o="3449">。*证书。*</font></p>
</li>
<li>
<p><font o="3450">VCAP_SERVICES</font></p>
</li>
</ul>
</div>
</div>
</div>
<h1 id="dataflow-samples" class="sect0"><font o="3451">样品</font></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p><font o="3452">本节显示可用的样本。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="samples-links"><font o="3453">68.链接</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3454">已创建了几个示例，以帮助您开始实现更高级别的用例，而不是参考指南中显示的基本Streams和Tasks。</font><font o="3455">这些示例是单独的</font><a href="javascript:;"><font o="3455">存储库的</font></a><font o="3455">一部分，</font><font o="3455">并有自己的</font><a href="javascript:;"><font o="3455">参考文档</font></a><font o="3455">。</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="javascript:;"><font o="3456">Java DSL</font></a></p>
</li>
<li>
<p><a href="javascript:;"><font o="3457">HTTP到Cassandra</font></a></p>
</li>
<li>
<p><a href="javascript:;"><font o="3458">HTTP到MySQL</font></a></p>
</li>
<li>
<p><a href="javascript:;"><font o="3459">HTTP到Gemfire</font></a></p>
</li>
<li>
<p><a href="javascript:;"><font o="3460">Gemfire CQ登录演示</font></a></p>
</li>
<li>
<p><a href="javascript:;"><font o="3461">Gemfire记录演示</font></a></p>
</li>
<li>
<p><a href="javascript:;"><font o="3462">定制处理器</font></a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title"><font o="3463">任务和批处理</font></div>
<ul>
<li>
<p><a href="javascript:;"><font o="3464">Cloud Foundry上的批量作业</font></a></p>
</li>
<li>
<p><a href="javascript:;"><font o="3465">批量文件摄取</font></a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title"><font o="3466">Analytics（分析）</font></div>
<ul>
<li>
<p><a href="javascript:;"><font o="3467">Twitter分析</font></a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title"><font o="3468">数据科学</font></div>
<ul>
<li>
<p><a href="javascript:;"><font o="3469">物种预测</font></a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title"><font o="3470">功能</font></div>
<ul>
<li>
<p><a href="javascript:;"><font o="3471">使用Spring Cloud函数</font></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><br>
<br></p>
</div>
</div>
</div>
<h1 id="api-guide" class="sect0"><font o="3472">REST API指南</font></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p><font o="3473">本节介绍Spring Cloud Data Flow REST API。</font></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-guide-overview"><font o="3474">69.概述</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3475">Spring Cloud Data Flow提供了一个REST API，允许您访问服务器的所有方面。</font><font o="3476">事实上，Spring Cloud Data Flow shell是该API的一流消费者。</font></p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="小费"></i>
</td>
<td class="content"><font o="3477">
如果计划将REST API与Jav​​a一起使用，则应考虑使用提供的内部使用REST API的Java客户端（<code i="1058">DataflowTemplate</code>）。
</font></td>
</tr>
</tbody></table>
</div>
<div class="sect2">
<h3 id="api-guide-overview-http-verbs">69.1.<font o="3479">HTTP动词</font></h3>
<div class="paragraph">
<p><font o="3480">Spring Cloud Data Flow尝试在使用HTTP谓词时尽可能地遵守标准HTTP和REST约定，如下表所述：</font></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3481">动词</font></th>
<th class="tableblock halign-left valign-top"><font o="3482">用法</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>GET</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Used to retrieve a resource</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>POST</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Used to create a new resource</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>PUT</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Used to update an existing resource, including partial updates. Also used for
resources that imply the concept of <code>restarts</code>, such as Tasks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>DELETE</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Used to delete an existing resource.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="api-guide-overview-http-status-codes">69.2.<font o="3484">HTTP状态代码</font></h3>
<div class="paragraph">
<p><font o="3485">Spring Cloud Data Flow尝试在使用HTTP状态代码时尽可能地遵守标准HTTP和REST约定，如下表所示：</font></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3486">状态代码</font></th>
<th class="tableblock halign-left valign-top"><font o="3487">用法</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>200 OK</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">The request completed successfully.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>201 Created</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">A new resource has been created successfully. The resource’s URI is available from the response’s <code>Location</code> header.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>204 No Content</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">An update to an existing resource has been applied successfully.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>400 Bad Request</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">The request was malformed. The response body includes an error description that provides further information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>404 Not Found</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">The requested resource did not exist.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>409 Conflict</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">The requested resource already exists. For example, the task already exists or the stream was already being deployed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>422 Unprocessable Entity</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Returned in cases where the Job Execution cannot be stopped or restarted.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="api-guide-overview-headers">69.3.<font o="3489">头</font></h3>
<div class="paragraph">
<p><font o="3490">每个响应都有以下标题：</font></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3491">名称</font></th>
<th class="tableblock halign-left valign-top"><font o="3492">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>Content-Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3493">有效负载的Content-Type，例如<code i="1059">application/hal+json</code></font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="api-guide-overview-errors">69.4.<font o="3495">错误</font></h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3496">路径</font></th>
<th class="tableblock halign-left valign-top"><font o="3497">类型</font></th>
<th class="tableblock halign-left valign-top"><font o="3498">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>error</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3499">发生的HTTP错误，例如<code i="1060">Bad Request</code></font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>message</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3500">错误原因的描述</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>path</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3501">请求的路径</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>status</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>Number</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3502">HTTP状态代码，例如<code i="1061">400</code></font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>timestamp</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3503">发生错误的时间（以毫秒为单位）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="api-guide-overview-hypermedia">69.5.<font o="3505">超媒体</font></h3>
<div class="paragraph">
<p><font o="3506">Spring Cloud Data Flow使用超媒体，资源包括其响应中其他资源的链接。</font><font o="3507">响应在</font><a href="javascript:;"><font o="3507">超文本应用程序中，从资源到资源语言（HAL）</font></a><font o="3507">格式。</font><font o="3508">链接可以在<code i="1062">_links</code>键下找到。</font><font o="3509">API的用户不应自己创建URI。</font><font o="3510">代替。</font><font o="3511">他们应该使用上述链接进行导航。</font></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-guide-resources"><font o="3512">70.资源</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="3513">API包括以下资源：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-index"><font o="3514">指数</font></a></p>
</li>
<li>
<p><a href="#resources-about"><font o="3515">服务器元信息</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-audit-records"><font o="3516">审计记录</font></a></p>
</li>
<li>
<p><a href="#resources-registered-applications"><font o="3517">注册申请</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions"><font o="3518">流定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-deployment"><font o="3519">流部署</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-validate"><font o="3520">流验证</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-definitions"><font o="3521">任务定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions"><font o="3522">任务执行</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-scheduler"><font o="3523">任务计划程序</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-validate"><font o="3524">任务验证</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions"><font o="3525">工作执行</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-instances"><font o="3526">工作实例</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-step-executions"><font o="3527">工作步骤执行</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-runtime-information-applications"><font o="3528">有关应用程序的运行时信息</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-metrics-stream-applications"><font o="3529">流应用程序的度量标准</font></a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="api-guide-resources-index">70.1.<font o="3531">指数</font></h3>
<div class="paragraph">
<p><font o="3532">索引提供了进入Spring Cloud Data Flow的REST API的入口点。</font><font o="3533">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-index-access"><font o="3534">访问索引</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-index-request-structure"><font o="3535">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-index-example-request"><font o="3536">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-index-response-structure"><font o="3537">响应结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-index-example-response"><font o="3538">示例响应</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-index-links"><font o="3539">链接</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-index-access">70.1.1.<font o="3541">访问索引</font></h4>
<div class="paragraph">
<p><font o="3542">使用<code i="1063">GET</code>请求访问索引。</font></p>
</div>
<div class="sect4">
<h5 id="api-guide-resources-index-request-structure"><font o="3543">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET / HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-index-example-request"><font o="3544">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-index-response-structure"><font o="3545">响应结构</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3546">路径</font></th>
<th class="tableblock halign-left valign-top"><font o="3547">类型</font></th>
<th class="tableblock halign-left valign-top"><font o="3548">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>_links</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>Object</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3549">与其他资源的链接</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>['api.revision']</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>Number</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3550">每次在此REST API中实施更改时都会增加</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-index-example-response"><font o="3551">示例响应</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 4669

{
  "_links" : {
    "dashboard" : {
      "href" : "http://localhost:9393/dashboard"
    },
    "audit-records" : {
      "href" : "http://localhost:9393/audit-records"
    },
    "streams/definitions" : {
      "href" : "http://localhost:9393/streams/definitions"
    },
    "streams/definitions/definition" : {
      "href" : "http://localhost:9393/streams/definitions/{name}",
      "templated" : true
    },
    "streams/validation" : {
      "href" : "http://localhost:9393/streams/validation/{name}",
      "templated" : true
    },
    "runtime/apps" : {
      "href" : "http://localhost:9393/runtime/apps"
    },
    "runtime/apps/app" : {
      "href" : "http://localhost:9393/runtime/apps/{appId}",
      "templated" : true
    },
    "runtime/apps/instances" : {
      "href" : "http://localhost:9393/runtime/apps/{appId}/instances",
      "templated" : true
    },
    "metrics/streams" : {
      "href" : "http://localhost:9393/metrics/streams"
    },
    "streams/deployments" : {
      "href" : "http://localhost:9393/streams/deployments"
    },
    "streams/deployments/deployment" : {
      "href" : "http://localhost:9393/streams/deployments/{name}",
      "templated" : true
    },
    "tasks/definitions" : {
      "href" : "http://localhost:9393/tasks/definitions"
    },
    "tasks/definitions/definition" : {
      "href" : "http://localhost:9393/tasks/definitions/{name}",
      "templated" : true
    },
    "tasks/executions" : {
      "href" : "http://localhost:9393/tasks/executions"
    },
    "tasks/executions/name" : {
      "href" : "http://localhost:9393/tasks/executions{?name}",
      "templated" : true
    },
    "tasks/executions/current" : {
      "href" : "http://localhost:9393/tasks/executions/current"
    },
    "tasks/executions/execution" : {
      "href" : "http://localhost:9393/tasks/executions/{id}",
      "templated" : true
    },
    "tasks/validation" : {
      "href" : "http://localhost:9393/tasks/validation/{name}",
      "templated" : true
    },
    "tasks/schedules" : {
      "href" : "http://localhost:9393/tasks/schedules"
    },
    "tasks/schedules/instances" : {
      "href" : "http://localhost:9393/tasks/schedules/instances/{taskDefinitionName}",
      "templated" : true
    },
    "jobs/executions" : {
      "href" : "http://localhost:9393/jobs/executions"
    },
    "jobs/executions/name" : {
      "href" : "http://localhost:9393/jobs/executions{?name}",
      "templated" : true
    },
    "jobs/executions/execution" : {
      "href" : "http://localhost:9393/jobs/executions/{id}",
      "templated" : true
    },
    "jobs/executions/execution/steps" : {
      "href" : "http://localhost:9393/jobs/executions/{jobExecutionId}/steps",
      "templated" : true
    },
    "jobs/executions/execution/steps/step" : {
      "href" : "http://localhost:9393/jobs/executions/{jobExecutionId}/steps/{stepId}",
      "templated" : true
    },
    "jobs/executions/execution/steps/step/progress" : {
      "href" : "http://localhost:9393/jobs/executions/{jobExecutionId}/steps/{stepId}/progress",
      "templated" : true
    },
    "jobs/instances/name" : {
      "href" : "http://localhost:9393/jobs/instances{?name}",
      "templated" : true
    },
    "jobs/instances/instance" : {
      "href" : "http://localhost:9393/jobs/instances/{id}",
      "templated" : true
    },
    "tools/parseTaskTextToGraph" : {
      "href" : "http://localhost:9393/tools"
    },
    "tools/convertTaskGraphToText" : {
      "href" : "http://localhost:9393/tools"
    },
    "counters" : {
      "href" : "http://localhost:9393/metrics/counters"
    },
    "counters/counter" : {
      "href" : "http://localhost:9393/metrics/counters/{name}",
      "templated" : true
    },
    "field-value-counters" : {
      "href" : "http://localhost:9393/metrics/field-value-counters"
    },
    "field-value-counters/counter" : {
      "href" : "http://localhost:9393/metrics/field-value-counters/{name}",
      "templated" : true
    },
    "aggregate-counters" : {
      "href" : "http://localhost:9393/metrics/aggregate-counters"
    },
    "aggregate-counters/counter" : {
      "href" : "http://localhost:9393/metrics/aggregate-counters/{name}",
      "templated" : true
    },
    "apps" : {
      "href" : "http://localhost:9393/apps"
    },
    "about" : {
      "href" : "http://localhost:9393/about"
    },
    "completions/stream" : {
      "href" : "http://localhost:9393/completions/stream{?start,detailLevel}",
      "templated" : true
    },
    "completions/task" : {
      "href" : "http://localhost:9393/completions/task{?start,detailLevel}",
      "templated" : true
    }
  },
  "api.revision" : 14
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-index-links"><font o="3552">链接</font></h5>
<div class="paragraph">
<p><font o="3553">索引的主要元素是链接，因为它们允许您遍历API并执行所需的功能：</font></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3554">关系</font></th>
<th class="tableblock halign-left valign-top"><font o="3555">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>about</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3556">访问元信息，包括启用的功能，安全信息，版本信息</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>dashboard</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3557">访问仪表板UI</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>audit-records</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3558">提供审计跟踪信息</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>apps</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3559">处理已注册的申请</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>completions/stream</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3560">公开Stream的DSL完成功能</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>completions/task</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3561">公开任务的DSL完成功能</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>metrics/streams</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3562">公开流应用程序的指标</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>jobs/executions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3563">提供JobExecution资源</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>jobs/executions/execution</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3564">提供特定JobExecution的详细信息</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>jobs/executions/execution/steps</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3565">提供JobExecution的步骤</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>jobs/executions/execution/steps/step</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3566">返回特定步骤的详细信息</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>jobs/executions/execution/steps/step/progress</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3567">提供特定步骤的进度信息</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>jobs/executions/name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3568">按作业名称检索作业执行</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>jobs/instances/instance</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3569">为特定作业实例提供作业实例资源</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>jobs/instances/name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3570">为特定作业名称提供作业实例资源</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>runtime/apps</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3571">提供运行时应用程序资源</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>runtime/apps/app</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3572">公开特定应用程序的运行时状态</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>runtime/apps/instances</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3573">提供应用程序实例的状态</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>tasks/definitions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3574">提供任务定义资源</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>tasks/definitions/definition</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3575">提供特定任务定义的详细信息</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>tasks/validation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3576">提供任务定义的验证</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>tasks/executions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3577">返回任务执行并允许启动任务</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>tasks/executions/current</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3578">提供当前运行任务的计数</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>tasks/schedules</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3579">提供任务的计划信息</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>tasks/schedules/instances</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3580">提供特定任务的计划信息</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>tasks/executions/name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3581">返回给定任务名称的所有任务执行</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>tasks/executions/execution</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3582">提供特定任务执行的详细信息</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>streams/definitions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3583">公开Streams资源</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>streams/definitions/definition</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3584">处理特定的流定义</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>streams/validation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3585">提供流定义的验证</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>streams/deployments</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3586">提供Stream部署操作</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>streams/deployments/deployment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3587">请求（取消）部署现有流定义</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>counters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3588">公开处理计数器的资源</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>counters/counter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3589">处理特定的柜台</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>aggregate-counters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3590">提供处理聚合计数器的资源</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>aggregate-counters/counter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3591">处理特定的聚合计数器</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>field-value-counters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3592">提供处理字段值计数器的资源</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>field-value-counters/counter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3593">处理特定的字段值计数器</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>tools/parseTaskTextToGraph</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3594">将任务定义解析为图结构</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>tools/convertTaskGraphToText</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3595">将图形格式转换为DSL文本格式</font></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="resources-about">70.2.<font o="3597">服务器元信息</font></h3>
<div class="paragraph">
<p><font o="3598">服务器元信息端点提供有关服务器本身的更多信息。</font><font o="3599">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-server-meta-retrieving"><font o="3600">检索有关服务器的信息</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-server-meta-request-structure"><font o="3601">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-server-meta-example-request"><font o="3602">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-server-meta-response-structure"><font o="3603">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-server-meta-retrieving">70.2.1.<font o="3605">检索有关服务器的信息</font></h4>
<div class="paragraph">
<p><font o="3606"><code i="1064">GET</code>请求返回Spring Cloud Data Flow的元信息，包括：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="3607">运行时环境信息</font></p>
</li>
<li>
<p><font o="3608">有关启用哪些功能的信息</font></p>
</li>
<li>
<p><font o="3609">Spring Cloud Data Flow服务器的依赖信息</font></p>
</li>
<li>
<p><font o="3610">安全信息</font></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-server-meta-request-structure"><font o="3611">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /about HTTP/1.1
Accept: application/json
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-server-meta-example-request"><font o="3612">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/about' -i -H 'Accept: application/json'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-server-meta-response-structure"><font o="3613">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 2167

{
  "featureInfo" : {
    "analyticsEnabled" : true,
    "streamsEnabled" : true,
    "tasksEnabled" : true,
    "skipperEnabled" : false,
    "schedulerEnabled" : true
  },
  "versionInfo" : {
    "implementation" : {
      "name" : "spring-cloud-starter-dataflow-server-local",
      "version" : "1.7.3.RELEASE"
    },
    "core" : {
      "name" : "Spring Cloud Data Flow Core",
      "version" : "1.7.3.RELEASE"
    },
    "dashboard" : {
      "name" : "Spring Cloud Dataflow UI",
      "version" : "1.7.2.RELEASE"
    },
    "shell" : {
      "name" : "Spring Cloud Data Flow Shell",
      "version" : "1.7.3.RELEASE",
      "url" : "https://repo.spring.io/libs-release/org/springframework/cloud/spring-cloud-dataflow-shell/1.7.3.RELEASE/spring-cloud-dataflow-shell-1.7.3.RELEASE.jar"
    }
  },
  "securityInfo" : {
    "authenticationEnabled" : false,
    "authorizationEnabled" : false,
    "formLogin" : false,
    "authenticated" : false,
    "username" : null,
    "roles" : [ ]
  },
  "runtimeEnvironment" : {
    "appDeployer" : {
      "deployerImplementationVersion" : "1.3.10.RELEASE",
      "deployerName" : "LocalAppDeployer",
      "deployerSpiVersion" : "1.3.4.RELEASE",
      "javaVersion" : "1.8.0_144",
      "platformApiVersion" : "Linux 4.4.0-139-generic",
      "platformClientVersion" : "4.4.0-139-generic",
      "platformHostVersion" : "4.4.0-139-generic",
      "platformSpecificInfo" : { },
      "platformType" : "Local",
      "springBootVersion" : "1.5.16.RELEASE",
      "springVersion" : "4.3.19.RELEASE"
    },
    "taskLauncher" : {
      "deployerImplementationVersion" : "1.3.10.RELEASE",
      "deployerName" : "LocalTaskLauncher",
      "deployerSpiVersion" : "1.3.4.RELEASE",
      "javaVersion" : "1.8.0_144",
      "platformApiVersion" : "Linux 4.4.0-139-generic",
      "platformClientVersion" : "4.4.0-139-generic",
      "platformHostVersion" : "4.4.0-139-generic",
      "platformSpecificInfo" : { },
      "platformType" : "Local",
      "springBootVersion" : "1.5.16.RELEASE",
      "springVersion" : "4.3.19.RELEASE"
    }
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/about"
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="resources-registered-applications">70.3.<font o="3615">注册申请</font></h3>
<div class="paragraph">
<p><font o="3616">已注册的应用程序端点提供有关在Spring Cloud Data Flow服务器中注册的应用程序的信息。</font><font o="3617">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#resources-app-registry-list"><font o="3618">上市申请</font></a></p>
</li>
<li>
<p><a href="#resources-app-registry-get"><font o="3619">获取特定应用的信息</font></a></p>
</li>
<li>
<p><a href="#resources-app-registry-post"><font o="3620">注册新的应用程序</font></a></p>
</li>
<li>
<p><a href="#resources-app-registry-post-skipper"><font o="3621">使用版本注册新应用程序</font></a><font o="3621">（在Skipper模式下）</font></p>
</li>
<li>
<p><a href="#resources-app-registry-default"><font o="3622">设置默认应用程序版本</font></a><font o="3622">（在Skipper模式下）</font></p>
</li>
<li>
<p><a href="#resources-app-registry-delete"><font o="3623">取消注册应用程序</font></a></p>
</li>
<li>
<p><a href="#resources-app-registry-bulk"><font o="3624">批量注册应用程序</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="resources-app-registry-list">70.3.1.<font o="3626">上市申请</font></h4>
<div class="paragraph">
<p><font o="3627"><code i="1065">GET</code>请求将列出Spring Cloud Data Flow已知的所有应用程序。</font><font o="3628">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-app-registry-request-structure"><font o="3629">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-request-parameters"><font o="3630">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-example-request"><font o="3631">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-response-structure"><font o="3632">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-request-structure"><font o="3633">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /apps?type=source HTTP/1.1
Accept: application/json
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-request-parameters"><font o="3634">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3635">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3636">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3637">将返回的应用限制为应用类型。</font><font o="3638">[app，source，processor，sink，task]之一</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-example-request"><font o="3639">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/apps?type=source' -i -H 'Accept: application/json'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-response-structure"><font o="3640">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 911

{
  "_embedded" : {
    "appRegistrationResourceList" : [ {
      "name" : "http",
      "type" : "source",
      "uri" : "maven://org.springframework.cloud.stream.app:http-source-rabbit:1.2.0.RELEASE",
      "version" : null,
      "defaultVersion" : false,
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/apps/source/http"
        }
      }
    }, {
      "name" : "time",
      "type" : "source",
      "uri" : "maven://org.springframework.cloud.stream.app:time-source-rabbit:1.2.0.RELEASE",
      "version" : null,
      "defaultVersion" : false,
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/apps/source/time"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/apps?page=0&amp;size=20"
    }
  },
  "page" : {
    "size" : 20,
    "totalElements" : 2,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="resources-app-registry-get">70.3.2.<font o="3642">获取特定应用的信息</font></h4>
<div class="paragraph">
<p><font o="3643"><code i="1067">/apps/&lt;type&gt;/&lt;name&gt;</code>上的<code i="1066">GET</code>请求获取特定应用程序的信息。</font><font o="3644">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-app-registry-get-request-structure"><font o="3645">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-get-path-parameters"><font o="3646">路径参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-get-example-request"><font o="3647">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-get-response-structure"><font o="3648">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-get-request-structure"><font o="3649">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /apps/source/http?exhaustive=false HTTP/1.1
Accept: application/json
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-get-request-parameters"><font o="3650">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3651">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3652">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>exhaustive</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3653">返回所有应用程序属性，包括常见的Spring Boot属性</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-get-path-parameters"><font o="3654">路径参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="3655">表2. / apps / {type} / {name}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3656">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3657">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3658">要查询的应用程序类型。</font><font o="3659">[app，source，processor，sink，task]之一</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3660">要查询的应用程序的名称</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-get-example-request"><font o="3661">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/apps/source/http?exhaustive=false' -i -H 'Accept: application/json'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-get-response-structure"><font o="3662">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 2436

{
  "name" : "http",
  "type" : "source",
  "uri" : "maven://org.springframework.cloud.stream.app:http-source-rabbit:1.2.0.RELEASE",
  "version" : null,
  "defaultVersion" : false,
  "options" : [ {
    "id" : "http.path-pattern",
    "name" : "path-pattern",
    "type" : "java.lang.String",
    "description" : "An Ant-Style pattern to determine which http requests will be captured.",
    "shortDescription" : "An Ant-Style pattern to determine which http requests will be captured.",
    "defaultValue" : "/",
    "hints" : {
      "keyHints" : [ ],
      "keyProviders" : [ ],
      "valueHints" : [ ],
      "valueProviders" : [ ]
    },
    "deprecation" : null,
    "sourceType" : "org.springframework.cloud.stream.app.http.source.HttpSourceProperties",
    "sourceMethod" : null,
    "deprecated" : false
  }, {
    "id" : "http.mapped-request-headers",
    "name" : "mapped-request-headers",
    "type" : "java.lang.String[]",
    "description" : "Headers that will be mapped.",
    "shortDescription" : "Headers that will be mapped.",
    "defaultValue" : null,
    "hints" : {
      "keyHints" : [ ],
      "keyProviders" : [ ],
      "valueHints" : [ ],
      "valueProviders" : [ ]
    },
    "deprecation" : null,
    "sourceType" : "org.springframework.cloud.stream.app.http.source.HttpSourceProperties",
    "sourceMethod" : null,
    "deprecated" : false
  }, {
    "id" : "http.secured",
    "name" : "secured",
    "type" : "java.lang.Boolean",
    "description" : "Secure or not HTTP source path.",
    "shortDescription" : "Secure or not HTTP source path.",
    "defaultValue" : false,
    "hints" : {
      "keyHints" : [ ],
      "keyProviders" : [ ],
      "valueHints" : [ ],
      "valueProviders" : [ ]
    },
    "deprecation" : null,
    "sourceType" : "org.springframework.cloud.stream.app.http.source.HttpSourceProperties",
    "sourceMethod" : null,
    "deprecated" : false
  }, {
    "id" : "server.port",
    "name" : "port",
    "type" : "java.lang.Integer",
    "description" : "Server HTTP port.",
    "shortDescription" : "Server HTTP port.",
    "defaultValue" : null,
    "hints" : {
      "keyHints" : [ ],
      "keyProviders" : [ ],
      "valueHints" : [ ],
      "valueProviders" : [ ]
    },
    "deprecation" : null,
    "sourceType" : "org.springframework.boot.autoconfigure.web.ServerProperties",
    "sourceMethod" : null,
    "deprecated" : false
  } ],
  "shortDescription" : null
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="resources-app-registry-post">70.3.3.<font o="3664">注册新的应用程序</font></h4>
<div class="paragraph">
<p><font o="3665"><code i="1069">/apps/&lt;type&gt;/&lt;name&gt;</code>上的<code i="1068">POST</code>请求允许注册新的申请。</font><font o="3666">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-app-registry-post-request-structure"><font o="3667">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-post-request-parameters"><font o="3668">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-post-path-parameters"><font o="3669">路径参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-post-example-request"><font o="3670">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-post-response-structure"><font o="3671">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-post-request-structure"><font o="3672">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">POST /apps/source/http HTTP/1.1
Host: localhost:9393
Content-Type: application/x-www-form-urlencoded

uri=maven%3A%2F%2Forg.springframework.cloud.stream.app%3Ahttp-source-rabbit%3A1.1.0.RELEASE</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-post-request-parameters"><font o="3673">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3674">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3675">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3676">应用程序位所在的URI</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>metadata-uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3677">可以找到应用程序元数据jar的URI</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>force</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3678">如果已存在具有相同名称和类型的注册，则必须为true，否则将发生错误</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-post-path-parameters"><font o="3679">路径参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="3680">表3. / apps / {type} / {name}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3681">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3682">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3683">要注册的应用程序类型。</font><font o="3684">[app，source，processor，sink，task]之一</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3685">要注册的应用程序的名称</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-post-example-request"><font o="3686">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/apps/source/http' -i -X POST -d 'uri=maven%3A%2F%2Forg.springframework.cloud.stream.app%3Ahttp-source-rabbit%3A1.1.0.RELEASE'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-post-response-structure"><font o="3687">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 201 Created</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="resources-app-registry-post-skipper">70.3.4.<font o="3689">使用版本注册新应用程序</font></h4>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="3690">
要使用此功能，数据流服务器必须处于</font><a href="#spring-cloud-dataflow-stream-lifecycle-skipper"><font o="3690">Skipper模式</font></a>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="3691"><code i="1071">/apps/&lt;type&gt;/&lt;name&gt;/&lt;version&gt;</code>上的<code i="1070">POST</code>请求允许在Skipper模式下注册新应用程序。</font><font o="3692">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-app-registry-post-skipper-request-structure"><font o="3693">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-post-skipper-request-parameters"><font o="3694">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-post-skipper-path-parameters"><font o="3695">路径参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-post-skipper-example-request"><font o="3696">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-post-skipper-response-structure"><font o="3697">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-post-skipper-request-structure"><font o="3698">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">POST /apps/source/http/1.1.0.RELEASE HTTP/1.1
Host: localhost:9393
Content-Type: application/x-www-form-urlencoded

uri=maven%3A%2F%2Forg.springframework.cloud.stream.app%3Ahttp-source-rabbit%3A1.1.0.RELEASE</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-post-skipper-request-parameters"><font o="3699">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3700">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3701">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3702">应用程序位所在的URI</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>metadata-uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3703">可以找到应用程序元数据jar的URI</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>force</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3704">如果已存在具有相同名称和类型的注册，则必须为true，否则将发生错误</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-post-skipper-path-parameters"><font o="3705">路径参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="3706">表4. /apps/{type}/{name}/{version:.+}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3707">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3708">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3709">要注册的应用程序类型。</font><font o="3710">[app，source，processor，sink，task]之一</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3711">要注册的应用程序的名称</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>version</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3712">要注册的应用程序的版本</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-post-skipper-example-request"><font o="3713">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/apps/source/http/1.1.0.RELEASE' -i -X POST -d 'uri=maven%3A%2F%2Forg.springframework.cloud.stream.app%3Ahttp-source-rabbit%3A1.1.0.RELEASE'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-post-skipper-response-structure"><font o="3714">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 201 Created</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="resources-app-registry-default">70.3.5.<font o="3716">设置默认应用程序版本</font></h4>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="3717">
要使用此功能，数据流服务器必须处于</font><a href="#spring-cloud-dataflow-stream-lifecycle-skipper"><font o="3717">Skipper模式</font></a>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="3718">对于具有<code i="1072">name</code>和<code i="1073">type</code>的应用程序，可以在Skipper模式下注册多个版本。</font><font o="3719">在这种情况下，可以选择其中一个版本作为默认应用程序。</font></p>
</div>
<div class="paragraph">
<p><font o="3720">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-app-registry-default-request-structure"><font o="3721">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-default-path-parameters"><font o="3722">路径参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-default-example-request"><font o="3723">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-default-response-structure"><font o="3724">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-default-request-structure"><font o="3725">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">PUT /apps/source/http/1.2.0.RELEASE HTTP/1.1
Accept: application/json
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-default-path-parameters"><font o="3726">路径参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="3727">表5. /apps/{type}/{name}/{version:.+}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3728">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3729">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3730">应用程序的类型。</font><font o="3731">[app，source，processor，sink，task]之一</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3732">应用程序的名称</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>version</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3733">应用程序的版本</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-default-example-request"><font o="3734">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/apps/source/http/1.2.0.RELEASE' -i -X PUT -H 'Accept: application/json'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-default-response-structure"><font o="3735">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 202 Accepted</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="resources-app-registry-delete">70.3.6.<font o="3737">取消注册应用程序</font></h4>
<div class="paragraph">
<p><font o="3738"><code i="1075">/apps/&lt;type&gt;/&lt;name&gt;</code>上的<code i="1074">DELETE</code>请求取消注册以前注册的申请。</font><font o="3739">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-app-registry-delete-request-structure"><font o="3740">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-delete-path-parameters"><font o="3741">路径参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-delete-example-request"><font o="3742">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-delete-response-structure"><font o="3743">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-delete-request-structure"><font o="3744">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">DELETE /apps/source/http HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-delete-path-parameters"><font o="3745">路径参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="3746">表6. / apps / {type} / {name}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3747">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3748">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3749">要取消注册的应用程序类型。</font><font o="3750">[app，source，processor，sink，task]之一</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3751">要取消注册的应用程序的名称</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-delete-example-request"><font o="3752">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/apps/source/http' -i -X DELETE</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-delete-response-structure"><font o="3753">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="resources-app-registry-bulk">70.3.7.<font o="3755">批量注册应用程序</font></h4>
<div class="paragraph">
<p><font o="3756"><code i="1077">/apps</code>上的<code i="1076">POST</code>请求允许一次注册多个应用程序。</font><font o="3757">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-app-registry-bulk-request-structure"><font o="3758">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-bulk-request-parameters"><font o="3759">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-bulk-example-request"><font o="3760">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-app-registry-bulk-response-structure"><font o="3761">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-bulk-request-structure"><font o="3762">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">POST /apps HTTP/1.1
Host: localhost:9393
Content-Type: application/x-www-form-urlencoded

apps=source.http%3Dmaven%3A%2F%2Forg.springframework.cloud.stream.app%3Ahttp-source-rabbit%3A1.1.0.RELEASE&amp;force=false</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-bulk-request-parameters"><font o="3763">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3764">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3765">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3766">可以获取包含注册的属性文件的URI。</font><font o="3767">仅限<code i="1078">apps</code>。</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>apps</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3768">内联注册。</font><font o="3769">仅限<code i="1079">uri</code>。</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>force</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3770">如果已存在具有相同名称和类型的注册，则必须为true，否则将发生错误</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-bulk-example-request"><font o="3771">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/apps' -i -X POST -d 'apps=source.http%3Dmaven%3A%2F%2Forg.springframework.cloud.stream.app%3Ahttp-source-rabbit%3A1.1.0.RELEASE&amp;force=false'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-app-registry-bulk-response-structure"><font o="3772">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 201 Created
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 587

{
  "_embedded" : {
    "appRegistrationResourceList" : [ {
      "name" : "http",
      "type" : "source",
      "uri" : "maven://org.springframework.cloud.stream.app:http-source-rabbit:1.1.0.RELEASE",
      "version" : null,
      "defaultVersion" : false,
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/apps/source/http"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/apps?page=0&amp;size=20"
    }
  },
  "page" : {
    "size" : 20,
    "totalElements" : 1,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-audit-records">70.4.<font o="3774">审计记录</font></h3>
<div class="sect3">
<h4 id="api-guide-resources-audit-records-list">70.4.1.<font o="3776">列出所有审核记录</font></h4>
<div class="paragraph">
<p><font o="3777">审计记录端点允许您检索审计跟踪信息。</font></p>
</div>
<div class="paragraph">
<p><font o="3778">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-audit-records-list-request-structure"><font o="3779">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-audit-records-list-request-parameters"><font o="3780">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-audit-records-list-example-request"><font o="3781">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-audit-records-list-response-structure"><font o="3782">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-audit-records-list-request-structure"><font o="3783">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /audit-records?page=0&amp;size=10&amp;operations=STREAM&amp;actions=CREATE HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-audit-records-list-request-parameters"><font o="3784">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3785">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3786">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3787">从零开始的页码（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3788">请求的页面大小（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>operations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3789">逗号分隔的审计操作列表（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>actions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3790">逗号分隔的审计操作列表（可选）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-audit-records-list-example-request"><font o="3791">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/audit-records?page=0&amp;size=10&amp;operations=STREAM&amp;actions=CREATE' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-audit-records-list-response-structure"><font o="3792">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 651

{
  "_embedded" : {
    "auditRecordResourceList" : [ {
      "auditRecordId" : 1,
      "createdBy" : null,
      "correlationId" : "timelog",
      "auditData" : "time --format='YYYY MM DD' | log",
      "createdOn" : "2018-12-05T14:41:54.902Z",
      "auditAction" : "CREATE",
      "auditOperation" : "STREAM",
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/audit-records/1"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/audit-records?page=0&amp;size=10"
    }
  },
  "page" : {
    "size" : 10,
    "totalElements" : 1,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-stream-definitions">70.5.<font o="3794">流定义</font></h3>
<div class="paragraph">
<p><font o="3795">已注册的应用程序端点提供有关在Spring Cloud Data Flow服务器中注册的流定义的信息。</font><font o="3796">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-create"><font o="3797">创建新的流定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-list"><font o="3798">列出所有流定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-list-related"><font o="3799">列出相关的流定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-delete-one"><font o="3800">删除单流定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-delete-all"><font o="3801">删除所有流定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-deployment-deploy"><font o="3802">部署流定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-deployment-undeploy"><font o="3803">取消部署流定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-deployment-undeploy-all"><font o="3804">取消部署所有流定义</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-definitions-create">70.5.1.<font o="3806">创建新的流定义</font></h4>
<div class="paragraph">
<p><font o="3807">通过为流定义端点创建POST请求来实现创建流定义。</font><font o="3808"><code i="1080">ticktock</code>流的curl请求可能类似于以下内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">curl -X POST -d "name=ticktock&amp;definition=time | log" localhost:9393/streams/definitions?deploy=false</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="3809">流定义还可以包含其他参数。</font><font o="3810">例如，在“ </font><a href="#api-guide-resources-stream-definitions-create-request-structure"><font o="3810">请求结构</font></a><font o="3810"> ” </font><font o="3810">下显示的示例中</font><font o="3810">，我们还提供了日期时间格式。</font></p>
</div>
<div class="paragraph">
<p><font o="3811">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-create-request-structure"><font o="3812">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-create-request-parameters"><font o="3813">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-create-example-request"><font o="3814">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-create-response-structure"><font o="3815">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-create-request-structure"><font o="3816">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">POST /streams/definitions HTTP/1.1
Host: localhost:9393
Content-Type: application/x-www-form-urlencoded

name=timelog&amp;definition=time+--format%3D%27YYYY+MM+DD%27+%7C+log&amp;deploy=false</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-create-request-parameters"><font o="3817">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3818">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3819">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3820">创建的任务定义的名称</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>definition</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3821">流的定义，使用Data Flow DSL</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>deploy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3822">如果为true，则在创建时部署流（默认为false）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-create-example-request"><font o="3823">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/definitions' -i -X POST -d 'name=timelog&amp;definition=time+--format%3D%27YYYY+MM+DD%27+%7C+log&amp;deploy=false'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-create-response-structure"><font o="3824">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 201 Created
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 307

{
  "name" : "timelog",
  "dslText" : "time --format='YYYY MM DD' | log",
  "status" : "undeployed",
  "statusDescription" : "The app or group is known to the system, but is not currently deployed",
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/streams/definitions/timelog"
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-definitions-list">70.5.2.<font o="3826">列出所有流定义</font></h4>
<div class="paragraph">
<p><font o="3827">流端点允许您列出所有流定义。</font><font o="3828">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-list-request-structure"><font o="3829">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-list-request-parameters"><font o="3830">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-list-example-request"><font o="3831">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-list-response-structure"><font o="3832">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-list-request-structure"><font o="3833">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /streams/definitions?page=0&amp;size=10 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-list-request-parameters"><font o="3834">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3835">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3836">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3837">从零开始的页码（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3838">请求的页面大小（可选）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-list-example-request"><font o="3839">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/definitions?page=0&amp;size=10' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-list-response-structure"><font o="3840">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 628

{
  "_embedded" : {
    "streamDefinitionResourceList" : [ {
      "name" : "timelog",
      "dslText" : "time --format='YYYY MM DD' | log",
      "status" : "undeployed",
      "statusDescription" : "The app or group is known to the system, but is not currently deployed",
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/streams/definitions/timelog"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/streams/definitions?page=0&amp;size=10"
    }
  },
  "page" : {
    "size" : 10,
    "totalElements" : 1,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-definitions-list-related">70.5.3.<font o="3842">列出相关的流定义</font></h4>
<div class="paragraph">
<p><font o="3843">流端点允许您列出相关的流定义。</font><font o="3844">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-list-related-request-structure"><font o="3845">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-list-related-request-parameters"><font o="3846">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-list-related-example-request"><font o="3847">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-list-related-response-structure"><font o="3848">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-list-related-request-structure"><font o="3849">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /streams/definitions/timelog/related?nested=true HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-list-related-request-parameters"><font o="3850">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3851">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3852">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>nested</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3853">我们是否应该递归地找到相关流定义的ByNameLike（可选）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-list-related-example-request"><font o="3854">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/definitions/timelog/related?nested=true' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-list-related-response-structure"><font o="3855">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 644

{
  "_embedded" : {
    "streamDefinitionResourceList" : [ {
      "name" : "timelog",
      "dslText" : "time --format='YYYY MM DD' | log",
      "status" : "undeployed",
      "statusDescription" : "The app or group is known to the system, but is not currently deployed",
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/streams/definitions/timelog"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/streams/definitions/timelog/related?page=0&amp;size=20"
    }
  },
  "page" : {
    "size" : 20,
    "totalElements" : 1,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-definitions-delete-one">70.5.4.<font o="3857">删除单流定义</font></h4>
<div class="paragraph">
<p><font o="3858">流端点允许您删除单个流定义。</font><font o="3859">（另请参阅：</font><a href="#api-guide-resources-stream-definitions-delete-all"><font o="3859">删除所有流定义</font></a><font o="3859">。）以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-delete-one-request-structure"><font o="3860">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-delete-one-request-parameters"><font o="3861">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-delete-one-example-request"><font o="3862">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-delete-one-response-structure"><font o="3863">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-delete-one-request-structure"><font o="3864">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">DELETE /streams/definitions/timelog HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-delete-one-request-parameters"><font o="3865">请求参数</font></h5>
<div class="paragraph">
<p><font o="3866">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-delete-one-example-request"><font o="3867">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/definitions/timelog' -i -X DELETE</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-delete-one-response-structure"><font o="3868">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-definitions-delete-all">70.5.5.<font o="3870">删除所有流定义</font></h4>
<div class="paragraph">
<p><font o="3871">流端点允许您删除所有单个流定义。</font><font o="3872">（另请参阅：</font><a href="#api-guide-resources-stream-definitions-delete-one"><font o="3872">删除单个流定义</font></a><font o="3872">。）以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-delete-all-request-structure"><font o="3873">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-delete-all-request-parameters"><font o="3874">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-delete-all-example-request"><font o="3875">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-delete-all-response-structure"><font o="3876">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-delete-all-request-structure"><font o="3877">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">DELETE /streams/definitions HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-delete-all-request-parameters"><font o="3878">请求参数</font></h5>
<div class="paragraph">
<p><font o="3879">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-delete-all-example-request"><font o="3880">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/definitions' -i -X DELETE</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-delete-all-response-structure"><font o="3881">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-stream-validate">70.6.<font o="3883">流验证</font></h3>
<div class="paragraph">
<p><font o="3884">流验证端点允许您在流定义中验证应用程序。</font><font o="3885">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-validation-request-structure"><font o="3886">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-validation-request-parameters"><font o="3887">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-validation-example-request"><font o="3888">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-validation-response-structure"><font o="3889">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-validation-request-structure">70.6.1.<font o="3891">请求结构</font></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /streams/validation/timelog HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-validation-request-parameters">70.6.2.<font o="3893">请求参数</font></h4>
<div class="paragraph">
<p><font o="3894">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-validation-example-request">70.6.3.<font o="3896">示例请求</font></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/validation/timelog' -i</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-validation-response-structure">70.6.4.<font o="3898">响应结构</font></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 152

{
  "appName" : "timelog",
  "dsl" : "time --format='YYYY MM DD' | log",
  "appStatuses" : {
    "source:time" : "valid",
    "sink:log" : "valid"
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-stream-deployment">70.7.<font o="3900">流部署</font></h3>
<div class="paragraph">
<p><font o="3901">部署定义端点提供有关使用Spring Cloud Data Flow服务器注册的部署的信息。</font><font o="3902">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-deployment-deploy"><font o="3903">部署流定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-deployment-undeploy"><font o="3904">取消部署流定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-deployment-undeploy-all"><font o="3905">取消部署所有流定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-deployment-update"><font o="3906">更新已部署的流</font></a><font o="3906">（在Skipper模式下）</font></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-deployment-rollback"><font o="3907">回滚流定义</font></a><font o="3907">（在Skipper模式下）</font></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-deployment-manifest"><font o="3908">获取清单</font></a><font o="3908">（在Skipper模式下）</font></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-deployment-history"><font o="3909">获取部署历史记录</font></a><font o="3909">（在Skipper模式下）</font></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-deployment-platform-list"><font o="3910">获取部署平台</font></a><font o="3910">（在Skipper模式下）</font></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-deployment-deploy">70.7.1.<font o="3912">部署流定义</font></h4>
<div class="paragraph">
<p><font o="3913">流定义端点允许您部署单个流定义。</font><font o="3914">（可选）您可以将应用程序参数作为属性传递到请求正文中。</font><font o="3915">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-deploy-request-structure"><font o="3916">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-deploy-request-parameters"><font o="3917">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-deploy-example-request"><font o="3918">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-deploy-response-structure"><font o="3919">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-deploy-request-structure"><font o="3920">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">POST /streams/deployments/timelog HTTP/1.1
Content-Type: application/json
Host: localhost:9393
Content-Length: 36

{"app.time.timestamp.format":"YYYY"}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="3921">表7. / streams / deployments / {timelog}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3922">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3923">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>timelog</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3924">现有流定义的名称（必需）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-deploy-request-parameters"><font o="3925">请求参数</font></h5>
<div class="paragraph">
<p><font o="3926">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-deploy-example-request"><font o="3927">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/deployments/timelog' -i -X POST -H 'Content-Type: application/json' -d '{"app.time.timestamp.format":"YYYY"}'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-deploy-response-structure"><font o="3928">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 201 Created</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-deployment-undeploy">70.7.2.<font o="3930">取消部署流定义</font></h4>
<div class="paragraph">
<p><font o="3931">流定义端点允许您取消部署单个流定义。</font><font o="3932">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-undeploy-request-structure"><font o="3933">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-undeploy-request-parameters"><font o="3934">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-undeploy-example-request"><font o="3935">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-undeploy-response-structure"><font o="3936">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-undeploy-request-structure"><font o="3937">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">DELETE /streams/deployments/timelog HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="3938">表8. / streams / deployments / {timelog}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3939">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3940">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>timelog</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3941">现有流定义的名称（必需）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-undeploy-request-parameters"><font o="3942">请求参数</font></h5>
<div class="paragraph">
<p><font o="3943">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-undeploy-example-request"><font o="3944">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/deployments/timelog' -i -X DELETE</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-undeploy-response-structure"><font o="3945">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-deployment-undeploy-all">70.7.3.<font o="3947">取消部署所有流定义</font></h4>
<div class="paragraph">
<p><font o="3948">流定义端点允许您取消部署所有单个流定义。</font><font o="3949">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-undeploy-all-request-structure"><font o="3950">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-undeploy-all-request-parameters"><font o="3951">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-undeploy-all-example-request"><font o="3952">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-undeploy-all-response-structure"><font o="3953">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-undeploy-all-request-structure"><font o="3954">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">DELETE /streams/deployments HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-undeploy-all-request-parameters"><font o="3955">请求参数</font></h5>
<div class="paragraph">
<p><font o="3956">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-undeploy-all-example-request"><font o="3957">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/deployments' -i -X DELETE</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-undeploy-all-response-structure"><font o="3958">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-deployment-update">70.7.4.<font o="3960">更新已部署的流</font></h4>
<div class="paragraph">
<p><font o="3961">在Skipper模式下</font><font o="3961">使用</font><em><font o="3961">Spring Cloud Data Flow</font></em><font o="3961">时，您可以更新已部署的流，并提供其他部署属性。</font></p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="3962">
要使用此功能，数据流服务器必须处于</font><a href="#spring-cloud-dataflow-stream-lifecycle-skipper"><font o="3962">Skipper模式</font></a>
</td>
</tr>
</tbody></table>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-update-request-structure"><font o="3963">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-update-request-parameters"><font o="3964">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-update-example-request"><font o="3965">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-update-response-structure"><font o="3966">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-update-request-structure"><font o="3967">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">POST /streams/deployments/update/timelog1 HTTP/1.1
Content-Type: application/json
Host: localhost:9393
Content-Length: 196

{"releaseName":"timelog1","packageIdentifier":{"repositoryName":"test","packageName":"timelog1","packageVersion":"1.0.0"},"updateProperties":{"app.time.timestamp.format":"YYYYMMDD"},"force":false}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="3968">表9. / streams / deployments / update / {timelog1}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3969">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3970">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>timelog1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3971">现有流定义的名称（必需）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-update-request-parameters"><font o="3972">请求参数</font></h5>
<div class="paragraph">
<p><font o="3973">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-update-example-request"><font o="3974">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/deployments/update/timelog1' -i -X POST -H 'Content-Type: application/json' -d '{"releaseName":"timelog1","packageIdentifier":{"repositoryName":"test","packageName":"timelog1","packageVersion":"1.0.0"},"updateProperties":{"app.time.timestamp.format":"YYYYMMDD"},"force":false}'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-update-response-structure"><font o="3975">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 201 Created</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-deployment-rollback">70.7.5.<font o="3977">回滚流定义</font></h4>
<div class="paragraph">
<p><font o="3978">将流回滚到前一个或特定版本的流。</font></p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="3979">
要使用此功能，数据流服务器必须处于</font><a href="#spring-cloud-dataflow-stream-lifecycle-skipper"><font o="3979">Skipper模式</font></a>
</td>
</tr>
</tbody></table>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-rollback-request-structure"><font o="3980">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-rollback-request-parameters"><font o="3981">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-rollback-example-request"><font o="3982">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-rollback-response-structure"><font o="3983">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-rollback-request-structure"><font o="3984">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">POST /streams/deployments/rollback/timelog1/1 HTTP/1.1
Content-Type: application/json
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="3985">表10. / streams / deploymentments // rollback / {name} / {version}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="3986">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="3987">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3988">现有流定义的名称（必需）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>version</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="3989">要回滚的版本</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-rollback-request-parameters"><font o="3990">请求参数</font></h5>
<div class="paragraph">
<p><font o="3991">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-rollback-example-request"><font o="3992">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/deployments/rollback/timelog1/1' -i -X POST -H 'Content-Type: application/json'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-rollback-response-structure"><font o="3993">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 201 Created</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-deployment-manifest">70.7.6.<font o="3995">获得清单</font></h4>
<div class="paragraph">
<p><font o="3996">返回已发布版本的清单。</font><font o="3997">对于具有依赖项的包，清单包含这些依赖项的内容。</font></p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="3998">
要使用此功能，数据流服务器必须处于</font><a href="#spring-cloud-dataflow-stream-lifecycle-skipper"><font o="3998">Skipper模式</font></a>
</td>
</tr>
</tbody></table>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-manifest-request-structure"><font o="3999">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-manifest-request-parameters"><font o="4000">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-manifest-example-request"><font o="4001">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-manifest-response-structure"><font o="4002">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-manifest-request-structure"><font o="4003">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /streams/deployments/manifest/timelog1/1 HTTP/1.1
Content-Type: application/json
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4004">表11. / streams / deployments / manifest / {name} / {version}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4005">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4006">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4007">现有流定义的名称（必需）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>version</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4008">流的版本</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-manifest-request-parameters"><font o="4009">请求参数</font></h5>
<div class="paragraph">
<p><font o="4010">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-manifest-example-request"><font o="4011">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/deployments/manifest/timelog1/1' -i -H 'Content-Type: application/json'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-manifest-response-structure"><font o="4012">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 2332

"\"apiVersion\": \"skipper.spring.io/v1\"\n\"kind\": \"SpringCloudDeployerApplication\"\n\"metadata\":\n  \"name\": \"time\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:time-source-rabbit\"\n  \"resourceMetadata\": \"maven://org.springframework.cloud.stream.app:time-source-rabbit:jar:metadata:1.2.0.RELEASE\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"applicationProperties\":\n    \"timestamp.format\": \"YYYY\"\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"time\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.time.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.output.producer.requiredGroups\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"format\": \"YYYY MM DD\"\n    \"spring.cloud.stream.bindings.output.destination\": \"timelog1.time\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"source\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.group\": \"timelog1\"\n---\n\"apiVersion\": \"skipper.spring.io/v1\"\n\"kind\": \"SpringCloudDeployerApplication\"\n\"metadata\":\n  \"name\": \"log\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:log-sink-rabbit\"\n  \"resourceMetadata\": \"maven://org.springframework.cloud.stream.app:log-sink-rabbit:jar:metadata:1.2.0.RELEASE\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"applicationProperties\":\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"log\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.log.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.input.group\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"sink\"\n    \"spring.cloud.stream.bindings.input.destination\": \"timelog1.time\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.group\": \"timelog1\"\n"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-deployment-history">70.7.7.<font o="4014">获取部署历史记录</font></h4>
<div class="paragraph">
<p><font o="4015">获取流的部署历史记录。</font></p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="4016">
要使用此功能，数据流服务器必须处于</font><a href="#spring-cloud-dataflow-stream-lifecycle-skipper"><font o="4016">Skipper模式</font></a>
</td>
</tr>
</tbody></table>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-history-request-structure"><font o="4017">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-history-example-request"><font o="4018">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-history-response-structure"><font o="4019">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-history-request-structure"><font o="4020">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /streams/deployments/history/timelog1 HTTP/1.1
Content-Type: application/json
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-history-example-request"><font o="4021">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/deployments/history/timelog1' -i -H 'Content-Type: application/json'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-history-response-structure"><font o="4022">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 25705

[ {
  "name" : "timelog1",
  "version" : 3,
  "info" : {
    "status" : {
      "statusCode" : "DEPLOYED",
      "platformStatus" : "[{\"deploymentId\":\"timelog1.log-v1\",\"instances\":{\"timelog1.log-v1-0\":{\"instanceNumber\":0,\"baseUrl\":\"http://10.194.6.22:35443\",\"attributes\":{\"guid\":\"35443\",\"pid\":\"680\",\"port\":\"35443\",\"stderr\":\"/tmp/spring-cloud-deployer-2950880049650447965/timelog1-1544020970140/timelog1.log-v1/stderr_0.log\",\"stdout\":\"/tmp/spring-cloud-deployer-2950880049650447965/timelog1-1544020970140/timelog1.log-v1/stdout_0.log\",\"url\":\"http://10.194.6.22:35443\",\"working.dir\":\"/tmp/spring-cloud-deployer-2950880049650447965/timelog1-1544020970140/timelog1.log-v1\"},\"process\":{\"outputStream\":{},\"errorStream\":{},\"alive\":true,\"inputStream\":{}},\"id\":\"timelog1.log-v1-0\",\"state\":\"deployed\"}},\"state\":\"deployed\"},{\"deploymentId\":\"timelog1.time-v3\",\"instances\":{\"timelog1.time-v3-0\":{\"instanceNumber\":0,\"baseUrl\":\"http://10.194.6.22:56016\",\"attributes\":{\"guid\":\"56016\",\"pid\":\"1134\",\"port\":\"56016\",\"stderr\":\"/tmp/spring-cloud-deployer-2950880049650447965/timelog1-1544021031166/timelog1.time-v3/stderr_0.log\",\"stdout\":\"/tmp/spring-cloud-deployer-2950880049650447965/timelog1-1544021031166/timelog1.time-v3/stdout_0.log\",\"url\":\"http://10.194.6.22:56016\",\"working.dir\":\"/tmp/spring-cloud-deployer-2950880049650447965/timelog1-1544021031166/timelog1.time-v3\"},\"process\":{\"outputStream\":{},\"errorStream\":{},\"alive\":true,\"inputStream\":{}},\"id\":\"timelog1.time-v3-0\",\"state\":\"deployed\"}},\"state\":\"deployed\"}]"
    },
    "firstDeployed" : "2018-12-05T14:43:51.059+0000",
    "lastDeployed" : "2018-12-05T14:43:51.059+0000",
    "deleted" : null,
    "description" : "Rollback complete"
  },
  "pkg" : {
    "metadata" : {
      "apiVersion" : "skipper.spring.io/v1",
      "origin" : null,
      "repositoryId" : 2,
      "repositoryName" : "local",
      "kind" : "SpringCloudDeployerApplication",
      "name" : "timelog1",
      "displayName" : null,
      "version" : "1.0.0",
      "packageSourceUrl" : null,
      "packageHomeUrl" : null,
      "tags" : null,
      "maintainer" : "dataflow",
      "description" : "time --format='YYYY MM DD' | log",
      "sha256" : null,
      "iconUrl" : null
    },
    "templates" : [ ],
    "dependencies" : [ {
      "metadata" : {
        "apiVersion" : "skipper.spring.io/v1",
        "origin" : null,
        "repositoryId" : null,
        "repositoryName" : null,
        "kind" : "SpringCloudDeployerApplication",
        "name" : "time",
        "displayName" : null,
        "version" : "1.0.0",
        "packageSourceUrl" : null,
        "packageHomeUrl" : null,
        "tags" : null,
        "maintainer" : "dataflow",
        "description" : null,
        "sha256" : null,
        "iconUrl" : null
      },
      "templates" : [ {
        "name" : "time.yml",
        "data" : "apiVersion: skipper.spring.io/v1\nkind: SpringCloudDeployerApplication\nmetadata:\n  {{#metadata.entrySet}}\n  \"{{{key}}}\": \"{{{value}}}\"\n  {{/metadata.entrySet}}\nspec:\n  resource: \"{{{spec.resource}}}\"\n  resourceMetadata: \"{{{spec.resource}}}:jar:metadata:{{{spec.version}}}\"\n  version: \"{{{spec.version}}}\"\n  applicationProperties:\n    {{#spec.applicationProperties.entrySet}}\n    \"{{{key}}}\": \"{{{value}}}\"\n    {{/spec.applicationProperties.entrySet}}\n  deploymentProperties:\n    {{#spec.deploymentProperties.entrySet}}\n    \"{{{key}}}\": \"{{{value}}}\"\n    {{/spec.deploymentProperties.entrySet}}\n"
      } ],
      "dependencies" : [ ],
      "configValues" : {
        "raw" : "\"metadata\":\n  \"name\": \"time\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:time-source-rabbit\"\n  \"applicationProperties\":\n    \"timestamp.format\": \"YYYY\"\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"time\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.time.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.output.producer.requiredGroups\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"format\": \"YYYY MM DD\"\n    \"spring.cloud.stream.bindings.output.destination\": \"timelog1.time\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"source\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.group\": \"timelog1\"\n"
      },
      "fileHolders" : [ ]
    }, {
      "metadata" : {
        "apiVersion" : "skipper.spring.io/v1",
        "origin" : null,
        "repositoryId" : null,
        "repositoryName" : null,
        "kind" : "SpringCloudDeployerApplication",
        "name" : "log",
        "displayName" : null,
        "version" : "1.0.0",
        "packageSourceUrl" : null,
        "packageHomeUrl" : null,
        "tags" : null,
        "maintainer" : "dataflow",
        "description" : null,
        "sha256" : null,
        "iconUrl" : null
      },
      "templates" : [ {
        "name" : "log.yml",
        "data" : "apiVersion: skipper.spring.io/v1\nkind: SpringCloudDeployerApplication\nmetadata:\n  {{#metadata.entrySet}}\n  \"{{{key}}}\": \"{{{value}}}\"\n  {{/metadata.entrySet}}\nspec:\n  resource: \"{{{spec.resource}}}\"\n  resourceMetadata: \"{{{spec.resource}}}:jar:metadata:{{{spec.version}}}\"\n  version: \"{{{spec.version}}}\"\n  applicationProperties:\n    {{#spec.applicationProperties.entrySet}}\n    \"{{{key}}}\": \"{{{value}}}\"\n    {{/spec.applicationProperties.entrySet}}\n  deploymentProperties:\n    {{#spec.deploymentProperties.entrySet}}\n    \"{{{key}}}\": \"{{{value}}}\"\n    {{/spec.deploymentProperties.entrySet}}\n"
      } ],
      "dependencies" : [ ],
      "configValues" : {
        "raw" : "\"metadata\":\n  \"name\": \"log\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:log-sink-rabbit\"\n  \"applicationProperties\":\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"log\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.log.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.input.group\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"sink\"\n    \"spring.cloud.stream.bindings.input.destination\": \"timelog1.time\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.group\": \"timelog1\"\n"
      },
      "fileHolders" : [ ]
    } ],
    "configValues" : null,
    "fileHolders" : [ ]
  },
  "configValues" : {
    "raw" : null
  },
  "manifest" : {
    "data" : "\"apiVersion\": \"skipper.spring.io/v1\"\n\"kind\": \"SpringCloudDeployerApplication\"\n\"metadata\":\n  \"name\": \"time\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:time-source-rabbit\"\n  \"resourceMetadata\": \"maven://org.springframework.cloud.stream.app:time-source-rabbit:jar:metadata:1.2.0.RELEASE\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"applicationProperties\":\n    \"timestamp.format\": \"YYYY\"\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"time\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.time.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.output.producer.requiredGroups\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"format\": \"YYYY MM DD\"\n    \"spring.cloud.stream.bindings.output.destination\": \"timelog1.time\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"source\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.count\": \"1\"\n    \"spring.cloud.deployer.group\": \"timelog1\"\n---\n\"apiVersion\": \"skipper.spring.io/v1\"\n\"kind\": \"SpringCloudDeployerApplication\"\n\"metadata\":\n  \"name\": \"log\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:log-sink-rabbit\"\n  \"resourceMetadata\": \"maven://org.springframework.cloud.stream.app:log-sink-rabbit:jar:metadata:1.2.0.RELEASE\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"applicationProperties\":\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"log\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.log.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.input.group\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"sink\"\n    \"spring.cloud.stream.bindings.input.destination\": \"timelog1.time\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.group\": \"timelog1\"\n"
  },
  "platformName" : "default"
}, {
  "name" : "timelog1",
  "version" : 2,
  "info" : {
    "status" : {
      "statusCode" : "DELETED",
      "platformStatus" : null
    },
    "firstDeployed" : "2018-12-05T14:43:20.554+0000",
    "lastDeployed" : "2018-12-05T14:43:20.554+0000",
    "deleted" : null,
    "description" : "Delete complete"
  },
  "pkg" : {
    "metadata" : {
      "apiVersion" : "skipper.spring.io/v1",
      "origin" : null,
      "repositoryId" : 2,
      "repositoryName" : "local",
      "kind" : "SpringCloudDeployerApplication",
      "name" : "timelog1",
      "displayName" : null,
      "version" : "1.0.0",
      "packageSourceUrl" : null,
      "packageHomeUrl" : null,
      "tags" : null,
      "maintainer" : "dataflow",
      "description" : "time --format='YYYY MM DD' | log",
      "sha256" : null,
      "iconUrl" : null
    },
    "templates" : [ ],
    "dependencies" : [ {
      "metadata" : {
        "apiVersion" : "skipper.spring.io/v1",
        "origin" : null,
        "repositoryId" : null,
        "repositoryName" : null,
        "kind" : "SpringCloudDeployerApplication",
        "name" : "time",
        "displayName" : null,
        "version" : "1.0.0",
        "packageSourceUrl" : null,
        "packageHomeUrl" : null,
        "tags" : null,
        "maintainer" : "dataflow",
        "description" : null,
        "sha256" : null,
        "iconUrl" : null
      },
      "templates" : [ {
        "name" : "time.yml",
        "data" : "apiVersion: skipper.spring.io/v1\nkind: SpringCloudDeployerApplication\nmetadata:\n  {{#metadata.entrySet}}\n  \"{{{key}}}\": \"{{{value}}}\"\n  {{/metadata.entrySet}}\nspec:\n  resource: \"{{{spec.resource}}}\"\n  resourceMetadata: \"{{{spec.resource}}}:jar:metadata:{{{spec.version}}}\"\n  version: \"{{{spec.version}}}\"\n  applicationProperties:\n    {{#spec.applicationProperties.entrySet}}\n    \"{{{key}}}\": \"{{{value}}}\"\n    {{/spec.applicationProperties.entrySet}}\n  deploymentProperties:\n    {{#spec.deploymentProperties.entrySet}}\n    \"{{{key}}}\": \"{{{value}}}\"\n    {{/spec.deploymentProperties.entrySet}}\n"
      } ],
      "dependencies" : [ ],
      "configValues" : {
        "raw" : "\"metadata\":\n  \"name\": \"time\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:time-source-rabbit\"\n  \"applicationProperties\":\n    \"timestamp.format\": \"YYYY\"\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"time\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.time.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.output.producer.requiredGroups\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"format\": \"YYYY MM DD\"\n    \"spring.cloud.stream.bindings.output.destination\": \"timelog1.time\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"source\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.group\": \"timelog1\"\n"
      },
      "fileHolders" : [ ]
    }, {
      "metadata" : {
        "apiVersion" : "skipper.spring.io/v1",
        "origin" : null,
        "repositoryId" : null,
        "repositoryName" : null,
        "kind" : "SpringCloudDeployerApplication",
        "name" : "log",
        "displayName" : null,
        "version" : "1.0.0",
        "packageSourceUrl" : null,
        "packageHomeUrl" : null,
        "tags" : null,
        "maintainer" : "dataflow",
        "description" : null,
        "sha256" : null,
        "iconUrl" : null
      },
      "templates" : [ {
        "name" : "log.yml",
        "data" : "apiVersion: skipper.spring.io/v1\nkind: SpringCloudDeployerApplication\nmetadata:\n  {{#metadata.entrySet}}\n  \"{{{key}}}\": \"{{{value}}}\"\n  {{/metadata.entrySet}}\nspec:\n  resource: \"{{{spec.resource}}}\"\n  resourceMetadata: \"{{{spec.resource}}}:jar:metadata:{{{spec.version}}}\"\n  version: \"{{{spec.version}}}\"\n  applicationProperties:\n    {{#spec.applicationProperties.entrySet}}\n    \"{{{key}}}\": \"{{{value}}}\"\n    {{/spec.applicationProperties.entrySet}}\n  deploymentProperties:\n    {{#spec.deploymentProperties.entrySet}}\n    \"{{{key}}}\": \"{{{value}}}\"\n    {{/spec.deploymentProperties.entrySet}}\n"
      } ],
      "dependencies" : [ ],
      "configValues" : {
        "raw" : "\"metadata\":\n  \"name\": \"log\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:log-sink-rabbit\"\n  \"applicationProperties\":\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"log\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.log.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.input.group\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"sink\"\n    \"spring.cloud.stream.bindings.input.destination\": \"timelog1.time\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.group\": \"timelog1\"\n"
      },
      "fileHolders" : [ ]
    } ],
    "configValues" : null,
    "fileHolders" : [ ]
  },
  "configValues" : {
    "raw" : "log:\n  spec:\n    applicationProperties:\n      spring.cloud.dataflow.stream.app.type: sink\ntime:\n  spec:\n    applicationProperties:\n      timestamp.format: YYYYMMDD\n      spring.cloud.dataflow.stream.app.type: source\n"
  },
  "manifest" : {
    "data" : "\"apiVersion\": \"skipper.spring.io/v1\"\n\"kind\": \"SpringCloudDeployerApplication\"\n\"metadata\":\n  \"name\": \"time\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:time-source-rabbit\"\n  \"resourceMetadata\": \"maven://org.springframework.cloud.stream.app:time-source-rabbit:jar:metadata:1.2.0.RELEASE\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"applicationProperties\":\n    \"timestamp.format\": \"YYYYMMDD\"\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"time\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.time.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.output.producer.requiredGroups\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"format\": \"YYYY MM DD\"\n    \"spring.cloud.stream.bindings.output.destination\": \"timelog1.time\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"source\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.count\": \"1\"\n    \"spring.cloud.deployer.group\": \"timelog1\"\n---\n\"apiVersion\": \"skipper.spring.io/v1\"\n\"kind\": \"SpringCloudDeployerApplication\"\n\"metadata\":\n  \"name\": \"log\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:log-sink-rabbit\"\n  \"resourceMetadata\": \"maven://org.springframework.cloud.stream.app:log-sink-rabbit:jar:metadata:1.2.0.RELEASE\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"applicationProperties\":\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"log\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.log.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.input.group\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"sink\"\n    \"spring.cloud.stream.bindings.input.destination\": \"timelog1.time\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.group\": \"timelog1\"\n"
  },
  "platformName" : "default"
}, {
  "name" : "timelog1",
  "version" : 1,
  "info" : {
    "status" : {
      "statusCode" : "DELETED",
      "platformStatus" : null
    },
    "firstDeployed" : "2018-12-05T14:42:49.973+0000",
    "lastDeployed" : "2018-12-05T14:42:49.973+0000",
    "deleted" : null,
    "description" : "Delete complete"
  },
  "pkg" : {
    "metadata" : {
      "apiVersion" : "skipper.spring.io/v1",
      "origin" : null,
      "repositoryId" : 2,
      "repositoryName" : "local",
      "kind" : "SpringCloudDeployerApplication",
      "name" : "timelog1",
      "displayName" : null,
      "version" : "1.0.0",
      "packageSourceUrl" : null,
      "packageHomeUrl" : null,
      "tags" : null,
      "maintainer" : "dataflow",
      "description" : "time --format='YYYY MM DD' | log",
      "sha256" : null,
      "iconUrl" : null
    },
    "templates" : [ ],
    "dependencies" : [ {
      "metadata" : {
        "apiVersion" : "skipper.spring.io/v1",
        "origin" : null,
        "repositoryId" : null,
        "repositoryName" : null,
        "kind" : "SpringCloudDeployerApplication",
        "name" : "time",
        "displayName" : null,
        "version" : "1.0.0",
        "packageSourceUrl" : null,
        "packageHomeUrl" : null,
        "tags" : null,
        "maintainer" : "dataflow",
        "description" : null,
        "sha256" : null,
        "iconUrl" : null
      },
      "templates" : [ {
        "name" : "time.yml",
        "data" : "apiVersion: skipper.spring.io/v1\nkind: SpringCloudDeployerApplication\nmetadata:\n  {{#metadata.entrySet}}\n  \"{{{key}}}\": \"{{{value}}}\"\n  {{/metadata.entrySet}}\nspec:\n  resource: \"{{{spec.resource}}}\"\n  resourceMetadata: \"{{{spec.resource}}}:jar:metadata:{{{spec.version}}}\"\n  version: \"{{{spec.version}}}\"\n  applicationProperties:\n    {{#spec.applicationProperties.entrySet}}\n    \"{{{key}}}\": \"{{{value}}}\"\n    {{/spec.applicationProperties.entrySet}}\n  deploymentProperties:\n    {{#spec.deploymentProperties.entrySet}}\n    \"{{{key}}}\": \"{{{value}}}\"\n    {{/spec.deploymentProperties.entrySet}}\n"
      } ],
      "dependencies" : [ ],
      "configValues" : {
        "raw" : "\"metadata\":\n  \"name\": \"time\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:time-source-rabbit\"\n  \"applicationProperties\":\n    \"timestamp.format\": \"YYYY\"\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"time\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.time.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.output.producer.requiredGroups\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"format\": \"YYYY MM DD\"\n    \"spring.cloud.stream.bindings.output.destination\": \"timelog1.time\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"source\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.group\": \"timelog1\"\n"
      },
      "fileHolders" : [ ]
    }, {
      "metadata" : {
        "apiVersion" : "skipper.spring.io/v1",
        "origin" : null,
        "repositoryId" : null,
        "repositoryName" : null,
        "kind" : "SpringCloudDeployerApplication",
        "name" : "log",
        "displayName" : null,
        "version" : "1.0.0",
        "packageSourceUrl" : null,
        "packageHomeUrl" : null,
        "tags" : null,
        "maintainer" : "dataflow",
        "description" : null,
        "sha256" : null,
        "iconUrl" : null
      },
      "templates" : [ {
        "name" : "log.yml",
        "data" : "apiVersion: skipper.spring.io/v1\nkind: SpringCloudDeployerApplication\nmetadata:\n  {{#metadata.entrySet}}\n  \"{{{key}}}\": \"{{{value}}}\"\n  {{/metadata.entrySet}}\nspec:\n  resource: \"{{{spec.resource}}}\"\n  resourceMetadata: \"{{{spec.resource}}}:jar:metadata:{{{spec.version}}}\"\n  version: \"{{{spec.version}}}\"\n  applicationProperties:\n    {{#spec.applicationProperties.entrySet}}\n    \"{{{key}}}\": \"{{{value}}}\"\n    {{/spec.applicationProperties.entrySet}}\n  deploymentProperties:\n    {{#spec.deploymentProperties.entrySet}}\n    \"{{{key}}}\": \"{{{value}}}\"\n    {{/spec.deploymentProperties.entrySet}}\n"
      } ],
      "dependencies" : [ ],
      "configValues" : {
        "raw" : "\"metadata\":\n  \"name\": \"log\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:log-sink-rabbit\"\n  \"applicationProperties\":\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"log\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.log.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.input.group\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"sink\"\n    \"spring.cloud.stream.bindings.input.destination\": \"timelog1.time\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.group\": \"timelog1\"\n"
      },
      "fileHolders" : [ ]
    } ],
    "configValues" : null,
    "fileHolders" : [ ]
  },
  "configValues" : {
    "raw" : null
  },
  "manifest" : {
    "data" : "\"apiVersion\": \"skipper.spring.io/v1\"\n\"kind\": \"SpringCloudDeployerApplication\"\n\"metadata\":\n  \"name\": \"time\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:time-source-rabbit\"\n  \"resourceMetadata\": \"maven://org.springframework.cloud.stream.app:time-source-rabbit:jar:metadata:1.2.0.RELEASE\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"applicationProperties\":\n    \"timestamp.format\": \"YYYY\"\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"time\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.time.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.output.producer.requiredGroups\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"format\": \"YYYY MM DD\"\n    \"spring.cloud.stream.bindings.output.destination\": \"timelog1.time\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"source\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.group\": \"timelog1\"\n---\n\"apiVersion\": \"skipper.spring.io/v1\"\n\"kind\": \"SpringCloudDeployerApplication\"\n\"metadata\":\n  \"name\": \"log\"\n\"spec\":\n  \"resource\": \"maven://org.springframework.cloud.stream.app:log-sink-rabbit\"\n  \"resourceMetadata\": \"maven://org.springframework.cloud.stream.app:log-sink-rabbit:jar:metadata:1.2.0.RELEASE\"\n  \"version\": \"1.2.0.RELEASE\"\n  \"applicationProperties\":\n    \"spring.metrics.export.triggers.application.includes\": \"integration**\"\n    \"spring.cloud.dataflow.stream.app.label\": \"log\"\n    \"spring.cloud.stream.metrics.key\": \"timelog1.log.${spring.cloud.application.guid}\"\n    \"spring.cloud.stream.bindings.input.group\": \"timelog1\"\n    \"spring.cloud.stream.metrics.properties\": \"spring.application.name,spring.application.index,spring.cloud.application.*,spring.cloud.dataflow.*\"\n    \"spring.cloud.dataflow.stream.name\": \"timelog1\"\n    \"spring.cloud.dataflow.stream.app.type\": \"sink\"\n    \"spring.cloud.stream.bindings.input.destination\": \"timelog1.time\"\n  \"deploymentProperties\":\n    \"spring.cloud.deployer.group\": \"timelog1\"\n"
  },
  "platformName" : "default"
} ]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-stream-deployment-platform-list">70.7.8.<font o="4024">获取部署平台</font></h4>
<div class="paragraph">
<p><font o="4025">检索支持的部署平台列表。</font></p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="4026">
要使用此功能，数据流服务器必须处于</font><a href="#spring-cloud-dataflow-stream-lifecycle-skipper"><font o="4026">Skipper模式</font></a>
</td>
</tr>
</tbody></table>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-platform-list-request-structure"><font o="4027">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-history-example-request"><font o="4028">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-definitions-deployment-history-response-structure"><font o="4029">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-platform-list-request-structure"><font o="4030">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /streams/deployments/platform/list HTTP/1.1
Content-Type: application/json
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-platform-list-example-request"><font o="4031">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/streams/deployments/platform/list' -i -H 'Content-Type: application/json'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-definitions-deployment-platform-list-response-structure"><font o="4032">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 287

[ {
  "id" : null,
  "name" : "default",
  "type" : "local",
  "description" : "ShutdownTimeout = [30], EnvVarsToInherit = [TMP,LANG,LANGUAGE,LC_.*,PATH,SPRING_APPLICATION_JSON], JavaCmd = [/opt/jdk1.8.0_144/jre/bin/java], WorkingDirectoriesRoot = [/tmp], DeleteFilesOnExit = [true]"
} ]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-task-definitions">70.8.<font o="4034">任务定义</font></h3>
<div class="paragraph">
<p><font o="4035">任务定义端点提供有关向Spring Cloud Data Flow服务器注册的任务定义的信息。</font><font o="4036">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-task-definitions-creating"><font o="4037">创建新的任务定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-definitions-list"><font o="4038">列出所有任务定义</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-definition-detail"><font o="4039">检索任务定义详细信息</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-delete-task-definition"><font o="4040">删除任务定义</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-definitions-creating">70.8.1.<font o="4042">创建新的任务定义</font></h4>
<div class="paragraph">
<p><font o="4043">任务定义端点允许您创建新的任务定义。</font><font o="4044">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-task-definitions-creating-request-structure"><font o="4045">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-definitions-creating-request-parameters"><font o="4046">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-definitions-creating-example-request"><font o="4047">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-definitions-creating-response-structure"><font o="4048">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-definitions-creating-request-structure"><font o="4049">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">POST /tasks/definitions HTTP/1.1
Host: localhost:9393
Content-Type: application/x-www-form-urlencoded

name=my-task&amp;definition=timestamp+--format%3D%27YYYY+MM+DD%27</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-definitions-creating-request-parameters"><font o="4050">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4051">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4052">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4053">创建的任务定义的名称</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>definition</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4054">使用Data Flow DSL完成任务的定义</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-definitions-creating-example-request"><font o="4055">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/definitions' -i -X POST -d 'name=my-task&amp;definition=timestamp+--format%3D%27YYYY+MM+DD%27'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-definitions-creating-response-structure"><font o="4056">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 255

{
  "name" : "my-task",
  "dslText" : "timestamp --format='YYYY MM DD'",
  "composed" : false,
  "lastTaskExecution" : null,
  "status" : "UNKNOWN",
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/tasks/definitions/my-task"
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-definitions-list">70.8.2.<font o="4058">列出所有任务定义</font></h4>
<div class="paragraph">
<p><font o="4059">任务定义端点允许您获取所有任务定义。</font><font o="4060">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-task-definitions-list-request-structure"><font o="4061">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-definitions-list-request-parameters"><font o="4062">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-definitions-list-example-request"><font o="4063">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-definitions-list-response-structure"><font o="4064">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-definitions-list-request-structure"><font o="4065">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /tasks/definitions?page=0&amp;size=10 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-definitions-list-request-parameters"><font o="4066">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4067">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4068">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4069">从零开始的页码（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4070">请求的页面大小（可选）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-definitions-list-example-request"><font o="4071">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/definitions?page=0&amp;size=10' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-definitions-list-response-structure"><font o="4072">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 576

{
  "_embedded" : {
    "taskDefinitionResourceList" : [ {
      "name" : "my-task",
      "dslText" : "timestamp --format='YYYY MM DD'",
      "composed" : false,
      "lastTaskExecution" : null,
      "status" : "UNKNOWN",
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/tasks/definitions/my-task"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/tasks/definitions?page=0&amp;size=10"
    }
  },
  "page" : {
    "size" : 10,
    "totalElements" : 1,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-definition-detail">70.8.3.<font o="4074">检索任务定义详细信息</font></h4>
<div class="paragraph">
<p><font o="4075">任务定义端点允许您获取单个任务定义。</font><font o="4076">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-task-definitions-detail-request-structure"><font o="4077">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-definitions-detail-request-parameters"><font o="4078">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-definitions-detail-example-request"><font o="4079">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-definitions-detail-response-structure"><font o="4080">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-definitions-detail-request-structure"><font o="4081">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /tasks/definitions/my-task HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4082">表12. / tasks / definitions / {my-task}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4083">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4084">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>my-task</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4085">现有任务定义的名称（必填）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-definitions-detail-request-parameters"><font o="4086">请求参数</font></h5>
<div class="paragraph">
<p><font o="4087">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-definitions-detail-example-request"><font o="4088">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/definitions/my-task' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-definitions-detail-response-structure"><font o="4089">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 255

{
  "name" : "my-task",
  "dslText" : "timestamp --format='YYYY MM DD'",
  "composed" : false,
  "lastTaskExecution" : null,
  "status" : "UNKNOWN",
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/tasks/definitions/my-task"
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-delete-task-definition">70.8.4.<font o="4091">删除任务定义</font></h4>
<div class="paragraph">
<p><font o="4092">任务定义端点允许您删除单个任务定义。</font><font o="4093">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-delete-task-definition-request-structure"><font o="4094">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-delete-task-definition-request-parameters"><font o="4095">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-delete-task-definition-example-request"><font o="4096">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-delete-task-definition-response-structure"><font o="4097">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-delete-task-definition-request-structure"><font o="4098">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">DELETE /tasks/definitions/my-task HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4099">表13. / tasks / definitions / {my-task}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4100">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4101">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>my-task</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4102">现有任务定义的名称（必填）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-delete-task-definition-request-parameters"><font o="4103">请求参数</font></h5>
<div class="paragraph">
<p><font o="4104">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-delete-task-definition-example-request"><font o="4105">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/definitions/my-task' -i -X DELETE</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-delete-task-definition-response-structure"><font o="4106">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-task-scheduler">70.9.<font o="4108">任务计划程序</font></h3>
<div class="paragraph">
<p><font o="4109">任务计划程序端点提供有关使用计划程序实现注册的任务计划的信息。</font><font o="4110">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-task-schedule-creating"><font o="4111">创建新的任务计划</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-schedule-list"><font o="4112">列出所有时间表</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-schedule-filtered-list"><font o="4113">列出已过滤的计划</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-delete-schedule"><font o="4114">删除任务时间表</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-schedule-creating">70.9.1.<font o="4116">创建新的任务计划</font></h4>
<div class="paragraph">
<p><font o="4117">任务计划端点允许您创建新的任务计划。</font><font o="4118">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-task-schedule-creating-request-structure"><font o="4119">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-schedule-creating-request-parameters"><font o="4120">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-schedule-creating-example-request"><font o="4121">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-schedule-creating-response-structure"><font o="4122">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-schedule-creating-request-structure"><font o="4123">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">POST /tasks/schedules HTTP/1.1
Host: localhost:9393
Content-Type: application/x-www-form-urlencoded

scheduleName=myschedule&amp;taskDefinitionName=mytaskname&amp;properties=scheduler.cron.expression%3D00+22+17+%3F+*&amp;arguments=--foo%3Dbar</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-schedule-creating-request-parameters"><font o="4124">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4125">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4126">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>scheduleName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4127">创建的计划的名称</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>taskDefinitionName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4128">要计划的任务定义的名称</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>properties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4129">计划和启动任务所需的属性</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>arguments</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4130">用于启动任务的命令行参数</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-schedule-creating-example-request"><font o="4131">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/schedules' -i -X POST -d 'scheduleName=myschedule&amp;taskDefinitionName=mytaskname&amp;properties=scheduler.cron.expression%3D00+22+17+%3F+*&amp;arguments=--foo%3Dbar'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-schedule-creating-response-structure"><font o="4132">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 201 Created</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-schedule-list">70.9.2.<font o="4134">列出所有时间表</font></h4>
<div class="paragraph">
<p><font o="4135">任务计划端点允许您获取所有任务计划。</font><font o="4136">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-task-schedule-list-request-structure"><font o="4137">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-schedule-list-request-parameters"><font o="4138">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-schedule-list-example-request"><font o="4139">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-schedule-list-response-structure"><font o="4140">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-schedule-list-request-structure"><font o="4141">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /tasks/schedules?page=0&amp;size=10 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-schedule-list-request-parameters"><font o="4142">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4143">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4144">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4145">从零开始的页码（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4146">请求的页面大小（可选）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-schedule-list-example-request"><font o="4147">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/schedules?page=0&amp;size=10' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-schedule-list-response-structure"><font o="4148">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 585

{
  "_embedded" : {
    "scheduleInfoResourceList" : [ {
      "scheduleName" : "FOO",
      "taskDefinitionName" : "BAR",
      "scheduleProperties" : {
        "scheduler.AAA.spring.cloud.scheduler.cron.expression" : "00 41 17 ? * *"
      },
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/tasks/schedules/FOO"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/tasks/schedules?page=0&amp;size=1"
    }
  },
  "page" : {
    "size" : 1,
    "totalElements" : 1,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-schedule-filtered-list">70.9.3.<font o="4150">列出已过滤的计划</font></h4>
<div class="paragraph">
<p><font o="4151">任务计划端点允许您获取具有指定任务定义名称的所有任务计划。</font><font o="4152">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-stream-task-schedule-list-filtered-request-structure"><font o="4153">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-schedule-list-filtered-request-parameters"><font o="4154">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-schedule-list-filtered-example-request"><font o="4155">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-stream-task-schedule-list-filtered-response-structure"><font o="4156">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-schedule-list-filtered-request-structure"><font o="4157">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /tasks/schedules/instances/FOO?page=0&amp;size=10 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4158">表14. / tasks / schedules / instances / {task-definition-name}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4159">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4160">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>task-definition-name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4161">根据指定的任务定义过滤计划（必需）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-schedule-list-filtered-request-parameters"><font o="4162">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4163">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4164">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4165">从零开始的页码（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4166">请求的页面大小（可选）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-schedule-list-filtered-example-request"><font o="4167">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/schedules/instances/FOO?page=0&amp;size=10' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-stream-task-schedule-list-filtered-response-structure"><font o="4168">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 599

{
  "_embedded" : {
    "scheduleInfoResourceList" : [ {
      "scheduleName" : "FOO",
      "taskDefinitionName" : "BAR",
      "scheduleProperties" : {
        "scheduler.AAA.spring.cloud.scheduler.cron.expression" : "00 41 17 ? * *"
      },
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/tasks/schedules/FOO"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/tasks/schedules/instances/FOO?page=0&amp;size=1"
    }
  },
  "page" : {
    "size" : 1,
    "totalElements" : 1,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-delete-schedule">70.9.4.<font o="4170">删除任务时间表</font></h4>
<div class="paragraph">
<p><font o="4171">任务计划端点允许您删除单个任务计划。</font><font o="4172">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-delete-task-schedule-request-structure"><font o="4173">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-delete-task-schedule-request-parameters"><font o="4174">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-delete-task-schedule-example-request"><font o="4175">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-delete-task-schedule-response-structure"><font o="4176">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-delete-task-schedule-request-structure"><font o="4177">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">DELETE /tasks/schedules/mytestschedule HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4178">表15. / tasks / schedules / {scheduleName}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4179">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4180">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>scheduleName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4181">现有计划的名称（必填）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-delete-task-schedule-request-parameters"><font o="4182">请求参数</font></h5>
<div class="paragraph">
<p><font o="4183">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-delete-task-schedule-example-request"><font o="4184">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/schedules/mytestschedule' -i -X DELETE</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-delete-task-schedule-response-structure"><font o="4185">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-task-validate">70.10.<font o="4187">任务验证</font></h3>
<div class="paragraph">
<p><font o="4188">任务验证端点允许您在任务定义中验证应用程序。</font><font o="4189">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-task-validation-request-structure"><font o="4190">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-validation-request-parameters"><font o="4191">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-validation-example-request"><font o="4192">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-validation-response-structure"><font o="4193">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-validation-request-structure"><font o="4194">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /tasks/validation/taskC HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-validation-request-parameters"><font o="4195">请求参数</font></h5>
<div class="paragraph">
<p><font o="4196">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-validation-example-request"><font o="4197">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/validation/taskC' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-validation-response-structure"><font o="4198">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 122

{
  "appName" : "taskC",
  "dsl" : "timestamp --format='yyyy MM dd'",
  "appStatuses" : {
    "task:taskC" : "valid"
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-task-executions">70.11.<font o="4200">任务执行</font></h3>
<div class="paragraph">
<p><font o="4201">任务执行端点提供有关在Spring Cloud Data Flow服务器中注册的任务执行的信息。</font><font o="4202">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-task-executions-launching"><font o="4203">启动任务</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-list"><font o="4204">列出所有任务执行</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-list-by-name"><font o="4205">列出具有指定任务名称的所有任务执行</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-detail"><font o="4206">任务执行细节</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-delete"><font o="4207">删除任务执行</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-executions-launching">70.11.1.<font o="4209">启动任务</font></h4>
<div class="paragraph">
<p><font o="4210">通过请求创建新任务执行来完成启动任务。</font><font o="4211">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-task-executions-launching-request-structure"><font o="4212">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-launching-request-parameters"><font o="4213">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-launching-example-request"><font o="4214">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-launching-response-structure"><font o="4215">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-launching-request-structure"><font o="4216">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">POST /tasks/executions HTTP/1.1
Host: localhost:9393
Content-Type: application/x-www-form-urlencoded

name=taskA&amp;properties=app.my-task.foo%3Dbar%2Cdeployer.my-task.something-else%3D3&amp;arguments=--server.port%3D8080+--foo%3Dbar</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-launching-request-parameters"><font o="4217">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4218">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4219">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4220">要启动的任务定义的名称</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>properties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4221">启动时使用的Application和Deployer属性</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>arguments</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4222">要传递给任务的命令行参数</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-launching-example-request"><font o="4223">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/executions' -i -X POST -d 'name=taskA&amp;properties=app.my-task.foo%3Dbar%2Cdeployer.my-task.something-else%3D3&amp;arguments=--server.port%3D8080+--foo%3Dbar'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-launching-response-structure"><font o="4224">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 201 Created
Content-Type: application/json;charset=UTF-8
Content-Length: 1

1</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-executions-list">70.11.2.<font o="4226">列出所有任务执行</font></h4>
<div class="paragraph">
<p><font o="4227">任务执行端点允许您列出所有任务执行。</font><font o="4228">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-task-executions-list-request-structure"><font o="4229">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-list-request-parameters"><font o="4230">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-list-example-request"><font o="4231">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-list-response-structure"><font o="4232">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-list-request-structure"><font o="4233">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /tasks/executions?page=0&amp;size=10 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-list-request-parameters"><font o="4234">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4235">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4236">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4237">从零开始的页码（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4238">请求的页面大小（可选）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-list-example-request"><font o="4239">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/executions?page=0&amp;size=10' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-list-response-structure"><font o="4240">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 1243

{
  "_embedded" : {
    "taskExecutionResourceList" : [ {
      "executionId" : 2,
      "exitCode" : null,
      "taskName" : "taskB",
      "startTime" : null,
      "endTime" : null,
      "exitMessage" : null,
      "arguments" : [ ],
      "jobExecutionIds" : [ ],
      "errorMessage" : null,
      "externalExecutionId" : "taskB-7078e799-4b8c-4e4e-8cb8-8a31efd3177b",
      "taskExecutionStatus" : "UNKNOWN",
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/tasks/executions/2"
        }
      }
    }, {
      "executionId" : 1,
      "exitCode" : null,
      "taskName" : "taskA",
      "startTime" : null,
      "endTime" : null,
      "exitMessage" : null,
      "arguments" : [ ],
      "jobExecutionIds" : [ ],
      "errorMessage" : null,
      "externalExecutionId" : "taskA-8f3ba6ff-3b11-4a4b-82b2-60a623e45c2a",
      "taskExecutionStatus" : "UNKNOWN",
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/tasks/executions/1"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/tasks/executions?page=0&amp;size=10"
    }
  },
  "page" : {
    "size" : 10,
    "totalElements" : 2,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-executions-list-by-name">70.11.3.<font o="4242">列出具有指定任务名称的所有任务执行</font></h4>
<div class="paragraph">
<p><font o="4243">任务执行端点允许您列出具有指定任务名称的任务执行。</font><font o="4244">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-task-executions-list-by-name-request-structure"><font o="4245">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-list-by-name-request-parameters"><font o="4246">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-list-by-name-example-request"><font o="4247">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-list-by-name-response-structure"><font o="4248">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-list-by-name-request-structure"><font o="4249">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /tasks/executions?name=taskB&amp;page=0&amp;size=10 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-list-by-name-request-parameters"><font o="4250">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4251">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4252">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4253">从零开始的页码（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4254">请求的页面大小（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4255">与任务执行关联的名称</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-list-by-name-example-request"><font o="4256">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/executions?name=taskB&amp;page=0&amp;size=10' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-list-by-name-response-structure"><font o="4257">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 758

{
  "_embedded" : {
    "taskExecutionResourceList" : [ {
      "executionId" : 2,
      "exitCode" : null,
      "taskName" : "taskB",
      "startTime" : null,
      "endTime" : null,
      "exitMessage" : null,
      "arguments" : [ ],
      "jobExecutionIds" : [ ],
      "errorMessage" : null,
      "externalExecutionId" : "taskB-7078e799-4b8c-4e4e-8cb8-8a31efd3177b",
      "taskExecutionStatus" : "UNKNOWN",
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/tasks/executions/2"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/tasks/executions?page=0&amp;size=10"
    }
  },
  "page" : {
    "size" : 10,
    "totalElements" : 1,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-executions-detail">70.11.4.<font o="4259">任务执行细节</font></h4>
<div class="paragraph">
<p><font o="4260">任务执行端点允许您获取有关任务执行的详细信息。</font><font o="4261">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-task-executions-detail-request-structure"><font o="4262">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-detail-request-parameters"><font o="4263">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-detail-example-request"><font o="4264">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-detail-response-structure"><font o="4265">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-detail-request-structure"><font o="4266">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /tasks/executions/1 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4267">表16. / tasks / executions / {id}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4268">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4269">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4270">现有任务执行的id（必需）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-detail-request-parameters"><font o="4271">请求参数</font></h5>
<div class="paragraph">
<p><font o="4272">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-detail-example-request"><font o="4273">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/executions/1' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-detail-response-structure"><font o="4274">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 415

{
  "executionId" : 1,
  "exitCode" : null,
  "taskName" : "taskA",
  "startTime" : null,
  "endTime" : null,
  "exitMessage" : null,
  "arguments" : [ ],
  "jobExecutionIds" : [ ],
  "errorMessage" : null,
  "externalExecutionId" : "taskA-8f3ba6ff-3b11-4a4b-82b2-60a623e45c2a",
  "taskExecutionStatus" : "UNKNOWN",
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/tasks/executions/1"
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-executions-delete">70.11.5.<font o="4276">删除任务执行</font></h4>
<div class="paragraph">
<p><font o="4277">任务执行端点允许您清理用于部署任务的资源。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="4278">
清理实现是特定于平台的。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="4279">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-task-executions-delete-request-structure"><font o="4280">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-delete-request-parameters"><font o="4281">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-delete-example-request"><font o="4282">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-delete-response-structure"><font o="4283">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-delete-request-structure"><font o="4284">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">DELETE /tasks/executions/1 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4285">表17. / tasks / executions / {id}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4286">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4287">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4288">现有任务执行的id（必需）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-delete-request-parameters"><font o="4289">请求参数</font></h5>
<div class="paragraph">
<p><font o="4290">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-delete-example-request"><font o="4291">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/executions/1' -i -X DELETE</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-delete-response-structure"><font o="4292">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-task-executions-current-count">70.11.6.<font o="4294">任务执行当前计数</font></h4>
<div class="paragraph">
<p><font o="4295">任务执行当前端点允许您检索当前正在运行的执行数。</font><font o="4296">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-task-executions-current-count-request-structure"><font o="4297">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-current-count-request-parameters"><font o="4298">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-current-count-example-request"><font o="4299">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-task-executions-current-count-response-structure"><font o="4300">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-current-count-request-structure"><font o="4301">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /tasks/executions/current HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-current-count-request-parameters"><font o="4302">请求参数</font></h5>
<div class="paragraph">
<p><font o="4303">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-current-count-example-request"><font o="4304">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/tasks/executions/current' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-task-executions-current-count-response-structure"><font o="4305">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 65

{
  "maximumTaskExecutions" : 20,
  "runningExecutionCount" : 1
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-job-executions">70.12.<font o="4307">工作执行</font></h3>
<div class="paragraph">
<p><font o="4308">作业执行端点提供有关在Spring Cloud Data Flow服务器中注册的作业执行的信息。</font><font o="4309">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-executions-list"><font o="4310">列出所有工作执行</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-list-by-name"><font o="4311">列出具有指定作业名称的所有作业执行</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-detail"><font o="4312">工作执行细节</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-stop"><font o="4313">停止执行作业</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-restart"><font o="4314">重新启动作业执行</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-job-executions-list">70.12.1.<font o="4316">列出所有工作执行</font></h4>
<div class="paragraph">
<p><font o="4317">作业执行端点允许您列出所有作业执行。</font><font o="4318">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-executions-list-request-structure"><font o="4319">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-list-request-parameters"><font o="4320">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-list-example-request"><font o="4321">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-list-response-structure"><font o="4322">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-list-request-structure"><font o="4323">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /jobs/executions?page=0&amp;size=10 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-list-request-parameters"><font o="4324">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4325">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4326">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4327">从零开始的页码（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4328">请求的页面大小（可选）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-list-example-request"><font o="4329">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/jobs/executions?page=0&amp;size=10' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-list-response-structure"><font o="4330">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 3357

{
  "_embedded" : {
    "jobExecutionResourceList" : [ {
      "executionId" : 2,
      "stepExecutionCount" : 0,
      "jobId" : 2,
      "taskExecutionId" : 2,
      "name" : "DOCJOB_1",
      "startDate" : "2018-12-05",
      "startTime" : "14:42:12",
      "duration" : "00:00:00",
      "jobExecution" : {
        "id" : 2,
        "version" : 1,
        "jobParameters" : {
          "parameters" : { },
          "empty" : true
        },
        "jobInstance" : {
          "id" : 2,
          "version" : null,
          "jobName" : "DOCJOB_1",
          "instanceId" : 2
        },
        "stepExecutions" : [ ],
        "status" : "STOPPED",
        "startTime" : "2018-12-05T14:42:12.345Z",
        "createTime" : "2018-12-05T14:42:12.343Z",
        "endTime" : null,
        "lastUpdated" : "2018-12-05T14:42:12.345Z",
        "exitStatus" : {
          "exitCode" : "UNKNOWN",
          "exitDescription" : "",
          "running" : true
        },
        "executionContext" : {
          "dirty" : false,
          "empty" : true,
          "values" : [ ]
        },
        "failureExceptions" : [ ],
        "jobConfigurationName" : null,
        "running" : true,
        "jobId" : 2,
        "stopping" : false,
        "allFailureExceptions" : [ ]
      },
      "jobParameters" : { },
      "jobParametersString" : "",
      "restartable" : true,
      "abandonable" : true,
      "stoppable" : false,
      "defined" : true,
      "timeZone" : "UTC",
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/jobs/executions/2"
        }
      }
    }, {
      "executionId" : 1,
      "stepExecutionCount" : 0,
      "jobId" : 1,
      "taskExecutionId" : 1,
      "name" : "DOCJOB",
      "startDate" : "2018-12-05",
      "startTime" : "14:42:12",
      "duration" : "00:00:00",
      "jobExecution" : {
        "id" : 1,
        "version" : 2,
        "jobParameters" : {
          "parameters" : { },
          "empty" : true
        },
        "jobInstance" : {
          "id" : 1,
          "version" : null,
          "jobName" : "DOCJOB",
          "instanceId" : 1
        },
        "stepExecutions" : [ ],
        "status" : "STOPPING",
        "startTime" : "2018-12-05T14:42:12.339Z",
        "createTime" : "2018-12-05T14:42:12.337Z",
        "endTime" : null,
        "lastUpdated" : "2018-12-05T14:42:12.372Z",
        "exitStatus" : {
          "exitCode" : "UNKNOWN",
          "exitDescription" : "",
          "running" : true
        },
        "executionContext" : {
          "dirty" : false,
          "empty" : true,
          "values" : [ ]
        },
        "failureExceptions" : [ ],
        "jobConfigurationName" : null,
        "running" : true,
        "jobId" : 1,
        "stopping" : true,
        "allFailureExceptions" : [ ]
      },
      "jobParameters" : { },
      "jobParametersString" : "",
      "restartable" : false,
      "abandonable" : true,
      "stoppable" : false,
      "defined" : false,
      "timeZone" : "UTC",
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/jobs/executions/1"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/jobs/executions?page=0&amp;size=10"
    }
  },
  "page" : {
    "size" : 10,
    "totalElements" : 2,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-job-executions-list-by-name">70.12.2.<font o="4332">列出具有指定作业名称的所有作业执行</font></h4>
<div class="paragraph">
<p><font o="4333">作业执行端点允许您列出所有作业执行。</font><font o="4334">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-executions-list-by-name-request-structure"><font o="4335">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-list-by-name-request-parameters"><font o="4336">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-list-by-name-example-request"><font o="4337">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-list-by-name-response-structure"><font o="4338">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-list-by-name-request-structure"><font o="4339">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /jobs/executions?name=DOCJOB&amp;page=0&amp;size=10 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-list-by-name-request-parameters"><font o="4340">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4341">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4342">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4343">从零开始的页码（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4344">请求的页面大小（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4345">与作业执行关联的名称</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-list-by-name-example-request"><font o="4346">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/jobs/executions?name=DOCJOB&amp;page=0&amp;size=10' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-list-by-name-response-structure"><font o="4347">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 1813

{
  "_embedded" : {
    "jobExecutionResourceList" : [ {
      "executionId" : 1,
      "stepExecutionCount" : 0,
      "jobId" : 1,
      "taskExecutionId" : 1,
      "name" : "DOCJOB",
      "startDate" : "2018-12-05",
      "startTime" : "14:42:12",
      "duration" : "00:00:00",
      "jobExecution" : {
        "id" : 1,
        "version" : 2,
        "jobParameters" : {
          "parameters" : { },
          "empty" : true
        },
        "jobInstance" : {
          "id" : 1,
          "version" : null,
          "jobName" : "DOCJOB",
          "instanceId" : 1
        },
        "stepExecutions" : [ ],
        "status" : "STOPPING",
        "startTime" : "2018-12-05T14:42:12.339Z",
        "createTime" : "2018-12-05T14:42:12.337Z",
        "endTime" : null,
        "lastUpdated" : "2018-12-05T14:42:12.372Z",
        "exitStatus" : {
          "exitCode" : "UNKNOWN",
          "exitDescription" : "",
          "running" : true
        },
        "executionContext" : {
          "dirty" : false,
          "empty" : true,
          "values" : [ ]
        },
        "failureExceptions" : [ ],
        "jobConfigurationName" : null,
        "running" : true,
        "jobId" : 1,
        "stopping" : true,
        "allFailureExceptions" : [ ]
      },
      "jobParameters" : { },
      "jobParametersString" : "",
      "restartable" : false,
      "abandonable" : true,
      "stoppable" : false,
      "defined" : false,
      "timeZone" : "UTC",
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/jobs/executions/1"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/jobs/executions?page=0&amp;size=10"
    }
  },
  "page" : {
    "size" : 10,
    "totalElements" : 1,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-job-executions-detail">70.12.3.<font o="4349">工作执行细节</font></h4>
<div class="paragraph">
<p><font o="4350">作业执行端点使您可以获取有关作业执行的详细信息。</font><font o="4351">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-executions-detail-request-structure"><font o="4352">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-detail-request-parameters"><font o="4353">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-detail-example-request"><font o="4354">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-detail-response-structure"><font o="4355">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-detail-request-structure"><font o="4356">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /jobs/executions/2 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4357">表18. / jobs / executions / {id}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4358">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4359">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4360">现有作业执行的id（必填）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-detail-request-parameters"><font o="4361">请求参数</font></h5>
<div class="paragraph">
<p><font o="4362">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-detail-example-request"><font o="4363">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/jobs/executions/2' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-detail-response-structure"><font o="4364">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 1311

{
  "executionId" : 2,
  "stepExecutionCount" : 0,
  "jobId" : 2,
  "taskExecutionId" : 2,
  "name" : "DOCJOB_1",
  "startDate" : "2018-12-05",
  "startTime" : "14:42:12",
  "duration" : "00:00:00",
  "jobExecution" : {
    "id" : 2,
    "version" : 1,
    "jobParameters" : {
      "parameters" : { },
      "empty" : true
    },
    "jobInstance" : {
      "id" : 2,
      "version" : 0,
      "jobName" : "DOCJOB_1",
      "instanceId" : 2
    },
    "stepExecutions" : [ ],
    "status" : "STOPPED",
    "startTime" : "2018-12-05T14:42:12.345Z",
    "createTime" : "2018-12-05T14:42:12.343Z",
    "endTime" : null,
    "lastUpdated" : "2018-12-05T14:42:12.345Z",
    "exitStatus" : {
      "exitCode" : "UNKNOWN",
      "exitDescription" : "",
      "running" : true
    },
    "executionContext" : {
      "dirty" : false,
      "empty" : true,
      "values" : [ ]
    },
    "failureExceptions" : [ ],
    "jobConfigurationName" : null,
    "running" : true,
    "jobId" : 2,
    "stopping" : false,
    "allFailureExceptions" : [ ]
  },
  "jobParameters" : { },
  "jobParametersString" : "",
  "restartable" : true,
  "abandonable" : true,
  "stoppable" : false,
  "defined" : true,
  "timeZone" : "UTC",
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/jobs/executions/2"
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-job-executions-stop">70.12.4.<font o="4366">停止执行作业</font></h4>
<div class="paragraph">
<p><font o="4367">作业执行端点允许您停止作业执行。</font><font o="4368">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-executions-stop-request-structure"><font o="4369">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-stop-request-parameters"><font o="4370">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-stop-example-request"><font o="4371">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-stop-response-structure"><font o="4372">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-stop-request-structure"><font o="4373">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">PUT /jobs/executions/1 HTTP/1.1
Accept: application/json
Host: localhost:9393
Content-Type: application/x-www-form-urlencoded

stop=true</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4374">表19. / jobs / executions / {id}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4375">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4376">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4377">现有作业执行的id（必填）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-stop-request-parameters"><font o="4378">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4379">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4380">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>stop</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4381">如果设置为true，则发送信号以停止作业</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-stop-example-request"><font o="4382">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/jobs/executions/1' -i -X PUT -H 'Accept: application/json' -d 'stop=true'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-stop-response-structure"><font o="4383">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-job-executions-restart">70.12.5.<font o="4385">重新启动作业执行</font></h4>
<div class="paragraph">
<p><font o="4386">作业执行端点允许您重新启动作业执行。</font><font o="4387">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-executions-restart-request-structure"><font o="4388">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-restart-request-parameters"><font o="4389">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-restart-example-request"><font o="4390">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-executions-restart-response-structure"><font o="4391">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-restart-request-structure"><font o="4392">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">PUT /jobs/executions/2 HTTP/1.1
Accept: application/json
Host: localhost:9393
Content-Type: application/x-www-form-urlencoded

restart=true</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4393">表20. / jobs / executions / {id}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4394">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4395">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4396">现有作业执行的id（必填）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-restart-request-parameters"><font o="4397">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4398">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4399">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>restart</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4400">如果设置为true，则发送信号以重新启动作业</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-restart-example-request"><font o="4401">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/jobs/executions/2' -i -X PUT -H 'Accept: application/json' -d 'restart=true'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-executions-restart-response-structure"><font o="4402">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-job-instances">70.13.<font o="4404">工作实例</font></h3>
<div class="paragraph">
<p><font o="4405">作业实例端点提供有关在Spring Cloud Data Flow服务器中注册的作业实例的信息。</font><font o="4406">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-instances-list"><font o="4407">列出所有作业实例</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-instances-detail"><font o="4408">工作实例细节</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-job-instances-list">70.13.1.<font o="4410">列出所有作业实例</font></h4>
<div class="paragraph">
<p><font o="4411">作业实例端点允许您列出所有作业实例。</font><font o="4412">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-instances-list-request-structure"><font o="4413">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-instances-list-request-parameters"><font o="4414">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-instances-list-example-request"><font o="4415">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-instances-list-response-structure"><font o="4416">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-instances-list-request-structure"><font o="4417">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /jobs/instances?name=DOCJOB&amp;page=0&amp;size=10 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-instances-list-request-parameters"><font o="4418">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4419">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4420">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4421">从零开始的页码（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4422">请求的页面大小（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4423">与作业实例关联的名称</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-instances-list-example-request"><font o="4424">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/jobs/instances?name=DOCJOB&amp;page=0&amp;size=10' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-instances-list-response-structure"><font o="4425">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 2002

{
  "_embedded" : {
    "jobInstanceResourceList" : [ {
      "jobName" : "DOCJOB",
      "jobInstanceId" : 1,
      "jobExecutions" : [ {
        "executionId" : 1,
        "stepExecutionCount" : 0,
        "jobId" : 1,
        "taskExecutionId" : 1,
        "name" : "DOCJOB",
        "startDate" : "2018-12-05",
        "startTime" : "14:42:08",
        "duration" : "00:00:00",
        "jobExecution" : {
          "id" : 1,
          "version" : 1,
          "jobParameters" : {
            "parameters" : { },
            "empty" : true
          },
          "jobInstance" : {
            "id" : 1,
            "version" : 0,
            "jobName" : "DOCJOB",
            "instanceId" : 1
          },
          "stepExecutions" : [ ],
          "status" : "STARTED",
          "startTime" : "2018-12-05T14:42:08.528Z",
          "createTime" : "2018-12-05T14:42:08.526Z",
          "endTime" : null,
          "lastUpdated" : "2018-12-05T14:42:08.528Z",
          "exitStatus" : {
            "exitCode" : "UNKNOWN",
            "exitDescription" : "",
            "running" : true
          },
          "executionContext" : {
            "dirty" : false,
            "empty" : true,
            "values" : [ ]
          },
          "failureExceptions" : [ ],
          "jobConfigurationName" : null,
          "running" : true,
          "jobId" : 1,
          "stopping" : false,
          "allFailureExceptions" : [ ]
        },
        "jobParameters" : { },
        "jobParametersString" : "",
        "restartable" : false,
        "abandonable" : false,
        "stoppable" : true,
        "defined" : false,
        "timeZone" : "UTC"
      } ],
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/jobs/instances/1"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/jobs/instances?page=0&amp;size=10"
    }
  },
  "page" : {
    "size" : 10,
    "totalElements" : 1,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-job-instances-detail">70.13.2.<font o="4427">工作实例细节</font></h4>
<div class="paragraph">
<p><font o="4428">作业实例端点允许您列出所有作业实例。</font><font o="4429">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-instances-detail-request-structure"><font o="4430">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-instances-detail-request-parameters"><font o="4431">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-instances-detail-example-request"><font o="4432">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-instances-detail-response-structure"><font o="4433">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-instances-detail-request-structure"><font o="4434">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /jobs/instances/1 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4435">表21. / jobs / instances / {id}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4436">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4437">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4438">现有作业实例的ID（必需）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-instances-detail-request-parameters"><font o="4439">请求参数</font></h5>
<div class="paragraph">
<p><font o="4440">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-instances-detail-example-request"><font o="4441">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/jobs/instances/1' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-instances-detail-response-structure"><font o="4442">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 1487

{
  "jobName" : "DOCJOB",
  "jobInstanceId" : 1,
  "jobExecutions" : [ {
    "executionId" : 1,
    "stepExecutionCount" : 0,
    "jobId" : 1,
    "taskExecutionId" : 1,
    "name" : "DOCJOB",
    "startDate" : "2018-12-05",
    "startTime" : "14:42:08",
    "duration" : "00:00:00",
    "jobExecution" : {
      "id" : 1,
      "version" : 1,
      "jobParameters" : {
        "parameters" : { },
        "empty" : true
      },
      "jobInstance" : {
        "id" : 1,
        "version" : 0,
        "jobName" : "DOCJOB",
        "instanceId" : 1
      },
      "stepExecutions" : [ ],
      "status" : "STARTED",
      "startTime" : "2018-12-05T14:42:08.528Z",
      "createTime" : "2018-12-05T14:42:08.526Z",
      "endTime" : null,
      "lastUpdated" : "2018-12-05T14:42:08.528Z",
      "exitStatus" : {
        "exitCode" : "UNKNOWN",
        "exitDescription" : "",
        "running" : true
      },
      "executionContext" : {
        "dirty" : false,
        "empty" : true,
        "values" : [ ]
      },
      "failureExceptions" : [ ],
      "jobConfigurationName" : null,
      "running" : true,
      "jobId" : 1,
      "stopping" : false,
      "allFailureExceptions" : [ ]
    },
    "jobParameters" : { },
    "jobParametersString" : "",
    "restartable" : false,
    "abandonable" : false,
    "stoppable" : true,
    "defined" : false,
    "timeZone" : "UTC"
  } ],
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/jobs/instances/1"
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-job-step-executions">70.14.<font o="4444">工作步骤执行</font></h3>
<div class="paragraph">
<p><font o="4445">作业步骤执行端点提供有关在Spring Cloud Data Flow服务器中注册的作业步骤执行的信息。</font><font o="4446">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-step-executions-list"><font o="4447">列出作业执行的所有步骤执行</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-step-execution-detail"><font o="4448">工作步骤执行细节</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-step-execution-progress"><font o="4449">工作步骤执行进度</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-job-step-executions-list">70.14.1.<font o="4451">列出作业执行的所有步骤执行</font></h4>
<div class="paragraph">
<p><font o="4452">作业步骤执行端点允许您列出所有作业步骤执行。</font><font o="4453">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-step-executions-list-request-structure"><font o="4454">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-step-executions-list-request-parameters"><font o="4455">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-step-executions-list-example-request"><font o="4456">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-step-executions-list-response-structure"><font o="4457">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-step-executions-list-request-structure"><font o="4458">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /jobs/executions/1/steps?page=0&amp;size=10 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-step-executions-list-request-parameters"><font o="4459">请求参数</font></h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4460">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4461">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4462">从零开始的页码（可选）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4463">请求的页面大小（可选）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-step-executions-list-example-request"><font o="4464">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/jobs/executions/1/steps?page=0&amp;size=10' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-step-executions-list-response-structure"><font o="4465">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 1669

{
  "_embedded" : {
    "stepExecutionResourceList" : [ {
      "jobExecutionId" : 1,
      "stepExecution" : {
        "id" : 1,
        "version" : 0,
        "stepName" : "DOCJOB_STEP",
        "status" : "STARTING",
        "readCount" : 0,
        "writeCount" : 0,
        "commitCount" : 0,
        "rollbackCount" : 0,
        "readSkipCount" : 0,
        "processSkipCount" : 0,
        "writeSkipCount" : 0,
        "startTime" : "2018-12-05T14:41:50.841Z",
        "endTime" : null,
        "lastUpdated" : "2018-12-05T14:41:50.842Z",
        "executionContext" : {
          "dirty" : false,
          "empty" : true,
          "values" : [ ]
        },
        "exitStatus" : {
          "exitCode" : "EXECUTING",
          "exitDescription" : "",
          "running" : true
        },
        "terminateOnly" : false,
        "filterCount" : 0,
        "failureExceptions" : [ ],
        "jobParameters" : {
          "parameters" : { },
          "empty" : true
        },
        "jobExecutionId" : 1,
        "summary" : "StepExecution: id=1, version=0, name=DOCJOB_STEP, status=STARTING, exitStatus=EXECUTING, readCount=0, filterCount=0, writeCount=0 readSkipCount=0, writeSkipCount=0, processSkipCount=0, commitCount=0, rollbackCount=0",
        "skipCount" : 0
      },
      "stepType" : "",
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/jobs/executions/1/steps/1"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/jobs/executions/1/steps?page=0&amp;size=10"
    }
  },
  "page" : {
    "size" : 10,
    "totalElements" : 1,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-job-step-execution-detail">70.14.2.<font o="4467">工作步骤执行细节</font></h4>
<div class="paragraph">
<p><font o="4468">作业步骤执行端点允许您获取有关作业步骤执行的详细信息。</font><font o="4469">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-step-execution-detail-request-structure"><font o="4470">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-step-execution-detail-request-parameters"><font o="4471">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-step-execution-detail-example-request"><font o="4472">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-step-execution-detail-response-structure"><font o="4473">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-step-execution-detail-request-structure"><font o="4474">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /jobs/executions/1/steps/1 HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4475">表22. / jobs / executions / {id} / steps / {stepid}</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4476">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4477">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4478">现有作业执行的id（必填）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>stepid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4479">特定作业执行的现有步骤执行的id（必需）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-step-execution-detail-request-parameters"><font o="4480">请求参数</font></h5>
<div class="paragraph">
<p><font o="4481">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-step-execution-detail-example-request"><font o="4482">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/jobs/executions/1/steps/1' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-step-execution-detail-response-structure"><font o="4483">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 1211

{
  "jobExecutionId" : 1,
  "stepExecution" : {
    "id" : 1,
    "version" : 0,
    "stepName" : "DOCJOB_STEP",
    "status" : "STARTING",
    "readCount" : 0,
    "writeCount" : 0,
    "commitCount" : 0,
    "rollbackCount" : 0,
    "readSkipCount" : 0,
    "processSkipCount" : 0,
    "writeSkipCount" : 0,
    "startTime" : "2018-12-05T14:41:50.841Z",
    "endTime" : null,
    "lastUpdated" : "2018-12-05T14:41:50.842Z",
    "executionContext" : {
      "dirty" : false,
      "empty" : true,
      "values" : [ ]
    },
    "exitStatus" : {
      "exitCode" : "EXECUTING",
      "exitDescription" : "",
      "running" : true
    },
    "terminateOnly" : false,
    "filterCount" : 0,
    "failureExceptions" : [ ],
    "jobParameters" : {
      "parameters" : { },
      "empty" : true
    },
    "jobExecutionId" : 1,
    "summary" : "StepExecution: id=1, version=0, name=DOCJOB_STEP, status=STARTING, exitStatus=EXECUTING, readCount=0, filterCount=0, writeCount=0 readSkipCount=0, writeSkipCount=0, processSkipCount=0, commitCount=0, rollbackCount=0",
    "skipCount" : 0
  },
  "stepType" : "",
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/jobs/executions/1/steps/1"
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-job-step-execution-progress">70.14.3.<font o="4485">工作步骤执行进度</font></h4>
<div class="paragraph">
<p><font o="4486">作业步骤执行端点允许您获取有关作业步骤执行进度的详细信息。</font><font o="4487">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-job-step-execution-progress-request-structure"><font o="4488">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-step-execution-progress-request-parameters"><font o="4489">请求参数</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-step-execution-progress-example-request"><font o="4490">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-job-step-execution-progress-response-structure"><font o="4491">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-step-execution-progress-request-structure"><font o="4492">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /jobs/executions/1/steps/1/progress HTTP/1.1
Host: localhost:9393</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title"><font o="4493">表23. / jobs / executions / {id} / steps / {stepid} / progress</font></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4494">参数</font></th>
<th class="tableblock halign-left valign-top"><font o="4495">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4496">现有作业执行的id（必填）</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>stepid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4497">特定作业执行的现有步骤执行的id（必需）</font></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-step-execution-progress-request-parameters"><font o="4498">请求参数</font></h5>
<div class="paragraph">
<p><font o="4499">此端点没有请求参数。</font></p>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-step-execution-progress-example-request"><font o="4500">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/jobs/executions/1/steps/1/progress' -i</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-job-step-execution-progress-response-structure"><font o="4501">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/hal+json;charset=UTF-8
Content-Length: 2714

{
  "stepExecution" : {
    "id" : 1,
    "version" : 0,
    "stepName" : "DOCJOB_STEP",
    "status" : "STARTING",
    "readCount" : 0,
    "writeCount" : 0,
    "commitCount" : 0,
    "rollbackCount" : 0,
    "readSkipCount" : 0,
    "processSkipCount" : 0,
    "writeSkipCount" : 0,
    "startTime" : "2018-12-05T14:41:50.841Z",
    "endTime" : null,
    "lastUpdated" : "2018-12-05T14:41:50.842Z",
    "executionContext" : {
      "dirty" : false,
      "empty" : true,
      "values" : [ ]
    },
    "exitStatus" : {
      "exitCode" : "EXECUTING",
      "exitDescription" : "",
      "running" : true
    },
    "terminateOnly" : false,
    "filterCount" : 0,
    "failureExceptions" : [ ],
    "jobParameters" : {
      "parameters" : { },
      "empty" : true
    },
    "jobExecutionId" : 1,
    "summary" : "StepExecution: id=1, version=0, name=DOCJOB_STEP, status=STARTING, exitStatus=EXECUTING, readCount=0, filterCount=0, writeCount=0 readSkipCount=0, writeSkipCount=0, processSkipCount=0, commitCount=0, rollbackCount=0",
    "skipCount" : 0
  },
  "stepExecutionHistory" : {
    "stepName" : "DOCJOB_STEP",
    "count" : 0,
    "commitCount" : {
      "count" : 0,
      "min" : 0.0,
      "max" : 0.0,
      "mean" : 0.0,
      "standardDeviation" : 0.0
    },
    "rollbackCount" : {
      "count" : 0,
      "min" : 0.0,
      "max" : 0.0,
      "mean" : 0.0,
      "standardDeviation" : 0.0
    },
    "readCount" : {
      "count" : 0,
      "min" : 0.0,
      "max" : 0.0,
      "mean" : 0.0,
      "standardDeviation" : 0.0
    },
    "writeCount" : {
      "count" : 0,
      "min" : 0.0,
      "max" : 0.0,
      "mean" : 0.0,
      "standardDeviation" : 0.0
    },
    "filterCount" : {
      "count" : 0,
      "min" : 0.0,
      "max" : 0.0,
      "mean" : 0.0,
      "standardDeviation" : 0.0
    },
    "readSkipCount" : {
      "count" : 0,
      "min" : 0.0,
      "max" : 0.0,
      "mean" : 0.0,
      "standardDeviation" : 0.0
    },
    "writeSkipCount" : {
      "count" : 0,
      "min" : 0.0,
      "max" : 0.0,
      "mean" : 0.0,
      "standardDeviation" : 0.0
    },
    "processSkipCount" : {
      "count" : 0,
      "min" : 0.0,
      "max" : 0.0,
      "mean" : 0.0,
      "standardDeviation" : 0.0
    },
    "duration" : {
      "count" : 0,
      "min" : 0.0,
      "max" : 0.0,
      "mean" : 0.0,
      "standardDeviation" : 0.0
    },
    "durationPerRead" : {
      "count" : 0,
      "min" : 0.0,
      "max" : 0.0,
      "mean" : 0.0,
      "standardDeviation" : 0.0
    }
  },
  "percentageComplete" : 0.5,
  "finished" : false,
  "duration" : 124.0,
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/jobs/executions/1/steps/1"
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-runtime-information-applications">70.15.<font o="4503">有关应用程序的运行时信息</font></h3>
<div class="paragraph">
<p><font o="4504">可以全局或单独获取有关运行系统已知应用程序的信息。</font><font o="4505">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-runtime-information-applications-listing-all"><font o="4506">在运行时列出所有应用程序</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-runtime-information-applications-querying-all-instances-single-app"><font o="4507">查询单个应用程序的所有实例</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-runtime-information-applications-querying-single-instance-single-app"><font o="4508">查询单个应用程序的单个实例</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-runtime-information-applications-listing-all">70.15.1.<font o="4510">在运行时列出所有应用程序</font></h4>
<div class="paragraph">
<p><font o="4511">要检索有关所有应用程序的所有实例的信息，请使用<code i="1082">GET</code>查询<code i="1081">/runtime/apps</code>端点。</font><font o="4512">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-runtime-information-applications-listing-all-request-structure"><font o="4513">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-runtime-information-applications-listing-all-example-request"><font o="4514">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-runtime-information-applications-listing-all-response-structure"><font o="4515">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-runtime-information-applications-listing-all-request-structure"><font o="4516">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /runtime/apps HTTP/1.1
Accept: application/json
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-runtime-information-applications-listing-all-example-request"><font o="4517">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/runtime/apps' -i -H 'Accept: application/json'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-runtime-information-applications-listing-all-response-structure"><font o="4518">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 2555

{
  "_embedded" : {
    "appStatusResourceList" : [ {
      "deploymentId" : "mystream.http",
      "state" : "deploying",
      "instances" : {
        "_embedded" : {
          "appInstanceStatusResourceList" : [ {
            "instanceId" : "mystream.http-0",
            "state" : "deploying",
            "attributes" : {
              "guid" : "27559",
              "pid" : "32072",
              "port" : "27559",
              "stderr" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885880/mystream.http/stderr_0.log",
              "stdout" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885880/mystream.http/stdout_0.log",
              "url" : "http://10.194.6.22:27559",
              "working.dir" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885880/mystream.http"
            },
            "_links" : {
              "self" : {
                "href" : "http://localhost:9393/runtime/apps/mystream.http/instances/mystream.http-0"
              }
            }
          } ]
        }
      },
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/runtime/apps/mystream.http"
        }
      }
    }, {
      "deploymentId" : "mystream.log",
      "state" : "deploying",
      "instances" : {
        "_embedded" : {
          "appInstanceStatusResourceList" : [ {
            "instanceId" : "mystream.log-0",
            "state" : "deploying",
            "attributes" : {
              "guid" : "47453",
              "pid" : "32057",
              "port" : "47453",
              "stderr" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885775/mystream.log/stderr_0.log",
              "stdout" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885775/mystream.log/stdout_0.log",
              "url" : "http://10.194.6.22:47453",
              "working.dir" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885775/mystream.log"
            },
            "_links" : {
              "self" : {
                "href" : "http://localhost:9393/runtime/apps/mystream.log/instances/mystream.log-0"
              }
            }
          } ]
        }
      },
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/runtime/apps/mystream.log"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/runtime/apps?page=0&amp;size=20"
    }
  },
  "page" : {
    "size" : 20,
    "totalElements" : 2,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-runtime-information-applications-querying-all-instances-single-app">70.15.2.<font o="4520">查询单个应用程序的所有实例</font></h4>
<div class="paragraph">
<p><font o="4521">要检索有关特定应用程序的所有实例的信息，请使用<code i="1084">GET</code>查询<code i="1083">/runtime/apps/&lt;appId&gt;/instances</code>端点。</font><font o="4522">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-runtime-information-applications-querying-all-instances-single-app-request-structure"><font o="4523">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-runtime-information-applications-querying-all-instances-single-app-example-request"><font o="4524">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-runtime-information-applications-querying-all-instances-single-app-response-structure"><font o="4525">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-runtime-information-applications-querying-all-instances-single-app-request-structure"><font o="4526">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /runtime/apps HTTP/1.1
Accept: application/json
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-runtime-information-applications-querying-all-instances-single-app-example-request"><font o="4527">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/runtime/apps' -i -H 'Accept: application/json'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-runtime-information-applications-querying-all-instances-single-app-response-structure"><font o="4528">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 2555

{
  "_embedded" : {
    "appStatusResourceList" : [ {
      "deploymentId" : "mystream.http",
      "state" : "deploying",
      "instances" : {
        "_embedded" : {
          "appInstanceStatusResourceList" : [ {
            "instanceId" : "mystream.http-0",
            "state" : "deploying",
            "attributes" : {
              "guid" : "27559",
              "pid" : "32072",
              "port" : "27559",
              "stderr" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885880/mystream.http/stderr_0.log",
              "stdout" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885880/mystream.http/stdout_0.log",
              "url" : "http://10.194.6.22:27559",
              "working.dir" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885880/mystream.http"
            },
            "_links" : {
              "self" : {
                "href" : "http://localhost:9393/runtime/apps/mystream.http/instances/mystream.http-0"
              }
            }
          } ]
        }
      },
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/runtime/apps/mystream.http"
        }
      }
    }, {
      "deploymentId" : "mystream.log",
      "state" : "deploying",
      "instances" : {
        "_embedded" : {
          "appInstanceStatusResourceList" : [ {
            "instanceId" : "mystream.log-0",
            "state" : "deploying",
            "attributes" : {
              "guid" : "47453",
              "pid" : "32057",
              "port" : "47453",
              "stderr" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885775/mystream.log/stderr_0.log",
              "stdout" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885775/mystream.log/stdout_0.log",
              "url" : "http://10.194.6.22:47453",
              "working.dir" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885775/mystream.log"
            },
            "_links" : {
              "self" : {
                "href" : "http://localhost:9393/runtime/apps/mystream.log/instances/mystream.log-0"
              }
            }
          } ]
        }
      },
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/runtime/apps/mystream.log"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/runtime/apps?page=0&amp;size=20"
    }
  },
  "page" : {
    "size" : 20,
    "totalElements" : 2,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-guide-resources-runtime-information-applications-querying-single-instance-single-app">70.15.3.<font o="4530">查询单个应用程序的单个实例</font></h4>
<div class="paragraph">
<p><font o="4531">最后，要检索有关特定应用程序的特定实例的信息，请使用<code i="1086">GET</code>查询<code i="1085">/runtime/apps/&lt;appId&gt;/instances/&lt;instanceId&gt;</code>端点。</font><font o="4532">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-runtime-information-applications-querying-single-instance-single-app-request-structure"><font o="4533">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-runtime-information-applications-querying-single-instance-single-app-example-request"><font o="4534">示例请求</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-runtime-information-applications-querying-single-instance-single-app-response-structure"><font o="4535">响应结构</font></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="api-guide-resources-runtime-information-applications-querying-single-instance-single-app-request-structure"><font o="4536">请求结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /runtime/apps HTTP/1.1
Accept: application/json
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-runtime-information-applications-querying-single-instance-single-app-example-request"><font o="4537">示例请求</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/runtime/apps' -i -H 'Accept: application/json'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="api-guide-resources-runtime-information-applications-querying-single-instance-single-app-response-structure"><font o="4538">响应结构</font></h5>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 2555

{
  "_embedded" : {
    "appStatusResourceList" : [ {
      "deploymentId" : "mystream.http",
      "state" : "deploying",
      "instances" : {
        "_embedded" : {
          "appInstanceStatusResourceList" : [ {
            "instanceId" : "mystream.http-0",
            "state" : "deploying",
            "attributes" : {
              "guid" : "27559",
              "pid" : "32072",
              "port" : "27559",
              "stderr" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885880/mystream.http/stderr_0.log",
              "stdout" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885880/mystream.http/stdout_0.log",
              "url" : "http://10.194.6.22:27559",
              "working.dir" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885880/mystream.http"
            },
            "_links" : {
              "self" : {
                "href" : "http://localhost:9393/runtime/apps/mystream.http/instances/mystream.http-0"
              }
            }
          } ]
        }
      },
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/runtime/apps/mystream.http"
        }
      }
    }, {
      "deploymentId" : "mystream.log",
      "state" : "deploying",
      "instances" : {
        "_embedded" : {
          "appInstanceStatusResourceList" : [ {
            "instanceId" : "mystream.log-0",
            "state" : "deploying",
            "attributes" : {
              "guid" : "47453",
              "pid" : "32057",
              "port" : "47453",
              "stderr" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885775/mystream.log/stderr_0.log",
              "stdout" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885775/mystream.log/stdout_0.log",
              "url" : "http://10.194.6.22:47453",
              "working.dir" : "/tmp/spring-cloud-deployer-6288619770241875731/mystream-1544020885775/mystream.log"
            },
            "_links" : {
              "self" : {
                "href" : "http://localhost:9393/runtime/apps/mystream.log/instances/mystream.log-0"
              }
            }
          } ]
        }
      },
      "_links" : {
        "self" : {
          "href" : "http://localhost:9393/runtime/apps/mystream.log"
        }
      }
    } ]
  },
  "_links" : {
    "self" : {
      "href" : "http://localhost:9393/runtime/apps?page=0&amp;size=20"
    }
  },
  "page" : {
    "size" : 20,
    "totalElements" : 2,
    "totalPages" : 1,
    "number" : 0
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="api-guide-resources-metrics-stream-applications">70.16.<font o="4540">流应用程序的度量标准</font></h3>
<div class="paragraph">
<p><font o="4541">此REST端点公开流应用程序的度量标准。</font><font o="4542">它要求</font><a href="javascript:;"><font o="4542">Metrics Collector</font></a><font o="4542">应用程序作为单独的服务运行。</font><font o="4543">如果它未运行，则此端点返回空响应。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="4544">
要了解有关Metrics Collector的更多信息，请参阅“ </font><a href="#configuration-monitoring-deployed-applications"><font o="4544">监视已部署的流应用程序</font></a><font o="4544"> ”一章。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="4545">以下主题提供了更多详细信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#api-guide-resources-metrics-stream-applications-request-structure"><font o="4546">请求结构</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-metrics-stream-applications-example-request"><font o="4547">[API-导向资源度量流的应用程序，例如请求]</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-metrics-stream-applications-response-structure"><font o="4548">[API-导向资源度量流的应用程序 - 响应 - 结构]</font></a></p>
</li>
<li>
<p><a href="#api-guide-resources-metrics-stream-applications-example-response"><font o="4549">[API-导向资源度量流的应用程序，例如，响应]</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="api-guide-resources-metrics-stream-applications-request-structure">70.16.1.<font o="4551">请求结构</font></h4>
<div class="paragraph">
<p><font o="4552">例如，典型的请求可能类似于以下内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">GET /metrics/streams HTTP/1.1
Accept: application/json
Host: localhost:9393</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example_request">70.16.2.<font o="4554">示例请求</font></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ curl 'http://localhost:9393/metrics/streams' -i -H 'Accept: application/json'</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_response_structure">70.16.3.<font o="4556">响应结构</font></h4>
<div class="paragraph">
<p><font o="4557">此REST端点使用</font><a href="javascript:;"><font o="4557">Hystrix</font></a><font o="4557">通过</font><font o="4557">封面下</font><font o="4557">的</font><a href="javascript:;"><font o="4557">Spring Cloud Netflix</font></a><font o="4557">项目向Metrics Collector发出代理HTTP请求。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_example_response">70.16.4.<font o="4559">示例响应</font></h4>
<div class="paragraph">
<p><font o="4560">Metrics Collector未运行时，端点不会生成错误。</font><font o="4561">相反，它优雅地降级并返回空响应，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 3

[ ]</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4562">但是，如果正在收集度量标准并且Metrics Collector正在运行，您应该会看到类似于下面列表的响应。</font><font o="4563">下面列表中返回的度量标准数据基于在“ </font><a href="#configuration-monitoring-deployed-applications"><font o="4563">Monitoring Deployed Stream Applications</font></a><font o="4563"> ”一章中</font><font o="4563">创建的示例流定义</font><font o="4563">，其中我们创建了<code i="1087">time | log</code>，其中部署了每个应用程序的两个实例。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap notranslate"><code class="language-http" data-lang="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Content-Length: 30240

[ {
  "name" : "foostream",
  "applications" : [ {
    "name" : "log120RS",
    "instances" : [ {
      "guid" : "13208",
      "index" : 1,
      "properties" : {
        "spring.cloud.dataflow.stream.app.label" : "log120RS",
        "spring.application.index" : "1",
        "spring.application.name" : "log-sink",
        "spring.cloud.dataflow.stream.name" : "foostream",
        "spring.cloud.application.guid" : "13208",
        "spring.cloud.dataflow.stream.app.type" : "sink",
        "spring.cloud.application.group" : "foostream"
      },
      "metrics" : [ {
        "name" : "integration.channel.input.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.sendCount",
        "value" : 373.0
      }, {
        "name" : "integration.channel.input.sendRate.mean",
        "value" : 1.0
      }, {
        "name" : "integration.channel.input.sendRate.max",
        "value" : 2.01
      }, {
        "name" : "integration.channel.input.sendRate.min",
        "value" : 0.7
      }, {
        "name" : "integration.channel.input.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.sendRate.count",
        "value" : 373.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendCount",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendCount",
        "value" : 74.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.mean",
        "value" : 0.2
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.max",
        "value" : 13.49
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.min",
        "value" : 5.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.count",
        "value" : 74.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendCount",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.handler.org.springframework.cloud.stream.app.log.sink.LogSinkConfiguration.logSinkHandler.serviceActivator.handler.duration.mean",
        "value" : 0.22
      }, {
        "name" : "integration.handler.org.springframework.cloud.stream.app.log.sink.LogSinkConfiguration.logSinkHandler.serviceActivator.handler.duration.max",
        "value" : 5.42
      }, {
        "name" : "integration.handler.org.springframework.cloud.stream.app.log.sink.LogSinkConfiguration.logSinkHandler.serviceActivator.handler.duration.min",
        "value" : 0.11
      }, {
        "name" : "integration.handler.org.springframework.cloud.stream.app.log.sink.LogSinkConfiguration.logSinkHandler.serviceActivator.handler.duration.stdev",
        "value" : 0.17
      }, {
        "name" : "integration.handler.org.springframework.cloud.stream.app.log.sink.LogSinkConfiguration.logSinkHandler.serviceActivator.handler.duration.count",
        "value" : 373.0
      }, {
        "name" : "integration.handler.org.springframework.cloud.stream.app.log.sink.LogSinkConfiguration.logSinkHandler.serviceActivator.handler.activeCount",
        "value" : 0.0
      }, {
        "name" : "integration.handler.logSinkHandler.duration.mean",
        "value" : 0.22
      }, {
        "name" : "integration.handler.logSinkHandler.duration.max",
        "value" : 5.4
      }, {
        "name" : "integration.handler.logSinkHandler.duration.min",
        "value" : 0.11
      }, {
        "name" : "integration.handler.logSinkHandler.duration.stdev",
        "value" : 0.17
      }, {
        "name" : "integration.handler.logSinkHandler.duration.count",
        "value" : 373.0
      }, {
        "name" : "integration.handler.logSinkHandler.activeCount",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.mean",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.max",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.min",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.count",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.activeCount",
        "value" : 0.0
      }, {
        "name" : "integration.handlerCount",
        "value" : 3.0
      }, {
        "name" : "integration.channelCount",
        "value" : 4.0
      }, {
        "name" : "integration.sourceCount",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.send.mean",
        "value" : 1.0
      }, {
        "name" : "integration.channel.errorChannel.send.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.send.mean",
        "value" : 0.2
      }, {
        "name" : "integration.channel.nullChannel.send.mean",
        "value" : 0.0
      } ]
    }, {
      "guid" : "60633",
      "index" : 0,
      "properties" : {
        "spring.cloud.dataflow.stream.app.label" : "log120RS",
        "spring.application.index" : "0",
        "spring.application.name" : "log-sink",
        "spring.cloud.dataflow.stream.name" : "foostream",
        "spring.cloud.application.guid" : "60633",
        "spring.cloud.dataflow.stream.app.type" : "sink",
        "spring.cloud.application.group" : "foostream"
      },
      "metrics" : [ {
        "name" : "integration.channel.input.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.sendCount",
        "value" : 372.0
      }, {
        "name" : "integration.channel.input.sendRate.mean",
        "value" : 1.0
      }, {
        "name" : "integration.channel.input.sendRate.max",
        "value" : 1.98
      }, {
        "name" : "integration.channel.input.sendRate.min",
        "value" : 0.8
      }, {
        "name" : "integration.channel.input.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.sendRate.count",
        "value" : 372.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendCount",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendCount",
        "value" : 74.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.mean",
        "value" : 0.2
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.max",
        "value" : 13.09
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.min",
        "value" : 5.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.count",
        "value" : 74.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendCount",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.handler.org.springframework.cloud.stream.app.log.sink.LogSinkConfiguration.logSinkHandler.serviceActivator.handler.duration.mean",
        "value" : 0.22
      }, {
        "name" : "integration.handler.org.springframework.cloud.stream.app.log.sink.LogSinkConfiguration.logSinkHandler.serviceActivator.handler.duration.max",
        "value" : 3.46
      }, {
        "name" : "integration.handler.org.springframework.cloud.stream.app.log.sink.LogSinkConfiguration.logSinkHandler.serviceActivator.handler.duration.min",
        "value" : 0.12
      }, {
        "name" : "integration.handler.org.springframework.cloud.stream.app.log.sink.LogSinkConfiguration.logSinkHandler.serviceActivator.handler.duration.stdev",
        "value" : 0.18
      }, {
        "name" : "integration.handler.org.springframework.cloud.stream.app.log.sink.LogSinkConfiguration.logSinkHandler.serviceActivator.handler.duration.count",
        "value" : 372.0
      }, {
        "name" : "integration.handler.org.springframework.cloud.stream.app.log.sink.LogSinkConfiguration.logSinkHandler.serviceActivator.handler.activeCount",
        "value" : 0.0
      }, {
        "name" : "integration.handler.logSinkHandler.duration.mean",
        "value" : 0.21
      }, {
        "name" : "integration.handler.logSinkHandler.duration.max",
        "value" : 2.84
      }, {
        "name" : "integration.handler.logSinkHandler.duration.min",
        "value" : 0.11
      }, {
        "name" : "integration.handler.logSinkHandler.duration.stdev",
        "value" : 0.18
      }, {
        "name" : "integration.handler.logSinkHandler.duration.count",
        "value" : 372.0
      }, {
        "name" : "integration.handler.logSinkHandler.activeCount",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.mean",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.max",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.min",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.count",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.activeCount",
        "value" : 0.0
      }, {
        "name" : "integration.handlerCount",
        "value" : 3.0
      }, {
        "name" : "integration.channelCount",
        "value" : 4.0
      }, {
        "name" : "integration.sourceCount",
        "value" : 0.0
      }, {
        "name" : "integration.channel.input.send.mean",
        "value" : 1.0
      }, {
        "name" : "integration.channel.errorChannel.send.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.send.mean",
        "value" : 0.2
      }, {
        "name" : "integration.channel.nullChannel.send.mean",
        "value" : 0.0
      } ]
    } ],
    "aggregateMetrics" : [ {
      "name" : "integration.channel.nullChannel.send.mean",
      "value" : 0.0
    }, {
      "name" : "integration.channel.applicationMetrics.send.mean",
      "value" : 0.4
    }, {
      "name" : "integration.channel.errorChannel.send.mean",
      "value" : 0.0
    }, {
      "name" : "integration.channel.input.send.mean",
      "value" : 2.0
    } ]
  }, {
    "name" : "time120RS",
    "instances" : [ {
      "guid" : "50467",
      "index" : 0,
      "properties" : {
        "spring.cloud.dataflow.stream.app.label" : "time120RS",
        "spring.application.index" : "0",
        "spring.application.name" : "time-source",
        "spring.cloud.dataflow.stream.name" : "foostream",
        "spring.cloud.application.guid" : "50467",
        "spring.cloud.dataflow.stream.app.type" : "source",
        "spring.cloud.application.group" : "foostream"
      },
      "metrics" : [ {
        "name" : "integration.channel.output.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.output.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.output.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.output.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.output.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.output.sendCount",
        "value" : 369.0
      }, {
        "name" : "integration.channel.output.sendRate.mean",
        "value" : 1.0
      }, {
        "name" : "integration.channel.output.sendRate.max",
        "value" : 1.02
      }, {
        "name" : "integration.channel.output.sendRate.min",
        "value" : 1.0
      }, {
        "name" : "integration.channel.output.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.output.sendRate.count",
        "value" : 369.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendCount",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendCount",
        "value" : 73.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.mean",
        "value" : 0.2
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.max",
        "value" : 11.05
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.min",
        "value" : 5.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.count",
        "value" : 73.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendCount",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.mean",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.max",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.min",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.count",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.activeCount",
        "value" : 0.0
      }, {
        "name" : "integration.source.org.springframework.cloud.stream.app.time.source.TimeSourceConfiguration.publishTime.inboundChannelAdapter.source.messageCount",
        "value" : 369.0
      }, {
        "name" : "integration.handlerCount",
        "value" : 1.0
      }, {
        "name" : "integration.channelCount",
        "value" : 4.0
      }, {
        "name" : "integration.sourceCount",
        "value" : 1.0
      }, {
        "name" : "integration.channel.output.send.mean",
        "value" : 1.0
      }, {
        "name" : "integration.channel.errorChannel.send.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.send.mean",
        "value" : 0.2
      }, {
        "name" : "integration.channel.nullChannel.send.mean",
        "value" : 0.0
      } ]
    }, {
      "guid" : "61434",
      "index" : 1,
      "properties" : {
        "spring.cloud.dataflow.stream.app.label" : "time120RS",
        "spring.application.index" : "1",
        "spring.application.name" : "time-source",
        "spring.cloud.dataflow.stream.name" : "foostream",
        "spring.cloud.application.guid" : "61434",
        "spring.cloud.dataflow.stream.app.type" : "source",
        "spring.cloud.application.group" : "foostream"
      },
      "metrics" : [ {
        "name" : "integration.channel.output.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.output.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.output.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.output.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.output.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.output.sendCount",
        "value" : 375.0
      }, {
        "name" : "integration.channel.output.sendRate.mean",
        "value" : 1.0
      }, {
        "name" : "integration.channel.output.sendRate.max",
        "value" : 1.02
      }, {
        "name" : "integration.channel.output.sendRate.min",
        "value" : 1.0
      }, {
        "name" : "integration.channel.output.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.output.sendRate.count",
        "value" : 375.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendCount",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.errorChannel.sendRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendCount",
        "value" : 74.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.mean",
        "value" : 0.2
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.max",
        "value" : 12.88
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.min",
        "value" : 5.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.sendRate.count",
        "value" : 74.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.errorRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendCount",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.max",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.min",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.channel.nullChannel.sendRate.count",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.mean",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.max",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.min",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.stdev",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.duration.count",
        "value" : 0.0
      }, {
        "name" : "integration.handler._org.springframework.integration.errorLogger.handler.activeCount",
        "value" : 0.0
      }, {
        "name" : "integration.source.org.springframework.cloud.stream.app.time.source.TimeSourceConfiguration.publishTime.inboundChannelAdapter.source.messageCount",
        "value" : 375.0
      }, {
        "name" : "integration.handlerCount",
        "value" : 1.0
      }, {
        "name" : "integration.channelCount",
        "value" : 4.0
      }, {
        "name" : "integration.sourceCount",
        "value" : 1.0
      }, {
        "name" : "integration.channel.output.send.mean",
        "value" : 1.0
      }, {
        "name" : "integration.channel.errorChannel.send.mean",
        "value" : 0.0
      }, {
        "name" : "integration.channel.applicationMetrics.send.mean",
        "value" : 0.2
      }, {
        "name" : "integration.channel.nullChannel.send.mean",
        "value" : 0.0
      } ]
    } ],
    "aggregateMetrics" : [ {
      "name" : "integration.channel.output.send.mean",
      "value" : 2.0
    }, {
      "name" : "integration.channel.nullChannel.send.mean",
      "value" : 0.0
    }, {
      "name" : "integration.channel.applicationMetrics.send.mean",
      "value" : 0.4
    }, {
      "name" : "integration.channel.errorChannel.send.mean",
      "value" : 0.0
    } ]
  } ]
} ]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<h1 id="appendix" class="sect0"><font o="4564">附录</font></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p><font o="4565">遇到Spring Cloud Data Flow问题，我们想帮忙！</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="4566">提出问题 - 我们监控</font><a href="javascript:;"><font o="4566">stackoverflow.com</font></a><font o="4566">以获取标记的问题</font><a href="javascript:;"><code>spring-cloud-dataflow</code></a><font o="4566">。</font></p>
</li>
<li>
<p><font o="4567">在</font><a href="javascript:;" class="bare"><font o="4567">github.com/spring-cloud/spring-cloud-dataflow/issues上</font></a><font o="4567">使用Spring Cloud Data Flow报告错误</font><font o="4567">。</font></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dataflow-template"><font o="4568">附录A：数据流模板</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="4569">如前一章所述，Spring Cloud Data Flow的功能完全通过REST端点公开。</font><font o="4570">虽然您可以直接使用这些端点，但Spring Cloud Data Flow还提供了基于Java的API，这使得使用这些REST端点变得更加容易。</font></p>
</div>
<div class="paragraph">
<p><font o="4571">中心入口点是<code i="1089">org.springframework.cloud.dataflow.rest.client</code>包中的<code i="1088">DataFlowTemplate</code>类。</font></p>
</div>
<div class="paragraph">
<p><font o="4572">此类实现<code i="1090">DataFlowOperations</code>接口并委托给以下子模板，这些子模板为每个功能集提供特定功能：</font></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4573">接口</font></th>
<th class="tableblock halign-left valign-top"><font o="4574">描述</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>StreamOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4575">用于流操作的REST客户端</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>CounterOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4576">REST客户端用于计数器操作</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>FieldValueCounterOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4577">用于字段值计数器操作的REST客户端</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>AggregateCounterOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4578">REST客户端用于聚合计数器操作</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>TaskOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4579">用于任务操作的REST客户端</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>JobOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4580">用于作业操作的REST客户端</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>AppRegistryOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4581">用于app注册表操作的REST客户端</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>CompletionOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4582">用于完成操作的REST客户端</font></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock"><code>RuntimeOperations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><font o="4583">REST Client用于运行时操作</font></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><font o="4584">初始化<code i="1091">DataFlowTemplate</code>时，可以通过HATEOAS提供的REST关系发现子模板。</font><sup class="footnote"><font o="4585">[ </font><a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="查看脚注。"><font o="4585">1</font></a><font o="4585"> ]</font></sup></p>
</div>
<div class="admonitionblock important">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-important" title="重要"></i>
</td>
<td class="content"><font o="4586">
如果无法解析资源，则相应的子模板将导致NULL。</font><font o="4587">一个常见原因是Spring Cloud Data Flow提供了启动时启用/禁用的特定功能集。</font><font o="4588">有关更多信息，请参阅“ </font><a href="#enable-disable-specific-features"><font o="4588">功能切换</font></a><font o="4588"> ”。
</font></td>
</tr>
</tbody></table>
</div>
<div class="sect2">
<h3 id="_using_the_data_flow_template">A.1.<font o="4590">使用数据流模板</font></h3>
<div class="paragraph">
<p><font o="4591">使用数据流模板时，唯一需要的数据流依赖项是Spring Cloud Data Flow Rest Client，如以下Maven代码段所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
  &lt;artifactId&gt;spring-cloud-dataflow-rest-client&lt;/artifactId&gt;
  &lt;version&gt;1.7.3.RELEASE&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4592">使用该依赖项，您将获得<code i="1092">DataFlowTemplate</code>类以及调用Spring Cloud Data Flow服务器所需的所有依赖项。</font></p>
</div>
<div class="paragraph">
<p><font o="4593">实例化<code i="1093">DataFlowTemplate</code>时，您还传入<code i="1094">RestTemplate</code>。</font><font o="4594">请注意，所需的<code i="1095">RestTemplate</code>需要一些额外的配置才能在<code i="1096">DataFlowTemplate</code>的上下文中有效。</font><font o="4595">将<code i="1097">RestTemplate</code>声明为bean时，以下配置就足够了：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">  @Bean
  public static RestTemplate restTemplate() {
    RestTemplate restTemplate = new RestTemplate();
    restTemplate.setErrorHandler(new VndErrorResponseErrorHandler(restTemplate.getMessageConverters()));
    for(HttpMessageConverter&lt;?&gt; converter : restTemplate.getMessageConverters()) {
      if (converter instanceof MappingJackson2HttpMessageConverter) {
        final MappingJackson2HttpMessageConverter jacksonConverter =
            (MappingJackson2HttpMessageConverter) converter;
        jacksonConverter.getObjectMapper()
            .registerModule(new Jackson2HalModule())
            .addMixIn(JobExecution.class, JobExecutionJacksonMixIn.class)
            .addMixIn(JobParameters.class, JobParametersJacksonMixIn.class)
            .addMixIn(JobParameter.class, JobParameterJacksonMixIn.class)
            .addMixIn(JobInstance.class, JobInstanceJacksonMixIn.class)
            .addMixIn(ExitStatus.class, ExitStatusJacksonMixIn.class)
            .addMixIn(StepExecution.class, StepExecutionJacksonMixIn.class)
            .addMixIn(ExecutionContext.class, ExecutionContextJacksonMixIn.class)
            .addMixIn(StepExecutionHistory.class, StepExecutionHistoryJacksonMixIn.class);
      }
    }
    return restTemplate;
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4596">现在，您可以使用以下代码实例化<code i="1098">DataFlowTemplate</code>：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">DataFlowTemplate dataFlowTemplate = new DataFlowTemplate(
    new URI("http://localhost:9393/"), restTemplate);         <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><font o="4597"><code i="1099">URI</code>指向Spring Cloud Data Flow服务器的ROOT。</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="4598">根据您的要求，您现在可以调用服务器。</font><font o="4599">例如，如果要获取当前可用应用程序的列表，可以运行以下代码：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-java" data-lang="java">PagedResources&lt;AppRegistrationResource&gt; apps = dataFlowTemplate.appRegistryOperations().list();

System.out.println(String.format("Retrieved %s application(s)",
    apps.getContent().size()));

for (AppRegistrationResource app : apps.getContent()) {
  System.out.println(String.format("App Name: %s, App Type: %s, App URI: %s",
    app.getName(),
    app.getType(),
    app.getUri()));
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto"><font o="4600">附录B：“操作方法”指南</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="4601">本节提供了使用Spring Cloud Data Flow时经常出现的一些常见“我该怎么做......”类型的问题的答案。</font></p>
</div>
<div class="paragraph">
<p><font o="4602">如果您遇到我们未在此处讨论的特定问题，您可能需要查看</font><a href="javascript:;"><font o="4602">stackoverflow.com</font></a><font o="4602">以查看是否有人已提供答案。</font><font o="4603">这也是提出新问题的好地方（请使用<code i="1100">spring-cloud-dataflow</code>标签）。</font></p>
</div>
<div class="paragraph">
<p><font o="4604">我们也非常乐意扩展这一部分。</font><font o="4605">如果您想添加“操作方法”，可以向我们发送</font><a href="javascript:;"><font o="4605">拉取请求</font></a><font o="4605">。</font></p>
</div>
<div class="sect2">
<h3 id="_configure_maven_properties">B.1.<font o="4607">配置Maven Properties</font></h3>
<div class="paragraph">
<p><font o="4608">您可以在启动数据流服务器时通过命令行属性设置maven属性，例如本地maven存储库位置，远程maven存储库，身份验证凭据和代理服务器属性。</font><font o="4609">或者，您可以使用数据流服务器的<code i="1101">SPRING_APPLICATION_JSON</code>环境属性设置属性。</font></p>
</div>
<div class="paragraph">
<p><font o="4610">如果使用maven存储库解析应用程序，则需要显式配置远程maven存储库，但<code i="1102">local</code>数据流服务器除外。</font><font o="4611">其他数据流服务器实现（使用maven资源进行应用程序工件解析）没有远程存储库的默认值。</font><font o="4612"><code i="1103">local</code>服务器具有<code i="1104"><a href="javascript:;" class="bare">repo.spring.io/libs-snapshot</a></code>作为默认远程存储库。</font></p>
</div>
<div class="paragraph">
<p><font o="4613">要将属性作为命令行选项传递，请使用与以下内容类似的命令运行服务器：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar &lt;dataflow-server&gt;.jar --maven.localRepository=mylocal
--maven.remote-repositories.repo1.url=https://repo1
--maven.remote-repositories.repo1.auth.username=repo1user
--maven.remote-repositories.repo1.auth.password=repo1pass
--maven.remote-repositories.repo2.url=https://repo2 --maven.proxy.host=proxyhost
--maven.proxy.port=9018 --maven.proxy.auth.username=proxyuser
--maven.proxy.auth.password=proxypass</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4614">您还可以使用<code i="1105">SPRING_APPLICATION_JSON</code>环境属性：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-json" data-lang="json">export SPRING_APPLICATION_JSON='{ "maven": { "local-repository": "local","remote-repositories": { "repo1": { "url": "https://repo1", "auth": { "username": "repo1user", "password": "repo1pass" } },
"repo2": { "url": "https://repo2" } }, "proxy": { "host": "proxyhost", "port": 9018, "auth": { "username": "proxyuser", "password": "proxypass" } } } }'</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4615">以下是格式良好的JSON中的相同内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-json" data-lang="json">SPRING_APPLICATION_JSON='{
  "maven": {
    "local-repository": "local",
    "remote-repositories": {
      "repo1": {
        "url": "https://repo1",
        "auth": {
          "username": "repo1user",
          "password": "repo1pass"
        }
      },
      "repo2": {
        "url": "https://repo2"
      }
    },
    "proxy": {
      "host": "proxyhost",
      "port": 9018,
      "auth": {
        "username": "proxyuser",
        "password": "proxypass"
      }
    }
  }
}'</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="4616">
根据Spring Cloud Data Flow服务器实现，您可能必须使用特定于平台的环境设置功能来传递环境属性。</font><font o="4617">例如，在Cloud Foundry中，您将它们传递为<code i="1106">cf set-env SPRING_APPLICATION_JSON</code>。
</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_logging">B.2.<font o="4619">记录</font></h3>
<div class="paragraph">
<p><font o="4620">Spring Cloud Data Flow基于多个Spring项目构建，但最终数据流服务器是Spring Boot应用程序，因此适用于任何</font><a href="javascript:;"><font o="4620">Spring Boot</font></a><font o="4620">应用程序</font><font o="4620">的日志记录技术</font><font o="4620">也适用于此。</font></p>
</div>
<div class="paragraph">
<p><font o="4621">在进行故障排除时，启用DEBUG日志的两个主要区域可能是有用的</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#troubleshooting-deployment-logs"><font o="4622">部署日志</font></a></p>
</li>
<li>
<p><a href="#troubleshooting-application-logs"><font o="4623">应用程序日志</font></a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="troubleshooting-deployment-logs">B.2.1.<font o="4625">部署日志</font></h4>
<div class="paragraph">
<p><font o="4626">Spring Cloud Data Flow建立在</font><a href="javascript:;"><font o="4626">Spring Cloud Deployer</font></a><font o="4626"> SPI </font><font o="4626">之上</font><font o="4626">，而特定于平台的数据流服务器使用相应的</font><a href="javascript:;"><font o="4626">SPI实现</font></a><font o="4626">。</font><font o="4627">具体来说，如果我们要解决部署特定问题（例如网络错误），那么在底层部署程序及其使用的库中启用DEBUG日志会很有用。</font></p>
</div>
<div class="paragraph">
<p><font o="4628">要为</font><a href="javascript:;"><font o="4628">local-deployer</font></a><font o="4628">启用DEBUG日志，请</font><font o="4628">按如下所示启动服务器：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ java -jar &lt;dataflow-server&gt;.jar --logging.level.org.springframework.cloud.deployer.spi.local=DEBUG</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4629">（其中<code i="1107">org.springframework.cloud.deployer.spi.local</code>是本地部署者相关的全局包。）</font></p>
</div>
<div class="paragraph">
<p><font o="4630">要为</font><a href="javascript:;"><font o="4630">cloudfoundry-deployer</font></a><font o="4630">启用DEBUG日志</font><font o="4630">，请设置以下环境变量，并在重新分配数据流服务器后，您可以查看有关请求和响应的更多日志，并查看故障的详细堆栈跟踪。</font><font o="4631">cloudfoundry部署者使用</font><a href="javascript:;"><font o="4631">cf-java-client</font></a><font o="4631">，因此您还必须为此库启用DEBUG日志。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ cf set-env dataflow-server JAVA_OPTS '-Dlogging.level.cloudfoundry-client=DEBUG'
$ cf restage dataflow-server</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4632">（其中<code i="1108">cloudfoundry-client</code>是所有与<code i="1109">cf-java-client</code>相关的全局包。）</font></p>
</div>
<div class="paragraph">
<p><font o="4633">要查看<code i="1110">cf-java-client</code>使用的Reactor日志，那么下面的commad会有所帮助：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">$ cf set-env dataflow-server JAVA_OPTS '-Dlogging.level.cloudfoundry-client=DEBUG -Dlogging.level.reactor.ipc.netty=DEBUG'
$ cf restage dataflow-server</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4634">（其中<code i="1111">reactor.ipc.netty</code>是与<code i="1112">reactor-netty</code>相关的全局包。）</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="4635">
与上面讨论的<code i="1113">local-deployer</code>和<code i="1114">cloudfoundry-deployer</code>选项类似，Kubernetes也有相同的设置。</font><font o="4636">有关</font><font o="4636">要为日志记录配置的程序包的更多详细信息，</font><font o="4636">请参阅相应的</font><a href="javascript:;"><font o="4636">SPI实现</font></a><font o="4636">。
</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="troubleshooting-application-logs">B.2.2.<font o="4638">应用程序日志</font></h4>
<div class="paragraph">
<p><font o="4639">Spring Cloud Data Flow中的流应用程序是Spring Cloud Stream应用程序，而这些应用程序又基于Spring Boot。</font><font o="4640">可以使用日志记录配置独立设置它们。</font></p>
</div>
<div class="paragraph">
<p><font o="4641">例如，如果您必须对围绕源，处理器和接收器通道传递的<code i="1115">header</code>和<code i="1116">payload</code>细节进行故障排除，则应使用以下选项部署该流：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream create foo --definition "http --logging.level.org.springframework.integration=DEBUG | transform --logging.level.org.springframework.integration=DEBUG | log --logging.level.org.springframework.integration=DEBUG" --deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4642">（其中<code i="1117">org.springframework.integration</code>是所有Spring Integration相关的全局包，负责消息传递通道。）</font></p>
</div>
<div class="paragraph">
<p><font o="4643">在部署流时，也可以使用<code i="1118">deployment</code>属性指定这些属性，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream deploy foo --properties "app.*.logging.level.org.springframework.integration=DEBUG"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_remote_debugging">B.2.3.<font o="4645">远程调试</font></h4>
<div class="paragraph">
<p><font o="4646">数据流本地服务器允许您调试已部署的应用程序。</font><font o="4647">这是通过部署适当的方式启用JVM的远程调试功能来实现的，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">stream deploy --name mystream --properties "deployer.fooApp.local.debugPort=9999"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4648">上面的示例在调试模式下启动<code i="1119">fooApp</code>应用程序，允许在端口9999上附加远程调试器。默认情况下，应用程序以“挂起”模式启动并等待连接（启动）远程调试会话。</font><font o="4649">否则，您可以提供额外的<code i="1120">debugSuspend</code>属性，其值为<code i="1121">n</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="4650">此外，当存在多个应用程序实例时，每个实例的调试端口是<code i="1122">debugPort</code> + instanceId的值。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="4651">
与其他属性不同，您不能对应用程序名称使用通配符，因为每个应用程序都必须使用唯一的调试端口。
</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="_log_redirect">B.2.4.<font o="4653">记录重定向</font></h4>
<div class="paragraph">
<p><font o="4654">鉴于每个应用程序都是一个维护自己的日志集的独立进程，访问单个日志可能有点不方便，特别是在开发的早期阶段，更频繁地访问日志。</font><font o="4655">由于依赖于将每个应用程序部署为本地JVM进程的本地SCDF服务器也是一种常见模式，因此可以将stdout和stdin从已部署的应用程序重定向到父进程。</font><font o="4656">因此，对于本地SCDF服务器，应用程序日志将显示在正在运行的本地SCDF服务器的日志中。</font></p>
</div>
<div class="paragraph">
<p><font o="4657">通常，在部署流时，您会在服务器日志中看到类似以下内容的内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">017-06-28 09:50:16.372  INFO 41161 --- [nio-9393-exec-7] o.s.c.d.spi.local.LocalAppDeployer       : Deploying app with deploymentId mystream.myapp instance 0.
   Logs will be in /var/folders/l2/63gcnd9d7g5dxxpjbgr0trpw0000gn/T/spring-cloud-dataflow-5939494818997196225/mystream-1498661416369/mystream.myapp</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4658">但是，通过将<code i="1123">local.inheritLogging=true</code>设置为部署属性，您可以看到以下内容：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">017-06-28 09:50:16.372  INFO 41161 --- [nio-9393-exec-7] o.s.c.d.spi.local.LocalAppDeployer       : Deploying app with deploymentId mystream.myapp instance 0.
   Logs will be inherited.</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4659">之后，应用程序日志将显示在服务器日志旁边，如以下示例所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">stream deploy --name mystream --properties "deployer.*.local.inheritLogging=true”</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4660">前面的流定义为流中的每个应用程序启用日志重定向。</font><font o="4661">以下流定义仅为名为“my app”的应用程序启用日志重定向。</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">stream deploy --name mystream --properties "deployer.myapp.local.inheritLogging=true”</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="4662">
只有</font><a href="javascript:;"><font o="4662">local-deployer</font></a><font o="4662">支持日志重定向</font><font o="4662">。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="faqs">B.3.<font o="4664">经常问的问题</font></h3>
<div class="paragraph">
<p><font o="4665">在本节中，我们将回顾Spring Cloud Data Flow中的常见问题。</font></p>
</div>
<div class="sect3">
<h4 id="_advanced_spel_expressions">B.3.1.<font o="4667">高级SpEL表达式</font></h4>
<div class="paragraph">
<p><font o="4668">SpEL表达式的一个强大功能是</font><a href="javascript:;"><font o="4668">函数</font></a><font o="4668">。</font><font o="4669">如果适当的库在类路径中，Spring Integration提供<code i="1124">jsonPath()</code>和<code i="1125">xpath()</code> </font><a href="javascript:;"><font o="4669">SpEL  - 函数</font></a><font o="4669">。</font><font o="4670">所有提供的Spring Cloud Stream应用程序启动程序都在其超级jar中使用<code i="1126">json-path</code>和<code i="1127">spring-integration-xml</code>。</font><font o="4671">因此，只要表达式可行，我们就可以在Spring Cloud Data Flow流中使用那些SpEL  - 函数。</font><font o="4672">例如，我们可以使用几个<code i="1129">jsonPath()</code>表达式从HTTP请求转换支持JSON的<code i="1128">payload</code>，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream create jsonPathTransform --definition "http | transform --expression=#jsonPath(payload,'$.price') | log" --deploy
...
dataflow:&gt; http post --target http://localhost:8080 --data {"symbol":"SCDF","price":72.04}
dataflow:&gt; http post --target http://localhost:8080 --data {"symbol":"SCDF","price":72.06}
dataflow:&gt; http post --target http://localhost:8080 --data {"symbol":"SCDF","price":72.08}</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4673">在前面的示例中，我们对传入的有效负载应用<code i="1130">jsonPath</code>以仅提取<code i="1131">price</code>字段值。</font><font o="4674">类似的语法可以与<code i="1132">splitter</code>或<code i="1133">filter</code> <code i="1134">expression</code>选项一起使用。</font><font o="4675">实际上，任何可用的基于SpEL的选项都可以访问内置的SpEL  - 函数。</font><font o="4676">例如，我们可以从JSON数据中提取一些值，以便在将输出发送到Binder之前计算<code i="1135">partitionKey</code>，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream deploy foo --properties "deployer.transform.count=2,app.transform.producer.partitionKeyExpression=#jsonPath(payload,'$.symbol')"</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4677">处理XML数据时，<code i="1136">xpath()</code> SpEL  - 函数可以应用相同的语法。</font><font o="4678">也可以使用任何其他自定义SpEL  - 函数。</font><font o="4679">但是，为此，您应该构建一个包含<code i="1137">@Configuration</code>类的库，其中包含适当的<code i="1138">SpelFunctionFactoryBean</code> <code i="1139">@Bean</code>定义。</font><font o="4680">应重新打包目标Spring Cloud Stream应用程序启动程序以提供具有内置Spring Boot <code i="1140">@ComponentScan</code>机制或自动配置挂钩的自定义扩展。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="dataflow-jdbc-sink">B.3.2.<font o="4682">如何使用JDBC-sink？</font></h4>
<div class="paragraph">
<p><font o="4683">JDBC-sink可用于将消息有效负载数据插入关系数据库表。</font><font o="4684">默认情况下，它将整个有效内容插入到以<code i="1141">jdbc.table-name</code>属性命名的表中。</font><font o="4685">如果未设置，则默认情况下，应用程序期望使用名称为<code i="1142">messages</code>的表。</font><font o="4686">要更改此行为，JDBC接收器会接受</font><a href="javascript:;"><font o="4686">多个选项</font></a><font o="4686">，您可以使用流中的--param = value表示法传递或全局更改。</font><font o="4687">JDBC接收器具有<code i="1143">jdbc.initialize</code>属性，如果设置为<code i="1144">true</code>，则会导致接收器在启动时根据指定的配置创建表。</font><font o="4688">如果该initialize属性为<code i="1145">false</code>（默认值），则必须确保要使用的表已可用。</font></p>
</div>
<div class="paragraph">
<p><font o="4689">使用<code i="1146">jdbc</code>接收器并依赖于MySQL作为后备数据库的所有默认值的流定义类似于以下示例：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream create --name mydata --definition "time | jdbc --spring.datasource.url=jdbc:mysql://localhost:3306/test --spring.datasource.username=root --spring.datasource.password=root --spring.datasource.driver-class-name=org.mariadb.jdbc.Driver" --deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4690">在前面的示例中，系统时间每秒都在MySQL中保留。</font><font o="4691">为此，您必须在MySQL数据库中包含以下表：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-sql" data-lang="sql">CREATE TABLE test.messages
(
  payload varchar(255)
);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">mysql&gt; desc test.messages;
+---------+--------------+------+-----+---------+-------+
| Field   | Type         | Null | Key | Default | Extra |
+---------+--------------+------+-----+---------+-------+
| payload | varchar(255) | YES  |     | NULL    |       |
+---------+--------------+------+-----+---------+-------+
1 row in set (0.00 sec)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">mysql&gt; select * from test.messages;
+-------------------+
| payload           |
+-------------------+
| 04/25/17 09:10:04 |
| 04/25/17 09:10:06 |
| 04/25/17 09:10:07 |
| 04/25/17 09:10:08 |
| 04/25/17 09:10:09 |
.............
.............
.............</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dataflow-multiple-brokers">B.3.3.<font o="4693">如何使用多个邮件绑定器？</font></h4>
<div class="paragraph">
<p><font o="4694">对于在两个不同的消息代理之间使用和处理数据的情况，Spring Cloud Data Flow提供易于覆盖的全局配置，开箱即用</font><a href="javascript:;"><code>bridge-processor</code></a><font o="4694">和DSL原语以构建这些类型的拓扑。</font></p>
</div>
<div class="paragraph">
<p><font o="4695">假设数据在RabbitMQ中排队（例如，queue = <code i="1147">myRabbit</code>），并且要求使用所有有效负载并将它们发布到Apache Kafka（例如，topic = <code i="1148">myKafka</code>） ，作为下游处理的目的地。</font></p>
</div>
<div class="paragraph">
<p><font o="4696">在这种情况下，您应该遵循</font><a href="#spring-cloud-dataflow-global-properties"><font o="4696">配置</font></a><font o="4696">的全局应用程序</font><font o="4696">来定义多个绑定器配置，如以下配置中所示</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-properties" data-lang="properties"># Apache Kafka Global Configurations (that is, identified by "kafka1")
spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.binders.kafka1.type=kafka
spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.binders.kafka1.environment.spring.cloud.stream.kafka.binder.brokers=localhost:9092
spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.binders.kafka1.environment.spring.cloud.stream.kafka.binder.zkNodes=localhost:2181

# RabbitMQ Global Configurations (that is, identified by "rabbit1")
spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.binders.rabbit1.type=rabbit
spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.binders.rabbit1.environment.spring.rabbitmq.host=localhost
spring.cloud.dataflow.applicationProperties.stream.spring.cloud.stream.binders.rabbit1.environment.spring.rabbitmq.port=5672</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="4697">
在前面的示例中，两个消息代理都在本地运行，并且可以通过各自的端口在<code i="1149">localhost</code>访问。
</font></td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><font o="4698">这些属性可以在<code i="1150">.properties</code>文件中提供，该文件可直接或通过<code i="1151">config-server</code>访问服务器，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">java -jar spring-cloud-dataflow-server-local/target/spring-cloud-dataflow-server-local-1.7.3.RELEASE.jar --spring.config.location=<path-to-file>/foo.properties</path-to-file></code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4699">Spring Cloud Data Flow内部使用<code i="1152">bridge-processor</code>直接连接不同的命名通道目的地。</font><font o="4700">由于我们要从两个不同的消息传递系统发布和订阅，因此必须在类路径中使用RabbitMQ和Apache Kafka绑定器构建<code i="1153">bridge-processor</code>。</font><font o="4701">为此，请转到</font><a href="javascript:;" class="bare"><font o="4701">start-scs.cfapps.io/</font></a><font o="4701">并选择<code i="1154">Bridge Processor</code>，<code i="1155">Kafka binder starter</code>和<code i="1156">Rabbit binder starter</code>作为依赖项，并按照</font><a href="javascript:;"><font o="4701">参考指南中</font></a><font o="4701">描述的修补程序进行操作</font><font o="4701">。</font><font o="4702">具体来说，对于<code i="1157">bridge-processor</code>，您必须导入启动器提供的<code i="1158">BridgeProcessorConfiguration</code>。</font></p>
</div>
<div class="paragraph">
<p><font o="4703">完成必要的调整后，即可构建应用程序。</font><font o="4704">以下示例将应用程序的名称注册为<code i="1159">multiBinderBridge</code>：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;app register --type processor --name multiBinderBridge --uri file:///&lt;PATH-TO-FILE&gt;/multipleBinderBridge-0.0.1-SNAPSHOT.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4705">是时候使用新注册的处理器应用程序创建流定义，如下所示：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-bash" data-lang="bash">dataflow:&gt;stream create fooRabbitToBarKafka --definition ":fooRabbit &gt; multiBinderBridge --spring.cloud.stream.bindings.input.binder=rabbit1 --spring.cloud.stream.bindings.output.binder=kafka1 &gt; :barKafka" --deploy</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="4706">
由于我们要使用来自RabbitMQ的消息（由<code i="1160">rabbit1</code>标识）然后将有效负载发布到Apache Kafka（由<code i="1161">kafka1</code>标识），因此我们将其作为<code i="1162">input</code>和<code i="1163">output</code>通道设置分别。
</font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="4707">
该流使用来自RabbitMQ中<code i="1164">myRabbit</code>队列的事件，并将数据发送到Apache Kafka中的<code i="1165">myKafka</code>主题。
</font></td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="migrationguide"><font o="4708">附录C：Spring XD到SCDF</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="4709">本附录介绍了如何从Spring XD迁移到Spring Cloud Data Flow，以及一些可能有用的提示和技巧。</font></p>
</div>
<div class="sect2">
<h3 id="_terminology_changes">C.1.<font o="4711">术语变化</font></h3>
<div class="paragraph">
<p><font o="4712">下表描述了从Spring XD到Spring Cloud Data Flow的术语变化：</font></p>
</div>
<table class="tableblock frame-topbot grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4713">旧</font></th>
<th class="tableblock halign-left valign-top"><font o="4714">新</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">XD-Admin</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Server (implementations: local, Cloud Foundry, and Kubernetes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">XD-Container</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">N/A</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Modules</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Applications</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Admin UI</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Dashboard</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Message Bus</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Binders</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Batch / Job</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Task</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_modules_to_applications">C.2.<font o="4716">模块到应用程序</font></h3>
<div class="paragraph">
<p><font o="4717">如果您有自定义的Spring XD模块，则需要重构它们以使用Spring Cloud Stream和Spring Cloud Task注释。</font><font o="4718">作为该工作的一部分，您需要更新依赖项并将其构建为普通的Spring Boot应用程序。</font></p>
</div>
<div class="sect3">
<h4 id="_custom_applications">C.2.1.<font o="4720">定制应用</font></h4>
<div class="paragraph">
<p><font o="4721">在转换自定义应用程序时，请记住以下信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="4722">Spring XD的流和批处理模块分别重构为</font><a href="javascript:;"><font o="4722">Spring Cloud Stream</font></a><font o="4722">和</font><a href="javascript:;"><font o="4722">Spring Cloud Task</font></a><font o="4722">应用程序启动器。</font><font o="4723">在重构Spring XD模块时，这些应用程序可用作参考。</font></p>
</li>
<li>
<p><font o="4724">还有一些用于</font><a href="javascript:;"><font o="4724">Spring Cloud Stream</font></a><font o="4724">和</font><a href="javascript:;"><font o="4724">Spring Cloud Task</font></a><font o="4724">应用的</font><font o="4724">样本</font><font o="4724">供参考。</font></p>
</li>
<li>
<p><font o="4725">如果您想创建一个全新的自定义应用程序，请使用</font><a href="javascript:;"><font o="4725">Spring Cloud Stream</font></a><font o="4725">和</font><a href="javascript:;"><font o="4725">Spring Cloud Task</font></a><font o="4725">应用程序的</font><a href="javascript:;"><font o="4725">入门指南</font></a><font o="4725">，并查看</font><a href="javascript:;"><font o="4725">开发指南</font></a><font o="4725">。</font></p>
</li>
<li>
<p><font o="4726">或者，如果要修补任何现成的流应用程序，可以按照</font><a href="javascript:;"><font o="4726">此处描述</font></a><font o="4726">的过程进行操作</font><font o="4726">。</font></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_application_registration">C.2.2.<font o="4728">申请注册</font></h4>
<div class="paragraph">
<p><font o="4729">在注册应用程序时，请记住以下信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="4730">自定义流/任务应用程序可以注册为Spring Boot uber-jar用于Cloud Foundry或本地实现。</font><font o="4731">它们也可以注册为Local，Cloud Foundry或Kuberenetes实现的docker镜像。</font><font o="4732">除了Maven和docker解析之外，您还可以从<code i="1166">http(s)</code>和<code i="1167">file</code>坐标解析应用程序工件。</font></p>
</li>
<li>
<p><font o="4733">与Spring XD不同，您不必在注册自定义应用程序时上传应用程序位。</font><font o="4734">相反，您需要</font><a href="#spring-cloud-dataflow-register-stream-apps"><font o="4734">注册</font></a><font o="4734"> Maven存储库中托管的应用程序坐标，或者通过上一个项目中讨论的其他方式注册。</font></p>
</li>
<li>
<p><font o="4735">默认情况下，没有预先加载的现成应用程序。</font><font o="4736">它旨在提供灵活性，以便在您认为适合特定用例要求时注册应用程序。</font></p>
</li>
<li>
<p><font o="4737">根据活页夹选择，您可以手动添加适当的活页夹依赖项以构建特定于该活页夹类型的应用程序。</font><font o="4738">或者，您可以按照</font><a href="javascript:;"><font o="4738">Spring Initializr </font></a> <a href="javascript:;"><font o="4738">过程</font></a><font o="4738">创建一个嵌入了binder的应用程序。</font></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_application_properties_4">C.2.3.<font o="4740">申请Properties</font></h4>
<div class="paragraph">
<p><font o="4741">在修改应用程序的属性时，请记住以下信息：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="4742">反水槽：</font></p>
<div class="ulist">
<ul>
<li>
<p><font o="4743">Spring Cloud Data Flow中不需要外围设备<code i="1168">redis</code>。</font><font o="4744">如果您打算使用<code i="1169">counter-sink</code>，则需要<code i="1170">redis</code>，并且您需要拥有自己的<code i="1171">redis</code>群集。</font></p>
</li>
</ul>
</div>
</li>
<li>
<p><font o="4745">域值 - 抗衡水槽：</font></p>
<div class="ulist">
<ul>
<li>
<p><font o="4746">Spring Cloud Data Flow中不需要外围设备<code i="1172">redis</code>。</font><font o="4747">如果您打算使用<code i="1173">field-value-counter-sink</code>，则需要<code i="1174">redis</code>，并且您需要拥有自己的运行<code i="1175">redis</code>群集。</font></p>
</li>
</ul>
</div>
</li>
<li>
<p><font o="4748">总结柜台汇：</font></p>
<div class="ulist">
<ul>
<li>
<p><font o="4749">Spring Cloud Data Flow中不需要外围设备<code i="1176">redis</code>。</font><font o="4750">如果您打算使用<code i="1177">aggregate-counter-sink</code>，则需要<code i="1178">redis</code>，并且您需要拥有自己的<code i="1179">redis</code>群集。</font></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_message_bus_to_binders">C.3.<font o="4752">消息Bus至Binders</font></h3>
<div class="paragraph">
<p><font o="4753">术语明智地，在Spring Cloud Data Flow中，消息总线实现通常被称为绑定器。</font></p>
</div>
<div class="sect3">
<h4 id="_message_bus">C.3.1.<font o="4755">消息Bus</font></h4>
<div class="paragraph">
<p><font o="4756">与Spring XD类似，Spring Cloud Data Flow包含一个可用于扩展活页夹界面的抽象。</font><font o="4757">默认情况下，我们将</font><a href="javascript:;"><font o="4757">Apache Kafka</font></a><font o="4757">和</font><a href="javascript:;"><font o="4757">RabbitMQ的固定</font></a><font o="4757">视图</font><font o="4757">作为生产就绪粘合剂。</font><font o="4758">它们作为GA版本提供。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_binders">C.3.2.Binders</h4>
<div class="paragraph">
<p><font o="4761">选择绑定器需要在类路径中提供正确的绑定器依赖关系。</font><font o="4762">如果选择Kafka作为活页夹，则需要注册预先使用Kafka活页夹构建的流应用程序。</font><font o="4763">如果要使用Kafka binder创建自定义应用程序，则需要在类路径中添加以下依赖项：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-stream-binder-kafka&lt;/artifactId&gt;
    &lt;version&gt;1.0.2.RELEASE&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="4764">Spring Cloud Stream支持</font><a href="javascript:;"><font o="4764">Apache Kafka</font></a><font o="4764">和</font><a href="javascript:;"><font o="4764">RabbitMQ</font></a><font o="4764">。</font><font o="4765">所有绑定器实现都在其各自的存储库中进行维护和管理。</font></p>
</li>
<li>
<p><font o="4766">每个Stream / Task应用程序都可以使用您选择的binder实现构建。</font><font o="4767">所有开箱即用的应用程序都是为Kafka和Rabbit预先构建的，可以随时用作Maven工件（</font><a href="javascript:;"><font o="4767">Spring Cloud Stream</font></a><font o="4767">或</font><a href="javascript:;"><font o="4767">Spring Cloud Task</font></a><font o="4767">）或Docker镜像（</font><a href="javascript:;"><font o="4767">Spring Cloud Stream</font></a><font o="4767">或</font><a href="javascript:;"><font o="4767">Spring Cloud Task</font></a><font o="4767">）。</font><font o="4768">更改活页夹需要选择正确的活页夹</font><a href="javascript:;"><font o="4768">依赖项</font></a><font o="4768">。</font><font o="4769">或者，您可以从此版本的</font><a href="javascript:;"><font o="4769">Spring Initializr</font></a><font o="4769">下载预构建的应用程序，</font><font o="4769">其中包含所需的“binder-starter”依赖项。</font></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_named_channels">C.3.3.<font o="4771">命名频道</font></h4>
<div class="paragraph">
<p><font o="4772">从根本上说，所有消息传递通道都由pub / sub语义支持。</font><font o="4773">与Spring XD不同，消息传递通道仅由<code i="1180">topics</code>或<code i="1181">topic-exchange</code>支持，并且在新架构中没有<code i="1182">queues</code>的表示。</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="4774"><code i="1183">${xd.module.index}</code>不再受支持。</font><font o="4775">相反，您可以直接与</font><a href="#spring-cloud-dataflow-stream-dsl-named-destinations"><font o="4775">命名目标进行</font></a><font o="4775">交互</font><font o="4775">。</font></p>
</li>
<li>
<p><font o="4776"><code i="1184">stream.index</code>更改为<code i="1185">:&lt;stream-name&gt;.&lt;label/app-name&gt;</code></font></p>
<div class="ulist">
<ul>
<li>
<p><font o="4777">例如，<code i="1186">ticktock.0</code>更改为<code i="1187">:ticktock.time</code>。</font></p>
</li>
</ul>
</div>
</li>
<li>
<p><font o="4778">“主题/队列”前缀不需要与命名通道交互。</font></p>
<div class="ulist">
<ul>
<li>
<p><font o="4779">例如，<code i="1188">topic:mytopic</code>更改为<code i="1189">:mytopic</code>。</font></p>
</li>
<li>
<p><font o="4780">例如，<code i="1190">stream create stream1 --definition ":foo &gt; log"</code>。</font></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_directed_graphs">C.3.4.<font o="4782">有向图</font></h4>
<div class="paragraph">
<p><font o="4783">如果构建非线性流，则可以利用</font><a href="#spring-cloud-dataflow-stream-dsl-named-destinations"><font o="4783">命名目标</font></a><font o="4783">来构建有向图。</font></p>
</div>
<div class="paragraph">
<p><font o="4784">考虑以下来自Spring XD的示例：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-xml" data-lang="xml">stream create f --definition "queue:foo &gt; transform --expression=payload+'-sample1' | log" --deploy
stream create b --definition "queue:bar &gt; transform --expression=payload+'-sample2' | log" --deploy
stream create r --definition "http | router --expression=payload.contains('a')?'queue:sample1':'queue:sample2'" --deploy</code></pre>
</div>
</div>
<div class="paragraph">
<p><font o="4785">您可以在Spring Cloud Data Flow中执行以下操作：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight notranslate"><code class="language-xml" data-lang="xml">stream create f --definition ":foo &gt; transform --expression=payload+'-sample1' | log" --deploy
stream create b --definition ":bar &gt; transform --expression=payload+'-sample2' | log" --deploy
stream create r --definition "http | router --expression=payload.contains('a')?'sample1':'sample2'" --deploy</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_batch_to_tasks">C.4.<font o="4787">批量到任务</font></h3>
<div class="paragraph">
<p><font o="4788">根据定义，任务是任何不会永远运行的应用程序，它们会在某个时刻结束。</font><font o="4789">任务包括Spring Batch个工作。</font><font o="4790">任务应用程序可用于按需用例，例如数据库迁移，机器学习，计划操作等。</font><font o="4791">使用</font><a href="javascript:;"><font o="4791">Spring Cloud Task</font></a><font o="4791">，您可以将Spring Batch作业构建为微服务应用程序。</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="4792">Spring Batch </font><font o="4792">来自Spring XD的</font><a href="javascript:;"><font o="4792">作业</font></a><font o="4792">正被重构为Spring Boot应用程序，也称为Spring Cloud Task </font><a href="javascript:;"><font o="4792">应用程序</font></a><font o="4792">。</font></p>
</li>
<li>
<p><font o="4793">与Spring XD不同，这些任务不需要显式部署。</font><font o="4794">相反，一旦声明了定义，就可以直接启动任务。</font></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_shell_and_dsl_command_changes">C.5.<font o="4796">Shell和DSL命令的变化</font></h3>
<div class="paragraph">
<p><font o="4797">下表显示了对shell和DSL命令的更改：</font></p>
</div>
<table class="tableblock frame-topbot grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4798">老命令</font></th>
<th class="tableblock halign-left valign-top"><font o="4799">新命令</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">module upload</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">app register / app import</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">module list</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">app list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">module info</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">app info</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">admin config server</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">dataflow config server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">job create</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">task create</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">job launch</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">task launch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">job list</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">task list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">job status</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">task status</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">job display</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">task display</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">job destroy</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">task destroy</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">job execution list</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">task execution list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">runtime modules</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">runtime apps</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_rest_api_changes">C.6.<font o="4801">REST API更改</font></h3>
<div class="paragraph">
<p><font o="4802">下表显示了REST API的更改：</font></p>
</div>
<table class="tableblock frame-topbot grid-all" style="width: 70%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4803">旧API</font></th>
<th class="tableblock halign-left valign-top"><font o="4804">新API</font></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">/modules</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">/apps</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">/runtime/modules</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">/runtime/apps</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">/runtime/modules/{moduleId}</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">/runtime/apps/{appId}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">/jobs/definitions</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">/task/definitions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">/jobs/deployments</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">/task/deployments</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_ui_including_flo">C.7.<font o="4806">UI（包括Flo）</font></h3>
<div class="paragraph">
<p><font o="4807">Admin-UI现在名为Dashboard。</font><font o="4808">用于访问仪表板的URI从<code i="1191"><a href="javascript:;" class="bare">localhost:9393/admin-ui</a></code>更改为<code i="1192"><a href="javascript:;" class="bare">localhost:9393/dashboard</a></code>。</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="4809">应用程序（新视图）：列出可供使用的所有已注册应用程序。</font><font o="4810">此视图包含URI和每个应用程序支持的属性等详细信息。</font><font o="4811">您还可以从此视图注册/取消注册应用程序。</font></p>
</li>
<li>
<p><font o="4812">运行时（容器）：容器更改为运行时。</font><font o="4813"><code i="1193">xd-container</code>的概念已经消失，取而代之的是作为自主Spring Boot应用程序运行的开箱即用的应用程序。</font><font o="4814">“运行时”选项卡显示在运行时平台中运行的应用程序（实现：本地，Cloud Foundry或Kubernetes）。</font><font o="4815">您可以单击每个应用程序以查看相关详细信息，例如它的运行位置，使用的资源以及其他详细信息。</font></p>
</li>
<li>
<p><a href="javascript:;"><font o="4816">Spring Flo</font></a><font o="4816">现在是OSS产品。</font><font o="4817">Flo为Spring Cloud Data Flow的“创建流”现在是仪表板中的设计器选项卡。</font></p>
</li>
<li>
<p><font o="4818">任务（新视图）：</font></p>
<div class="ulist">
<ul>
<li>
<p><font o="4819">“模块”子选项卡重命名为“应用程序”。</font></p>
</li>
<li>
<p><font o="4820">“定义”子选项卡列出了所有任务定义，包括作为任务编排的Spring Batch作业。</font></p>
</li>
<li>
<p><font o="4821">“执行”子选项卡以类似于Spring XD的作业执行列表的方式列出所有任务执行详细信息。</font></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_architecture_components">C.8.<font o="4823">架构组件</font></h3>
<div class="paragraph">
<p><font o="4824">Spring Cloud Data Flow带有显着简化的架构。</font><font o="4825">实际上，与Spring XD相比，您需要更少的外设才能使用Spring Cloud Data Flow。</font></p>
</div>
<div class="sect3">
<h4 id="_zookeeper">C.8.1.ZooKeeper</h4>
<div class="paragraph">
<p><font o="4828">新架构中未使用ZooKeeper。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="rdbms">C.8.2.<font o="4830">RDBMS</font></h4>
<div class="paragraph">
<p><font o="4831">Spring Cloud Data Flow使用RDBMS而不是Redis进行流/任务定义，应用程序注册和作业存储库。</font><font o="4832">默认配置使用嵌入式H2实例，但支持Oracle，DB2，SqlServer，MySQL / MariaDB，PostgreSQL，H2和HSQLDB数据库。</font><font o="4833">要使用Oracle，DB2和SqlServer，您需要使用</font><a href="javascript:;"><font o="4833">Spring Initializr</font></a><font o="4833">创建自己的数据流服务器</font><font o="4833">并添加适当的JDBC驱动程序依赖项。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_redis">C.8.3.<font o="4835">Redis的</font></h4>
<div class="paragraph">
<p><font o="4836">只有分析功能才需要运行Redis群集。</font><font o="4837">具体来说，当您使用<code i="1194">counter-sink</code>，<code i="1195">field-value-counter-sink</code>或<code i="1196">aggregate-counter-sink</code>应用程序时，还需要有一个正在运行的Redis群集实例。</font></p>
</div>
</div>
<div class="sect3">
<h4 id="_cluster_topology">C.8.4.<font o="4839">集群拓扑</font></h4>
<div class="paragraph">
<p><font o="4840">Spring XD的<code i="1197">xd-admin</code>和<code i="1198">xd-container</code>服务器组件由流和任务应用程序替换，这些应用程序本身作为自治Spring Boot应用程序运行。</font><font o="4841">应用程序在各种平台上本地运行，包括Cloud Foundry和Kubernetes。</font><font o="4842">您可以单独开发，测试，部署，向上或向下扩展以及与（Spring Boot）应用程序交互，它们可以孤立地发展。</font></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_central_configuration">C.9.<font o="4844">中央配置</font></h3>
<div class="paragraph">
<p><font o="4845">为了支持应用程序配置属性的集中和一致管理，</font><a href="javascript:;"><font o="4845">Spring Cloud Config</font></a><font o="4845">服务器中包含</font><a href="javascript:;"><font o="4845">Spring Cloud Config</font></a><font o="4845">客户端库以及Spring Cloud Stream应用程序启动器提供的Spring Cloud Stream应用程序。</font><font o="4846">您还可以</font><font o="4846">在数据流服务器启动时</font><a href="#spring-cloud-dataflow-global-properties"><font o="4846">将常用应用程序属性传递</font></a><font o="4846">给所有流。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_distribution">C.10.<font o="4848">分配</font></h3>
<div class="paragraph">
<p><font o="4849">Spring Cloud Data Flow是Spring Boot应用程序。</font><font o="4850">根据您选择的平台，您可以下载相应的版本超级jar并将其部署或推送到运行时平台（Cloud Foundry或Kubernetes）。</font><font o="4851">例如，如果在Cloud Foundry上运行Spring Cloud Data Flow，则可以下载Cloud Foundry服务器实现并执行<code i="1199">cf push</code>，如</font><a href="javascript:;"><font o="4851">Cloud Foundry参考指南中所述</font></a><font o="4851">。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_hadoop_distribution_compatibility">C.11.<font o="4853">Hadoop分发兼容性</font></h3>
<div class="paragraph">
<p><font o="4854"><code i="1200">hdfs-sink</code>应用程序构建于Spring Hadoop 2.4.0版本之上，因此该应用程序与以下Hadoop发行版兼容：</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="4855">Cloudera：cdh5</font></p>
</li>
<li>
<p><font o="4856">Pivotal Hadoop：phd30</font></p>
</li>
<li>
<p><font o="4857">Hortonworks Hadoop：hdp24</font></p>
</li>
<li>
<p><font o="4858">Hortonworks Hadoop：hdp23</font></p>
</li>
<li>
<p><font o="4859">Vanilla Hadoop：hadoop26</font></p>
</li>
<li>
<p><font o="4860">Vanilla Hadoop：2.7.x（默认）</font></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_use_case_comparison">C.12.<font o="4862">用例比较</font></h3>
<div class="paragraph">
<p><font o="4863">本附录的其余部分回顾了一些用例，以显示Spring XD和Spring Cloud Data Flow之间的差异。</font></p>
</div>
<div class="sect3">
<h4 id="_use_case_1_ticktock">C.12.1.<font o="4865">用例＃1：Ticktock</font></h4>
<div class="paragraph">
<p><font o="4866">此用例假定您已经下载了XD和SCDF分发。</font></p>
</div>
<div class="paragraph">
<p><font o="4867">描述：使用local / singlenode的简单<code i="1201">ticktock</code>示例。</font></p>
</div>
<div class="paragraph">
<p><font o="4868">下表描述了差异：</font></p>
</div>
<table class="tableblock frame-topbot grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4869">Spring XD</font></th>
<th class="tableblock halign-left valign-top">Spring Cloud Data Flow</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Start an <code>xd-singlenode</code> server from CLI
</p><p class="tableblock"><code>→ xd-singlenode</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Start a binder of your choice
</p><p class="tableblock">Start a <code>local-server</code> implementation of SCDF from the CLI
</p><p class="tableblock"><code>→ java -jar spring-cloud-dataflow-server-local-1.0.0.BUILD-SNAPSHOT.jar</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Start an <code>xd-shell</code> server from the CLI
</p><p class="tableblock"><code>→ xd-shell</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Start <code>dataflow-shell</code> server from the CLI
</p><p class="tableblock"><code>→ java -jar spring-cloud-dataflow-shell-1.0.0.BUILD-SNAPSHOT.jar</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Create <code>ticktock</code> stream
</p><p class="tableblock"><code>xd:&gt;stream create ticktock --definition “time | log” --deploy</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Create <code>ticktock</code> stream
</p><p class="tableblock"><code>dataflow:&gt;stream create ticktock --definition “time | log” --deploy</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Review <code>ticktock</code> results in the <code>xd-singlenode</code> server console</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Review <code>ticktock</code> results by using the <code>tail</code> commang to view the <code>ticktock.log/stdout_log</code> application logs</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_use_case_2_stream_with_custom_module_or_application">C.12.2.<font o="4872">用例＃2：使用自定义模块或应用程序流</font></h4>
<div class="paragraph">
<p><font o="4873">此用例假定您已经下载了XD和SCDF分发。</font></p>
</div>
<div class="paragraph">
<p><font o="4874">描述：使用自定义模块或应用程序流。</font></p>
</div>
<div class="paragraph">
<p><font o="4875">下表描述了差异：</font></p>
</div>
<table class="tableblock frame-topbot grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4876">Spring XD</font></th>
<th class="tableblock halign-left valign-top">Spring Cloud Data Flow</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Start an <code>xd-singlenode</code> server from CLI
</p><p class="tableblock"><code>→ xd-singlenode</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Start a binder of your choice
</p><p class="tableblock">Start a <code>local-server</code> implementation of SCDF from the CLI
</p><p class="tableblock"><code>→ java -jar spring-cloud-dataflow-server-local-1.0.0.BUILD-SNAPSHOT.jar</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Start an <code>xd-shell</code> server from the CLI
</p><p class="tableblock"><code>→ xd-shell</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Start <code>dataflow-shell</code> server from the CLI
</p><p class="tableblock"><code>→ java -jar spring-cloud-dataflow-shell-1.0.0.BUILD-SNAPSHOT.jar</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Register a custom “processor” module to transform the payload to the desired format
</p><p class="tableblock"><code>xd:&gt;module upload --name toupper --type processor --file &lt;CUSTOM_JAR_FILE_LOCATION&gt;</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Register custom “processor” application to transform payload to a desired format
</p><p class="tableblock"><code>dataflow:&gt;app register --name toupper --type processor --uri &lt;MAVEN_URI_COORDINATES&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Create a stream with a custom module
</p><p class="tableblock"><code>xd:&gt;stream create testupper --definition “http | toupper | log” --deploy</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Create a stream with custom application
</p><p class="tableblock"><code>dataflow:&gt;stream create testupper --definition “http | toupper | log” --deploy</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Review results in the <code>xd-singlenode</code> server console</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Review results by using the <code>tail</code> command to view the <code>testupper.log/stdout_log</code> application logs</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_use_case_3_batch_job">C.12.3.<font o="4879">用例＃3：批处理作业</font></h4>
<div class="paragraph">
<p><font o="4880">此用例假定您已经下载了XD和SCDF分发。</font></p>
</div>
<div class="paragraph">
<p><font o="4881">描述：批处理作业。</font></p>
</div>
<table class="tableblock frame-topbot grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><font o="4882">Spring XD</font></th>
<th class="tableblock halign-left valign-top">Spring Cloud Data Flow</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Start an <code>xd-singlenode</code> server from CLI
</p><p class="tableblock"><code>→ xd-singlenode</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Start a <code>local-server</code> implementation of SCDF from the CLI
</p><p class="tableblock"><code>→ java -jar spring-cloud-dataflow-server-local-1.0.0.BUILD-SNAPSHOT.jar</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Start an <code>xd-shell</code> server from the CLI
</p><p class="tableblock"><code>→ xd-shell</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Start <code>dataflow-shell</code> server from the CLI
</p><p class="tableblock"><code>→ java -jar spring-cloud-dataflow-shell-1.0.0.BUILD-SNAPSHOT.jar</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Register a custom “batch job” module
</p><p class="tableblock"><code>xd:&gt;module upload --name simple-batch --type job --file &lt;CUSTOM_JAR_FILE_LOCATION&gt;</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Register a custom “batch-job” as task application
</p><p class="tableblock"><code>dataflow:&gt;app register --name simple-batch --type task --uri &lt;MAVEN_URI_COORDINATES&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Create a job with custom batch-job module
</p><p class="tableblock"><code>xd:&gt;job create batchtest --definition “simple-batch”</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Create a task with a custom batch-job application
</p><p class="tableblock"><code>dataflow:&gt;task create batchtest --definition “simple-batch”</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Deploy job
</p><p class="tableblock"><code>xd:&gt;job deploy batchtest</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">NA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Launch job
</p><p class="tableblock"><code>xd:&gt;job launch batchtest</code></p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Launch task
</p><p class="tableblock"><code>dataflow:&gt;task launch batchtest</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Review results in the <code>xd-singlenode</code> server console as well as the Jobs tab in the UI
(executions sub-tab should include all step details)</p></td>
<td class="tableblock halign-left valign-top notranslate"><p class="tableblock">Review results by using the <code>tail</code> command to view the <code>batchtest/stdout_log</code> application logs as well as the Task tab in UI (the executions sub-tab should include all step details)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="building"><font o="4884">附录D：建筑</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="4885">要构建源，您需要安装JDK 1.8。</font></p>
</div>
<div class="paragraph">
<p><font o="4886">构建使用Maven包装器，因此您不必安装特定版本的Maven。</font><font o="4887">要为Redis启用测试，请在构建之前运行服务器。</font><font o="4888">有关如何运行Redis的更多信息将在本附录的后面部分中介绍。</font></p>
</div>
<div class="paragraph">
<p><font o="4889">主要构建命令如下：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">$ ./mvnw clean install</pre>
</div>
</div>
<div class="paragraph">
<p><font o="4890">如果您愿意，可以添加'-DskipTests'以避免运行测试。</font></p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="4891">
您也可以自己安装Maven（&gt; = 3.3.3）并在下面的示例中运行<code i="1202">mvn</code>命令代替<code i="1203">./mvnw</code>。</font><font o="4892">如果您这样做，如果您的本地Maven设置不包含Spring预发布工件的存储库声明，您可能还需要添加<code i="1204">-P spring</code>。
</font></td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="4893">
您可能需要通过将<code i="1205">MAVEN_OPTS</code>环境变量设置为类似于<code i="1206">-Xmx512m -XX:MaxPermSize=128m</code>的值来增加Maven可用的内存量。</font><font o="4894">我们尝试在<code i="1207">.mvn</code>配置中介绍这一点，因此，如果您发现必须这样做以使构建成功，请提出一个票证以将设置添加到源代码管理中。
</font></td>
</tr>
</tbody></table>
</div>
<div class="sect2">
<h3 id="_documentation">D.1.<font o="4896">文档</font></h3>
<div class="paragraph">
<p><font o="4897">有一个<code i="1208">full</code>配置文件可生成文档。</font><font o="4898">您可以使用以下命令仅构建文档：</font></p>
</div>
<div class="paragraph">
<p><code>$ ./mvnw clean package -DskipTests -P full -pl spring-cloud-dataflow-docs -am</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_working_with_the_code">D.2.<font o="4900">使用本准则</font></h3>
<div class="paragraph">
<p><font o="4901">如果您没有IDE首选项，我们建议您在使用</font><font o="4901">代码时</font><font o="4901">使用</font><a href="javascript:;"><font o="4901">Spring Tools Suite</font></a><font o="4901">或</font><a href="javascript:;"><font o="4901">Eclipse</font></a><font o="4901">。</font><font o="4902">我们使用</font><a href="javascript:;"><font o="4902">m2eclipse</font></a><font o="4902"> Eclipse插件来支持Maven。</font><font o="4903">其他IDE和工具通常也可以正常工作。</font></p>
</div>
<div class="sect3">
<h4 id="_importing_into_eclipse_with_m2eclipse">D.2.1.<font o="4905">使用m2eclipse导入Eclipse</font></h4>
<div class="paragraph">
<p><font o="4906">在使用Eclipse时，</font><font o="4906">我们建议使用</font><a href="javascript:;"><font o="4906">m2eclipe</font></a><font o="4906"> eclipse插件。</font><font o="4907">如果您还没有安装m2eclipse，可以从Eclipse市场获得。</font></p>
</div>
<div class="paragraph">
<p><font o="4908">不幸的是，m2e还不支持Maven 3.3。</font><font o="4909">因此，一旦将项目导入Eclipse，您还需要告诉m2eclipse将<code i="1209">.settings.xml</code>文件用于项目。</font><font o="4910">如果不这样做，您可能会看到许多与项目中的POM相关的错误。</font><font o="4911">为此：</font></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><font o="4912">打开Eclipse首选项。</font></p>
</li>
<li>
<p><font o="4913">展开Maven首选项。</font></p>
</li>
<li>
<p><font o="4914">选择用户设置。</font></p>
</li>
<li>
<p><font o="4915">在“用户设置”字段中，单击“浏览”并导航到导入的Spring Cloud项目。</font></p>
</li>
<li>
<p><font o="4916">选择该项目中的<code i="1210">.settings.xml</code>文件。</font></p>
</li>
<li>
<p><font o="4917">单击“应用”</font></p>
</li>
<li>
<p><font o="4918">单击确定。</font></p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="注意"></i>
</td>
<td class="content"><font o="4919">
或者，您可以将Spring Cloud </font><a href="javascript:;"><code>.settings.xml</code></a><font o="4919">文件中</font><font o="4919">的存储库设置复制</font><font o="4919">到您自己的<code i="1211">~/.m2/settings.xml</code>中。
</font></td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect3">
<h4 id="_importing_into_eclipse_without_m2eclipse">D.2.2.<font o="4921">在没有m2eclipse的情况下导入Eclipse</font></h4>
<div class="paragraph">
<p><font o="4922">如果您不想使用m2eclipse，则可以使用以下命令生成Eclipse项目元数据：</font></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="notranslate">$ ./mvnw eclipse:eclipse</pre>
</div>
</div>
<div class="paragraph">
<p><font o="4923">通过从<code i="1213">File</code>菜单中选择<code i="1212">Import existing projects</code>，可以导入生成的Eclipse项目。</font></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributing"><font o="4924">附录E：贡献</font></h2>
<div class="sectionbody">
<div class="paragraph">
<p><font o="4925">Spring Cloud是在非限制性Apache 2.0许可下发布的，遵循非常标准的Github开发过程，使用Github跟踪器解决问题并将pull请求合并到master中。</font><font o="4926">如果您想贡献一些微不足道的东西，请不要犹豫，但请遵循以下指南。</font></p>
</div>
<div class="sect2">
<h3 id="_sign_the_contributor_license_agreement">E.1.<font o="4928">签署贡献者许可协议</font></h3>
<div class="paragraph">
<p><font o="4929">在我们接受非平凡的补丁或拉取请求之前，我们需要您签署</font><a href="javascript:;"><font o="4929">贡献者的协议</font></a><font o="4929">。</font><font o="4930">签署贡献者的协议不会授予任何人对主存储库的提交权限，但它确实意味着我们可以接受您的贡献，如果我们这样做，您将获得作者信用。</font><font o="4931">可能会要求活跃的贡献者加入核心团队，并且可以合并拉取请求。</font></p>
</div>
</div>
<div class="sect2">
<h3 id="_code_conventions_and_housekeeping">E.2.<font o="4933">代码约定和内务管理</font></h3>
<div class="paragraph">
<p><font o="4934">以下指南对拉取请求都不是必不可少的，但它们都有助于您的开发人员理解并使用您的代码。</font><font o="4935">它们也可以在原始拉取请求之后但在合并之前添加。</font></p>
</div>
<div class="ulist">
<ul>
<li>
<p><font o="4936">使用Spring Framework代码格式约定。</font><font o="4937">如果使用Eclipse，则可以使用</font><a href="javascript:;"><font o="4937">Spring Cloud Build</font></a><font o="4937">项目中</font><font o="4937">的<code i="1214">eclipse-code-formatter.xml</code>文件导入格式化程序设置</font><font o="4937">。</font><font o="4938">如果使用IntelliJ，则可以使用</font><a href="javascript:;"><font o="4938">Eclipse Code Formatter Plugin</font></a><font o="4938">导入同一文件。</font></p>
</li>
<li>
<p><font o="4939">确保所有新的<code i="1215">.java</code>文件都有一个简单的Javadoc类注释，至少有一个标识您的<code i="1216">@author</code>标记，最好至少有一个段落描述该类的用途。</font></p>
</li>
<li>
<p><font o="4940">将ASF许可证标头注释添加到所有新的<code i="1217">.java</code>文件（为此，从项目中的现有文件进行复制）。</font></p>
</li>
<li>
<p><font o="4941">将自己添加为<code i="1218">@author</code>到您实际修改的.java文件（超过整容更改）。</font></p>
</li>
<li>
<p><font o="4942">添加一些Javadoc，如果更改名称空间，则添加一些XSD doc元素。</font></p>
</li>
<li>
<p><font o="4943">一些单元测试也会有很多帮助。</font><font o="4944">有人必须这样做，而你的开发人员也很欣赏这种努力。</font></p>
</li>
<li>
<p><font o="4945">如果没有其他人使用您的分支，请将其针对当前主服务器（或主项目中的其他目标分支）进行rebase。</font></p>
</li>
<li>
<p><font o="4946">编写提交消息时，请遵循</font><a href="javascript:;"><font o="4946">这些约定</font></a><font o="4946">。</font><font o="4947">如果您修复了现有问题，请在提交消息末尾添加<code i="1219">Fixes gh-XXXX</code>（其中XXXX是问题编号）。</font></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnote_1">
<a href="#_footnoteref_1"><font o="4948">1</font></a><font o="4948">。</font><font o="4949">HATEOAS代表超媒体作为应用程序状态的引擎
</font></div>
</div>
<div id="footer">
<div id="footer-text"><font o="4950">
上次更新时间2018-12-05 14:34:40 UTC
</font></div>
</div>
<script data-cfasync="false" src="static/js/email-decode.min.js"></script><script type="text/javascript" src="static/js/tocbot.js"></script>
<script type="text/javascript">var oldtoc=document.getElementById('toctitle').nextElementSibling;var newtoc=document.createElement('div');newtoc.setAttribute('id','tocbot');newtoc.setAttribute('class','js-toc');oldtoc.parentNode.replaceChild(newtoc,oldtoc);tocbot.init({contentSelector:'#content',tocSelector:'.js-toc',headingSelector:'h1, h2, h3, h4, h5',smoothScroll:false});var handleTocRefresh=function(){tocbot.refresh();}
var handleTocOnResize=function(){var width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;if(width<768){tocbot.refresh({contentSelector:'#content',tocSelector:'.js-toc',headingSelector:'h1, h2, h3, h4, h5',collapseDepth:6,activeLinkClass:'ignoreactive',throttleTimeout:1000,smoothScroll:false});}else{tocbot.refresh({contentSelector:'#content',tocSelector:'.js-toc',headingSelector:'h1, h2, h3, h4, h5',smoothScroll:false});}};window.addEventListener('resize',handleTocOnResize);window.addEventListener('tocRefresh',handleTocRefresh);handleTocOnResize();</script>

<script type="text/javascript" name="springcloud">springcloud.cc({"original":{"1":"{0/} Reference Guide","2":"Sabby AnandanMarius BogoeviciEric BottardMark FisherIlayaperumal GopinathanGunnar HillertMark PollackPatrick PeraltaGlenn RenfroThomas RisbergDave SyerDavid TuranskiJanne ValkealahtiOleg ZhurakouskyJay BryantVinicius CarvalhoChris Schaefer","3":"Table of Contents","4":"Preface","5":"1. About the documentation","6":"2. Getting help","7":"Getting started","8":"3. System Requirements","9":"4. Getting Started with Docker Compose","11":"Docker Compose Customization","12":"5. Getting Started with Manual Installation","13":"6. Deploying Streams","14":"7. Deploying Tasks","15":"Applications","16":"8. Available Applications","17":"Architecture","18":"9. Introduction","19":"10. Microservice Architectural Style","21":"Comparison to Other Platform Architectures","22":"11. Data Flow Server","24":"Endpoints","26":"Security","27":"12. Streams","29":"Topologies","31":"Concurrency","33":"Partitioning","35":"Message Delivery Guarantees","36":"13. Stream Programming Models","38":"Imperative Programming Model","40":"Functional Programming Model","41":"14. Application Versioning","42":"15. Task Programming Model","43":"16. Analytics","44":"17. Runtime","46":"Fault Tolerance","48":"Resource Management","50":"Scaling at Runtime","51":"Configuration","52":"18. Feature Toggles","53":"19. Database","55":"Disabling database schema creation and migration strategies","57":"Adding a Custom JDBC Driver","58":"20. Local Deployer","59":"21. Maven","60":"22. Local Data Flow Server Logging configuration","61":"23. Skipper","62":"24. Security","64":"Enabling HTTPS","66":"Using Self-Signed Certificates","68":"Self-Signed Certificates and the Shell","69":"Adding the Self-signed Certificate to the JVM Truststore","70":"Skipping Certificate Validation","72":"Traditional Authentication","74":"Single User Authentication","76":"File-based Authentication","78":"LDAP Authentication","79":"LDAP Role Mapping","80":"LDAP Transport Security","82":"Shell Authentication","84":"Customizing Authorization","86":"Authorization - Shell and Dashboard Behavior","88":"Authorization with LDAP","90":"OAuth 2.0","92":"OAuth REST Endpoint Authorization","94":"OAuth Authentication using the {0/} Shell","96":"OAuth2 Authentication Examples","97":"Local OAuth2 Server","98":"Authentication with GitHub","100":"Securing the {16/} Management Endpoints","101":"25. Monitoring and Management","103":"Monitoring Deployed Stream Applications","105":"Using the Metrics Collector","107":"{16/} 2.x","109":"{16/} 1.x","110":"26. About Configuration","112":"Enabling Shell Checksum values","114":"Reserved Values for URLs","115":"Shell","116":"27. Shell Options","117":"28. Listing Available Commands","118":"29. Tab Completion","119":"30. White Space and Quoting Rules","121":"Quotes and Escaping","123":"Shell rules","125":"Property files rules","127":"DSL Parsing Rules","129":"{32/} Syntax and {32/} Literals","131":"Putting It All Together","132":"Streams","133":"31. Introduction","135":"Stream Pipeline DSL","137":"Stream Application DSL","139":"Application properties","140":"32. Stream Lifecycle","142":"Register a Stream App","144":"Register Supported Applications and Tasks","146":"Whitelisting application properties","148":"Creating and Using a Dedicated Metadata Artifact","150":"Using the Companion Artifact","152":"Creating Custom Applications","154":"Creating a Stream","156":"Application {18/}","158":"Common Application {18/}","160":"Deploying a Stream","162":"Deployment {18/}","163":"Passing Instance Count","164":"Inline Versus File-based {18/}","165":"Passing application properties","166":"Passing {3/} properties","167":"Passing Per-binding Producer and Consumer {18/}","168":"Passing Stream Partition {18/}","169":"Passing application content type properties","170":"Overriding Application {18/} During Stream Deployment","172":"Destroying a Stream","174":"Undeploying a Stream","176":"Validating a Stream","177":"33. Stream Lifecycle with Skipper","179":"Register a Versioned Stream App","181":"Creating and Deploying a Stream","183":"Updating a Stream","185":"Force update of a Stream","187":"Stream versions","189":"Stream Manifests","191":"Rollback a Stream","193":"Application Count","195":"Skipper's Upgrade Strategy","196":"34. Stream DSL","198":"Tap a Stream","200":"Using Labels in a Stream","202":"Named Destinations","204":"Fan-in and Fan-out","205":"35. Stream Java DSL","207":"Overview","209":"Java DSL styles","211":"Using the DeploymentPropertiesBuilder","213":"Deploying using Skipper","214":"36. Stream Applications with Multiple {25/} Configurations","215":"37. Examples","217":"Simple Stream Processing","219":"Stateful Stream Processing","221":"Other Source and Sink Application Types","222":"Streams with Skipper","223":"38. Upgrading","225":"Force upgrade of a Stream","227":"Overriding properties during Stream update","229":"Stream History","231":"Stream Manifest","232":"39. Rolling back","233":"Stream Developer Guide","234":"40. Prebuilt Applications","235":"41. Running prebuilt applications","236":"42. Custom Processor Application","237":"43. Improving the Quality of Service","238":"44. Mapping Applications onto Data Flow","239":"Tasks","240":"45. Introduction","242":"Application properties","243":"46. The Lifecycle of a Task","245":"Creating a Task Application","247":"Task Database Configuration","249":"Registering a Task Application","251":"Creating a Task Definition","253":"Launching a Task","255":"Common application properties","257":"Limit the number concurrent task launches","259":"Reviewing Task Executions","261":"Destroying a Task Definition","263":"Validating a Task","264":"47. Subscribing to Task/Batch {29/}","265":"48. Composed Tasks","267":"Configuring the Composed Task Runner","269":"Registering the Composed Task Runner","271":"Configuring the Composed Task Runner","272":"Configuration Options","274":"The Lifecycle of a Composed Task","276":"Creating a Composed Task","277":"Task Application Parameters","279":"Launching a Composed Task","280":"Passing properties to the child tasks","281":"Passing arguments to the composed task runner","282":"Exit Statuses","284":"Destroying a Composed Task","286":"Stopping a Composed Task","288":"Restarting a Composed Task","289":"49. Composed Tasks DSL","291":"Conditional Execution","293":"Transitional Execution","295":"Basic Transition","297":"Transition With a Wildcard","299":"Transition With a Following Conditional Execution","301":"Split Execution","303":"Split Containing Conditional Execution","305":"Establishing the proper thread count for splits","306":"50. Launching Tasks from a Stream","308":"TriggerTask","310":"TaskLaunchRequest-transform","312":"Launching a Composed Task From a Stream","313":"51. Sharing {0/}’s Datastore with Tasks","315":"A Common DataStore Dependency","317":"A Common Data Store","319":"Simple Task Launch","321":"Task Launcher Sink","323":"Composed Task Runner","325":"Launching a task externally from {0/}","326":"52. Scheduling Tasks","328":"The Scheduler","330":"Enabling Scheduling","332":"The Lifecycle of a Schedule","334":"Scheduling a Task Execution","336":"Deleting a Schedule","337":"Task Developer Guide","338":"53. Prebuilt Applications","339":"54. Running Prebuilt Applications","340":"55. Building a Timestamp Task","341":"56. Developing Your Timestamp Application","343":"Creating the {27/} Task Project using {27/} Initializr","345":"Writing the Code","347":"Running the Example","349":"Recording an Error","351":"Adding Pre- and Post-processing","353":"Adding a MySQL Database","354":"57. Adding and Launching {14/} Tasks with Data Flow","356":"Registering and Launching Your First Task","358":"Registering and Launching Your First {13/}-Task","360":"Verifying that Your Task is a Batch","361":"58. Database Requirement for running tasks in {0/}","362":"Dashboard","363":"59. Introduction","364":"60. Apps","366":"Bulk Import of Applications","367":"61. Runtime","368":"62. Streams","370":"Working with Stream Definitions","372":"Creating a Stream","374":"Deploying a Stream","376":"Creating Fan-In/Fan-Out Streams","378":"Creating a Tap Stream","379":"63. Tasks","381":"Apps","383":"View Task App Details","385":"Create a Task Definition","387":"Definitions","389":"Creating Composed Task Definitions","391":"Launching Tasks","393":"Executions","395":"Execution Detail","396":"64. Jobs","398":"Job Execution Details","400":"Step Execution Details","402":"Step Execution Progress","403":"65. Scheduling","405":"Creating or deleting a Schedule from the Task Definition's page","407":"Creating a Schedule","409":"Listing Available Schedules","410":"66. Analytics","411":"67. Auditing","412":"Samples","413":"68. Links","414":"REST API Guide","415":"69. Overview","417":"HTTP verbs","419":"HTTP Status Codes","421":"Headers","423":"Errors","425":"Hypermedia","426":"70. Resources","428":"Index","430":"Accessing the index","431":"Request Structure","432":"Example Request","433":"Response Structure","434":"Example Response","435":"Links","437":"Server Meta Information","439":"Retrieving information about the server","440":"Request Structure","441":"Example Request","442":"Response Structure","444":"Registered Applications","446":"Listing Applications","447":"Request Structure","448":"Request Parameters","449":"Example Request","450":"Response Structure","452":"Getting Information on a Particular Application","453":"Request Structure","454":"Request Parameters","455":"Path Parameters","456":"Example Request","457":"Response Structure","459":"Registering a New Application","460":"Request Structure","461":"Request Parameters","462":"Path Parameters","463":"Example Request","464":"Response Structure","466":"Registering a New Application with version","467":"Request Structure","468":"Request Parameters","469":"Path Parameters","470":"Example Request","471":"Response Structure","473":"Set the default application version","474":"Request Structure","475":"Path Parameters","476":"Example Request","477":"Response Structure","479":"Unregistering an Application","480":"Request Structure","481":"Path Parameters","482":"Example Request","483":"Response Structure","485":"Registering Applications in Bulk","486":"Request Structure","487":"Request Parameters","488":"Example Request","489":"Response Structure","491":"Audit Records","493":"List All Audit Records","494":"Request Structure","495":"Request Parameters","496":"Example Request","497":"Response Structure","499":"Stream Definitions","501":"Creating a New Stream Definition","502":"Request Structure","503":"Request Parameters","504":"Example Request","505":"Response Structure","507":"List All Stream Definitions","508":"Request Structure","509":"Request Parameters","510":"Example Request","511":"Response Structure","513":"List Related Stream Definitions","514":"Request Structure","515":"Request Parameters","516":"Example Request","517":"Response Structure","519":"Delete a Single Stream Definition","520":"Request Structure","521":"Request Parameters","522":"Example Request","523":"Response Structure","525":"Delete All Stream Definitions","526":"Request Structure","527":"Request Parameters","528":"Example Request","529":"Response Structure","531":"Stream Validation","533":"Request Structure","535":"Request Parameters","537":"Example Request","539":"Response Structure","541":"Stream Deployments","543":"Deploying Stream Definition","544":"Request Structure","545":"Request Parameters","546":"Example Request","547":"Response Structure","549":"Undeploy Stream Definition","550":"Request Structure","551":"Request Parameters","552":"Example Request","553":"Response Structure","555":"Undeploy All Stream Definitions","556":"Request Structure","557":"Request Parameters","558":"Example Request","559":"Response Structure","561":"Update Deployed Stream","562":"Request Structure","563":"Request Parameters","564":"Example Request","565":"Response Structure","567":"Rollback Stream Definition","568":"Request Structure","569":"Request Parameters","570":"Example Request","571":"Response Structure","573":"Get Manifest","574":"Request Structure","575":"Request Parameters","576":"Example Request","577":"Response Structure","579":"Get Deployment History","580":"Request Structure","581":"Example Request","582":"Response Structure","584":"Get Deployment Platforms","585":"Request Structure","586":"Example Request","587":"Response Structure","589":"Task Definitions","591":"Creating a New Task Definition","592":"Request Structure","593":"Request Parameters","594":"Example Request","595":"Response Structure","597":"List All Task Definitions","598":"Request Structure","599":"Request Parameters","600":"Example Request","601":"Response Structure","603":"Retrieve Task Definition Detail","604":"Request Structure","605":"Request Parameters","606":"Example Request","607":"Response Structure","609":"Delete Task Definition","610":"Request Structure","611":"Request Parameters","612":"Example Request","613":"Response Structure","615":"Task Scheduler","617":"Creating a New Task Schedule","618":"Request Structure","619":"Request Parameters","620":"Example Request","621":"Response Structure","623":"List All Schedules","624":"Request Structure","625":"Request Parameters","626":"Example Request","627":"Response Structure","629":"List Filtered Schedules","630":"Request Structure","631":"Request Parameters","632":"Example Request","633":"Response Structure","635":"Delete Task Schedule","636":"Request Structure","637":"Request Parameters","638":"Example Request","639":"Response Structure","641":"Task Validation","642":"Request Structure","643":"Request Parameters","644":"Example Request","645":"Response Structure","647":"Task Executions","649":"Launching a Task","650":"Request Structure","651":"Request Parameters","652":"Example Request","653":"Response Structure","655":"List All Task Executions","656":"Request Structure","657":"Request Parameters","658":"Example Request","659":"Response Structure","661":"List All Task Executions With a Specified Task Name","662":"Request Structure","663":"Request Parameters","664":"Example Request","665":"Response Structure","667":"Task Execution Detail","668":"Request Structure","669":"Request Parameters","670":"Example Request","671":"Response Structure","673":"Delete Task Execution","674":"Request Structure","675":"Request Parameters","676":"Example Request","677":"Response Structure","679":"Task Execution Current Count","680":"Request Structure","681":"Request Parameters","682":"Example Request","683":"Response Structure","685":"Job Executions","687":"List All Job Executions","688":"Request Structure","689":"Request Parameters","690":"Example Request","691":"Response Structure","693":"List All Job Executions With a Specified Job Name","694":"Request Structure","695":"Request Parameters","696":"Example Request","697":"Response Structure","699":"Job Execution Detail","700":"Request Structure","701":"Request Parameters","702":"Example Request","703":"Response Structure","705":"Stop Job Execution","706":"Request structure","707":"Request parameters","708":"Example request","709":"Response structure","711":"Restart Job Execution","712":"Request Structure","713":"Request Parameters","714":"Example Request","715":"Response Structure","717":"Job Instances","719":"List All Job Instances","720":"Request Structure","721":"Request Parameters","722":"Example Request","723":"Response Structure","725":"Job Instance Detail","726":"Request Structure","727":"Request Parameters","728":"Example Request","729":"Response Structure","731":"Job Step Executions","733":"List All Step Executions For a Job Execution","734":"Request Structure","735":"Request Parameters","736":"Example Request","737":"Response Structure","739":"Job Step Execution Detail","740":"Request Structure","741":"Request Parameters","742":"Example Request","743":"Response Structure","745":"Job Step Execution Progress","746":"Request Structure","747":"Request Parameters","748":"Example Request","749":"Response Structure","751":"Runtime Information about Applications","753":"Listing All Applications at Runtime","754":"Request Structure","755":"Example Request","756":"Response Structure","758":"Querying All Instances of a Single App","759":"Request Structure","760":"Example Request","761":"Response Structure","763":"Querying a Single Instance of a Single App","764":"Request Structure","765":"Example Request","766":"Response Structure","768":"Metrics for Stream Applications","770":"Request Structure","772":"Example Request","774":"Response Structure","776":"Example Response","777":"Appendices","778":"Appendix A: Data Flow Template","780":"Using the Data Flow Template","781":"Appendix B: “How-to” guides","783":"Configure Maven {18/}","785":"Logging","787":"Deployment Logs","789":"Application Logs","791":"Remote Debugging","793":"Log Redirect","795":"Frequently Asked Questions","797":"Advanced {32/} Expressions","799":"How to Use JDBC-sink?","801":"How to Use Multiple Message-binders?","802":"Appendix C: {27/} XD to SCDF","804":"Terminology Changes","806":"Modules to Applications","808":"Custom Applications","810":"Application Registration","812":"Application {18/}","814":"Message {35/} to {22/}","816":"Message {35/}","820":"Named Channels","822":"Directed Graphs","824":"Batch to Tasks","826":"Shell and DSL Command Changes","828":"REST API Changes","830":"UI (including Flo)","832":"Architecture Components","836":"RDBMS","838":"Redis","840":"Cluster Topology","842":"Central Configuration","844":"Distribution","846":"Hadoop Distribution Compatibility","848":"Use Case Comparison","850":"Use Case #1: Ticktock","852":"Use Case #2: Stream with Custom Module or Application","854":"Use Case #3: Batch Job","855":"Appendix D: Building","857":"Documentation","859":"Working with the Code","861":"Importing into Eclipse with m2eclipse","863":"Importing into Eclipse without m2eclipse","864":"Appendix E: Contributing","866":"Sign the Contributor License Agreement","868":"Code Conventions and Housekeeping","869":"Version 1.7.3.RELEASE","870":"© 2012-2018 Pivotal Software, Inc.","871":"Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically.","872":"Preface","873":"1. About the documentation","874":"The documentation for this release is available in HTML.","875":"The latest copy of the {0/} reference guide can be found here.","876":"Copies of this document may be made for your own use and for\ndistribution to others, provided that you do not charge any fee for such copies and\nfurther provided that each copy contains this Copyright Notice, whether distributed in\nprint or electronically.","877":"2. Getting help","878":"Having trouble with {0/}, We would like to help!","879":"Ask a question.","880":"We monitor stackoverflow.com for questions tagged with .","881":"Report bugs with {0/} at github.com/spring-cloud/spring-cloud-dataflow/issues.","882":"All of {0/} is open source, including the documentation!","883":"If you find problems with the docs or if you just want to improve them, please get involved .","884":"Getting started","885":"If you are getting started with {0/}, this section is for you.","886":"In this section, we answer the basic “what?”, “how?” and “why?” questions.","887":"You can find a gentle introduction to {0/} along with installation instructions.","888":"We then build an introductory {0/} application, discussing some core principles as we go.","889":"3. System Requirements","890":"You need Java 8 to run and to build you need to have Maven.","891":"You need to have an RDBMS for storing stream definition and deployment properites and task/batch job states.","892":"By default, the Data Flow server uses embedded H2 database for this purpose but you can easily configure the server to use another external database.","893":"You also need to have Redis running if you are running any streams that involve analytics applications.","894":"Redis may also be required to run the unit/integration tests.","895":"For the deployed streams applications communicate, either {21/} or {31/} needs to be installed.","896":"If you would like to have the feature of upgrading and rolling back applications in Streams at runtime, you should install the {14/} Skipper server.","897":"4. Getting Started with Docker Compose","898":"As of {0/} 1.4, a Docker Compose file is provided to quickly bring up {0/} and its dependencies without having to obtain them manually.","899":"When running, a composed system includes the latest GA release of {0/} Local Server using the {31/} binder for communication.","900":"Docker Compose is required and it's recommended to use the latest version .","901":"Download the {0/} Local Server Docker Compose file:","902":"If the {36/} command is unavailable, {37/} or another platform specific utility may be used.","903":"Alternatively navigate to https://raw.githubusercontent.com/spring-cloud/spring-cloud-dataflow/v1.7.3.RELEASE/spring-cloud-dataflow-server-local/docker-compose.yml in a {33/} browser and save the contents.","904":"Ensure the downloaded filename is {38/}.","905":"Start Docker Compose","906":"In the directory where you downloaded {39/}, start the system, as follows:","907":"The {40/} file defines a variable {41/} so that it can be changed easily.","908":"The above commands first set the {42/} to use in the environment and then {43/} is started.","909":"A shorthand version which only exposes the {44/} variable to the {45/} process rather than setting it in the environment would be as follows:","910":"When using Windows, environment variables are defined by using the {46/} command.","911":"To start the system on Windows, enter the following commands:","912":"By default Docker Compose will use locally available images.","913":"For example when using the {47/} tag, execute {48/} prior to {49/} to ensure the latest image is downloaded.","914":"Launch the {0/} Dashboard","915":"{0/} will be ready for use once the {50/} command stops emitting log messages.","916":"At this time, in your browser navigate to the {0/} Dashboard .","917":"By default the latest GA releases of Stream and Task applications will be imported automatically.","918":"Create a Stream","919":"To create a stream, first navigate to the \"Streams\" menu link then click the \"Create Stream\" link.","920":"Enter {51/} into the \"Create Stream\" textarea then click the \"CREATE STREAM\" button.","921":"Enter \"ticktock\" for the stream name and click the \"Deploy Stream(s) checkbox as show in the following image:","922":"Figure 1. Creating a Stream","923":"Then click \"OK\" which will return back to the Definitions page.","924":"The stream will be in \"deploying\" status and move to \"deployed\" when finished.","925":"You may need to refresh your browser to see the updated status.","926":"View Stream Logs","927":"To view the stream logs, navigate to the \"Runtime\" menu link and click the \"ticktock.log\" link.","928":"Copy the path in the \"stdout\" text box on the dashboard and in another console type:","929":"You should now see the output of the log sink, printing a timestamp once per second.","930":"Press CTRL+c to end the {52/}.","931":"Delete a Stream","932":"To delete the stream, first navigate to the \"Streams\" menu link in the dashboard then click the checkbox on the \"ticktock\" row.","933":"Click the \"DESTROY ALL 1 SELECTED STREAMS\" button and then \"YES\" to destroy the stream.","934":"Destroy the Quick Start environment","935":"To destroy the Quick Start environment, in another console from where the {53/} is located, type as follows:","936":"Some stream applications may open a port, for example {54/}.","937":"By default, a port range of {55/} is exposed from the container to the host.","938":"If you would like to change this range, modify the {56/} block of the {57/} service in the {58/} file.","940":"Docker Compose Customization","941":"Out of the box {0/} will use the H2 embedded database for storing state, {31/} for communication and no analytics.","942":"Customizations can be made to these components by editing the {59/} file as described below.","943":"To use MySQL rather than the H2 embedded database, add the following configuration under the {60/} section:","944":"The following entries need to be added to the {61/} block of the {62/} service definition:","945":"To use {21/} instead of {31/} for communication, replace the following configuration under the {63/} section:","946":"With:","947":"In the {64/} services configuration block, add the following {65/} entry:","948":"And finally, modify the {66/} service definition {67/} attribute to replace {68/} with {69/}.","949":"To enable analytics using redis as a backend, add the following configuration under the {70/} section:","950":"Then add the following entries to the {71/} block of the {72/} service definition:","951":"To enable {73/} registration directly from the host machine you have to mount the source host folders to the {74/} container.","952":"For example, if the {75/} is in the {76/} folder on your host machine, then add the following {77/} block to the {78/} service definition:","953":"Later provides access to the {79/} (and the other files in the folder) from within container's {80/} folder.","954":"Check the compose-file reference for furthether configuration details.","955":"The explicit volume mounting couples the docker-compose to your host's file system, limiting the portability to other machines and OS-es.","956":"Unlike {81/}, the {82/} doesn't allow volume mounting from the command line (eg no {83/} like parameter).","957":"Instead you can define a placeholder environment variable such as {84/} in place of the hardcoded path: {85/} and set this variable before starting the docker-compose.","958":"Once the host folder is mounted, you can register the app starters (from {86/}), with the SCDF Shell or Dashboard, using the {87/} URI schema:","959":"\nUse also {88/} if the metadata jar is available in the /root/apps.\n","960":"To access host's local maven repository from within the {89/} container, you should mount host maven local repository (defaults to {90/} for OSX and Linux and {91/} for Windows) to a {92/} volume called {93/}.","961":"For MacOS or Linux host machines this looks like this:","962":"Now you can use the {94/} URI schema and maven coordinates to resolve jars installed in the host’s maven repository:","963":"This approach allow you to share jars build and installed on the host machine (e.g. {95/}) directly with the dataflow-server container.","964":"One can also pre-register the apps directly in the docker-compose.","965":"For every pre-registered app starer, add an additional {96/} statement to the {97/} block configuration:","966":"Check the SCDF REST API for further details.","967":"To enable {14/} Skipper along with Metrics support, the following modifications need to be made.","968":"In this example, its assumed the stock {98/} file is being used as a starting point.","969":"Customizations can still be applied, for example swapping {31/} with {30/} by using the examples above.","970":"First, after the {99/} service definition:","971":"Add MySQL as described in Using MySQL","972":"Add Redis as described in Enable analytics using Redis","973":"Then add Skipper and Metrics under the {100/} service definition:","974":"Remove application port mapping from {101/} as they are now assigned to the {102/} container:","975":"Becomes:","976":"And lastly append the following environment variables to the {103/} {104/} block:","977":"When using Skipper, launched applications and their logs reside on the {105/} container rather than the {106/} container.","978":"For example, when viewing stream logs as described earlier, the {107/} container would be referenced instead:","979":"5. Getting Started with Manual Installation","980":"Download the {0/} Server and Shell apps:","981":"Starting 1.3.x, the Data Flow Server can run in either the {108/} or {109/} mode.","982":"The {110/} mode is how the Data Flow Server worked in the 1.2.x releases.","983":"The mode is specified when starting the Data Flow server using the property {111/}.","984":"By default, the {112/} mode is enabled.","985":"Download Skipper if you would like the added features of upgrading and rolling back applications inside Streams, since Data Flow delegates to Skipper for those features.","986":"Launch Skipper (Required only if you want to run {0/} server in {113/} mode)","987":"In the directory where you downloaded Skipper, run the server using {114/}, as follows:","988":"Launch the Data Flow Server","989":"In the directory where you downloaded Data Flow, run the server using {115/}, as follows:","990":"To run the Data Flow server in {116/} mode:","991":"To run the Data Flow server in {117/} mode:","992":"If Skipper and the Data Flow server are not running on the same host, set the configuration property {118/} to the location of Skipper, e.g.","993":"Launch the Data Flow Shell, as follows:","994":"Launching the Data Flow shell requires the appropriate data flow server mode to be specified.","995":"To start the Data Flow Shell for the Data Flow server running in {119/} mode:","996":"To start the Data Flow Shell for the Data Flow server running in {120/} mode:","997":"\nBoth the Data Flow Server and the Shell must be on the same mode.\n","998":"If the Data Flow Server and shell are not running on the same host, you can also point the shell to the Data Flow server URL using the {121/} command when in the shell’s interactive mode.","999":"If the Data Flow Server and shell are not running on the same host, point the shell to the Data Flow server URL, as follows:","1000":"Alternatively, pass in the command line option {122/}.","1001":"The shell's command line option {123/} shows what is available.","1002":"6. Deploying Streams","1003":"Register Stream Apps","1004":"By default, the application registry is empty.","1005":"As an example, register two applications, {124/} and {125/}, that communicate by using {21/}.","1006":"For more details, such as how to register applications that are based on docker containers or use {31/} as the messaging middleware, review the section on how to register applications.","1007":"Depending on your environment, you may need to configure the Data Flow Server to point to a custom Maven repository location or configure proxy settings.","1008":"See Maven for more information.","1009":"In this getting started section, we only show deploying a stream, so the commands are the same in {126/} as well as {127/} mode of the server.","1010":"Create a stream","1011":"Use the {128/} command to create a stream with a {129/} source and a {130/} sink and deploy it:","1012":"You need to wait a little while, until the apps are actually deployed successfully, before posting data.","1013":"Look in the log file of the Data Flow server for the location of the log files for the {131/} and {132/} applications.","1014":"Use the {133/} command on the log file for each application to verify that the application has started.","1015":"Now post some data, as shown in the following example:","1016":"Check to see if {134/} ended up in log files for the {135/} application.","1017":"The location of the log file for the {136/} application will be shown in the Data Flow server's log.","1018":"You can read more about the general features of using Skipper to deploy streams in the section Stream Lifecycle with Skipper and how to upgrade and rollback streams in Streams with Skipper.","1019":"When deploying locally, each app (and each app instance, in case of {137/}) gets a dynamically assigned {138/}, unless you explicitly assign one with {139/}.","1020":"In both cases, this setting is propagated as a configuration property that overrides any lower-level setting that you may have used (for example, in {140/} files).","1021":"7. Deploying Tasks","1022":"In this getting started section, we show how to register a task, create a task definition and then launch it.","1023":"We will then also review information about the task executions.","1024":"Launching {7/} applications are not delegated to Skipper since they are short lived applications.","1025":"Tasks are alwasy deployed directly via the Data Flow Server.","1026":"Register a Task App","1027":"By default, the application registry is empty.","1028":"As an example, we will register one task application, {141/} which simply prints the current time to the log.","1029":"Depending on your environment, you may need to configure the Data Flow Server to point to a custom Maven repository location or configure proxy settings.","1030":"See Maven for more information.","1031":"Create a Task Definition","1032":"Use the {142/} command to create a task definition using the previously registered {143/} application.","1033":"In this example, no additional properties are used to configure the {144/} application.","1034":"Launch a Task","1035":"The launching of task definitions is done through the shell’s {145/} command.","1036":"Check to see if the a timestamp ended up in log file for the timestamp task.","1037":"The location of the log file for the task application will be shown in the Data Flow server's log.","1038":"You should see a log entry similar to","1039":"Review task execution","1040":"Information about the task execution can be obtained using the command {146/}.","1041":"Additional information can be obtained using the command {147/}.","1042":"The Tasks section has more information on the lifecycle of Tasks and also how to use\nComposed Tasks which let you create a directed graph where each node of the graph is a task application.","1043":"Applications","1044":"A selection of pre-built stream and task/batch starter apps for various data integration and processing scenarios to facilitate learning and experimentation.","1045":"The table below includes the pre-built applications at a glance.","1046":"For more details, review how to register supported applications .","1047":"8. Available Applications","1048":"Source","1049":"Processor","1050":"Sink","1051":"Task","1052":"Architecture","1053":"9. Introduction","1054":"{0/} simplifies the development and deployment of applications focused on data processing use cases.","1055":"The major concepts of the architecture are Applications, the Data Flow Server, and the target runtime.","1056":"Applications come in two flavors:","1057":"Long-lived Stream applications where an unbounded amount of data is consumed or produced through messaging middleware.","1058":"Short-lived Task applications that process a finite set of data and then terminate.","1059":"Depending on the runtime, applications can be packaged in two ways:","1060":"{16/} uber-jar that is hosted in a maven repository, file, or HTTP(S).","1061":"Docker image.","1062":"The runtime is the place where applications execute.","1063":"The target runtimes for applications are platforms that you may already be using for other application deployments.","1064":"The supported platforms are:","1066":"Kubernetes","1067":"Local Server","1068":"The local server is supported in production for Task deployment as a replacement for the {13/} Admin project.","1069":"The local server is not supported in production for Stream deployments.","1070":"There is a deployer Service Provider Interface (SPI) that lets you extend Data Flow to deploy onto other runtimes.","1071":"There are community implementations","1072":"HashiCorp Nomad","1073":"OpenShift","1074":"Apache Mesos","1075":"The Apache YARN implementation has reached end-of-line status.","1076":"Let us know at {28/} if youare interested in forking the project to continue developing and maintaining it.","1077":"There are two mutually exclusive options that determine how long lived streaming applications are deployed to the platform.","1078":"Select a {0/} Server executable jar that targets a single platform.","1079":"Enable the {0/} Server to delegate the deployment and runtime status of applications to the {14/} Skipper Server, which has the capability to deploy to multiple platforms.","1080":"Selecting the {14/} Skipper option also enables the ability to update and rollback applications in a Stream at runtime.","1081":"The Data Flow server is also responsible for:","1082":"Interpreting and executing a stream DSL that describes the logical flow of data through multiple long-lived applications.","1083":"Launching a long-lived task application.","1084":"Interpreting and executing a composed task DSL that describes the logical flow of data through multiple short-lived applications.","1085":"Applying a deployment manifest that describes the mapping of applications onto the runtime - for example, to set the initial number of instances, memory requirements, and data partitioning.","1086":"Providing the runtime status of deployed applications.","1087":"As an example, the stream DSL to describe the flow of data from an HTTP source to an Apache Cassandra sink would be written using a Unix pipes and filter syntax \" {148/} \".","1088":"Each name in the DSL is mapped to an application that can that Maven or Docker repositories.","1089":"You can also register an application to an {149/} location.","1090":"Many source, processor, and sink applications for common use cases (such as JDBC, HDFS, HTTP, and router) are provided by the {0/} team.","1091":"The pipe symbol represents the communication between the two applications through messaging middleware.","1092":"The two messaging middleware brokers that are supported are:","1095":"In the case of {31/}, when deploying the stream, the Data Flow server is responsible for creating the topics that correspond to each pipe symbol and configure each application to produce or consume from the topics so the desired flow of data is achieved.","1096":"Similarly for {21/}, exchanges and queues are created as needed to achieve the desired flow.","1097":"The interaction of the main components is shown in the following image:","1098":"Figure 2. The {14/} Data High Level Architecure","1099":"In the preceding diagram, a DSL description of a stream is POSTed to the Data Flow Server.","1100":"Based on the mapping of DSL application names to Maven and Docker artifacts, the http-source and cassandra-sink applications are deployed on the target runtime.","1101":"Data that is posted to the HTTP application will then be stored in Cassandra.","1102":"The Samples {19/} shows this use case in full detail.","1103":"10. Microservice Architectural Style","1104":"The Data Flow Server deploys applications onto the target runtime that conform to the microservice architectural style.","1105":"For example, a stream represents a high-level application that consists of multiple small microservice applications each running in their own process.","1106":"Each microservice application can be scaled up or down independently of the other and each has its own versioning lifecycle.","1107":"Using Data Flow with Skipper enables you to independently upgrade or rollback each application at runtime.","1108":"Both Streaming and Task-based microservice applications build upon {16/} as the foundational library.","1109":"This gives all microservice applications functionality such as health checks, security, configurable logging, monitoring, and management functionality, as well as executable JAR packaging.","1110":"It is important to emphasize that these microservice applications are 'just apps' that you can run by yourself by using {150/} and passing in appropriate configuration properties.","1111":"We provide many common microservice applications for common operations so you need not start from scratch when addressing common use cases that build upon the rich ecosystem of {27/} Projects, such as {6/}, {17/}, and {13/}.","1112":"Creating your own microservice application is similar to creating other {16/} applications.","1113":"You can start by using the {27/} Initializr {33/} site to create the basic scaffolding of either a Stream or Task-based microservice.","1114":"In addition to passing the appropriate application properties to each applications, the Data Flow server is responsible for preparing the target platform's infrastructure so that the applications can be deployed.","1115":"For example, in {11/}, it would bind specified services to the applications and execute the {151/} command for each application.","1116":"For Kubernetes, it would create the replication controller, service, and load balancer.","1117":"The Data Flow Server helps simplify the deployment of multiple, relatated, applications onto a target runtime, setting up necessary input and output topics, partitions, and metrics functionality.","1118":"However, one could also opt to deploy each of the microservice applications manually and not use Data Flow at all.","1119":"This approach might be more appropriate to start out with for small scale deployments, gradually adopting the convenience and consistency of Data Flow as you develop more applications.","1120":"Manual deployment of Stream- and Task-based microservices is also a useful educational exercise that can help you better understand some of the automatic application configuration and platform targeting steps that the Data Flow Server provides.","1122":"Comparison to Other Platform Architectures","1123":"{0/}'s architectural style is different than other Stream and Batch processing platforms.","1124":"For example in Apache Spark, Apache Flink, and Google Cloud Dataflow, applications run on a dedicated compute engine cluster.","1125":"The nature of the compute engine gives these platforms a richer environment for performing complex calculations on the data as compared to {0/}, but it introduces the complexity of another execution environment that is often not needed when creating data-centric applications.","1126":"That does not mean you cannot do real-time data computations when using {0/}.","1127":"Refer to the section Analytics , which describes the integration of Redis to handle common counting-based use cases.","1128":"{3/} also supports using Reactive APIs such as Project {24/} and {26/} which can be useful for creating functional style applications that contain time-sliding-window and moving-average functionality.","1129":"Similarly, {3/} also supports the development of applications in that use the {31/} Streams API.","1130":"Apache Storm, Hortonworks DataFlow, and {0/}'s predecessor, {27/} XD, use a dedicated application execution cluster, unique to each product, that determines where your code should run on the cluster and performs health checks to ensure that long-lived applications are restarted if they fail.","1131":"Often, framework-specific interfaces are required in order to correctly “plug in” to the cluster's execution framework.","1132":"As we discovered during the evolution of {27/} XD, the rise of multiple container frameworks in 2015 made creating our own runtime a duplication of effort.","1133":"There is no reason to build your own resource management mechanics when there are multiple runtime platforms that offer this functionality already.","1134":"Taking these considerations into account is what made us shift to the current architecture, where we delegate the execution to popular runtimes, which you may already be using for other purposes.","1135":"This is an advantage in that it reduces the cognitive distance for creating and managing data-centric applications as many of the same skills used for deploying other end-user/{33/} applications are applicable.","1136":"11. Data Flow Server","1137":"The Data Flow Server provides the following functionality:","1138":"Endpoints","1139":"Security","1141":"Endpoints","1142":"The Data Flow Server uses an embedded servlet container and exposes REST endpoints for creating, deploying, undeploying, and destroying streams and tasks, querying runtime state, analytics, and the like.","1143":"The Data Flow Server is implemented by using {27/}'s MVC framework and the {10/} library to create REST representations that follow the HATEOAS principle, as shown in the following image:","1144":"Figure 3. The {0/} Server","1145":"[NOTE] The Data Flow Server that deploys applications to the local machine is not intended to be used in production for streaming use cases but for the development and testing of stream based applications.","1146":"The local Data Flow is intended to be used in production for batch use cases as a replacement for the {13/} Admin project.","1147":"Both streaming and batch use cases are intended to be used in production when deploying to {11/} or Kuberenetes.","1149":"Security","1150":"The Data Flow Server executable jars support basic HTTP, LDAP(S), File-based, and OAuth 2.0 authentication to access its endpoints.","1151":"Refer to the security section for more information.","1152":"12. Streams","1154":"Topologies","1155":"The Stream DSL describes linear sequences of data flowing through the system.","1156":"For example, in the stream definition {152/}, each pipe symbol connects the application on the left to the one on the right.","1157":"Named channels can be used for routing and to fan in/fan out data to multiple messaging destinations.","1158":"The concept of a tap can be used to 'listen' to the data that is flowing across any of the pipe symbols.","1159":"\"Taps\" are just other streams that use an input any one of the \"pipes\" in a target stream and have an independent life cycle from the target stream.","1161":"Concurrency","1162":"For an application that consumes events, {3/} exposes a concurrency setting that controls the size of a thread pool used for dispatching incoming messages.","1163":"See the Consumer properties documentation for more information.","1165":"Partitioning","1166":"A common pattern in stream processing is to partition the data as it moves from one application to the next.","1167":"Partitioning is a critical concept in stateful processing, for either performance or consistency reasons, to ensure that all related data is processed together.","1168":"For example, in a time-windowed average calculation example, it is important that all measurements from any given sensor are processed by the same application instance.","1169":"Alternatively, you may want to cache some data related to the incoming events so that it can be enriched without making a remote procedure call to retrieve the related data.","1170":"{0/} supports partitioning by configuring {3/}'s output and input bindings.","1171":"{3/} provides a common abstraction for implementing partitioned processing use cases in a uniform fashion across different types of middleware.","1172":"Partitioning can thus be used whether the broker itself is naturally partitioned (for example, {31/} topics) or not ({21/}).","1173":"The following image shows how data could be partitioned into two buckets, such that each instance of the average processor application consumes a unique set of data.","1174":"Figure 4. {3/} Partitioning","1175":"To use a simple partitioning strategy in {0/}, you need only set the instance count for each application in the stream and a {153/} producer property when deploying the stream.","1176":"The {154/} identifies what part of the message is used as the key to partition data in the underlying middleware.","1177":"An {155/} stream can be defined as {156/}.","1178":"(Note that the Cassandra sink is not shown in the diagram above.) Suppose the payload being sent to the HTTP source was in JSON format and had a field called {157/}.","1179":"For example, consider the case of deploying the stream with the shell command {158/} where the contents of the {159/} file are as follows:","1180":"The result is to deploy the stream such that all the input and output destinations are configured for data to flow through the applications but also ensure that a unique set of data is always delivered to each {160/} instance.","1181":"In this case, the default algorithm is to evaluate {161/} where the {162/} is the application count in the case of {21/} and the partition count of the topic in the case of {31/}.","1182":"Please refer to Passing Stream Partition {18/} for additional strategies to partition streams during deployment and how they map onto the underlying {3/} Partitioning properties.","1183":"Also note that you cannot currently scale partitioned streams.","1184":"Read Scaling at Runtime for more information.","1186":"Message Delivery Guarantees","1187":"Streams are composed of applications that use the {3/} library as the basis for communicating with the underlying messaging middleware product.","1188":"{3/} also provides an opinionated configuration of middleware from several vendors, in particular providing persistent publish-subscribe semantics .","1189":"The {25/} abstraction in {3/} is what connects the application to the middleware.","1190":"There are several configuration properties of the binder that are portable across all binder implementations and some that are specific to the middleware.","1191":"For consumer applications, there is a retry policy for exceptions generated during message handling.","1192":"The retry policy is configured by using the common consumer properties {163/}, {164/}, {165/}, and {166/}.","1193":"The default values of these properties retry the callback method invocation 3 times and wait one second for the first retry.","1194":"A backoff multiplier of 2 is used for the second and third attempts.","1195":"When the number of retry attempts has exceeded the {167/} value, the exception and the failed message become the payload of a message and are sent to the application's error channel.","1196":"By default, the default message handler for this error channel logs the message.","1197":"You can change the default behavior in your application by creating your own message handler that subscribes to the error channel.","1198":"{3/} also supports a configuration option for both {31/} and {21/} binder implementations that sends the failed message and stack trace to a dead letter queue.","1199":"The dead letter queue is a destination and its nature depends on the messaging middleware (for example, in the case of {31/}, it is a dedicated topic).","1200":"To enable this for {21/} set the {168/} and {169/} consumer properties and the {170/} producer property to true when deploying the stream.","1201":"To always apply these producer and consumer properties when deploying streams, configure them as common application properties when starting the Data Flow server.","1202":"Additional messaging delivery guarantees are those provided by the underlying messaging middleware that is chosen for the application for both producing and consuming applications.","1203":"Refer to the {31/} Consumer and Producer and {30/} Consumer and Producer documentation for more details.","1204":"You can find extensive declarative support for all the native QOS options.","1205":"13. Stream Programming Models","1206":"While {16/} provides the foundation for creating DevOps-friendly microservice applications, other libraries in the {27/} ecosystem help create Stream-based microservice applications.","1207":"The most important of these is {3/}.","1208":"The essence of the {3/} programming model is to provide an easy way to describe multiple inputs and outputs of an application that communicate over messaging middleware.","1209":"These input and outputs map onto {31/} topics or {30/} exchanges and queues as well as the KStream/KTable programming model.","1210":"Common application configuration for a Source that generates data, a Processor that consumes and produces data, and a Sink that consumes data is provided as part of the library.","1212":"Imperative Programming Model","1213":"{3/} is most closely integrated with {6/}'s imperative \"one event at a time\" programming model.","1214":"This means you write code that handles a single event callback, as shown in the following example,","1215":"In this case, the {171/} payload of a message coming on the input channel is handed to the {172/} method.","1216":"The {173/} annotation is used to tie the input channel to the external middleware.","1218":"Functional Programming Model","1219":"However, {3/} can support other programming styles, such as reactive APIs, where incoming and outgoing data is handled as continuous data flows and how each individual message should be handled is defined.","1220":"With many reactive AOIs, you can also use operators that describe functional transformations from inbound to outbound data flows.","1221":"Here is an example:","1222":"14. Application Versioning","1223":"Application versioning within a Stream is now supported when using Data Flow together with Skipper.","1224":"You can update application and deployment properties as well as the version of the application.","1225":"Rolling back to a previous application version is also supported.","1226":"15. Task Programming Model","1227":"The {7/} programming model provides:","1228":"Persistence of the Task’s lifecycle events and exit code status.","1229":"Lifecycle hooks to execute code before or after a task execution.","1230":"The ability to emit task events to a stream (as a source) during the task lifecycle.","1231":"Integration with {13/} Jobs.","1232":"See the Tasks section for more information.","1233":"16. Analytics","1234":"{0/} is aware of certain Sink applications that write counter data to Redis and provides a REST endpoint to read counter data.","1235":"The types of counters supported are as follows:","1236":"Counter: Counts the number of messages it receives, optionally storing counts in a separate store such as Redis.","1237":"Field Value Counter: Counts occurrences of unique values for a named field in a message payload.","1238":"Aggregate Counter: Stores total counts but also retains the total count values for each minute, hour, day, and month.","1239":"Note that the timestamp used in the aggregate counter can come from a field in the message itself so that out-of-order messages are properly accounted.","1240":"17. Runtime","1241":"The Data Flow Server relies on the target platform for the following runtime functionality:","1242":"Fault Tolerance","1243":"Resource Management","1245":"Fault Tolerance","1246":"The target runtimes supported by Data Flow all have the ability to restart a long-lived application.","1247":"{0/} sets up health probes are required by the runtime environment when deploying the application.","1248":"You also have the ability to customize the health probes.","1249":"The collective state of all applications that make up the stream is used to determine the state of the stream.","1250":"If an application fails, the state of the stream changes from 'deployed' to 'partial'.","1252":"Resource Management","1253":"Each target runtime lets you control the amount of memory, disk, and CPU allocated to each application.","1254":"These are passed as properties in the deployment manifest by using key names that are unique to each runtime.","1255":"Refer to each platform's server documentation for more information.","1257":"Scaling at Runtime","1258":"When deploying a stream, you can set the instance count for each individual application that makes up the stream.","1259":"Once the stream is deployed, each target runtime lets you control the target number of instances for each individual application.","1260":"Using the APIs, UIs, or command line tools for each runtime, you can scale up or down the number of instances as required.","1261":"Currently, scaling at runtime is not supported with the {31/} binder, as well as with partitioned streams, for which the suggested workaround is redeploying the stream with an updated number of instances.","1262":"Both cases require a static consumer to be set up, based on information about the total instance count and current instance index.","1263":"Configuration","1264":"This section covers how to configure {0/} Server's features, such as which relational database to use and security.","1265":"It also covers how to configure {0/}'s shell features.","1266":"18. Feature Toggles","1267":"Sprig Cloud Data Flow Server offers specific set of features that can be enabled/disabled when launching.","1268":"These features include all the lifecycle operations and REST endpoints (server and client implementations, including the shell and the UI) for:","1269":"Streams","1270":"Tasks","1271":"Analytics","1272":"Skipper","1273":"Task Scheduler","1274":"One can enable and disable these features by setting the following boolean properties when launching the Data Flow server:","1275":"By default, stream, tasks, and analytics are enabled and Skipper along with Task Scheduler are disabled by default.","1276":"Since the analytics feature is enabled by default, the Data Flow Server expects to have a valid Redis store available to server as the analytic repository, because {0/} provides a default implementation of analytics based on Redis.","1277":"This also means that the Data Flow Server's {174/} depends on the redis store availability as well.","1278":"If you do not want Data Flow's endpoints to read analytics data written to Redis, then disable the analytics feature by setting the property mentioned above.","1279":"The REST {175/} endpoint provides information on the features that have been enabled and disabled.","1280":"19. Database","1281":"A relational database is used to store stream and task definitions as well as the state of executed tasks.","1282":"{0/} provides schemas for H2, HSQLDB, MySQL, Oracle, Postgresql, DB2, and SqlServer.","1283":"The schema is automatically created when the server starts.","1284":"By default, {0/} offers an embedded instance of the H2 database.","1285":"The H2 database is good for development purposes but is not recommended for production use.","1286":"The JDBC drivers for MySQL (through the MariaDB driver), HSQLDB , PostgreSQL , and embedded H2 are available without additional configuration.","1287":"If you are using any other database, then you need to put the corresponding JDBC driver jar on the classpath of the server.","1288":"The database properties can be passed as environment variables or command-line arguments to the Data Flow Server.","1289":"The following example shows how to define a database connection with environment variables:","1290":"The following example shows how to define a MySQL database connection with command Line arguments","1291":"The following example shows how to define a PostgreSQL database connection with command line arguments:","1292":"The following example shows how to define a HSQLDB database connection with command line arguments:","1293":"If you wish to use an external H2 database instance instead of the one embedded with {0/}, set the {176/} property to false.","1294":"If {177/} is set to false or a database other than h2 is specified as the datasource, the embedded database does not start.","1296":"Disabling database schema creation and migration strategies","1297":"You can control whether or not Data Flow bootstraps your database on startup.","1298":"On most production environments chances are you will not have enough privileges to do so.","1299":"If that's the case you can disable it by setting the property {178/} to {179/}.","1300":"The scripts that the server uses to bootstrap the database can be found under {180/} folder.","1301":"For new installations run the corresponding database script located under {181/} and {182/}, for upgrades from version {183/} you only need to run the {184/} scripts.","1303":"Adding a Custom JDBC Driver","1304":"To add a custom driver for the database (for example, Oracle), you should rebuild the Data Flow Server and add the dependency to the Maven {185/} file.","1305":"Since there is a {0/} Server for each target platform, you need to modify the appropriate maven {186/} for each platform.","1306":"There are tags in each GitHub repository for each server version.","1307":"To add a custom JDBC driver dependency for the local server implementation:","1308":"Select the tag that corresponds to the version of the server you want to rebuild and clone the github repository.","1309":"Edit the spring-cloud-dataflow-server-local/pom.xml and, in the {187/} section, add the dependency for the database driver required.","1310":"In the following example , an Oracle driver has been chosen:","1311":"Build the application as described in Building {0/}","1312":"You can also provide default values when rebuilding the server by adding the necessary properties to the dataflow-server.yml file,\nas shown in the following example for PostgreSQL:","1313":"20. Local Deployer","1314":"You can use the following configuration properties of the Data Flow Local server’s deployer to customize how applications are deployed:","1315":"Data Flow Local server itself overrides\n{188/} to {189/} from its\ndefault value.","1316":"When deploying the application, you can also set deployer properties prefixed with {190/}.","1317":"For example, to set Java options for the time application in the {191/} stream, use the following stream deployment properties.","1318":"As a convenience, you can set the {192/} property to set the Java option {193/}, as shown in the following example:","1319":"At deployment time, if you specify an {194/} option in the {195/} property in addition to a value of the {196/} option, the value in the {197/} property has precedence.","1320":"Also, the {198/} property set when deploying the application has precedence over the Data Flow Server's {199/} property.","1321":"21. Maven","1322":"If you want to override specific maven configuration properties (remote repositories, proxies, and others) or run the Data Flow Server behind a proxy,\nyou need to specify those properties as command line arguments when starting the Data Flow Server, as shown in the following example:","1323":"By default, the protocol is set to {200/}.","1324":"You can omit the auth properties if the proxy does not need a username and password.","1325":"Also, the maven {201/} is set to {202/} by default.","1326":"As shown in the preceding example, the remote repositories can be specified along with their authentication (if needed).","1327":"If the remote repositories are behind a proxy, then the proxy properties can be specified as shown in the preceding example.","1328":"The repository policies can be specified for each remote repository configuration as shown in the preceding example.","1329":"The key {203/} is applicable to both {204/} and the {205/} repository policies.","1330":"You can refer to {19/} Policies for the list of\nsupported repository policies.","1331":"As these are {16/} {206/}, you can also specify them as environment variables, such as {207/}.","1332":"Another common option is to set the properties by setting the {208/} environment variable.","1333":"The following example shows how the JSON is structured:","1334":"22. Local Data Flow Server Logging configuration","1335":"{0/} {209/} server is configured to use {210/} for logging.","1336":"By default, the log file is configured to use:","1337":"with the logback configuration for the {211/}:","1338":"To check the {212/} for the current {0/} Server {213/} server,","1339":"If you want to change or override any of the properties {214/}, {215/}, {216/}, {217/}, {218/} and {219/}, please set them as system properties.","1340":"23. Skipper","1341":"To use features such as Stream update and rollback, the Data Flow Server delegates to the Skipper server to manage the Stream's lifecycle.","1342":"Set the configuration property {220/} to the location of Skipper, eg","1344":"24. Security","1345":"By default, the Data Flow server is unsecured and runs on an unencrypted HTTP connection.","1346":"You can secure your REST endpoints as well as the Data Flow Dashboard by enabling HTTPS and requiring clients to authenticate using either:","1347":"OAuth 2.0","1348":"Traditional Authentication (including Basic Authentication)","1349":"The following image shows the authentication options for {0/} Server:","1350":"Figure 5. Authentication Options","1351":"When choosing traditional authentication, the {0/} server is the main authentication point, using {9/} under the covers.","1352":"When selecting this option, users then need to further define their preferred authentication mechanism by selecting the desired authentication backing store, which can be one of the following options:","1353":"Single User Authentication","1354":"LDAP Authentication","1355":"File-based authentication","1356":"When choosing between traditional authentication or OAuth2, keep in mind that both options are mutually exclusive.","1357":"Please refer to the sections below for a more detailed discussion.","1358":"By default, the REST endpoints (administration, management, and health) as well as the Dashboard UI do not require authenticated access.","1360":"Enabling HTTPS","1361":"By default, the dashboard, management, and health endpoints use HTTP as a transport.","1362":"You can switch to HTTPS by adding a certificate to your configuration in {221/}, as shown in the following example:","1363":"As the default port is {222/}, you may choose to change the port to a more common HTTPs-typical port.","1364":"The alias (or name) under which the key is stored in the keystore.","1365":"The path to the keystore file.","1366":"Classpath resources may also be specified, by using the classpath prefix - for example: {223/}.","1367":"The password of the keystore.","1368":"The password of the key.","1369":"The path to the truststore file.","1370":"Classpath resources may also be specified, by using the classpath prefix - for example: {224/}","1371":"The password of the trust store.","1372":"If HTTPS is enabled, it completely replaces HTTP as the protocol over which the REST endpoints and the Data Flow Dashboard interact.","1373":"Plain HTTP requests will fail.","1374":"Therefore, make sure that you configure your Shell accordingly.","1376":"Using Self-Signed Certificates","1377":"For testing purposes or during development, it might be convenient to create self-signed certificates.","1378":"To get started, execute the following command to create a certificate:","1379":"{225/} is the important parameter here.","1380":"It should match the domain you are trying to access - for example, {226/}.","1381":"Then add the following lines to your {227/} file:","1382":"This is all that is needed for the Data Flow Server.","1383":"Once you start the server, you should be able to access it at {228/}.","1384":"As this is a self-signed certificate, you should hit a warning in your browser, which you need to ignore.","1386":"Self-Signed Certificates and the Shell","1387":"By default, self-signed certificates are an issue for the shell, and additional steps are necessary to make the shell work with self-signed certificates.","1388":"Two options are available:","1389":"Add the self-signed certificate to the JVM truststore.","1390":"Skip certificate validation.","1391":"Adding the Self-signed Certificate to the JVM Truststore","1392":"In order to use the JVM truststore option, we need to\nexport the previously created certificate from the keystore, as follows:","1393":"Next, we need to create a truststore which the shell can use, as follows:","1394":"Now, you are ready to launch the Data Flow Shell by using the following JVM arguments:","1395":"In case you run into trouble establishing a connection over SSL, you can enable additional\nlogging by using and setting the {229/} JVM argument to {230/}.","1396":"Do not forget to target the Data Flow Server with the following:","1397":"Skipping Certificate Validation","1398":"Alternatively, you can also bypass the certification validation by providing the\noptional command-line parameter {231/}.","1399":"If you set this command-line parameter, the shell accepts any (self-signed) SSL\ncertificate.","1400":"If possible, you should avoid using this option.","1401":"Disabling the trust manager defeats the purpose of SSL and makes you vulnerable to man-in-the-middle attacks.","1403":"Traditional Authentication","1404":"When using traditional authentication, {0/} is the sole authentication provider.","1405":"In that case, Data Flow REST API users would use Basic Authentication to access the endpoints.","1406":"When using that option, users have a choice of three backing stores for authentication\ndetails:","1407":"Single User Authentication by setting {16/} properties","1408":"File-based Authentication for multiple users by using a Yaml file","1409":"Ldap Authentication","1411":"Single User Authentication","1412":"This is the simplest option and mimics the behavior of the default {16/} user experience.","1413":"It can be enabled by setting environment variables or by adding the following to {232/}:","1414":"Enables basic authentication.","1415":"Must be set to true for security to be enabled.","1416":"(Optional) The realm for Basic authentication.","1417":"Defaults to {233/} if not explicitly set.","1418":"Current versions of Chrome do not display the realm.","1419":"Please see the following Chromium issue ticket for more information.","1420":"In this use case, the underlying {16/} auto-creates a user called {234/}\nwith an auto-generated password which is printed out to the console upon startup.","1421":"With this setup, the generated user has all main roles assigned, as follows:","1422":"VIEW","1423":"CREATE","1424":"MANAGE","1425":"The following image shows the default {16/} user credentials as they appear in the console.","1426":"Figure 6. Default {16/} user credentials","1427":"You can customize the user by setting the following properties:","1428":"\nPlease be aware of inherent issues of Basic Authentication and logging out: The credentials are cached by the browser and simply browsing back to application pages logs you back in.\n","1429":"Of course, you can also pass in credentials by setting system properties, environment variables, or command-line arguments, as this is standard {16/} behavior.","1430":"For instance, in the following example, command-line arguments are used to specify the user credentials:","1431":"If you need to define more than one file-based user account, please take a look\nat File-based authentication.","1433":"File-based Authentication","1434":"By default, {16/} lets you specify only one single user.","1435":"{14/} Data Flow also supports the listing of more than one user in a configuration file.","1436":"Each user must be assigned a password and one or more roles.","1437":"The following example shows the creation of additional users:","1438":"Enables file based authentication.","1439":"This is a yaml map of username to password.","1440":"Each map {235/} is made of a corresponding password and role(s), comma separated.","1442":"LDAP Authentication","1443":"{0/} also supports authentication against an LDAP (Lightweight Directory Access Protocol) server, providing support for the following modes:","1444":"Direct bind","1445":"Search and bind","1446":"When the LDAP authentication option is activated, the default single user mode is\nturned off.","1447":"In direct bind mode, a pattern is defined for the user's distinguished name (DN), using a placeholder for the username.","1448":"The authentication process derives the distinguished name of the user by replacing the placeholder and using it to authenticate a user against the LDAP server, along with the supplied password.","1449":"You can set up LDAP direct bind as follows:","1450":"Enables LDAP authentication","1451":"The URL for the LDAP server","1452":"The distinguished name (DN) pattern for authenticating against the server","1453":"The search and bind mode involves connecting to an LDAP server, either anonymously or with a fixed account, searching for the distinguished name of the authenticating user based on its username, and then using the resulting value and the supplied password for binding to the LDAP server.","1454":"This option is configured as follows:","1455":"Enables LDAP integration","1456":"The URL of the LDAP server","1457":"A DN to authenticate to the LDAP server, if anonymous searches are not supported (optional, required together with next option)","1458":"A password to authenticate to the LDAP server, if anonymous searches are not supported (optional, required together with previous option)","1459":"The base for searching the DN of the authenticating user (serves to restrict the scope of the search)","1460":"The search filter for the DN of the authenticating user","1461":"\nFor more information, please also see the\nLDAP Authentication\nchapter of the {9/} reference guide.\n","1462":"LDAP Role Mapping","1463":"By default, the role name retrieved from Ldap needs to match the name of the role in {0/}.","1464":"However, it is also possible to explicitly provide a mapping between LDAP roles and {0/} roles.","1465":"Enables explicit role mapping support","1466":"When role mapping support is enabled, you must provide a mapping for\nall 3 {0/} roles ROLE_MANAGE, ROLE_VIEW, ROLE_CREATE.","1467":"LDAP Transport Security","1468":"When connecting to an LDAP server, you typically (in the LDAP world) have two options\nto establish a connection to an LDAP server securely:","1469":"LDAP over SSL (LDAPs)","1470":"Start Transport Layer Security (Start TLS is defined in RFC2830)","1471":"As of {0/} 1.1.0, only LDAPs is supported out-of-the-box.","1472":"When using official certificates, no special configuration is necessary to connect to an LDAP Server over LDAPs.","1473":"You need only change the url format to ldaps - for example: {236/}.","1474":"In the case of self-signed certificates, the setup for your {0/} server becomes slightly more complex.","1475":"The setup is very similar to Using Self-Signed Certificates (please read first), and {0/} needs to reference a trustStore in order to work with your self-signed certificates.","1476":"\nWhile useful during development and testing, never use\nself-signed certificates in production!\n","1477":"Ultimately, you have to provide a set of system properties to reference\nthe trustStore and its credentials when starting the server, as follows:","1478":"As mentioned earlier, another option to connect to an LDAP server securely is over Start TLS.","1479":"In the LDAP world, LDAPs is technically even considered deprecated in favor of Start TLS.","1480":"However, this option is currently not supported out-of-the-box by {0/}.","1481":"Please follow the following issue tracker ticket to track its implementation.","1482":"You may also want to look at the {27/} LDAP reference documentation chapter on Custom DirContext Authentication Processing for further details.","1484":"Shell Authentication","1485":"When using traditional authentication with the Data Flow Shell, you typically provide\na username and password by using command-line arguments, as shown in the following example:","1486":"If authentication is enabled, the username must be provided.","1487":"If the password is not provided, the shell prompts for it.","1488":"Alternatively, you can target a Data Flow Server also from within the shell, as follows:","1489":"Optional, defaults to localhost:9393.","1490":"Mandatory if security is enabled.","1491":"If security is enabled, and the password is not provided, the user is prompted for it.","1492":"Optional, ignores certificate errors (when using self-signed certificates).","1493":"Use cautiously!","1494":"The following image shows a typical shell command to connect to and authenticate a Data\nFlow Server:","1495":"Figure 7. Target and Authenticate with the Data Flow Server from within the Shell","1497":"Customizing Authorization","1498":"The preceding content deals with authentication - that is, how to assess the identity of the user.","1499":"Irrespective of the option chosen, you can also customize authorization - that is, who can do what.","1500":"The default scheme uses three roles to protect the REST endpoints\nthat {0/} exposes:","1501":"ROLE_VIEW for anything that relates to retrieving state","1502":"ROLE_CREATE for anything that involves creating, deleting, or mutating the state of the system","1503":"ROLE_MANAGE for boot management endpoints","1504":"All of those defaults are specified in {237/}, which is part of the {0/} Core Module.","1505":"Nonetheless, you can override those, if desired - for example, in {238/}.","1506":"The configuration takes the form of a YAML list (as some rules may have precedence over others).","1507":"Consequently, you need to copy and paste the whole list and tailor it to your needs (as there is no way to merge lists).","1508":"\nAlways refer to your version of {239/}, as the following snippet may be outdated.\n","1509":"The default rules are as follows:","1510":"The format of each line is the following:","1511":"where","1512":"HTTP_METHOD is one http method, capital case","1513":"URL_PATTERN is an Ant style URL pattern","1514":"SECURITY_ATTRIBUTE is a {32/} expression.","1515":"See Expression-Based Access Control .","1516":"Each of those separated by one or several blank characters (spaces, tabs, and so on)","1517":"Be mindful that the above is indeed a YAML list, not a map (thus the use of '-' dashes at the start of each line) that lives under the {240/} key.","1518":"In case you are solely interested in authentication but not authorization\n(for instance every user shall have have access to all endpoints), then you can also\nset {241/}.","1519":"If you use basic security configuration by setting security properties, then it is important to set the roles for the users,\nas shown in the following example:","1521":"Authorization - Shell and Dashboard Behavior","1522":"When authorization is enabled, the dashboard and the shell are role-aware,\nmeaning that, depending on the assigned roles, not all functionality may be visible.","1523":"For instance, shell commands for which the user does not have the necessary roles\nare marked as unavailable.","1524":"Currently, the shell's {242/} command lists commands that are unavailable.","1525":"Please track the following issue: github.com/spring-projects/spring-shell/issues/115","1526":"Similarly, for the dashboard, the UI does not show pages or page elements for\nwhich the user is not authorized.","1528":"Authorization with LDAP","1529":"When configuring LDAP for authentication, you can also specify the {243/}\nin conjunction with {244/} and {245/}.","1530":"The group role attribute contains the name of the role.","1531":"If not specified, the {246/} role is populated by default.","1532":"For further information, please refer to Configuring an LDAP Server in the {9/} reference guide.","1534":"OAuth 2.0","1535":"OAuth 2.0 lets you integrate {14/} Data Flow into Single Sign On (SSO) environments.","1536":"The following OAuth2 Grant Types are used:","1537":"Authorization Code : Used for the GUI (browser) integration.","1538":"Visitors are redirected to your OAuth Service for authentication","1539":"Password: Used by the shell (and the REST integration), so visitors can log in with username and password","1540":"Client Credentials: Retrieve an access token directly from your OAuth provider and pass it to the Data Flow server by using the Authorization HTTP header","1541":"The REST endpoints can be accessed in two ways:","1542":"Basic authentication, which uses the Password Grant Type under the covers to authenticate with your OAuth2 service","1543":"Access token, which uses the Client Credentials Grant Type under the covers","1544":"\nWhen authentication is set up, it is strongly recommended to enable HTTPS\nas well, especially in production environments.\n","1545":"You can turn on OAuth2 authentication by adding the following to {247/} or by setting\nenvironment variables:","1546":"Providing the Client ID in the OAuth Configuration Section activates OAuth2 security","1547":"You can verify that basic authentication is working properly by using curl, as follows:","1548":"As a result, you should see a list of available REST endpoints.","1549":"Please be aware that when accessing the Root URL with a {33/} browser and enabled security, you are redirected to the Dashboard UI.","1550":"In order to see the list of REST endpoints, specify the {248/}.","1551":"Also be sure to add the Accept header using tools such as Postman (Chrome) or RESTClient (Firefox).","1552":"Besides Basic Authentication, you can also provide an Access Token in order to access the REST Api.","1553":"In order to make that happen, you would retrieve an OAuth2 Access Token from your OAuth2 provider first and then pass that Access Token to the REST Api using the Authorization Http header:","1555":"OAuth REST Endpoint Authorization","1556":"The OAuth2 authentication option uses the same authorization rules as used by the\nTraditional Authentication option.","1557":"The authorization rules are defined in {249/} (part of the {0/} Core module).","1558":"Please see the chapter on customizing authorization for more details.","1559":"Because the determination of security roles is environment-specific,\n{0/}, by default, assigns all roles to authenticated OAuth2\nusers by using the {250/} class.","1560":"You can customize that behavior by providing your own {27/} bean definition that extends {9/} OAuth's {251/} interface.","1561":"In that case, the custom bean definition takes precedence over the default one provided by {0/}.","1563":"OAuth Authentication using the {0/} Shell","1564":"When using the Shell, the credentials can either be provided via username and password\nor by specifying a credentials-provider command.","1565":"If your OAuth2 provider supports the Password Grant Type you can start the\nData Flow Shell with:","1566":"\nKeep in mind that when authentication for {0/} is enabled,\nthe underlying OAuth2 provider must support the Password OAuth2 Grant Type\nif you want to use the Shell via username/password authentication.\n","1567":"From within the Data Flow Shell you can also provide credentials by using the following command:","1568":"Once successfully targeted, you should see the following output:","1569":"Alternatively, you can specify the credentials-provider command in order to pass-in a bearer token directly, instead of providing a username and password.","1570":"This works from within the shell or by providing the {252/} command-line argument when starting the Shell.","1571":"When using the credentials-provider command, please be aware that your specified command must return a Bearer token (Access Token prefixed with Bearer ).","1572":"For instance, in Unix environments the following simplistic command can be used:","1574":"OAuth2 Authentication Examples","1575":"This section offers the following authentication examples:","1576":"Local OAuth2 Server","1577":"Authentication with GitHub","1578":"Local OAuth2 Server","1579":"With {9/} OAuth, you\ncan easily create your own OAuth2 Server with the following simple annotations:","1580":"A working example application can be found at:","1581":"https://github.com/ghillert/oauth-test-server/","1582":"Clone the project and configure {14/} Data Flow with the respective Client ID and Client Secret.","1583":"Then build and start the project.","1584":"Authentication with GitHub","1585":"If you like to use an existing OAuth2 provider, here is an example for GitHub.","1586":"First, you need to register a new application under your GitHub account at:","1587":"https://github.com/settings/developers","1588":"When running a default version of {0/} locally, your GitHub configuration\nshould look like the following image:","1589":"Figure 8. Register an OAuth Application for GitHub","1590":"\nFor the authorization callback URL, enter {0/}’s Login URL - for example, {253/}.\n","1591":"Configure {0/} with the GitHub relevant Client ID and Secret, as follows:","1592":"GitHub does not support the OAuth2 password grant type.","1593":"As a result, you cannot use the {0/} Shell in conjunction with GitHub.","1595":"Securing the {16/} Management Endpoints","1596":"When enabling security, please also make sure that the {16/} HTTP Management Endpoints are secured as well.","1597":"You can enable security for the management endpoints by adding the following to {254/}:","1598":"\nIf you do not explicitly enable security for the management endpoints,\nyou may end up having unsecured REST endpoints, despite {255/}\nbeing set to {256/}.\n","1599":"25. Monitoring and Management","1600":"The {0/} server is a {16/} 1.5 application that includes the Actuator\nlibrary, which adds several production ready features to help you monitor and manage your application.","1601":"The Actuator library adds HTTP endpoints under the context path {257/} which is a discovery page for available managerment endpoints.","1602":"For example, there is a {258/} endpoint that shows application health information and an {259/} that lists properties from {27/}'s {260/}.","1603":"By default, only the health and application info endpoints are accessible.","1604":"The other endpoints are considered to be sensitive and need to be enabled explicitly via configuration .","1605":"If you enable sensitive endpoints, you should also secure the Data Flow server's endpoints so that information is not inadvertently exposed to unauthenticated users.","1606":"The local Data Flow server has security disabled by default, so all actuator endpoints are available.","1607":"The Data Flow server requires a relational database, and, if the feature toggle for analytics is enabled, a Redis server is also required.","1608":"The Data Flow server autoconfigures the DataSourceHealthIndicator and RedisHealthIndicator if needed.","1609":"The health of these two services is incorporated to the overall health status of the server through the {261/} endpoint.","1611":"Monitoring Deployed Stream Applications","1612":"The stream applications deployed by {0/} can be based on {16/} 1.5 or {16/} 2.0.","1613":"Both versions contains several features for monitoring your application in production.","1614":"However, {16/} 1.x and 2.x as well as {3/} 1.x and 2.x differ in how monitoring is implemented.","1615":"Since {0/} supports deploying 1.x and 2.x applications, we will cover both cases individually.","1616":"What is common across 1.x and 2.x applications is that {3/} apps can be configured to publish metrics to a messaging middleware destination.","1617":"The {0/} Metrics Collector subscribes to this destination and aggregates metrics into a stream based view.","1618":"The Metrics Collector 2.0 server supports collecting metrics from streams that contain only Boot 1.x or 2.x apps as well as streams that contain a mixture of Boot versions.","1619":"The Data Flow UI queries the Metrics collector over HTTP to display messages rates next to each deployed application.","1620":"The following image shows the architecture when using {3/}’s metrics publisher, the Metrics Collector, and the Data Flow server:","1621":"Figure 9. {0/} Metrics Architecture","1623":"Using the Metrics Collector","1624":"There are two versions of the Metrics Collector, a 1.0 version based on {16/} 1.0 that understands how to aggregate metrics from {16/} 1.x applications and a 2.0 version based on {16/} 2.0 that understands how to aggregate metrics from {16/} 1.x and 2.x.","1625":"There is a Metrics Collector server for {30/} and {31/}.","1626":"You can find more information on downloading and running the Metrics Collector on its project page .","1627":"The Data Flow server property: {262/} references the URI the Metrics Collector.","1628":"For example, if you run the Metrics Collector locally on port {263/}, this is how you start local Data Flow server to reference the Metrics Collector.","1629":"The Metrics Collector can be secured with 'basic' authentication that requires a username and password.","1630":"To set the username and password, use the properties {264/} and {265/} when starting the Data Flow server.","1631":"The metrics for each application are published when the property {266/} is set.","1632":"Using a destination name of {267/} is a good choice as the Metrics Collector subscribes to that name by default.","1633":"Since it is quite common to want all stream applications deployed by Data Flow to emit metrics, setting the property:","1634":"on the Data Flow server will let you configure support for metrics publication in one central location.","1635":"Using a destination name of {268/} is a good choice as the Metrics Collector subscribes to that name by default, which of course, can be overridden to be different than the default as needed.","1636":"The next most common way to configure the metrics destination is to use deployment properties.","1637":"The following example shows the {269/} stream that uses the App Starters {270/} and {271/} applications:","1638":"The Metrics Collector exposes aggregated metrics under the HTTP endpoint {272/} in JSON format.","1639":"The Data Flow server accesses this endpoint in two distinct ways.","1640":"The first is by exposing a {273/} HTTP endpoint that acts as a proxy to the Metrics Collector endpoint.","1641":"This is accessed by the UI when overlaying message rates on SCDF's Flo and it's visual representation of streaming pipelines.","1642":"It is also accessed to enrich the Data Flow {274/} endpoint that is exposed in the UI in the {275/} tab and in the shell through the {276/} command with message rates.","1643":"The following image shows the message rates as they appear in the Streams tab of the UI:","1644":"Figure 10. Stream Message Rates","1645":"When deploying applications, Data Flow sets the {277/} property, as shown\nin the following example:","1646":"The values of these keys are used as the tags to perform aggregation.","1647":"In the case of 2.x applications, these key-values map directly onto tags in the Micrometer library .","1648":"The property {278/} can be used to track back to the specific application instance that generated the metric.","1649":"The {279/} value is platform-dependent.","1650":"Data Flow also sets the application property that controls which metric values are exported.","1651":"For 1.x applications, the property is {280/} and the default value is is shown below:","1652":"For 2.x applications, the property is {281/} and it does not have a default value, so all metrics are exported.","1653":"Note that the Data Flow UI only displays instantaneous input and output channel message rates.","1654":"Data Flow does not provide its own implementation to store and visualize historical metrics data, instead we integrate with existing monitoring systems.","1655":"For Boot 1.x, there is support for sending metrics to the application log and Datadog .","1656":"For Boot 2.x, metrics is backed by the Micrometer library that provides a wide range of monitoring systems .","1658":"{16/} 2.x","1659":"We have developed a sample application that show how to modify the {282/} and {283/} applications and export metrics to InfluxDB using the micrometer library.","1660":"A Grafana front end is also provided.","1661":"This is a WIP, so check the {0/} Samples {19/} for the latest status.","1663":"{16/} 1.x","1664":"Each deployed application contains {33/} endpoints for monitoring and interacting with Stream and Task applications.","1665":"In particular, the {284/} endpoint contains counters and gauges for HTTP requests, System Metrics such as JVM stats, DataSource Metrics, and Message Channel Metrics.","1666":"{16/} lets you add your own metrics to the {285/} endpoint either by registering an implementation of the {286/} interface or through its integration with Dropwizard .","1667":"The {16/} interfaces, {287/} and {288/}, are used to send the metrics data to a place where they can be displayed and analyzed.","1668":"There are implementations in {16/} to export metrics to Redis, Open TSDB, Statsd, and JMX.","1669":"A few additional {27/} projects provide support for sending metrics data to external systems:","1670":"{0/} Metrics provides {289/} that writes to the log.","1671":"{0/} Metrics Datadog Metrics provides {290/} that writes to Datadog.","1672":"To make use of this functionality, you need to build the Stream application with the additional pom dependency of the MetricWriter implementation you want to use.","1673":"To customize the “out of the box” Stream applications, use the {3/} Initializr to generate a project and then modify the pom.","1674":"The documentation on the Data Flow Metrics project pages provides the additional information you need to get started.","1675":"26. About Configuration","1676":"The {0/} About Restful API result contains a display name, version, and, if specified, a URL for each of the major dependencies that comprise {0/}.","1677":"The result (if enabled) also contains the sha1 and or sha256 checksum values for the shell dependency.","1678":"The information that is returned for each of the dependencies is configurable by setting the following properties:","1679":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-core.name: the\nname to be used for the core.","1680":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-core.version:\nthe version to be used for the core.","1681":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-dashboard.name: the\nname to be used for the dashboard.","1682":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-dashboard.version:\nthe version to be used for the dashboard.","1683":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-implementation.name: the\nname to be used for the implementation.","1684":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-implementation.version:\nthe version to be used for the implementation.","1685":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.name: the\nname to be used for the shell.","1686":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.version:\nthe version to be used for the shell.","1687":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.url:\nthe URL to be used for downloading the shell dependency.","1688":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.checksum-sha1: the sha1\nchecksum value that is returned with the shell dependency info.","1689":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.checksum-sha256:\nthe sha256 checksum value that is returned with the shell dependency info.","1690":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.checksum-sha1-url:\nif the {291/}\nis not specified, SCDF uses the contents of the file specified at this URL for the checksum.","1691":"spring.cloud.dataflow.version-info.spring-cloud-dataflow-shell.checksum-sha256-url:\nif the {292/}\nis not specified, SCDF uses the contents of the file specified at this URL for the checksum.","1693":"Enabling Shell Checksum values","1694":"By default, checksum values are not displayed for the shell dependency.","1695":"If you need this feature enabled, set the {293/} property to true.","1697":"Reserved Values for URLs","1698":"There are reserved values (surrounded by curly braces) that you can insert into\nthe URL that will make sure that the links are up to date:","1699":"repository: if using a build-snapshot, milestone, or release candidate of Data Flow, the repository refers to the repo-spring-io repository.","1700":"Otherwise, it refers to Maven Central.","1701":"version: Inserts the version of the jar/pom.","1702":"For example,\n{294/}\nproduces\n{295/}\nif you were using the 1.2.3.RELEASE version of the {0/} Shell","1703":"Shell","1704":"This section covers the options for starting the shell and more advanced functionality relating to how the shell handles white spaces, quotes, and interpretation of {32/} expressions.","1705":"The introductory chapters to the Stream DSL and Composed Task DSL are good places to start for the most common usage of shell commands.","1706":"27. Shell Options","1707":"The shell is built upon the {27/} Shell project.","1708":"There are command line options generic to {27/} Shell and some specific to Data Flow.","1709":"The shell takes the following command line options","1710":"The {296/} option can be used to point to an existing file that contains all the shell commands to deploy one or many related streams and tasks.","1711":"Multiple files execution is also supported, they should be passed as comma delimited string :","1712":"This is useful when creating some scripts to help automate deployment.","1713":"Also, the following shell command helps to modularize a complex script into multiple independent files:","1714":"28. Listing Available Commands","1715":"Typing {297/} at the command prompt gives a listing of all available commands.","1716":"Most of the commands are for Data Flow functionality, but a few are general purpose.","1717":"Adding the name of the command to {298/} shows additional information on how to invoke the command.","1718":"29. Tab Completion","1719":"The shell command options can be completed in the shell by pressing the {299/} key after the leading {300/}.","1720":"For example, pressing {301/} after {302/} results in","1721":"If you type {303/} and then hit tab, {304/} will be expanded.","1722":"Tab completion is also available inside the stream or composed task DSL expression for application or task properties.","1723":"You can also use {305/} to get hints in a stream DSL expression for what available sources, processors, or sinks can be used.","1724":"30. White Space and Quoting Rules","1725":"It is only necessary to quote parameter values if they contain spaces or the {306/} character.","1726":"The following example passes a {32/} expression (which is applied to any data it encounters) to a transform processor:","1727":"If the parameter value needs to embed a single quote, use two single quotes, as follows:","1729":"Quotes and Escaping","1730":"There is a {27/} Shell-based client that talks to the Data Flow Server and is responsible for parsing the DSL.","1731":"In turn, applications may have applications properties that rely on embedded languages, such as the {27/} Expression Language .","1732":"The shell, Data Flow DSL parser, and {32/} have rules about how they handle quotes and how syntax escaping works.","1733":"When combined together, confusion may arise.","1734":"This section explains the rules that apply and provides examples of the most complicated situations you may encounter when all three components are involved.","1735":"It’s not always that complicated","1736":"If you do not use the Data Flow shell (for example, you use the REST API directly) or if application properties are not {32/} expressions, then the escaping rules are simpler.","1738":"Shell rules","1739":"Arguably, the most complex component when it comes to quotes is the shell.","1740":"The rules can be laid out quite simply, though:","1741":"A shell command is made of keys ({307/}) and corresponding values.","1742":"There is a special, keyless mapping, though, which is described later.","1743":"A value cannot normally contain spaces, as space is the default delimiter for commands.","1744":"Spaces can be added though, by surrounding the value with quotes (either single ({308/}) or double ({309/}) quotes).","1745":"Values passed inside deployment properties (e.g. {310/}) should not be quoted again.","1746":"If surrounded with quotes, a value can embed a literal quote of the same kind by prefixing it with a backslash ({311/}).","1747":"Other escapes are available, such as {312/}, {313/}, {314/}, {315/} and unicode escapes of the form {316/}.","1748":"The keyless mapping is handled in a special way such that it does not need quoting to contain spaces.","1749":"For example, the shell supports the {317/} command to execute native shell commands.","1750":"The {318/} accepts a single keyless argument.","1751":"This is why the following works:","1752":"The argument here is the whole {319/} string, which is passed as is to the underlying shell.","1753":"As another example, the following commands are strictly equivalent, and the argument value is {320/} (without the quotes):","1755":"Property files rules","1756":"Rules are relaxed when loading the properties from files.","1757":"* The special characters used in property files (both Java and YAML) needs to be escaped.","1758":"For example {321/} should be replaced by {322/}, '\\t` by {323/} and so forth.","1759":"* For Java property files ({324/} <FILE_PATH>.properties) the property values should not be surrounded by quotes!","1760":"It is not needed even if they contain spaces.","1761":"For YAML property files ({325/} <FILE_PATH>.yaml), though, the values need to be surrounded by double quotes.","1763":"DSL Parsing Rules","1764":"At the parser level (that is, inside the body of a stream or task definition) the rules are as follows:","1765":"Option values are normally parsed until the first space character.","1766":"They can be made of literal strings, though, surrounded by single or double quotes.","1767":"To embed such a quote, use two consecutive quotes of the desired kind.","1768":"As such, the values of the {326/} option to the filter application are semantically equivalent in the following examples:","1769":"Arguably, the last one is more readable.","1770":"It is made possible thanks to the surrounding quotes.","1771":"The actual expression is {327/} (without quotes).","1772":"Now, imagine that we want to test against string messages.","1773":"If we want to compare the payload to the {32/} literal string, {328/}, we could use the following:","1774":"This works because there are no spaces.","1775":"It is not very legible, though.","1776":"This uses single quotes to protect the whole argument.","1777":"Hence, the actual single quotes need to be doubled.","1778":"{32/} recognizes String literals with either single or double quotes, so this last method is arguably the most readable.","1779":"Please note that the preceding examples are to be considered outside of the shell (for example, when calling the REST API directly).","1780":"When entered inside the shell, chances are that the whole stream definition is itself inside double quotes, which would need to be escaped.","1781":"The whole example then becomes the following:","1783":"{32/} Syntax and {32/} Literals","1784":"The last piece of the puzzle is about {32/} expressions.","1785":"Many applications accept options that are to be interpreted as {32/} expressions, and, as seen above, String literals are handled in a special way there, too.","1786":"The rules are as follows:","1787":"Literals can be enclosed in either single or double quotes.","1788":"Quotes need to be doubled to embed a literal quote.","1789":"Single quotes inside double quotes need no special treatment, and the reverse is also true.","1790":"As a last example, assume you want to use the transform processor .","1791":"This processor accepts an {329/} option which is a {32/} expression.","1792":"It is to be evaluated against the incoming message, with a default of {330/} (which forwards the message payload untouched).","1793":"It is important to understand that the following statements are equivalent:","1794":"However, they are different from the following (and variations upon them):","1795":"The first series evaluates to the message payload, while the latter examples evaluate to the literal string, {331/}, (again, without quotes).","1797":"Putting It All Together","1798":"As a last, complete example, consider how one could force the transformation of all messages to the string literal, {332/}, by creating a stream in the context of the Data Flow shell:","1799":"In the first line, there are single quotes around the string (at the Data Flow parser level), but they need to be doubled because they are inside a string literal (started by the first single quote after the equals sign).","1800":"The second and third lines, use single and double quotes respectively to encompass the whole string at the Data Flow parser level.","1801":"Consequently, the other kind of quote can be used inside the string.","1802":"The whole thing is inside the {333/} argument to the shell, though, which uses double quotes.","1803":"Consequently, double quotes are escaped (at the shell level)","1804":"Streams","1805":"This section goes into more detail about how you can create Streams, which are collections of {3/} applications.","1806":"It covers topics such as creating and deploying Streams.","1807":"If you are just starting out with {0/}, you should probably read the\nGetting Started guide before diving into\nthis section.","1808":"31. Introduction","1809":"A Stream is are a collection of long-lived {3/} applications that communicate with each other over messaging middleware.","1810":"A text-based DSL defines the configuration and data flow between the applications.","1811":"While many applications are provided for you to implement common use-cases, you typically create a custom {3/} application to implement custom business logic.","1812":"The general lifecycle of a Stream is:","1813":"Register applications.","1814":"Create a Stream Definition.","1815":"Deploy the Stream.","1816":"Undeploy or Destroy the Stream.","1817":"Upgrade or Rollack applications in the Stream.","1818":"If you use Skipper, you can upgrade or rollback applications in the Stream.","1819":"There are two options for deploying streams:","1820":"Use a Data Flow Server implementation that deploys to a single platform.","1821":"Configure the Data Flow Server to delegate the deployment to a new server in the {14/} ecosystem named Skipper.","1822":"When using the first option, you can use the Local Data Flow Server to deploy streams to your local machine, the Data Flow Server for {11/} to deploy streams to a single org and space on {11/}.","1823":"Similarly, you can use Data Flow Server for Kuberenetes to deploy a stream to a single namespace on a Kubernetes cluster.","1824":"See the {0/} project page for a list of Data Flow server implementations.","1825":"When using the second option, you can configure Skipper to deploy applications to one or more {11/} orgs and spaces, one or more namespaces on a Kubernetes cluster, or to the local machine.","1826":"When deploying a stream in Data Flow using Skipper, you can specify which platform to use at deployment time.","1827":"Skipper also provides Data Flow with the ability to perform updates to deployed streams.","1828":"There are many ways the applications in a stream can be updated, but one of the most common examples is to upgrade a processor application with new custom business logic while leaving the existing source and sink applications alone.","1830":"Stream Pipeline DSL","1831":"A stream is defined by using a unix-inspired Pipeline syntax .","1832":"The syntax uses vertical bars, also known as “pipes” to connect multiple commands.","1833":"The command {334/} in Unix takes the output of the {335/} process and pipes it to the input of the {336/} process.","1834":"The output of {337/} in turn is sent to the input of the {338/} process.","1835":"Each {339/} symbol connects the standard output of the command on the left to the standard input of the command on the right.","1836":"Data flows through the pipeline from left to right.","1837":"In Data Flow, the Unix command is replaced by a {3/} application and each pipe symbol represents connecting the input and output of applications over messaging middleware, such as {21/} or {12/}.","1838":"Each {3/} application is registered under a simple name.","1839":"The registration process specifies where the application can be obtained (for example, in a Maven {19/} or a Docker registry).","1840":"You can find out more information on how to register {3/} applications in this section .","1841":"In Data Flow, we classify the {3/} applications as Sources, Processors, or Sinks.","1842":"As a simple example, consider the collection of data from an HTTP Source writing to a File Sink.","1843":"Using the DSL, the stream description is:","1844":"A stream that involves some processing would be expressed as:","1845":"Stream definitions can be created by using the shell’s {340/} command, as shown in the following example:","1846":"The Stream DSL is passed in to the {341/} command option.","1847":"The deployment of stream definitions is done through the shell’s {342/} command.","1848":"The Getting Started section shows you how to start the server and how to start and use the {0/} shell.","1849":"Note that the shell calls the Data Flow Servers' REST API.","1850":"For more information on making HTTP requests directly to the server, consult the REST API Guide .","1852":"Stream Application DSL","1853":"The Stream Pipeline DSL described in the previous section automatically sets the input and output binding properties of each {3/} application.","1854":"This can be done because there is only one input and/or output destination in a {3/} application that uses the provided binding interface of a {343/}, {344/}, or {345/}.","1855":"However, a {3/} application can define a custom binding interface such as the one shown below","1856":"or as is common when creating a {31/} Streams application,","1857":"In these cases with multiple input and output bindings, Data Flow cannot make any assumptions about the flow of data from one application to another.","1858":"Therefore the developer needs to set the binding properties to 'wire up' the application.","1859":"The Stream Application DSL uses a {346/}, instead of the {347/}, to indicate that Data Flow should not configure the binding properties of the application.","1860":"Think of {348/} as meaning 'in parallel'.","1861":"For example:","1862":"Breaking Change!","1863":"Versions of SCDF Local, {11/} 1.7.0 to 1.7.2 and SCDF Kubernetes 1.7.0 to 1.7.1 used the {349/} character as the separator between applications.","1864":"This caused breaking changes in the traditional Stream DSL.","1865":"While not ideal, changing the separator character was felt to be the best solution with the least impact on existing users.","1866":"There are four applications in this stream.","1867":"The baristaApp has two output destinations, {350/} and {351/} intended to be consumed by the {352/} and {353/} respectively.","1868":"When deploying this stream, you need to set the binding properties so that the {354/} sends hot drink messages to the {355/} destination and cold drink messages to the {356/} destination.","1869":"For example","1870":"If you want to use consumer groups, you will need to set the {3/} application property {357/} and {358/} on the producer and consumer applications respectively.","1871":"Another common use case for the Stream Application DSL is to deploy a http gateway application that sends a synchronous request/reply message to a {31/} or {21/} application.","1872":"In this case both the http gateway application and the {31/} or {21/} application can be a {6/} application that does not make use of the {3/} library.","1873":"It is also possible to deploy just a single application using the Stream application DSL.","1875":"Application properties","1876":"Each application takes properties to customize its behavior.","1877":"As an example, the {359/} source module exposes a {360/} setting that allows the data ingestion port to be changed from the default value.","1878":"This {361/} property is actually the same as the standard {16/} {362/} property.","1879":"Data Flow adds the ability to use the shorthand form {363/} instead of {364/}.","1880":"One may also specify the longhand version as well, as shown in the following example:","1881":"This shorthand behavior is discussed more in the section on Whitelisting application properties .","1882":"If you have registered application property metadata you can use tab completion in the shell after typing {365/} to get a list of candidate property names.","1883":"The shell provides tab completion for application properties.","1884":"The shell command {366/} provides additional documentation for all the supported properties.","1885":"\nSupported Stream {367/} possibilities are: source, processor, and sink.\n","1886":"32. Stream Lifecycle","1887":"The lifecycle of a stream, in \"classic\" mode, goes through the following stages:","1888":"Register a Stream App","1889":"Creating a Stream","1890":"Deploying a Stream","1891":"Destroying a Stream or Undeploying a Stream","1893":"Register a Stream App","1894":"You can register a Stream App with the App Registry by using the {0/} Shell {368/} command.","1895":"You must provide a unique name, an application type, and a URI that can be resolved to the app artifact.","1896":"For the type, specify {369/}, {370/}, {371/}, or {372/}.","1897":"Here are a few examples for {373/}, {374/} and {375/}:","1898":"When providing a URI with the {376/} scheme, the format should conform to the following:","1899":"For example, if you would like to register the snapshot versions of the {377/} and {378/}\napplications built with the {21/} binder, you could do the following:","1900":"If you would like to register multiple apps at one time, you can store them in a properties file\nwhere the keys are formatted as {379/} and the values are the URIs.","1901":"For example, if you would like to register the snapshot versions of the {380/} and {381/}\napplications built with the {21/} binder, you could have the following in a properties file (for example, {382/}):","1902":"Then to import the apps in bulk, use the {383/} command and provide the location of the properties file with the {384/} switch, as follows:","1903":"Registering an application using {385/} is the same as registering a {386/}, {387/} or {388/}.","1904":"Applications of the type {389/} are only allowed to be used in the Stream Application DSL, which uses a comma instead of the pipe symbol in the DSL, and instructs Data Flow not to configure the {3/} binding properties of the application.","1905":"The application that is registered using {390/} does not have to be a {3/} app, it can be any {16/} application.","1906":"See the Stream Application DSL introduction for more information on using this application type.","1908":"Register Supported Applications and Tasks","1909":"For convenience, we have the static files with application-URIs (for both maven and docker) available for all the out-of-the-box stream and task/batch app-starters.","1910":"You can point to this file and import all the application-URIs in bulk.","1911":"Otherwise, as explained previously, you can register them individually or have your own custom property file with only the required application-URIs in it.","1912":"It is recommended, however, to have a “focused” list of desired application-URIs in a custom property file.","1913":"The following table lists the bit.ly links to the available Stream Application Starters based on {16/} 1.5.x:","1914":"Artifact Type","1915":"Stable Release","1916":"SNAPSHOT Release","1917":"The following table lists the bit.ly links to the available Stream Application Starters based on {16/} 2.0.x:","1918":"App Starter actuator endpoints are secured by default.","1919":"You can disable security by deploying streams with the property {391/}.","1920":"On Kubernetes refer to the section Liveness and readiness probes to configure security for actuator endpoints.","1921":"Artifact Type","1922":"Stable Release","1923":"SNAPSHOT Release","1924":"The following table lists the available Task Application Starters:","1925":"Artifact Type","1926":"Stable Release","1927":"SNAPSHOT Release","1928":"You can find more information about the available task starters in the Task App Starters Project Page and related reference documentation.","1929":"For more information about the available stream starters, look at the Stream App Starters Project Page and related reference documentation.","1930":"As an example, if you would like to register all out-of-the-box stream applications built with the {31/} binder in bulk, you can use the following command:","1931":"Alternatively you can register all the stream applications with the {30/} binder, as follows:","1932":"You can also pass the {392/} option (which is {393/} by default) to indicate whether the properties file location should be resolved within the shell process itself.","1933":"If the location should be resolved from the Data Flow Server process, specify {394/}.","1934":"When using either {395/} or {396/}, if an app is already registered with the provided name and type, it is not overridden by default.","1935":"If you would like to override the pre-existing app coordinates, then include the {397/} option.","1936":"Note, however, that, once downloaded, applications may be cached locally on the Data Flow server, based on the resource location.","1937":"If the resource location does not change (even though the actual resource bytes may be different), then it is not re-downloaded.","1938":"When using {398/} resources on the other hand, using a constant location may still circumvent caching (if using {399/} versions).","1939":"Moreover, if a stream is already deployed and using some version of a registered app, then (forcibly) re-registering a\ndifferent app has no effect until the stream is deployed again.","1940":"In some cases, the Resource is resolved on the server side.","1941":"In others, the URI is passed to a runtime container instance where it is resolved.","1942":"Consult the specific documentation of each Data Flow Server for more detail.","1944":"Whitelisting application properties","1945":"Stream and Task applications are {16/} applications that are aware of many Common Application {18/} , such as {400/} but also families of properties such as those with the prefix {401/} and {402/}.","1946":"When creating your own application, you should whitelist properties so that the shell and the UI can display them first as primary properties when presenting options through TAB completion or in drop-down boxes.","1947":"To whitelist application properties, create a file named {403/} in the {404/} resource directory.","1948":"There are two property keys that can be used inside this file.","1949":"The first key is named {405/}.","1950":"The value is a comma separated list of fully qualified {406/} class names.","1951":"The second key is {407/}, whose value is a comma-separated list of property names.","1952":"This can contain the full name of the property, such as {408/}, or a partial name to whitelist a category of property names, such as {409/}.","1953":"The {3/} application starters are a good place to look for examples of usage.","1954":"The following example comes from the file sink's {410/} file:","1955":"If we also want to add {411/} to be white listed, it would become the following line:","1956":"Make sure to add 'spring-boot-configuration-processor' as an optional dependency to generate configuration metadata file for the properties.","1958":"Creating and Using a Dedicated Metadata Artifact","1959":"You can go a step further in the process of describing the main properties that your stream or task app supports by creating a metadata companion artifact.","1960":"This jar file contains only the {27/} boot JSON file about configuration properties metadata and the whitelisting file described in the previous section.","1961":"The following example shows the contents of such an artifact, for the canonical {412/} sink:","1962":"Note that the {413/} file is quite large.","1963":"This is because it contains the concatenation of all the properties that are available at runtime to the {414/} sink (some of them come from {415/}, some of them come from {416/}, some more from {417/}, and so on).","1964":"Data Flow always relies on all those properties, even when a companion artifact is not available, but here all have been merged into a single file.","1965":"To help with that (you do not want to try to craft this giant JSON file by hand), you can use the\nfollowing plugin in your build:","1966":"This plugin comes in addition to the {418/} that creates the individual JSON files.","1967":"Be sure to configure both.","1968":"The benefits of a companion artifact include:","1969":"Being much lighter.","1970":"(The companion artifact is usually a few kilobytes, as opposed to megabytes for the actual app.) Consequently, they are quicker to download, allowing quicker feedback when using, for example, {419/} or the Dashboard UI.","1971":"As a consequence of being lighter, they can be used in resource constrained environments (such as PaaS) when metadata is\nthe only piece of information needed.","1972":"For environments that do not deal with {16/} uber jars directly (for example, Docker-based runtimes such as\nKubernetes or {11/}), this is the only way to provide metadata about the properties supported by the app.","1973":"Remember, though, that this is entirely optional when dealing with uber jars.","1974":"The uber jar itself also includes the metadata in it already.","1976":"Using the Companion Artifact","1977":"Once you have a companion artifact at hand, you need to make the system aware of it so that it can be used.","1978":"When registering a single app with {420/}, you can use the optional {421/} option in the shell, as follows:","1979":"When registering several files by using the {422/} command, the file should contain a {423/} line in addition to each {424/} line.","1980":"Strictly speaking, doing so is optional (if some apps have it but some others do not, it works), but it is best practice.","1981":"The following example shows a Dockerized app, where the metadata artifact is being hosted in a Maven repository (retrieving\nit through {425/} or {426/} would be equally possible).","1983":"Creating Custom Applications","1984":"While there are out-of-the-box source, processor, sink applications available, you can extend these applications or write a custom {3/} application.","1985":"The process of creating {3/} applications with {27/} Initializr is detailed in the {3/} documentation .","1986":"It is possible to include multiple binders to an application.","1987":"If doing so, see the instructions in Passing {3/} properties for how to configure them.","1988":"For supporting property whitelisting, {3/} applications running in {0/} may include the {16/} {427/} as an optional dependency, as shown in the following example:","1989":"Make sure that the {428/} is included in the POM.","1990":"The plugin is necessary for creating the executable jar that is registered with {0/}.","1991":"{27/} Initialzr includes the plugin in the generated POM.","1992":"Once a custom application has been created, it can be registered as described in Register a Stream App.","1994":"Creating a Stream","1995":"The {0/} Server exposes a full RESTful API for managing the lifecycle of stream definitions, but the easiest way to use is it is through the {0/} shell.","1996":"Start the shell as described in the Getting Started section.","1997":"New streams are created with the help of stream definitions.","1998":"The definitions are built from a simple DSL.","1999":"For example, consider what happens if we execute the following shell command:","2000":"This defines a stream named {429/} that is based off the DSL expression {430/}.","2001":"The DSL uses the \"pipe\" symbol ({431/}), to connect a source to a sink.","2003":"Application {18/}","2004":"Application properties are the properties associated with each application in the stream.","2005":"When the application is deployed, the application properties are applied to the application through command line arguments or environment variables, depending on the underlying deployment implementation.","2006":"The following stream can have application properties defined at the time of stream creation:","2007":"The shell command {432/} displays the white-listed application properties for the application.","2008":"For more info on the property white listing, refer to Whitelisting application properties","2009":"The following listing shows the white_listed properties for the {433/} app:","2010":"The following listing shows the white-listed properties for the {434/} app:","2011":"The application properties for the {435/} and {436/} apps can be specified at the time of {437/} creation as follows:","2012":"Note that, in the preceding example, the {438/} and {439/} properties defined for the apps {440/} and {441/} are the \"'short-form'\" property names provided by the shell completion.","2013":"These \"'short-form'\" property names are applicable only for the white-listed properties.","2014":"In all other cases, only fully qualified property names should be used.","2016":"Common Application {18/}","2017":"In addition to configuration through DSL, {0/} provides a mechanism for setting common properties to all the streaming applications that are launched by it.","2018":"This can be done by adding properties prefixed with {442/} when starting the server.","2019":"When doing so, the server passes all the properties, without the prefix, to the instances it launches.","2020":"For example, all the launched applications can be configured to use a specific {31/} broker by launching the\nData Flow server with the following options:","2021":"Doing so causes the properties {443/} and {444/}\nto be passed to all the launched applications.","2022":"{18/} configured with this mechanism have lower precedence than stream deployment properties.","2023":"They are overridden if a property with the same key is specified at stream deployment time (for example, {445/} overrides the common property).","2025":"Deploying a Stream","2026":"This section describes how to deploy a Stream when the {0/} server is responsible for deploying the stream.","2027":"The following section, Stream Lifecycle with Skipper , covers the new deployment and upgrade features when the {0/} server delegates to Skipper for stream deployment.","2028":"The description of how deployment properties applies to both approaches of Stream deployment.","2029":"Give the {446/} stream definition:","2030":"To deploy the stream, use the following shell command:","2031":"The Data Flow Server resolves {447/} and {448/} to maven coordinates and uses those to launch the {449/} and {450/} applications of the stream, as shown in the following listing:","2032":"In the preceding example, the time source sends the current time as a message each second, and the log sink outputs it by using the logging framework.","2033":"You can tail the {451/} log (which has an {452/} suffix).","2034":"The log files are located within the directory displayed in the Data Flow Server's log output, as shown in the following listing:","2035":"You can also create and deploy the stream in one step by passing the {453/} flag when creating the stream, as follows:","2036":"However, it is not very common in real-world use cases to create and deploy the stream in one step.","2037":"The reason is that when you use the {454/} command, you can pass in properties that define how to map the applications onto the platform (for example, what is the memory size of the container to use, the number of each application to run, and whether to enable data partitioning features).","2038":"{18/} can also override application properties that were set when creating the stream.","2039":"The next sections cover this feature in detail.","2041":"Deployment {18/}","2042":"When deploying a stream, you can specify properties that fall into two groups:","2043":"{18/} that control how the apps are deployed to the target platform.","2044":"These properties use a {455/} prefix and are referred to as {456/} properties.","2045":"{18/} that set application properties or override application properties set during stream creation and are referred to as {457/} properties.","2046":"The syntax for {458/} properties is {459/}, and the syntax for {460/} properties {461/}.","2047":"This syntax is used when passing deployment properties through the shell.","2048":"You may also specify them in a YAML file, which is discussed later in this chapter.","2049":"The following table shows the difference in behavior between setting {462/} and {463/} properties when deploying an application.","2050":"Application {18/}","2051":"Deployer {18/}","2052":"Passing Instance Count","2053":"If you would like to have multiple instances of an application in the stream, you\ncan include a deployer property called {464/} with the {465/} command:","2054":"Note that {466/} is the reserved property name used by the underlying deployer.","2055":"Consequently, if the application also has a custom property named {467/}, it is not supported when specified in 'short-form' form during stream deployment as it could conflict with the instance {468/} deployer property.","2056":"Instead, the {469/} as a custom application property can be specified in its fully qualified form (for example, {470/}) during stream deployment or it can be specified by using the 'short-form' or the fully qualified form during the stream creation, where it is processed as an app property.","2057":"\nSee Using Labels in a Stream.\n","2058":"Inline Versus File-based {18/}","2059":"When using the {0/} Shell, there are two ways to provide deployment properties: either inline or through a file reference .","2060":"Those two ways are exclusive.","2061":"Inline properties use the {471/} shell option and list properties as a comma separated\nlist of key=value pairs, as shown in the following example:","2062":"File references use the {472/} option and point it to a local {473/}, {474/} or {475/} file (that is, a file that resides in the filesystem of the machine running the shell).","2063":"Being read as a {476/} file, normal rules apply (ISO 8859-1 encoding, {477/}, {478/} or {479/} delimiter, and others), although we recommend using {480/} as a key-value pair delimiter, for consistency.","2064":"The following example shows a {481/} command that uses the {482/} option:","2065":"Assume that {483/} contains the following properties:","2066":"Both of the properties are passed as deployment properties for the {484/} stream.","2067":"If you use YAML as the format for the deployment properties, use the {485/} or {486/} file extention when deploying the stream, as shown in the following example:","2068":"In that case, the {487/} file might contain the following content:","2069":"Passing application properties","2070":"The application properties can also be specified when deploying a stream.","2071":"When specified during deployment, these application properties can either be specified as 'short-form' property names (applicable for white-listed properties) or as fully qualified property names.","2072":"The application properties should have the prefix {488/}.","2073":"For example, consider the following stream command:","2074":"The stream in the precedig example can also be deployed with application properties by using the 'short-form' property names, as shown in the following example:","2075":"Consider the following example:","2076":"When using the app label, the application properties can be defined as follows:","2077":"Passing {3/} properties","2078":"{0/} sets the {489/} {3/} properties for the applications inside the stream.","2079":"Most importantly, the {490/} is set internally for the apps to bind.","2080":"If you want to override any of the {3/} properties, they can be set with deployment properties.","2081":"For example, consider the following stream definition:","2082":"If there are multiple binders available in the classpath for each of the applications and the binder is chosen for each deployment, then the stream can be deployed with the specific {3/} properties, as follows:","2083":"\nOverriding the destination names is not recommended, because {0/} internally takes care of setting this property.\n","2084":"Passing Per-binding Producer and Consumer {18/}","2085":"A {3/} application can have producer and consumer properties set on a {491/} basis.","2086":"While {0/} supports specifying short-hand notation for per-binding producer properties such as {492/} and {493/} (as described in Passing Stream Partition {18/} ), all the supported {3/} producer/consumer properties can be set as {3/} properties for the app directly as well.","2087":"The consumer properties can be set for the {494/} channel name with the prefix {495/}.","2088":"The producer properties can be set for the {496/} channel name with the prefix {497/}.","2089":"Consider the following example:","2090":"The stream can be deployed with producer and consumer properties, as follows:","2091":"The {498/}-specific producer and consumer properties can also be specified in a similar way, as shown in the following example:","2092":"Passing Stream Partition {18/}","2093":"A common pattern in stream processing is to partition the data as it is streamed.","2094":"This entails deploying multiple instances of a message-consuming app and using content-based routing so that messages with a given key (as determined at runtime) are always routed to the same app instance.","2095":"You can pass the partition properties during stream deployment to declaratively configure a partitioning strategy to route each message to a specific consumer instance.","2096":"The following list shows variations of deploying partitioned streams:","2097":"app.[app/label name].producer.partitionKeyExtractorClass:\nThe class name of a {499/} (default: {500/})","2098":"app.[app/label name].producer.partitionKeyExpression : A {32/} expression, evaluated against the message, to determine the partition key.","2099":"Only applies if {501/} is null.","2100":"If both are null, the app is not partitioned (default: {502/})","2101":"app.[app/label name].producer.partitionSelectorClass:\nThe class name of a {503/} (default: {504/})","2102":"app.[app/label name].producer.partitionSelectorExpression : A {32/} expression, evaluated against the partition key, to determine the partition index to which the message is routed.","2103":"The final partition index is the return value (an integer) modulo {505/}.","2104":"If both the class and expression are null, the underlying binder's default {506/} is applied to the key (default: {507/})","2105":"In summary, an app is partitioned if its count is > 1 and the previous app has a {508/} or {509/} ({510/} takes precedence).","2106":"When a partition key is extracted, the partitioned app instance is determined by invoking the {511/}, if present, or the {512/}.","2107":"{513/} is application count, in the case of {21/}, or the underlying partition count of the topic, in the case of {31/}.","2108":"If neither a {514/} nor a {515/} is\npresent, the result is {516/}.","2109":"Passing application content type properties","2110":"In a stream definition, you can specify that the input or the output of an application must be converted to a different type.","2111":"You can use the {517/} and {518/} properties to specify the content type for the incoming data and outgoing data, respectively.","2112":"For example, consider the following stream:","2113":"The {519/} app is expected to send the data in JSON and the {520/} app receives the JSON data and processes it as a {27/} Tuple.","2114":"In order to do so, we use the {521/} property on the filter app to convert the data into the expected {27/} Tuple format.","2115":"The {522/} application processes the Tuple data and sends the processed data to the downstream {523/} application.","2116":"Consider the following example of sending some data to the {524/} application:","2117":"At the log application, you see the content as follows:","2118":"Depending on how applications are chained, the content type conversion can be specified either as an {525/} in the upstream app or as an {526/} in the downstream app.","2119":"For instance, in the above stream, instead of specifying the {527/} on the 'transform' application to convert, the option {528/} can also be specified on the 'http' application.","2120":"For the complete list of message conversion and message converters, please refer to {3/} documentation.","2121":"Overriding Application {18/} During Stream Deployment","2122":"Application properties that are defined during deployment override the same properties defined during the stream creation.","2123":"For example, the following stream has application properties defined during stream creation:","2124":"To override these application properties, you can specify the new property values during deployment, as follows:","2126":"Destroying a Stream","2127":"You can delete a stream by issuing the {529/} command from the shell, as follows:","2128":"If the stream was deployed, it is undeployed before the stream definition is deleted.","2130":"Undeploying a Stream","2131":"Often you want to stop a stream but retain the name and definition for future use.","2132":"In that case, you can {530/} the stream by name.","2133":"You can issue the {531/} command at a later time to restart it.","2135":"Validating a Stream","2136":"Sometimes the one or more of the apps contained within a stream definition contain an invalid URI in its registration.","2137":"This can caused by an invalid URI entered at app registration time or the app was removed from the repository from which it was to be drawn.","2138":"To verify that all the apps contained in a stream are resolve-able, a user can use the {532/} command.","2139":"For example:","2140":"In the example above the user validated their ticktock stream.","2141":"As we see that both the {533/} and {534/} are valid.","2142":"Now let's see what happens if we have a stream definition with a registered app with an invalid URI.","2143":"In this case {0/} states that the stream is invalid because source:bad-time has an invalid URI.","2144":"33. Stream Lifecycle with Skipper","2145":"An additional lifecycle stage of Stream is available if you run in \"skipper\" mode.","2146":"Upgrade or Rollback applications in the Stream.","2147":"(Skipper mode)","2148":"Skipper is a server that you discover {16/} applications and manage their lifecycle on multiple Cloud Platforms.","2149":"Applications in Skipper are bundled as packages that contain the application's resource location, application properties and deployment properites.","2150":"You can think Skipper packages as analogous to packages found in tools such as {535/} or {536/}.","2151":"When Data Flow deploys a Stream, it will generate and upload a package to Skipper that represents the applications in the Stream.","2152":"Subsequent commands to upgrade or rollback the applications within the Stream are passed through to Skipper.","2153":"In addition, the Stream definition is reverse engineered from the package and the status of the Stream is also delegated to Skipper.","2155":"Register a Versioned Stream App","2156":"Skipper extends the Register a Stream App lifecycle with support of multi-versioned stream applications.","2157":"This allows to upgrade or rollback those applications at runtime using the deployment properties.","2158":"Register a versioned stream application using the {537/} command.","2159":"You must provide a unique name, application type, and a URI that can be resolved to the app artifact.","2160":"For the type, specify \"source\", \"processor\", or \"sink\".","2161":"The version is resolved from the URI.","2162":"Here are a few examples:","2163":"The application URI should conform to one the following schema formats:","2164":"maven schema","2165":"http schema","2166":"file schema","2167":"docker schema","2168":"\nThe URI {538/} part is compulsory for the versioned stream applications\n","2169":"Multiple versions can be registered for the same applications (eg same name and type) but only one can be set as default.","2170":"The default version is used for deploying Streams.","2171":"The first time an application is registered it will be marked as default.","2172":"The default application version can be altered with the {539/} command:","2173":"The {540/} command lists all versions for a given stream application.","2174":"The {541/} command has an optional {542/} parameter to specify the app version to unregister.","2175":"If a {543/} is not specified, the default version is unregistered.","2176":"All applications in a stream should have a default version set for the stream to be deployed.","2177":"Otherwise they will be treated as unregistered application during the deployment.","2178":"Use the {544/} to set the defaults.","2179":"The {545/} necessitates default app versions to be set.","2180":"The {546/} and {547/} commands though can use all (default and non-default) registered app versions.","2181":"This will create stream using the default mysource version (0.0.3).","2182":"Then we can update the version to 0.0.2 like this:","2183":"Only pre-registered applications can be used to {548/}, {549/} or {550/} a Stream.","2184":"An attempt to update the {551/} to version {552/} (not registered) will fail!","2186":"Creating and Deploying a Stream","2187":"You create and deploy a stream by using Skipper in two steps:","2188":"Creating the stream definition.","2189":"Deploying the stream.","2190":"The following example shows the two steps in action:","2191":"The {553/} command shows useful information about the stream, including the deployment properties, as shown (with its output) in the following example:","2192":"There is an important optional command argument (called {554/}) to the {555/} command.","2193":"Skipper can be configured to deploy to multiple platforms.","2194":"Skipper is pre-configured with a platform named {556/}, which deploys applications to the local machine where Skipper is running.","2195":"The default value of the command line argument {557/} is {558/}.","2196":"If you commonly deploy to one platform, when installing Skipper, you can override the configuration of the {559/} platform.","2197":"Otherwise, specify the {560/} to one of the values returned by the {561/} command.","2199":"Updating a Stream","2200":"To update the stream, use the command {562/} which takes as a command argument either {563/} or {564/}.","2201":"You can pass in values to these command arguments in the same format as when deploy the stream with or without Skipper.","2202":"There is an important new top level prefix available when using Skipper, which is {565/}.","2203":"If the Stream {566/} was deployed, and the version of {567/} which registered at the time of deployment was {568/}, the following command will update the Stream to use the {569/} of the log application.","2204":"Before updating the stream with the specific version of the app, we need to make sure that the app is registered with that version.","2205":"Only pre-registered application versions can be used to {570/}, {571/}, or {572/} a stream.","2206":"To verify the deployment properties and the updated version, we can use {573/}, as shown (with its output) in the following example:","2208":"Force update of a Stream","2209":"When upgrading a stream, the {574/} option can be used to deploy new instances of currently deployed applications even if no applicaton or deployment properties have changed.","2210":"This behavior is needed in the case when configuration information is obtained by the application itself at startup time, for example from {4/} Server.","2211":"You can specify which applications to force upgrade by using the option {575/}.","2212":"If you do not specify any application names, all the applications will be force upgraded.","2213":"You can specify {576/} and {577/} options together with {578/} or {579/} options.","2215":"Stream versions","2216":"Skipper keeps a history of the streams that were deployed.","2217":"After updating a Stream, there will be a second version of the stream.","2218":"You can query for the history of the versions using the command {580/}.","2220":"Stream Manifests","2221":"Skipper keeps a “manifest” of the all the applications, their application properties, and their deployment properties after all values have been substituted.","2222":"This represents the final state of what was deployed to the platform.","2223":"You can view the manifest for any of the versions of a Stream by using the following command:","2224":"If the {581/} is not specified, the manifest for the last version is returned.","2225":"The following example shows the use of the manifest:","2226":"Using the command results in the following output:","2227":"The majority of the deployment and application properties were set by Data Flow to enable the applications to talk to each other and to send application metrics with identifying labels.","2229":"Rollback a Stream","2230":"You can rollback to a previous version of the stream using the command {582/}.","2231":"The optional {583/} command argument adds the version of the stream.","2232":"If not specified, the rollback goes to the previous stream version.","2234":"Application Count","2235":"The application count is a dynamic property of the system.","2236":"If, due to scaling at runtime, the application to be upgraded has 5 instances running, then 5 instances of the upgraded application are deployed.","2238":"Skipper's Upgrade Strategy","2239":"Skipper has a simple 'red/black' upgrade strategy.","2240":"It deploys the new version of the applications, using as many instances as the currently running version, and checks the {584/} endpoint of the application.","2241":"If the health of the new application is good, then the previous application is undeployed.","2242":"If the health of the new application is bad, then all new applications are undeployed and the upgrade is considered to be not successful.","2243":"The upgrade strategy is not a rolling upgrade, so if five applications of the application are running, then in a sunny-day scenario, five of the new applications are also running before the older version is undeployed.","2244":"34. Stream DSL","2245":"This section covers additional features of the Stream DSL not covered in the Stream DSL introduction.","2247":"Tap a Stream","2248":"Taps can be created at various producer endpoints in a stream.","2249":"For a stream such as that defined in the following example, taps can be created at the output of {585/}, {586/} and {587/}:","2250":"To create a stream that acts as a 'tap' on another stream requires specifying the {588/} for the tap stream.","2251":"The syntax for the source destination name is as follows:","2252":"To create a tap at the output of {589/} in the preceding stream, the source destination name is {590/}\nTo create a tap at the output of the first transform app in the stream above, the source destination name is {591/}","2253":"The tap stream DSL resembles the following:","2254":"Note the colon ({592/}) prefix before the destination names.","2255":"The colon lets the parser recognize this as a destination name instead of an app name.","2257":"Using Labels in a Stream","2258":"When a stream is made up of multiple apps with the same name, they must be qualified with labels:\n{593/}","2260":"Named Destinations","2261":"Instead of referencing a source or sink application, you can use a named destination.","2262":"A named destination corresponds to a specific destination name in the middleware broker ({30/}, {31/}, and others).","2263":"When using the {594/} symbol, applications are connected to each other with messaging middleware destination names created by the Data Flow server.","2264":"In keeping with the Unix analogy, one can redirect standard input and output using the less-than ({595/}) and greater-than ({596/}) characters.","2265":"To specify the name of the destination, prefix it with a colon ({597/}).","2266":"For example, the following stream has the destination name in the {598/} position:","2267":"This stream receives messages from the destination called {599/}, located at the broker, and connects it to the {600/} app.","2268":"You can also create additional streams that consume data from the same named destination.","2269":"The following stream has the destination name in the {601/} position:","2270":"It is also possible to connect two different destinations ({602/} and {603/} positions) at the broker in a stream, as shown in the following example:","2271":"In the preceding stream, both the destinations ({604/} and {605/}) are located in the broker.","2272":"The messages flow from the source destination to the sink destination over a {606/} app that connects them.","2274":"Fan-in and Fan-out","2275":"By using named destinations, you can support fan-in and fan-out use cases.","2276":"Fan-in use cases are when multiple sources all send data to the same named destination, as shown in the following example:","2277":"The preceding example directs the data payloads from the Amazon S3, FTP, and HTTP sources to the same named destination called {607/}.","2278":"Then an additional stream created with the following DSL expression would have all the data from those three sources sent to the file sink:","2279":"The fan-out use case is when you determine the destination of a stream based on some information that is only known at runtime.","2280":"In this case, the Router Application can be used to specify how to direct the incoming message to one of N named destinations.","2281":"A nice Video showing Fan-in and Fan-out behavior is also available.","2282":"35. Stream Java DSL","2283":"Instead of using the shell to create and deploy streams, you can use the Java-based DSL provided by the {608/} module.","2284":"The Java DSL is a convenient wrapper around the {609/} class that enables creating and deploying streams programmatically.","2285":"To get started, you need to add the following dependency to your project, as follows:","2286":"\nA complete sample can be found in the {0/} Samples {19/}.\n","2288":"Overview","2289":"The classes at the heart of the Java DSL are {610/}, {611/}, {612/}, {613/}, and {614/}.","2290":"The entry point is a {615/} method on {616/} that takes an instance of a {617/}.","2291":"To create an instance of a {618/}, you need to provide a {619/} location of the Data Flow Server.","2292":"{16/} auto-configuration for {620/} and {621/} is also available.","2293":"The properties in DataFlowClientProperties can be used to configure the connection to the Data Flow server.","2294":"The common property to start using is {622/}","2295":"Consider the following example, using the {623/} style.","2296":"The {624/} method returns an instance of a {625/} representing a Stream that has been created but not deployed.","2297":"This is called the {626/} style since it takes a single string for the stream definition, same as in the shell.","2298":"If applications have not yet been registered in the Data Flow server, you can use the {627/} class to register them.","2299":"With the {628/} instance, you have methods available to {629/} or {630/} the stream.","2300":"The {631/} instance provides {632/}, {633/} and {634/} methods to control and query the stream.","2301":"If you are going to immediately deploy the stream, there is no need to create a separate local variable of the type {635/}.","2302":"You can just chain the calls together, as follows:","2303":"The {636/} method is overloaded to take a {637/} of deployment properties.","2304":"The {638/} class is used in the 'fluent' Java DSL style and is discussed in the next section.","2305":"The {639/} class is returned from the method {640/}.","2306":"In larger applications, it is common to create a single instance of the {641/} as a {27/} {642/} and share it across the application.","2308":"Java DSL styles","2309":"The Java DSL offers two styles to create Streams.","2310":"The {643/} style keeps the feel of using the pipes and filters textual DSL in the shell.","2311":"This style is selected by using the {644/} method after setting the stream name - for example, {645/}.","2312":"The {646/} style lets you chain together sources, processors, and sinks by passing in an instance of a {647/}.","2313":"This style is selected by using the {648/} method after setting the stream name - for example, {649/}.","2314":"You then chain together {650/} and {651/} methods to create a stream definition.","2315":"To demonstrate both styles, we include a simple stream that uses both approaches.","2316":"A complete sample for you to get started can be found in the {0/} Samples {19/} .","2317":"The following example demonstrates the definition approach:","2318":"The following example demonstrates the fluent approach:","2319":"The {652/} method uses the {653/} method to poll for the stream’s status, as shown in the following example:","2320":"When using the definition style, the deployment properties are specified as a {654/} in the same manner as using the shell.","2321":"The {655/} method is defined as follows:","2322":"Is this case, application properties are also overridden at deployment time in addition to setting the deployer property {656/} for the log application.","2323":"When using the fluent style, the deployment properties are added by using the method {657/} (for example, {658/}), and you do not need to prefix the property with {659/}.","2324":"In order to create and deploy your streams, you need to make sure that the corresponding apps have been registered in the DataFlow server first.","2325":"Attempting to create or deploy a stream that contains an unknown app throws an exception.","2326":"You can register your application by using the {660/}, as follows:","2327":"The Stream applications can also be beans within your application that are injected in other classes to create Streams.","2328":"There are many ways to structure {27/} applications, but one way is to have an {661/} class define the {662/} and {663/}, as shown in the following example:","2329":"Then in another class you can {664/} these classes and deploy a stream.","2330":"This style lets you share {665/} across multiple Streams.","2332":"Using the DeploymentPropertiesBuilder","2333":"Regardless of style you choose, the {666/} method allows customization of how your streams will be deployed.","2334":"We made it a easier to create a map with properties by using a builder style, as well as creating static methods for some properties so you don't need to remember the name of such properties.","2335":"If you take the previous example of {667/} it could be rewritten as:","2336":"This utility class is meant to help with the creation of a Map and adds a few methods to assist with defining pre-defined properties.","2338":"Deploying using Skipper","2339":"If you desire to deploy your streams using Skipper, you need to pass certain properties to the server specific to a Skipper based deployment, for example selecting the target platfrom.","2340":"The {668/} provides you all the properties in {669/} and adds those needed for Skipper.","2341":"36. Stream Applications with Multiple {25/} Configurations","2342":"In some cases, a stream can have its applications bound to multiple {15/} stream binders when they are required to connect to different messaging middleware configurations.","2343":"In those cases, it is important to make sure the applications are configured appropriately with their binder configurations.","2344":"For example, a multi-binder transformer that supports both {31/} and {30/} binders is the processor in the following stream:","2345":"\nIn the example above you would write your own multibindertransform application.\n","2346":"In this stream, each application connects to messaging middleware in the following way:","2347":"The HTTP source sends events to {21/} ({670/}).","2348":"The Multi-{25/} Transform processor receives events from {21/} ({671/}) and sends the processed events into {31/} ({672/}).","2349":"The log sink receives events from {31/} ({673/}).","2350":"Here, {674/} and {675/} are the binder names given in the {15/} stream application properties.","2351":"Based on this setup, the applications have the following binder(s) in their classpath with the appropriate configuration:","2352":"HTTP: {30/} binder","2353":"Transform: Both {31/} and {30/} binders","2354":"Log: {31/} binder","2355":"The {5/} {676/} configuration properties can be set within the applications themselves.","2356":"If not, they can be passed through {677/} properties when the stream is deployed as shown in the following example:","2357":"One can override any of the binder configuration properties by specifying them through deployment properties.","2358":"37. Examples","2359":"This chapter includes the following examples:","2360":"Simple Stream Processing","2361":"Stateful Stream Processing","2362":"Other Source and Sink Application Types","2363":"You can find links to more samples in the “Samples” chapter.","2365":"Simple Stream Processing","2366":"As an example of a simple processing step, we can transform the payload of the HTTP posted data to upper case by using the following stream definition:\n{678/}","2367":"To create this stream enter the following command in the shell","2368":"The following example uses a shell command to post some data:","2369":"The preceding example results in an upper-case 'HELLO' in the log, as follows:","2371":"Stateful Stream Processing","2372":"To demonstrate the data partitioning functionality, the following listing deploys a stream with {31/} as the binder:","2373":"You should then see the following in the server logs:","2374":"When you review the {679/} logs, you should see the following:","2375":"When you review the {680/} logs, you shoul see the following:","2376":"This example has shown that payload splits that contain the same word are routed to the same application instance.","2378":"Other Source and Sink Application Types","2379":"This example shows something a bit more complicated: swapping out the {681/} source for something else.","2380":"Another supported source type is {682/}, which accepts data for ingestion over HTTP POSTs.","2381":"Note that the {683/} source accepts data on a different port from the Data Flow Server (default 8080).","2382":"By default, the port is randomly assigned.","2383":"To create a stream using an {684/} source but still using the same {685/} sink, we would change the original command in the Simple Stream Processing example to the following:","2384":"`dataflow:> stream create --definition \"http | log\" --name myhttpstream --deploy","2385":"The preceding command produces the following output from the server:","2386":"Note that we do not see any other output this time until we actually post some data (by using a shell command).","2387":"In order to see the randomly assigned port on which the http source is listening, run the following command:","2388":"You should see that the corresponding {686/} source has a {687/} property containing the host and port information on which it is listening.","2389":"You are now ready to post to that url, as shown in the following example:","2390":"The stream then funnels the data from the http source to the output log implemented by the log sink, yielding output similar to the following:","2391":"We could also change the sink implementation.","2392":"You could pipe the output to a file ({688/}), to hadoop ({689/}), or to any of the other sink applications that are available.","2393":"You can also define your own applications.","2394":"Streams with Skipper","2395":"The Stream Lifecycle with Skipper section covers the overall role of Skipper in {0/}.","2396":"This section is a continuation of the getting started section on Deploying Streams and shows how Streams can be updated and rolled back by using the Local Data Flow server and Skipper.","2397":"The “ Getting started ” chapter leaves off with the Stream {690/} deployed.","2398":"This chapter continues where the “Getting Started” chapter ended.","2399":"The Stream consists of two applications, the {691/} source and the {692/} sink.","2400":"If you execute the Unix {693/} command you can see the two java processes running, as shown in the following listing:","2401":"38. Upgrading","2402":"Before we start upgrading the log-sink version to 1.2.0.RELEASE, we will have to register that version in the app registry.","2403":"Since we are using the local server, we need to set the port to a different value (9002) than the currently running log sink's value of 9000 to avoid a conflict.","2404":"While we are at it, we update log level to be {694/}.","2405":"To do so, we create a YAML file, named {695/}, with the following contents:","2406":"Now we update the Stream, as follows:","2407":"By executing the Unix {696/} command, you can see the two java processes running, but now the log application is version 1.2.0.RELEASE, as shown in the following listing:","2408":"Now you can look in the log file of the Skipper server.","2409":"To do so, use the following command:","2410":"{697/} to the directory {698/} and {699/}","2411":"You should see log entries similar to the following:","2412":"Now you can post a message to the http source at port {700/}, as follows:","2413":"The log message is now at the error level, as shown in the following example:","2414":"If you query the {701/} endpoint of the application, you can also see that it is at version {702/}, as shown in the following example:","2416":"Force upgrade of a Stream","2417":"When upgrading a stream, the --force option can be used to deploy new instances of currently deployed applications even if no applicaton or deployment properties have changed.","2418":"This behavior is needed in the case when configuration information is obtained by the application itself at startup time, for example from {4/} Server.","2419":"You can specify which applications to force upgrade by using the option --app-names.","2420":"If you do not specify any application names, all the applications will be force upgraded.","2421":"You can specify --force and --app-names options together with --properties or --propertiesFile options.","2423":"Overriding properties during Stream update","2424":"The properties that are passed during stream update are added on top of the existing properties for the same stream.","2425":"For instance, the stream {703/} is deployed without any explicit properties as follows:","2426":"In the second update, we try to add a new property for {704/} application {705/}.","2427":"Property {706/} is applied for the {707/} application.","2428":"Now, when we add another property {708/} to {709/} application, this new property is added on top of the existing properties for the stream {710/}.","2429":"The property {711/} is added along with the existing {712/} for the {713/} application.","2430":"We can still override the existing properties as follows:","2431":"The property {714/} is replaced with the new value` bar4` and the existing property {715/} remains.","2433":"Stream History","2434":"The history of the stream can be viewed by running the {716/} command, as shown (with its output), in the following example:","2436":"Stream Manifest","2437":"The manifest is a YAML document that represents the final state of what was deployed to the platform.","2438":"You can view the manifest for any stream version by using the {717/} command.","2439":"If the {718/} is not specified, the manifest for the last version is returned.","2440":"The following listing shows a typical {719/} command and its output:","2441":"The majority of the deployment and application properties were set by Data Flow in order to enable the applications to talk to each other and send application metrics with identifying labels.","2442":"If you compare this YAML document to the one for {720/} you will see the difference in the log application version.","2443":"39. Rolling back","2444":"To go back to the previous version of the stream, use the {721/} command, as shown (with its output) in the following example:","2445":"By executing the Unix {722/} command, you can see the two java processes running, but now the log application is back to 1.1.0.RELEASE.","2446":"The http source process remains unchanged.","2447":"The following listing shows the {723/} command and typical output:","2448":"Now look in the log file for the skipper server, by using the following command:","2449":"{724/} to the directory {725/} and {726/}","2450":"You should see log entries similar to the following:","2451":"Now post a message to the http source at port {727/}, as follows:","2452":"The log message in the log sink is now back at the info error level, as shown in the following example:","2453":"The {728/} command now shows that the third version of the stream has been deployed, as shown (with its output) in the following listing:","2454":"If you look at the manifest for version 3, you can see that it shows version 1.1.0.RELEASE for the log sink.","2455":"Stream Developer Guide","2456":"This section covers how to create, test, and run {3/} applications on your local machine.","2457":"It also shows how to map these applications into {0/} and deploy them.","2458":"40. Prebuilt Applications","2459":"The {3/} App Starters project provides many applications that you can start using right away.","2460":"For example, there is an HTTP source application that receives messages posted to an HTTP endpoint and publishes the data to the messaging middleware.","2461":"Each existing application comes in three variations, one for each type of messaging middleware that is supported.","2462":"The current supported messaging middleware systems are {21/}, {12/} 0.9, and {12/} 0.10.","2463":"All the applications are based on {16/} and {3/} .","2464":"Applications are published as a Maven artifact as well as a Docker image.","2465":"For GA releases, the Maven artifacts are published to Maven central and the {27/} Release {19/} .","2466":"Milestone and snapshot releases are published to the {27/} Milestone and {27/} Snapshot repositories, respectively.","2467":"Docker images are pushed to Docker Hub .","2468":"We use the Maven artifacts for our examples.","2469":"The root location of the {27/} {19/} that hosts the GA artifacts of prebuilt applications is repo.spring.io/release/org/springframework/cloud/stream/app/","2470":"41. Running prebuilt applications","2471":"In this example, we use {21/} as the messaging middleware.","2472":"Follow the directions on rabbitmq.com for your platform.","2473":"Then install the management plugin .","2474":"We will first run the HTTP source application and the log sink as stand alone applications using {729/}.","2475":"The two applications use {21/} to communicate.","2476":"Download each sample application, as follows:","2477":"These are {16/} applications that include the {2/} and the {9/} Starter .","2478":"You can specify common {16/} properties to configure each application.","2479":"The properties that are specific to each application are listed in the documentation for the {27/} App Starters - for example, the HTTP source and the log sink","2480":"Now you can run the http source application.","2481":"Just for fun, pass in a few Boot applications options using system properties, as shown in the following example:","2482":"The {730/} property comes from {16/}'s {34/} support, and the {731/} property comes from the HTTP source application, HttpSourceProperties .","2483":"The HTTP source app is now listening on port 8123 under the the path {732/}.","2484":"The {733/} property comes from the {3/} library and is the name of the messaging destination that is shared between the source and the sink.","2485":"The string {734/} in this property is the name of the {6/} channel whose contents will be published to the messaging middleware.","2486":"Now you can run the log sink application and change the logging level to WARN, as follows:","2487":"The {735/} property comes from the log sink application, LogSinkProperties.","2488":"The value of the property {736/} is set to {737/} so that the source and sink applications can communicate with each other.","2489":"You can use the following {738/} command to send data to the {739/} application:","2490":"The log sink application then shows the following output:","2491":"42. Custom Processor Application","2492":"Now you can create and test an application that does some processing on the output of the HTTP source and then sends data to the log sink.","2493":"You can then use the Processor convenience class, which has both an inbound channel and an outbound channel.","2494":"To do so:","2495":"Visit the {27/} Initialzr site.","2496":"Create a new Maven project with a Group name of {740/} and an Artifact name of {741/}.","2497":"In the Dependencies text box, type {742/} to select the {3/} dependency.","2498":"In the Dependencies text box, type either {743/} or {744/} and select which middleware you want to use.","2499":"Click the Generate Project button","2500":"Unzip the project and bring the project into your favorite IDE.","2501":"Create a class called Transformer in the {745/} package with the following contents:","2502":"All that this processor is doing is changing the names of the keys in the map and providing a default value if one does not exist.","2503":"Open the {746/} class (which already exists) and create a simple unit test for the {747/} class, as shown in the following example:","2504":"Executing {748/} in the root directory of the transformer\nproject generates the artifact {749/} under the\n{750/} directory.","2505":"Now you can run all three applications, as shown in the following listing:","2506":"Now you can post some content to the http source application, as follows:","2507":"The preceding {751/} command results in the log sink showing the following output:","2508":"43. Improving the Quality of Service","2509":"Without additional configuration, {21/} applications that produce data create a durable topic exchange.","2510":"Similarly, a {21/} application that consumes data creates an anonymous auto-delete queue.","2511":"This can result in a message not being stored and forwarded by the producer if the producer application started before the consumer application.","2512":"Even though the exchange is durable, there needs to be a durable queue bound to the exchange for the message to be stored for later consumption.","2513":"To pre-create durable queues and bind them to the exchange, producer applications should set the {752/} property.","2514":"The {753/} property accepts a comma-separated list of groups to which the producer must ensure message delivery even if they start after it has been created.","2515":"The consumer applications should then specify the {754/} property to consume from the durable queue.","2516":"The comma-separated list of groups for both properties should generally match.","2517":"Consumer groups are also the means by which multiple instances of a consuming application can participate in a competing consumer relationship with other members of the same consumer group.","2518":"The following listing shows multiple applications sharing the same groups:","2519":"As before, posting data to the {755/} source results in the same log message in the sink.","2520":"44. Mapping Applications onto Data Flow","2521":"{0/} (SCDF) provides a higher level way to create this group of three {3/} applications by introducing the concept of a stream.","2522":"A stream is defined by using Unix-like pipes and a filtering DSL.","2523":"Each application is first registered with a simple name, such as {756/}, {757/}, and {758/} (for the applications we are using in this example).","2524":"The stream DSL to connect these three applications is {759/}.","2525":"{0/} has server and shell components.","2526":"Through the shell, you can easily register applications under a name and also create and deploy streams.","2527":"You can also use the JavaDSL to perform the same actions.","2528":"However, we use the shell for the examples in this chapter.","2529":"In the shell application, register the jar files you have on your local machine by using the following commands.","2530":"In this example, the {760/} and {761/} applications are in the {762/} directory and the {763/} application is in the {764/} directory.","2531":"The following commands register the three applications:","2532":"Now you can create a stream definition and deploy it with the following command:","2533":"Then, in the shell, you can query for the list of streams, as shown (with output) in the following listing:","2534":"Eventually, you can see the status column say {765/}.","2535":"In the server log, you can see output similar to the following:","2536":"You can go to each directory to see the logs of each application.","2537":"In the {21/} management console, you can see two exchanges and two durable queues.","2538":"The SCDF server has configured the input and output destinations, through the {766/} and {767/} properties, for each application, as was done explicitly in the previous example.","2539":"Now you can post some content to the http source application, as follows:","2540":"Using the {768/} command on the stdout_0.log file for the log sink then shows output similar to the following listing:","2541":"If you access the Boot actuator endpoint for the applications, you can see the conventions that SCDF has made for the destination names, the consumer groups, and the requiredGroups configuration properties, as shown in the following listing:","2542":"Tasks","2543":"This section goes into more detail about how you can work with {7/} .","2544":"It covers topics such as creating and running task applications.","2545":"If you are just starting out with {0/}, you should probably read the “Getting Started” guide before diving into this section.","2546":"45. Introduction","2547":"A task executes a process on demand.","2548":"In the case of {7/}, a task is a {16/} application that is annotated with {769/}.","2549":"A user launches a task that performs a certain process, and, once complete, the task ends.","2550":"Unlike a stream where a stream definition can have at most one deployment a single task definition can be launched multiple times simultaneously.","2551":"An example of a task would be a {16/} application that exports data from a JDBC repository to an HDFS instance.","2552":"Tasks record the start time and the end time as well as the boot exit code in a relational database.","2553":"The task implementation is based on the {7/} project.","2555":"Application properties","2556":"Each application takes properties to customize its behavior.","2557":"As an example, the {770/} task {771/} setting establishes a output format that is different from the default value.","2558":"This {772/} property is actually the same as the {773/} property specified by the timestamp application.","2559":"Data Flow adds the ability to use the shorthand form {774/} instead of {775/}.","2560":"One may also specify the longhand version as well, as shown in the following example:","2561":"This shorthand behavior is discussed more in the section on Whitelisting application properties .","2562":"If you have registered application property metadata you can use tab completion in the shell after typing {776/} to get a list of candidate property names.","2563":"The shell provides tab completion for application properties.","2564":"The shell command {777/} provides additional documentation for all the supported properties.","2565":"\nThe supported Task {778/} is task.\n","2566":"46. The Lifecycle of a Task","2567":"Before we dive deeper into the details of creating Tasks, we need to understand the typical lifecycle for tasks in the context of {0/}:","2568":"Creating a Task Application","2569":"Registering a Task Application","2570":"Creating a Task Definition","2571":"Launching a Task","2572":"Reviewing Task Executions","2573":"Destroying a Task Definition","2575":"Creating a Task Application","2576":"While {7/} does provide a number of out-of-the-box applications (at spring-cloud-task-app-starters ), most task applications require custom development.","2577":"To create a custom task application:","2578":"Use the {27/} Initializer to create a new project, making sure to select the following starters:","2579":"{779/}: This dependency is the {780/}.","2580":"{781/}: This dependency is the {782/} starter.","2581":"Within your new project, create a new class to serve as your main class, as follows:","2582":"With this class, you need one or more {783/} or {784/} implementations within your application.","2583":"You can either implement your own or use the ones provided by {16/} (there is one for running batch jobs, for example).","2584":"Packaging your application with {16/} into an über jar is done through the standard {16/} conventions .","2585":"The packaged application can be registered and deployed as noted below.","2587":"Task Database Configuration","2588":"When launching a task application, be sure that the database driver that is being used by {0/} is also a dependency on the task application.","2589":"For example, if your {0/} is set to use Postgresql, be sure that the task application also has Postgresql as a dependency.","2590":"When you run tasks externally (that is, from the command line) and you want {0/} to show the TaskExecutions in its UI, be sure that common datasource settings are shared among the both.","2591":"By default, {7/} uses a local H2 instance, and the execution is recorded to the database used by {0/}.","2593":"Registering a Task Application","2594":"You can register a Task App with the App Registry by using the {0/} Shell {785/} command.","2595":"You must provide a unique name and a URI that can be resolved to the app artifact.","2596":"For the type, specify \"task\".","2597":"The following listing shows three examples:","2598":"When providing a URI with the {786/} scheme, the format should conform to the following:","2599":"If you would like to register multiple apps at one time, you can store them in a properties file where the keys are formatted as {787/} and the values are the URIs.","2600":"For example, the followinng listing would be a valid properties file:","2601":"Then you can use the {788/} command and provide the location of the properties file by using the {789/} option, as follows:","2602":"For convenience, we have the static files with application-URIs (for both maven and docker) available for all the out-of-the-box Task app-starters.","2603":"You can point to this file and import all the application-URIs in bulk.","2604":"Otherwise, as explained earlier in this chapter, you can register them individually or have your own custom property file with only the required application-URIs in it.","2605":"It is recommended, however, to have a “focused” list of desired application-URIs in a custom property file.","2606":"The following table lists the available static property files:","2607":"Artifact Type","2608":"Stable Release","2609":"SNAPSHOT Release","2610":"For example, if you would like to register all out-of-the-box task applications in bulk, you can do so with the following command:","2611":"You can also pass the {790/} option (which is {791/} by default) to indicate whether the properties file location should be resolved within the shell process itself.","2612":"If the location should be resolved from the Data Flow Server process, specify {792/}.","2613":"When using either {793/} or {794/}, if a task app is already registered with the provided name, it is not overridden by default.","2614":"If you would like to override the pre-existing task app, then include the {795/} option.","2615":"In some cases, the Resource is resolved on the server side.","2616":"In other cases, the URI is passed to a runtime container instance where it is resolved.","2617":"Consult the specific documentation of each Data Flow Server for more detail.","2619":"Creating a Task Definition","2620":"You can create a task Definition from a task app by providing a definition name as well as properties that apply to the task execution.","2621":"Creating a task definition can be done through the RESTful API or the shell.","2622":"To create a task definition by using the shell, use the {796/} command to create the task definition, as shown in the following example:","2623":"A listing of the current task definitions can be obtained through the RESTful API or the shell.","2624":"To get the task definition list by using the shell, use the {797/} command.","2626":"Launching a Task","2627":"An adhoc task can be launched through the RESTful API or the shell.","2628":"To launch an ad-hoc task through the shell, use the {798/} command, as shown in the following example:","2629":"When a task is launched, any properties that need to be passed as command line arguments to the task application can be set when launching the task, as follows:","2630":"\nThe arguments need to be passed as {799/} delimited values.\n","2631":"Additional properties meant for a {800/} itself can be passed in by using a {801/} option.","2632":"The format of this option is a comma-separated string of properties prefixed with {802/}.","2633":"{18/} are passed to {803/} as application properties.","2634":"It is up to an implementation to choose how those are passed into an actual task application.","2635":"If the property is prefixed with {804/} instead of {805/}, it is passed to {806/} as a deployment property and its meaning may be {807/} implementation specific.","2637":"Common application properties","2638":"In addition to configuration through DSL, {0/} provides a mechanism for setting common properties to all the task applications that are launched by it.","2639":"This can be done by adding properties prefixed with {808/} when starting the server.","2640":"When doing so, the server passes all the properties, without the prefix, to the instances it launches.","2641":"For example, all the launched applications can be configured to use the properties {809/} and {810/} by launching the Data Flow server with the following options:","2642":"This causes the properties, {811/} and {812/}, to be passed to all the launched applications.","2643":"{18/} configured by using this mechanism have lower precedence than task deployment properties.","2644":"They are overridden if a property with the same key is specified at task launch time (for example, {813/} overrides the common property).","2646":"Limit the number concurrent task launches","2647":"{0/} allows a user establish the maximum number of concurrently running tasks to prevent the saturation of IaaS/hardware resources.","2648":"This limit can be configured by setting the {814/} property.","2649":"By default it is set to {815/}.","2650":"If the number of concurrently running tasks is equal or greater than the value set by {816/} the next task launch request will be declined and a warning message will be returned via the RESTful API, Shell or UI.","2652":"Reviewing Task Executions","2653":"Once the task is launched, the state of the task is stored in a relational DB.","2654":"The state includes:","2655":"Task Name","2656":"Start Time","2657":"End Time","2658":"Exit Code","2659":"Exit Message","2660":"Last Updated Time","2661":"Parameters","2662":"A user can check the status of their task executions through the RESTful API or the shell.","2663":"To display the latest task executions through the shell, use the {817/} command.","2664":"To get a list of task executions for just one task definition, add {818/} and the task definition name, for example {819/}.","2665":"To retrieve full details for a task execution use the {820/} command with the id of the task execution, for example {821/}.","2667":"Destroying a Task Definition","2668":"Destroying a Task Definition removes the definition from the definition repository.","2669":"This can be done through the RESTful API or the shell.","2670":"To destroy a task through the shell, use the {822/} command, as shown in the following example:","2671":"The task execution information for previously launched tasks for the definition remains in the task repository.","2672":"This does not stop any currently executing tasks for this definition.","2673":"Instead, it removes the task definition from the database.","2675":"Validating a Task","2676":"Sometimes the one or more of the apps contained within a task definition contain an invalid URI in its registration.","2677":"This can be caused by an invalid URI entered at app registration time or the app was removed from the repository from which it was to be drawn.","2678":"To verify that all the apps contained in a task are resolve-able, a user can use the {823/} command.","2679":"For example:","2680":"In the example above the user validated their time-stamp task.","2681":"As we see {824/} app is valid.","2682":"Now let's see what happens if we have a stream definition with a registered app with an invalid URI.","2683":"In this case {0/} states that the task is invalid because task:badtimestamp has an invalid URI.","2684":"47. Subscribing to Task/Batch {29/}","2685":"You can also tap into various task and batch events when the task is launched.","2686":"If the task is enabled to generate task or batch events (with the additional dependencies {825/} and, in the case of {31/} as the binder, {826/}), those events are published during the task lifecycle.","2687":"By default, the destination names for those published events on the broker ({30/}, {31/}, and others) are the event names themselves (for instance: {827/}, {828/}, and so on).","2688":"You can control the destination name for those events by specifying explicit names when launching the task, as follows:","2689":"The following table lists the default task and batch event and destination names on the broker:","2690":"Table 1. Task and Batch Event Destinations","2691":"48. Composed Tasks","2692":"{0/} lets a user create a directed graph where each node of the graph is a task application.","2693":"This is done by using the DSL for composed tasks.","2694":"A composed task can be created through the RESTful API, the {0/} Shell, or the {0/} UI.","2696":"Configuring the Composed Task Runner","2697":"Composed tasks are executed through a task application called the Composed Task Runner.","2699":"Registering the Composed Task Runner","2700":"By default, the Composed Task Runner application is not registered with {0/}.","2701":"Consequently, to launch composed tasks, we must first register the Composed Task Runner as an application with {0/}, as follows:","2702":"You can also configure {0/} to use a different task definition name for the composed task runner.","2703":"This can be done by setting the {829/} property to the name of your choice.","2704":"You can then register the composed task runner application with the name you set by using that property.","2706":"Configuring the Composed Task Runner","2707":"The Composed Task Runner application has a {830/} property that is used for validation and for launching child tasks.","2708":"This defaults to {831/}.","2709":"If you run a distributed {0/} server, as you would if you deploy the server on {11/}, YARN, or Kubernetes, you need to provide the URI that can be used to access the server.","2710":"You can either provide this {832/} property for the Composed Task Runner application when launching a composed task or you can provide a {833/} property for the {0/} server when it is started.","2711":"For the latter case, the {834/} Composed Task Runner application property is automatically set when a composed task is launched.","2712":"In some cases, you may wish to execute an instance of the Composed Task Runner through the Task Launcher sink.","2713":"In that case, you must configure the Composed Task Runner to use the same datasource that the {0/} instance is using.","2714":"The datasource properties are set with the {835/} through the use of the {836/} or the {837/} switches.","2715":"This is because the Composed Task Runner monitors the {838/} table to check the status of the tasks that it is running.","2716":"Using information from the table, it determines how it should navigate the graph.","2717":"Configuration Options","2718":"The ComposedTaskRunner task has the following options:","2719":"increment-instance-enabled Allows a single ComposedTaskRunner instance to be re-executed without changing the parameters.","2720":"Default is false which means a ComposedTaskRunner instance can only be executed once with a given set of parameters, if true it can be re-executed.","2721":"(Boolean, default: false).","2722":"ComposedTaskRunner is built using {13/} and thus upon a successful execution the batch job is considered complete.","2723":"To launch the same ComposedTaskRunner definition multiple times you must set the {839/} property to true or change the parameters for the definition for each launch.","2724":"interval-time-between-checks The amount of time in millis that the ComposedTaskRunner will wait between checks of the database to see if a task has completed.","2725":"(Integer, default: 10000).","2726":"ComposedTaskRunner uses the datastore to determine the status of each child tasks.","2727":"This interval indicates to ComposedTaskRunner how often it should check the status its child tasks.","2728":"max-wait-time The maximum amount of time in millis that a individual step can run before the execution of the Composed task is failed (Integer, default: 0).","2729":"Determines the maximum time each child task is allowed to run before the CTR will terminate with a failure.","2730":"The default of {840/} indicates no timeout.","2731":"split-thread-allow-core-thread-timeout Specifies whether to allow split core threads to timeout.","2732":"Default is false;","2733":"(Boolean, default: false) Sets the policy governing whether core threads may timeout and terminate if no tasks arrive within the keep-alive time, being replaced if needed when new tasks arrive.","2734":"split-thread-core-pool-size Split's core pool size.","2735":"Default is 1;","2736":"(Integer, default: 1) Each child task contained in a split requires a thread in order to execute.","2737":"So for example a definition like: {841/} would require a split-thread-core-pool-size of 3. This is because the largest split contains 3 child tasks.","2738":"A count of 2 would mean that {842/} and {843/} would run in parallel but CCC would wait until either {844/} or {845/} to finish in order to run.","2739":"Then {846/} and {847/} would run in parallel.","2740":"split-thread-keep-alive-seconds Split's thread keep alive seconds.","2741":"Default is 60. (Integer, default: 60) If the pool currently has more than corePoolSize threads, excess threads will be terminated if they have been idle for more than the keepAliveTime.","2742":"split-thread-max-pool-size Split's maximum pool size.","2743":"Default is {@code Integer.MAX_VALUE} (Integer, default: <none>).","2744":"Establish the maximum number of threads allowed for the thread pool.","2745":"split-thread-queue-capacity Capacity for Split's BlockingQueue.","2746":"Default is {@code Integer.MAX_VALUE}.","2747":"(Integer, default: <none>)","2748":"If fewer than corePoolSize threads are running, the Executor always prefers adding a new thread rather than queuing.","2749":"If corePoolSize or more threads are running, the Executor always prefers queuing a request rather than adding a new thread.","2750":"If a request cannot be queued, a new thread is created unless this would exceed maximumPoolSize, in which case, the task will be rejected.","2751":"split-thread-wait-for-tasks-to-complete-on-shutdown Whether to wait for scheduled tasks to complete on shutdown, not interrupting running tasks and executing all tasks in the queue.","2752":"Default is false;","2753":"(Boolean, default: false)","2754":"Note when using the options above as environment variables, convert to uppercase, remove the dash character and replace with the underscore character.","2755":"For example: increment-instance-enabled would be INCREMENT_INSTANCE_ENABLED.","2757":"The Lifecycle of a Composed Task","2758":"The lifecycle of a composed task has three parts:","2759":"Creating a Composed Task","2760":"Stopping a Composed Task","2761":"Restarting a Composed Task","2763":"Creating a Composed Task","2764":"The DSL for the composed tasks is used when creating a task definition through the task create command, as shown in the following example:","2765":"In the preceding example, we assume that the applications to be used by our composed task have not been registered yet.","2766":"Consequently, in the first two steps, we register two task applications.","2767":"We then create our composed task definition by using the {848/} command.","2768":"The composed task DSL in the preceding example, when launched, runs mytaskapp and then runs the timestamp application.","2769":"But before we launch the {849/} definition, we can view what {0/} generated for us.","2770":"This can be done by executing the task list command, as shown (including its output) in the following example:","2771":"In the example, {0/} created three task definitions, one for each of the applications that makes up our composed task ({850/} and {851/}) as well as the composed task ({852/}) definition.","2772":"We also see that each of the generated names for the child tasks is made up of the name of the composed task and the name of the application, separated by a dash {853/} (as in my-composed-task mytaskapp ).","2773":"Task Application Parameters","2774":"The task applications that make up the composed task definition can also contain parameters, as shown in the following example:","2776":"Launching a Composed Task","2777":"Launching a composed task is done the same way as launching a stand-alone task, as follows:","2778":"Once the task is launched, and assuming all the tasks complete successfully, you can see three task executions when executing a {854/}, as shown in the following example:","2779":"In the preceding example, we see that {855/} launched and that it also launched the other tasks in sequential order.","2780":"All of them executed successfully with {856/} as {857/}.","2781":"Passing properties to the child tasks","2782":"To set the properties for child tasks in a composed task graph at task launch time, you would use the following format of {858/}.","2783":"Using the following Composed Task definition as an example:","2784":"To have mytaskapp display 'HELLO' and set the mytimestamp timestamp format to 'YYYY' for the Composed Task definition, you would use the following task launch format:","2785":"Similar to application properties, the {859/} properties can also be set for child tasks using the format format of {860/}.","2786":"Passing arguments to the composed task runner","2787":"Command line arguments for the composed task runner can be passed using {861/} option.","2788":"For example:","2789":"Exit Statuses","2790":"The following list shows how the Exit Status is set for each step (task) contained in the composed task following each step execution:","2791":"If the {862/} has an {863/}, that is used as the {864/}.","2792":"If no {865/} is present and the {866/} is set to zero, then the {867/} for the step is {868/}.","2793":"If no {869/} is present and the {870/} is set to any non-zero number, the {871/} for the step is {872/}.","2795":"Destroying a Composed Task","2796":"The command used to destroy a stand-alone task is the same as the command used to destroy a composed task.","2797":"The only difference is that destroying a composed task also destroys the child tasks associated with it.","2798":"The following example shows the task list before and after using the {873/} command:","2800":"Stopping a Composed Task","2801":"In cases where a composed task execution needs to be stopped, you can do so through the:","2802":"RESTful API","2803":"{0/} Dashboard","2804":"To stop a composed task through the dashboard, select the Jobs tab and click the Stop button next to the job execution that you want to stop.","2805":"The composed task run is stopped when the currently running child task completes.","2806":"The step associated with the child task that was running at the time that the composed task was stopped is marked as {874/} as well as the composed task job execution.","2808":"Restarting a Composed Task","2809":"In cases where a composed task fails during execution and the status of the composed task is {875/}, the task can be restarted.","2810":"You can do so through the:","2811":"RESTful API","2812":"The shell","2813":"{0/} Dashboard","2814":"To restart a composed task through the shell, launch the task with the same parameters.","2815":"To restart a composed task through the dashboard, select the Jobs tab and click the Restart button next to the job execution that you want to restart.","2816":"\nRestarting a Composed Task job that has been stopped (through the {0/} Dashboard or RESTful API) relaunches the {876/} child task and then launches the remaining (unlaunched) child tasks in the specified order.\n","2817":"49. Composed Tasks DSL","2818":"Composed tasks can be run in three ways:","2819":"Conditional Execution","2820":"Transitional Execution","2821":"Split Execution","2823":"Conditional Execution","2824":"Conditional execution is expressed by using a double ampersand symbol ({877/}).","2825":"This lets each task in the sequence be launched only if the previous task successfully completed, as shown in the following example:","2826":"When the composed task called {878/} is launched, it launches the task called {879/} and, if it completes successfully, then the task called {880/} is launched.","2827":"If {881/} fails, then {882/} does not launch.","2828":"You can also use the {0/} Dashboard to create your conditional execution, by using the designer to drag and drop applications that are required and connecting them together to create your directed graph, as shown in the following image:","2829":"Figure 11. Conditional Execution","2830":"The preceding diagram is a screen capture of the directed graph as it being created by using the {0/} Dashboard.","2831":"You can see that are four components in the diagram that comprise a conditional execution:","2832":"Start icon: All directed graphs start from this symbol.","2833":"There is only one.","2834":"Task icon: Represents each task in the directed graph.","2835":"End icon: Represents the termination of a directed graph.","2836":"Solid line arrow: Represents the flow conditional execution flow between:","2837":"Two applications.","2838":"The start control node and an application.","2839":"An application and the end control node.","2840":"End icon: All directed graphs end at this symbol.","2841":"\nYou can view a diagram of your directed graph by clicking the Detail button next to the composed task definition on the Definitions tab.\n","2843":"Transitional Execution","2844":"The DSL supports fine- grained control over the transitions taken during the execution of the directed graph.","2845":"Transitions are specified by providing a condition for equality based on the exit status of the previous task.","2846":"A task transition is represented by the following symbol {883/}.","2848":"Basic Transition","2849":"A basic transition would look like the following:","2850":"In the preceding example, {884/} would launch, and, if it had an exit status of {885/}, the {886/} task would launch.","2851":"If the exit status of {887/} was {888/}, {889/} would launch.","2852":"All other statuses returned by {890/} have no effect, and the task would terminate normally.","2853":"Using the {0/} Dashboard to create the same \" {891/} \" would resemble the following image:","2854":"Figure 12. Basic Transition","2855":"The preceding diagram is a screen capture of the directed graph as it being created in the {0/} Dashboard.","2856":"Notice that there are two different types of connectors:","2857":"Dashed line: Represents transitions from the application to one of the possible destination applications.","2858":"Solid line: Connects applications in a conditional execution or a connection between the application and a control node (start or end).","2859":"To create a transitional connector:","2860":"When creating a transition, link the application to each possible destination by using the connector.","2861":"Once complete, go to each connection and select it by clicking it.","2862":"A bolt icon appears.","2863":"Click that icon.","2864":"Enter the exit status required for that connector.","2865":"The solid line for that connector turns to a dashed line.","2867":"Transition With a Wildcard","2868":"Wildcards are supported for transitions by the DSL, as shown in the following:","2869":"In the preceding example, {892/} would launch, and, if it had an exit status of {893/}, the {894/} task would launch.","2870":"For any exit status of {895/} other than {896/}, {897/} would launch.","2871":"Using the {0/} Dashboard to create the same “transition with wildcard” would resemble the following image:","2872":"Figure 13. Basic Transition With Wildcard","2874":"Transition With a Following Conditional Execution","2875":"A transition can be followed by a conditional execution so long as the wildcard\nis not used, as shown in the following example:","2876":"In the preceding example, {898/} would launch, and, if it had an exit status of {899/}, the {900/} task would launch.","2877":"If {901/} had an exit status of {902/}, {903/} would launch.","2878":"For any exit status of {904/} other than {905/} or {906/}, {907/} would launch and, upon successful completion, {908/} would launch.","2879":"Using the {0/} Dashboard to create the same “transition with conditional execution” would resemble the following image:","2880":"Figure 14. Transition With Conditional Execution","2881":"\nIn this diagram we see the dashed line (transition) connecting the {909/} application to the target applications, but a solid line connecting the conditional executions between {910/}, {911/}, and {912/}.\n","2883":"Split Execution","2884":"Splits allow multiple tasks within a composed task to be run in parallel.","2885":"It is denoted by using angle brackets ({913/}) to group tasks and flows that are to be run in parallel.","2886":"These tasks and flows are separated by the double pipe {914/} symbol, as shown in the following example:","2887":"The preceding example above launches tasks {915/}, {916/} and {917/} in parallel.","2888":"Using the {0/} Dashboard to create the same “split execution” would resemble the following image:","2889":"Figure 15. Split","2890":"With the task DSL, a user may also execute multiple split groups in succession, as shown in the following example:","2891":"`task create my-split-task --definition \"<foo || bar || baz> && <qux || quux>\"'","2892":"In the preceding example, tasks {918/}, {919/}, and {920/} are launched in parallel.","2893":"Once they all complete, then tasks {921/} and {922/} are launched in parallel.","2894":"Once they complete, the composed task ends.","2895":"However, if {923/}, {924/}, or {925/} fails, the split containing {926/} and {927/} does not launch.","2896":"Using the {0/} Dashboard to create the same “split with multiple groups” would resemble the following image:","2897":"Figure 16. Split as a part of a conditional execution","2898":"Notice that there is a {928/} control node that is inserted by the designer when\nconnecting two consecutive splits.","2899":"Tasks that are used in a split should not set the their {929/}.","2900":"Setting the {930/} is only to be used with transitions .","2902":"Split Containing Conditional Execution","2903":"A split can also have a conditional execution within the angle brackets, as shown in the following example:","2904":"In the preceding example, we see that {931/} and {932/} are launched in parallel.","2905":"However, {933/} does not launch until {934/} completes successfully.","2906":"Using the {0/} Dashboard to create the same \" {935/} \" resembles the following image:","2907":"Figure 17. Split with conditional execution","2909":"Establishing the proper thread count for splits","2910":"Each child task contained in a split requires a thread in order to execute.","2911":"To set this properly you want to look at your graph and count the split that has the largest number of child tasks, this will be the number of threads you will need to utilize.","2912":"To set the thread count use the split-thread-core-pool-size property (defaults to 1).","2913":"So for example a definition like: {936/} would require a split-thread-core-pool-size of 3. This is because the largest split contains 3 child tasks.","2914":"A count of 2 would mean that {937/} and {938/} would run in parallel but CCC would wait until either {939/} or {940/} to finish in order to run.","2915":"Then {941/} and {942/} would run in parallel.","2916":"50. Launching Tasks from a Stream","2917":"You can launch a task from a stream by using one of the available {943/} sinks.","2918":"Currently the platforms supported by the {944/} sinks are:","2919":"local,","2921":"Kubernetes","2922":"Yarn","2923":"\n{945/} is meant for development purposes only.\n","2924":"A {946/} sink expects a message containing a TaskLaunchRequest object in its payload.","2925":"From the {947/} object, the {948/} obtains the URI of the artifact to be launched, as well as the environment properties, command line arguments, deployment properties, and application name to be used by the task.","2926":"The task-launcher-local can be added to the available sinks by executing the app register command, as follows (for the {30/} {25/}, in this case):","2927":"In the case of a Maven-based task that is to be launched, the {949/} application is responsible for downloading the artifact.","2928":"You must configure the {950/} with the appropriate configuration of Maven {18/} , such as {951/} to resolve artifacts (in this case against a milestone repo).","2929":"Note that this repostory can be different than the one used to register the {952/} application itself.","2931":"TriggerTask","2932":"One way to launch a task with the {953/} is to use the triggertask source.","2933":"The {954/} source emits a message with a {955/} object that contains the required launch information.","2934":"The {956/} can be added to the available sources by running the app register command, as follows (for the {30/} {25/}, in this case):","2935":"For example, to launch the timestamp task once every 60 seconds, the stream implementation would be as follows:","2936":"If you run {957/}, you can find the log file for the task launcher sink.","2937":"By using the {958/} command on that file, you can find the log file for the launched tasks.","2938":"Setting of {959/} establishes the Data Flow Server's H2 Database as the database where the task executions will be recorded.","2939":"You can then see the list of task executions by using the shell command {960/}, as shown (with its output) in the following example:","2941":"TaskLaunchRequest-transform","2942":"Another way to start a task with the {961/} would be to create a stream by using the\nTasklaunchrequest-transform processor to translate a message payload to a {962/}.","2943":"The {963/} can be added to the available processors by executing the app register command, as follows (for the {30/} {25/}, in this case):","2944":"The following example shows the creation of a task that includes the {964/}:","2946":"Launching a Composed Task From a Stream","2947":"A composed task can be launched with one of the {965/} sinks as discussed here .","2948":"Since we use the {966/} directly, we need to set up the task definitions it uses prior to the creation of the composed task launching stream.","2949":"Suppose we wanted to create the following composed task definition: {967/}.","2950":"The first step would be to create the task definitions, as shown in the following example:","2951":"Now that the task definitions we need for composed task definition are ready, we need to create a stream that launches {968/}.","2952":"So, in this case, we create a stream with","2953":"A trigger that emits a message once every 30 seconds","2954":"A transformer that creates a {969/} for each message received","2955":"A {970/} sink that launches a the {971/} on our local machine","2956":"The stream should resemble the following:","2957":"In the preceding example, we see that the {972/} is establishing two primary components:","2958":"uri: The URI of the {973/} that is used","2959":"command-line-arguments: To configure the {974/}","2960":"For now, we focus on the configuration that is required to launch the {975/}:","2961":"graph : this is the graph that is to be executed by the {976/}.","2962":"In this case it is {977/}.","2963":"increment-instance-enabled : This lets each execution of {978/} be unique.","2964":"{979/} is built by using {13/} .","2965":"Thus, we want a new Job Instance for each launch of the {980/}.","2966":"To do this, we set {981/} to be {982/}.","2967":"spring.datasource.","2968":"*: The datasource that is used by {14/} Data Flow, which lets the user track the tasks launched by the {983/} and the state of the job execution.","2969":"Also, this is so that the {984/} can track the state of the tasks it launched and update its state.","2970":"\nReleases of {985/} can be found\nhere.\n","2971":"51. Sharing {0/}’s Datastore with Tasks","2972":"As discussed in the Tasks documentation {27/} Cloud Data Flow allows a user to view {7/} App executions.","2973":"So in this section we will discuss what is required by a Task Application and {27/} Cloud Data Flow to share the task execution information.","2975":"A Common DataStore Dependency","2976":"{0/} supports many database types out-of-the-box, so all the user typically has to do is declare the {986/} environment variables to establish what data store {0/} will need.","2977":"So whatever database you decide to use for {0/} make sure that the your task also includes that database dependency in its {987/} or {988/} file.","2978":"If the database dependency that is used by {0/} is not present in the Task Application, the task will fail and the task execution will not be recorded.","2980":"A Common Data Store","2981":"{0/} and your task application must access the same datastore instance.","2982":"This is so that the task executions recorded by the task application can be read by {0/} to list them in the Shell and Dashboard views.","2983":"Also the task app must have read & write privileges to the task data tables that are used by {0/}.","2984":"Given the understanding of Datasource dependency between Task apps and {0/}, let’s review how to apply them in various Task orchestration scenarios.","2986":"Simple Task Launch","2987":"When launching a task from {0/}, Data Flow adds its datasource properties ({989/}, {990/}, {991/}, {992/}) to the app properties of the task being launched.","2988":"Thus a task application will record its task execution information to the {0/} repository.","2990":"Task Launcher Sink","2991":"The Task Launcher Sink allows tasks to be launched via a stream as discussed here .","2992":"Since tasks launched by the Task Launcher Sink may not want their task executions recorded to the same datastore as {0/}, each TaskLaunchRequest received by the Task Launcher Sink must have the required datasource information established as app properties or command line arguments.","2993":"Both TaskLaunchRequest-Transform and TriggerTask Source are examples of how a source and a processor allow a user to set the datasource properties via the app properties or command line arguments.","2995":"Composed Task Runner","2996":"{0/} allows a user to create a directed graph where each node of the graph is a task application and this is done via the Composed Task Runner .","2997":"In this case the rules that applied to a Simple Task Launch or Task Launcher Sink apply to the composed task runner as well.","2998":"All child apps must also have access to the datastore that is being used by the composed task runner Also, All child apps must have the same database dependency as the composed task runner enumerated in their {993/} or {994/} file.","3000":"Launching a task externally from {0/}","3001":"Users may wish to launch {7/} applications via another method (scheduler for example) but still track the task execution via {0/}.","3002":"This can be done so long as the task applications observe the rules specified here and here .","3003":"If a user wishes to use {0/} to view their {13/} jobs, the user must make sure that their batch application use the {995/} annotation and follow the rules enumerated here and here .","3004":"More information is available here .","3005":"52. Scheduling Tasks","3006":"{0/} lets a user schedule the execution of tasks via a cron expression.","3007":"A schedule can be created through the RESTful API or the {0/} UI.","3009":"The Scheduler","3010":"{0/} will schedule the execution of its tasks via a scheduling agent that is available on the cloud platform.","3011":"When using the {11/} platform {0/} will use the PCF Scheduler .","3012":"When using Kubernetes, a CronJob will be used.","3013":"Figure 18. Architectural Overview","3015":"Enabling Scheduling","3016":"By default the {0/} leaves the scheduling feature disabled.","3017":"To enable the scheduling feature the following feature properties must be set to {996/}:","3019":"The Lifecycle of a Schedule","3020":"The lifecycle of a schedule has 2 parts:","3021":"Scheduling a Task Execution","3022":"Deleting a Schedule","3024":"Scheduling a Task Execution","3025":"You can schedule a task execution via the:","3026":"RESTful API","3027":"{0/} Dashboard","3028":"To schedule a task from the UI click the Tasks tab at the top of the screen, this will take you to the Task Definitions screen.","3029":"Then from the Task Definition that you wish to schedule click the \"clock\" icon associated with task definition you wish to schedule.","3030":"This will lead you to a {997/} screen, where you will create a unique name for the schedule and enter the associated cron expression.","3031":"Keep in mind you can always create multiple schedules for a single task definition.","3033":"Deleting a Schedule","3034":"You can delete a schedule via the:","3035":"RESTful API","3036":"{0/} Dashboard","3037":"To delete a schedule through the dashboard, select the Schedule tab under Tasks tab and click the {998/} icon next to the schedule you wish to delete.","3038":"Any currently running tasks that were run by the scheduling agent will not be stopped if the schedule is deleted.","3039":"It only prevents future executions.","3040":"Task Developer Guide","3041":"This section covers how to create, test, and run {7/} applications on your local machine.","3042":"It also shows how to map these applications into {0/} and deploy them.","3043":"53. Prebuilt Applications","3044":"The {7/} App Starters project provides many applications that you can start using right away.","3045":"For example, there is a timestamp application that prints the timestamp to the console.","3046":"All the applications are based on {16/} and {7/} .","3047":"Applications are published as Maven artifacts as well as Docker images.","3048":"For GA releases, the Maven artifacts are published to Maven central and the {27/} Release {19/} .","3049":"Milestone and snapshot releases are published to the {27/} Milestone and {27/} Snapshot repositories, respectively.","3050":"Docker images are pushed to Docker Hub","3051":"The root location of the {27/} {19/} that hosts the GA artifacts of prebuilt applications is repo.spring.io/release/org/springframework/cloud/task/app/","3052":"54. Running Prebuilt Applications","3053":"You can run the timestamp application by using {999/}.","3054":"To get started, download the sample application, as follows:","3055":"That file contains a {16/} applications that includes the {2/} and the {9/} Starter .","3056":"You can specify common {16/} properties to configure each application.","3057":"Now you can run the timestamp application, as follows:","3058":"The {1000/} option lets you see output that would not otherwise be written to the console.","3059":"Because {7/} uses an in-memory database to store its results (and that in-memory database is destroyed at the end of the run), the {1001/} option is the only way to see the output from the timestamp task.","3060":"The timestamp application shows the following output (in the midst of much other output):","3061":"The first line shows the timestamp generated by the Timestamp task.","3062":"The second line shows an exit code of 0 and no error.","3063":"Had an error occurred, the exit code would be something other than 0, and the {1002/} would show the exception that was thrown.","3064":"If you have debug mode turned on, you can get even more information, in a line similar to the following (which appears just prior to the timestamp if you have debug mode turned on):","3065":"55. Building a Timestamp Task","3066":"To build your own timestamp task, follow each of these procedures:","3067":"Developing Your Timestamp Application","3068":"Recording an Error","3069":"Adding Pre- and Post-processing","3070":"Adding a MySQL Database","3071":"Adding and Launching {14/} Tasks with Data Flow","3072":"56. Developing Your Timestamp Application","3073":"So now that we’ve used a pre-built timestamp task application, let’s create one of our own.","3075":"Creating the {27/} Task Project using {27/} Initializr","3076":"Now let’s create and test an application that prints the current time to the console.","3077":"To do so:","3078":"Visit the {27/} Initialzr site.","3079":"Create a new Maven or Gradle project with a Group name of {1003/} and an Artifact name of {1004/}.","3080":"In the Dependencies text box, type {1005/} to select the {1006/} dependency.","3081":"In the Dependencies text box, type {1007/} then select the {1008/} dependency.","3082":"In the Dependencies text box, type {1009/} then select the {1010/}.","3083":"(or your favorite database)","3084":"Click the Generate Project button","3085":"Unzip the timestamp.zip file and import the project into your favorite IDE.","3087":"Writing the Code","3088":"To finish our application, we need to modify the generated {1011/} code with the following contents so that it will launch a Task.","3089":"The @EnableTask annotation sets up {1012/} which stores information about the task execution such as the start and end time of the task and the exit code.","3090":"In our demo, the {1013/} uses an embedded H2 database to record the results of a task.","3091":"This H2 embedded database is not a practical solution for a production environment, since the H2 database goes away once the task ends.","3092":"However, for a quick getting-started experience, we will use this in our example as well as echoing to the logs what is being updated in that repository.","3093":"The CommandLineRunner is a {16/} interface that tells Boot to execute the code in the {1014/} method once.","3094":"When our sample application runs, {16/} launches our {1015/} and outputs our timestamp message to standard out.","3095":"\nAny processing bootstrapped from mechanisms other than a {1016/} or\n{1017/} (by using {1018/} for example) is not\nrecorded by {7/}.\n","3096":"Now let's open the {1019/} file in {1020/} and configure two properties, the application name and logging.","3097":"The application name is also used as the name of the task.","3098":"The logging level is set to {1021/} so we can see more information on what is going on internally.","3100":"Running the Example","3101":"At this point, our application should work.","3102":"Since this application is {16/}-based, we can run it from the command line by using {1022/} from the root of our application, as shown (with its output) in the following example:","3103":"The preceding output has three lines that of interest to us here:","3104":"{1023/} logged the creation of the entry in the {1024/}.","3105":"The execution of our {1025/}, demonstrated by the timestamp output.","3106":"{1026/} logs the completion of the task in the {1027/}.","3108":"Recording an Error","3109":"Now that we have a working task, we can intentionally create an error, to show how a {7/} handles errors.","3110":"To do so:","3111":"Open {1028/} and insert the following line into the run method:","3112":"From the command line, run {1029/}.","3113":"\nWe must add {1030/}, because the tests would catch the Exception we added and prevent us from seeing it.\n","3114":"Now we can see the Exception we added coming through in the output, as an Exception with a stack trace.","3115":"Task has now captured this exception and recorded it to the database.","3116":"This can be seen in the console as shown here:","3117":"Remove or comment out the Exception so that the next lessons work correctly.","3119":"Adding Pre- and Post-processing","3120":"{7/} includes the ability to run additional processing both before and after the task.","3121":"To add both features to our current sample application:","3122":"Open {1031/} and add the following code to the TimestampCommandLineRunner:","3123":"From the command line, run {1032/}.","3124":"Now the output includes lines that print both {1033/} and {1034/}.","3126":"Adding a MySQL Database","3127":"Nearly always, a real-world {7/} needs to use a persistent (rather than an in-memory) database.","3128":"In this example, we show how to add a MySQL database (MariaDB) to our Task.","3129":"To do so:","3130":"Open the {1035/} file.","3131":"Add the following dependency:","3132":"From your command line set up the database connection properties for MySql for example","3133":"From the command line, run {1036/}.","3134":"If you examine the contents of your database, you should now see the task in the {1037/} table.","3135":"57. Adding and Launching {14/} Tasks with Data Flow","3136":"This guide walks through registering and launching a {7/} application.","3137":"It consists of the following procedures:","3138":"Registering and Launching Your First Task","3139":"Registering and Launching Your First {13/}-Task","3141":"Registering and Launching Your First Task","3142":"Once you have {0/} Server and Shell running, you can use the following procedure to create your first task:","3143":"Register a basic suite of tasks by importing their registrations through the {0/} Shell with the following command:","3144":"\nThis example shows how to register a task from a Maven repository.\n","3145":"Verify that the timestamp-task app registered by running the following command in the {0/} Shell:","3146":"The following output should appear:","3147":"Create a task definition that uses timestamp task by using the following command in the {0/} Shell:","3148":"You should see a message saying \"Created new task 'myStamp'\".","3149":"Launch your new task by using the following command:","3150":"You should see a message saying \"Launched task `myStamp`\".","3151":"Verify that your task was successfully run by running the following command in the {0/} Shell:\n{1038/}","3152":"You should see output similar to the following:","3153":"The exit code of 0 tells us that the task ran without errors.","3155":"Registering and Launching Your First {13/}-Task","3156":"Essentially, a Batch-Task is a {13/} application that includes the {1039/} annotation, which serves as an indicator that the {13/} application uses {7/}.","3157":"{16/} takes care of the rest of the set up for us.","3158":"To register your first {13/} Task:","3159":"In {0/} Shell, register a {13/} Task application by using the following command:","3160":"To verify that your application has been registered, run the following command in the {0/} Shell:","3161":"You should see output similar to the following:","3162":"Create a task definition that uses the batch-events task, by running the following command:","3163":"You should see a message saying \"Created new task 'myBatchTask'\".","3164":"Launch your batch-task by running the following command:","3165":"You should see a message saying \"Launched task `myBatchTask`\".","3166":"Verify that the task ran, run the following command:","3167":"You should see output similar to the following:","3168":"We can now verify that the task worked as a batch job.","3169":"The next section describes how to do so.","3171":"Verifying that Your Task is a Batch","3172":"When you create and run a Batch-Task, it is both a {7/} instance and a {13/} instance.","3173":"In the previous section , we saw how to verify that your first batch-task worked as a task.","3174":"This section steps through how to verify that it also worked as a batch.","3175":"To do so:","3176":"Run the following command to see the list of jobs that have run:","3177":"You should see output similar to the following:","3178":"Note the Job ID from the ID column (in this case, we want to look at {1040/}).","3179":"To get the details of the job execution, we can use the Job ID in the following command:","3180":"You should see output similar to the following:","3181":"58. Database Requirement for running tasks in {0/}","3182":"As previously discussed {7/} records the state of each task execution to a relational database.","3183":"And as such {0/} uses this recorded information when users request task or batch job execution information.","3184":"Also {13/} and {7/} offer features that allow {0/} to communicate certain start or stop behaviors.","3185":"One example is when a user utilizes the {0/} UI to stop a {13/} app execution.","3186":"Dashboard","3187":"This section describes how to use the dashboard of {0/}.","3188":"59. Introduction","3189":"{0/} provides a browser-based GUI called the dashboard to manage the following information:","3190":"Apps: The Apps tab lists all available applications and provides the controls to register/unregister them.","3191":"Runtime: The Runtime tab provides the list of all running applications.","3192":"Streams: The Streams tab lets you list, design, create, deploy, and destroy Stream Definitions.","3193":"Tasks: The Tasks tab lets you list, create, launch, schedule and, destroy Task Definitions.","3194":"Jobs: The Jobs tab lets you perform batch job related functions.","3195":"Analytics: The Analytics tab lets you create data visualizations for the various analytics applications.","3196":"Upon starting {0/}, the dashboard is available at:","3197":"For example, if {0/} is running locally, the dashboard is available at {1041/}.","3198":"If you have enabled https, then the dashboard will be located at {1042/}.","3199":"If you have enabled security, a login form is available at {1043/}.","3200":"\nThe default Dashboard server port is {1044/}.\n","3201":"The following image shows the opening page of the {0/} dashboard:","3202":"Figure 19. The {0/} Dashboard","3203":"60. Apps","3204":"The Apps section of the dashboard lists all the available applications and provides the controls to register and unregister them (if applicable).","3205":"It is possible to import a number of applications at once by using the Bulk Import Applications action.","3206":"The following image shows a typical list of available apps within the dashboard:","3207":"Figure 20. List of Available Applications","3209":"Bulk Import of Applications","3210":"The Bulk Import Applications page provides numerous options for defining and importing a set of applications all at once.","3211":"For bulk import, the application definitions are expected to be expressed in a properties style, as follows:","3212":"The following examples show a typical application definitions:","3213":"At the top of the bulk import page, a URI can be specified that points to a properties file stored elsewhere, it should contain properties formatted as shown in the previous example.","3214":"Alternatively, by using the textbox labeled “Apps as {18/}”, you can directly list each property string.","3215":"Finally, if the properties are stored in a local file, the “Select {18/} File” option opens a local file browser to select the file.","3216":"After setting your definitions through one of these routes, click Import.","3217":"The following image shows the Bulk Import Applications page:","3218":"Figure 21. Bulk Import Applications","3219":"61. Runtime","3220":"The Runtime section of the Dashboard application shows the list of all running applications.","3221":"For each runtime app, the state of the deployment and the number of deployed instances is shown.","3222":"A list of the used deployment properties is available by clicking on the App Id.","3223":"The following image shows an example of the Runtime tab in use:","3224":"Figure 22. List of Running Applications","3225":"62. Streams","3226":"The Streams tab has two child tabs: Definitions and Create Stream.","3227":"The following topics describe how to work with each one:","3228":"Working with Stream Definitions","3229":"Creating a Stream","3230":"Deploying a Stream","3232":"Working with Stream Definitions","3233":"The Streams section of the Dashboard includes the Definitions tab that provides a listing of Stream definitions.","3234":"There you have the option to deploy or undeploy those stream definitions.","3235":"Additionally, you can remove the definition by clicking on Destroy.","3236":"Each row includes an arrow on the left, which you can click to see a visual representation of the definition.","3237":"Hovering over the boxes in the visual representation shows more details about the apps, including any options passed to them.","3238":"In the following screenshot, the {1045/} stream has been expanded to show the visual representation:","3239":"Figure 23. List of Stream Definitions","3240":"If you click the details button, the view changes to show a visual representation of that stream and any related streams.","3241":"In the preceding example, if you click details for the {1046/} stream, the view changes to the following view, which clearly shows the relationship between the three streams (two of them are tapping into the {1047/} stream):","3242":"Figure 24. Stream Details Page","3244":"Creating a Stream","3245":"The Streams section of the Dashboard includes the Create Stream tab, which makes available the {27/} Flo designer: a canvas application that offers an interactive graphical interface for creating data pipelines.","3246":"In this tab, you can:","3247":"Create, manage, and visualize stream pipelines using DSL, a graphical canvas, or both","3248":"Write pipelines via DSL with content-assist and auto-complete","3249":"Use auto-adjustment and grid-layout capabilities in the GUI for simpler and interactive organization of pipelines","3250":"You should watch this screencast that highlights some of the \"Flo for {0/}\" capabilities.","3251":"The {27/} Flo wiki includes more detailed content on core Flo capabilities.","3252":"The following image shows the Flo designer in use:","3253":"Figure 25. Flo for {0/}","3255":"Deploying a Stream","3256":"The stream deploy page includes tabs that provide different ways to setup the deployment properties and deploy the stream.","3257":"The following screenshots show the stream deploy page for {1048/} ({1049/}).","3258":"You can define deployments properties using:","3259":"Form builder tab: a builder which help you to define deployment properties (deployer, application properties…​)","3260":"Free text tab: a free textarea (key/value pairs)","3261":"You can switch between the both views, the form builder provides a more stronger validation of the inputs.","3262":"Figure 26. The following image shows the form builder","3263":"Figure 27. The following image shows the same properties in the free text","3265":"Creating Fan-In/Fan-Out Streams","3266":"In chapter Fan-in and Fan-out you learned how we can support fan-in and fan-out use cases using named destinations .","3267":"The UI provides dedicated support for named destinations as well:","3268":"Figure 28. Flo for {0/}","3269":"In this example we have data from an HTTP Source and a JDBC Source that is being sent to the sharedData channel which represents a Fan-in use case.","3270":"On the other end we have a Cassandra Sink and a File Sink subscribed to the sharedData channel which represents a Fan-out use case.","3272":"Creating a Tap Stream","3273":"Creating Taps using the Dashboard is straightforward.","3274":"Let's say you have stream consisting of an HTTP Source and a File Sink and you would like to tap into the stream to also send data to a JDBC Sink .","3275":"In order to create the tap stream simply connect the output connector of the HTTP Source to the JDBC Sink .","3276":"The connection will be displayed as a dotted line, indicating that you created a tap stream.","3277":"Figure 29. Creating a Tap Stream","3278":"The primary stream ( HTTP Source to File Sink ) will be automatically named, in case you did not provide a name for the stream, yet.","3279":"When creating tap streams, the primary stream must always be explicitly named.","3280":"In the picture above, the primary stream was named HTTP_INGEST .","3281":"Using the Dashboard, you can also switch the primary stream to become the secondary tap stream.","3282":"Figure 30. Change Primary Stream to Secondary Tap Stream","3283":"Simply hover over the existing primary stream, the line between HTTP Source and File Sink .","3284":"Several control icons will appear, and by clicking on the icon labeled Switch to/from tap , you change the primary stream into a tap stream.","3285":"Do the same for the tap stream and switch it to a primary stream.","3286":"Figure 31. End Result of Switching the Primary Stream","3287":"When interacting directly with named destinations , there can be \"n\" combinations (Inputs/Outputs).","3288":"This allows you to create complex topologies involving a wide variety of data sources and destinations.","3289":"63. Tasks","3290":"The Tasks section of the Dashboard currently has three tabs:","3291":"Apps","3292":"Definitions","3293":"Executions","3294":"Scheduling","3296":"Apps","3297":"Each app encapsulates a unit of work into a reusable component.","3298":"Within the Data Flow runtime environment, apps let users create definitions for streams as well as tasks.","3299":"Consequently, the Apps tab within the Tasks section lets users create task definitions.","3300":"\nYou can also use this tab to create Batch Jobs.\n","3301":"The following image shows a typical list of task apps:","3302":"Figure 32. List of Task Apps","3303":"On this screen, you can perform the following actions:","3304":"View details, such as the task app options.","3305":"Create a task definition from the respective app.","3307":"View Task App Details","3308":"On this page you can view the details of a selected task app, including the list of available options (properties) for that app.","3310":"Create a Task Definition","3311":"At a minimum, you must provide a name for the new definition.","3312":"You also have the option to specify various properties that are used during the deployment of the app.","3313":"\nEach parameter is included only if the Include checkbox is selected.\n","3315":"Definitions","3316":"This page lists the Data Flow task definitions and provides actions to launch or destroy those tasks.","3317":"It also provides a shortcut operation to define one or more tasks with simple textual input, indicated by the Bulk Define Tasks button.","3318":"The following image shows the Definitions page:","3319":"Figure 33. List of Task Definitions","3321":"Creating Composed Task Definitions","3322":"The dashboard includes the Create Composed Task tab, which provides an interactive graphical interface for creating composed tasks.","3323":"In this tab, you can:","3324":"Create and visualize composed tasks using DSL, a graphical canvas, or both.","3325":"Use auto-adjustment and grid-layout capabilities in the GUI for simpler and interactive organization of the composed task.","3326":"On the Create Composed Task screen, you can define one or more task parameters by entering both the parameter key and the parameter value.","3327":"\nTask parameters are not typed.\n","3328":"The following image shows the composed task designer:","3329":"Figure 34. Composed Task Designer","3331":"Launching Tasks","3332":"Once the task definition has been created, the tasks can be launched through the dashboard.","3333":"To do so, click the Definitions tab and select the task you want to launch by pressing {1050/}.","3335":"Executions","3336":"The Executions tab shows the current running and completed tasks.","3337":"The following image shows the Executions tab:","3338":"Figure 35. List of Task Executions","3340":"Execution Detail","3341":"For each task execution on the Executions page, a user can retrieve detailed information about a specific execution by clicking the information icon located to the right of the task execution.","3342":"On this screen the user can view not only the information from the Task Executions page but also:","3343":"Task Arguments","3344":"External Execution Id","3345":"Batch Job Indicator (indicates if the task execution contained {13/} jobs.)","3346":"Job Execution Ids links (Clicking the Job Execution Id will take you to the Job Execution Details for that Job Execution Id.)","3347":"Task Execution Duration","3348":"Task Execution Exit Message","3349":"64. Jobs","3350":"The Jobs section of the Dashboard lets you inspect batch jobs.","3351":"The main section of the screen provides a list of job executions.","3352":"Batch jobs are tasks that each execute one or more batch jobs.","3353":"Each job execution has a reference to the task execution ID (in the Task Id column).","3354":"The list of Job Executions also shows the state of the underlying Job Definition.","3355":"Thus, if the underlying definition has been deleted, “No definition found” appears in the Status column.","3356":"You can take the following actions for each job:","3357":"Restart (for failed jobs).","3358":"Stop (for running jobs).","3359":"View execution details.","3360":"Note: Clicking the stop button actually sends a stop request to the running job, which may not immediately stop.","3361":"The following image shows the Jobs page:","3362":"Figure 36. List of Job Executions","3364":"Job Execution Details","3365":"After having launched a batch job, the Job Execution Details page will show information about the job.","3366":"The following image shows the Job Execution Details page:","3367":"Figure 37. Job Execution Details","3368":"The Job Execution Details page contains a list of the executed steps.","3369":"You can further drill into the details of each step's execution by clicking the magnifying glass icon.","3371":"Step Execution Details","3372":"The Step Execution Details page provides information about an individual step within a job.","3373":"The following image shows the Step Execution Details page:","3374":"Figure 38. Step Execution Details","3375":"On the top of the page, you can see a progress indicator the respective step, with the option to refresh the indicator.","3376":"A link is provided to view the step execution history.","3377":"The Step Execution Details screen provides a complete list of all Step Execution Context key/value pairs.","3378":"For exceptions, the Exit Description field contains additional error information.","3379":"However, this field can have a maximum of 2500 characters.","3380":"Therefore, in the case of long exception stack traces, trimming of error messages may occur.","3381":"When that happens, refer to the server log files for further details.","3383":"Step Execution Progress","3384":"On this screen, you can see a progress bar indicator in regards to the execution of the current step.","3385":"Under the Step Execution History, you can also view various metrics associated with the selected step, such as duration, read counts, write counts, and others.","3386":"65. Scheduling","3388":"Creating or deleting a Schedule from the Task Definition's page","3389":"From the Task Definitions page a user can create or delete a schedule for a specific task definition.","3390":"Figure 39. Task Definitions with Schedule controls","3391":"On this screen you can perform the following actions:","3392":"The user can click the clock icon and this will take you to the Schedule Creation screen.","3393":"The user can click the clock icon with the {1051/} to the upper right to delete the schedule(s) associated with the task definition.","3395":"Creating a Schedule","3396":"Figure 40. Create Schedule for Task Execution","3397":"Once the user clicks the clock icon on the Task Definition screen, {0/} will take the user to the Schedule Creation screen.","3398":"On this screen a user can establish the schedule name, the cron expression as well as establish the properties and arguments to be used when the task is launched by this schedule.","3400":"Listing Available Schedules","3401":"Figure 41. List Available Schedules","3402":"On this screen you can perform the following actions:","3403":"Delete a schedule","3404":"Get details for a schedule","3405":"66. Analytics","3406":"The Analytics page of the Dashboard provides the following data visualization capabilities for the various analytics applications available in {0/}:","3407":"Counters","3408":"Field-Value Counters","3409":"Aggregate Counters","3410":"For example, if you create a stream with a Counter application, you can create the corresponding graph from within the Dashboard tab.","3411":"To do so:","3412":"Under {1052/}, select {1053/} from the select box.","3413":"Under {1054/}, select {1055/}.","3414":"Under {1056/}, select the desired chart option, {1057/}.","3415":"Using the icons to the right, you can add additional charts to the Dashboard, re-arange the order of created dashboards, or remove data visualizations.","3416":"67. Auditing","3417":"The Auditing page of the Dashboard gives you access to recorded audit events.","3418":"Currently audit event are recorded for:","3419":"Streams","3420":"Create","3421":"Delete","3422":"Deploy","3423":"Undeploy","3424":"Tasks","3425":"Create","3426":"Delete","3427":"Launch","3428":"Scheduling of Tasks","3429":"Create Schedule","3430":"Delete Schedule","3431":"Figure 42. List Overview of Audit Records","3432":"By clicking on the Show Details icon, you can obtain further details regarding\nthe auditing details:","3433":"Figure 43. List Details of an Audit Record","3434":"Generally, auditing provides the following information:","3435":"When was the record created?","3436":"Username that triggered the audit event (if security is enabled)","3437":"Audit operation (Schedule, Stresm, Task)","3438":"Performed action (Create, Delete, Deploy, Rollback, Undeploy, Update)","3439":"Correlation Id, e.g. Stream/Task name","3440":"Audit Data","3441":"The written value of the property Audit Data depends on the performed Audit Operation and the ActionType .","3442":"For example, when a Schedule is being created, the name of the task definition, task definition properties, deployment properties, as well as command line arguments are written to the persistence store.","3443":"Sensitive information is sanitized prior to saving the Audit Record, in an best-effort-manner .","3444":"Any of the following keys are being detected and its sensitive values are masked:","3445":"password","3446":"secret","3447":"key","3448":"token","3449":".*credentials.*","3450":"vcap_services","3451":"Samples","3452":"This section shows the available samples.","3453":"68. Links","3454":"Several samples have been created to help you get started on implementing higher-level use cases than the basic Streams and Tasks shown in the reference guide.","3455":"The samples are part of a separate repository and have their own reference documentation .","3456":"Java DSL","3457":"HTTP to Cassandra","3458":"HTTP to MySQL","3459":"HTTP to Gemfire","3460":"Gemfire CQ to Log Demo","3461":"Gemfire to Log Demo","3462":"Custom Processor","3463":"Task and Batch","3464":"Batch Job on {11/}","3465":"Batch File Ingest","3466":"Analytics","3467":"Twitter Analytics","3468":"Data Science","3469":"Species Prediction","3470":"Functions","3471":"Using {14/} Function","3472":"REST API Guide","3473":"This section describes the {0/} REST API.","3474":"69. Overview","3475":"{0/} provides a REST API that lets you access all aspects of the server.","3476":"In fact, the {0/} shell is a first-class consumer of that API.","3477":"\nIf you plan to use the REST API with Java, you should consider using the\nprovided Java client ({1058/}) that uses the REST API internally.\n","3479":"HTTP verbs","3480":"{0/} tries to adhere as closely as possible to standard HTTP and REST conventions in its use of HTTP verbs, as described in the following table:","3481":"Verb","3482":"Usage","3484":"HTTP Status Codes","3485":"{0/} tries to adhere as closely as possible to standard HTTP and REST conventions in its use of HTTP status codes, as shown in the following table:","3486":"Status code","3487":"Usage","3489":"Headers","3490":"Every response has the following header(s):","3491":"Name","3492":"Description","3493":"The Content-Type of the payload, e.g. {1059/}","3495":"Errors","3496":"Path","3497":"Type","3498":"Description","3499":"The HTTP error that occurred, e.g. {1060/}","3500":"A description of the cause of the error","3501":"The path to which the request was made","3502":"The HTTP status code, e.g. {1061/}","3503":"The time, in milliseconds, at which the error occurred","3505":"Hypermedia","3506":"{0/} uses hypermedia, and resources include links to other resources in their responses.","3507":"Responses are in the Hypertext Application from resource to resource Language (HAL) format.","3508":"Links can be found beneath the {1062/} key.","3509":"Users of the API should not create URIs themselves.","3510":"Instead.","3511":"they should use the above-described links to navigate.","3512":"70. Resources","3513":"The API includes the following resources:","3514":"Index","3515":"Server Meta Information","3516":"Audit Records","3517":"Registered Applications","3518":"Stream Definitions","3519":"Stream Deployments","3520":"Stream Validation","3521":"Task Definitions","3522":"Task Executions","3523":"Task Scheduler","3524":"Task Validation","3525":"Job Executions","3526":"Job Instances","3527":"Job Step Executions","3528":"Runtime Information about Applications","3529":"Metrics for Stream Applications","3531":"Index","3532":"The index provides the entry point into {0/}'s REST API.","3533":"The following topics provide more detail:","3534":"Accessing the index","3535":"Request Structure","3536":"Example Request","3537":"Response Structure","3538":"Example Response","3539":"Links","3541":"Accessing the index","3542":"Use a {1063/} request to access the index.","3543":"Request Structure","3544":"Example Request","3545":"Response Structure","3546":"Path","3547":"Type","3548":"Description","3549":"Links to other resources","3550":"Incremented each time a change is implemented in this REST API","3551":"Example Response","3552":"Links","3553":"The main element of the index are the links, as they let you traverse the API\nand execute the desired functionality:","3554":"Relation","3555":"Description","3556":"Access meta information, including enabled features, security info, version information","3557":"Access the dashboard UI","3558":"Provides audit trail information","3559":"Handle registered applications","3560":"Exposes the DSL completion features for Stream","3561":"Exposes the DSL completion features for Task","3562":"Exposes metrics for the stream applications","3563":"Provides the JobExecution resource","3564":"Provides details for a specific JobExecution","3565":"Provides the steps for a JobExecution","3566":"Returns the details for a specific step","3567":"Provides progress information for a specific step","3568":"Retrieve Job Executions by Job name","3569":"Provides the job instance resource for a specific job instance","3570":"Provides the Job instance resource for a specific job name","3571":"Provides the runtime application resource","3572":"Exposes the runtime status for a specific app","3573":"Provides the status for app instances","3574":"Provides the task definition resource","3575":"Provides details for a specific task definition","3576":"Provides the validation for a task definition","3577":"Returns Task executions and allows launching of tasks","3578":"Provides the current count of running tasks","3579":"Provides schedule information of tasks","3580":"Provides schedule information of a specific task","3581":"Returns all task executions for a given Task name","3582":"Provides details for a specific task execution","3583":"Exposes the Streams resource","3584":"Handle a specific Stream definition","3585":"Provides the validation for a stream definition","3586":"Provides Stream deployment operations","3587":"Request (un-)deployment of an existing stream definition","3588":"Exposes the resource for dealing with Counters","3589":"Handle a specific counter","3590":"Provides the resource for dealing with aggregate counters","3591":"Handle a specific aggregate counter","3592":"Provides the resource for dealing with field-value-counters","3593":"Handle a specific field-value-counter","3594":"Parse a task definition into a graph structure","3595":"Convert a graph format into DSL text format","3597":"Server Meta Information","3598":"The server meta information endpoint provides more information about the server itself.","3599":"The following topics provide more detail:","3600":"Retrieving information about the server","3601":"Request Structure","3602":"Example Request","3603":"Response Structure","3605":"Retrieving information about the server","3606":"A {1064/} request returns meta information for {0/}, including:","3607":"Runtime environment information","3608":"Information regarding which features are enabled","3609":"Dependency information of {0/} Server","3610":"Security information","3611":"Request Structure","3612":"Example Request","3613":"Response Structure","3615":"Registered Applications","3616":"The registered applications endpoint provides information about the applications that are registered with the {0/} server.","3617":"The following topics provide more detail:","3618":"Listing Applications","3619":"Getting Information on a Particular Application","3620":"Registering a New Application","3621":"Registering a New Application with version (In Skipper mode)","3622":"Set the default application version (In Skipper mode)","3623":"Unregistering an Application","3624":"Registering Applications in Bulk","3626":"Listing Applications","3627":"A {1065/} request will list all applications known to {0/}.","3628":"The following topics provide more detail:","3629":"Request Structure","3630":"Request Parameters","3631":"Example Request","3632":"Response Structure","3633":"Request Structure","3634":"Request Parameters","3635":"Parameter","3636":"Description","3637":"Restrict the returned apps to the type of the app.","3638":"One of [app, source, processor, sink, task]","3639":"Example Request","3640":"Response Structure","3642":"Getting Information on a Particular Application","3643":"A {1066/} request on {1067/} gets info on a particular application.","3644":"The following topics provide more detail:","3645":"Request Structure","3646":"Path Parameters","3647":"Example Request","3648":"Response Structure","3649":"Request Structure","3650":"Request Parameters","3651":"Parameter","3652":"Description","3653":"Return all application properties, including common {16/} properties","3654":"Path Parameters","3655":"Table 2. /apps/{type}/{name}","3656":"Parameter","3657":"Description","3658":"The type of application to query.","3659":"One of [app, source, processor, sink, task]","3660":"The name of the application to query","3661":"Example Request","3662":"Response Structure","3664":"Registering a New Application","3665":"A {1068/} request on {1069/} allows registration of a new application.","3666":"The following topics provide more detail:","3667":"Request Structure","3668":"Request Parameters","3669":"Path Parameters","3670":"Example Request","3671":"Response Structure","3672":"Request Structure","3673":"Request Parameters","3674":"Parameter","3675":"Description","3676":"URI where the application bits reside","3677":"URI where the application metadata jar can be found","3678":"Must be true if a registration with the same name and type already exists, otherwise an error will occur","3679":"Path Parameters","3680":"Table 3. /apps/{type}/{name}","3681":"Parameter","3682":"Description","3683":"The type of application to register.","3684":"One of [app, source, processor, sink, task]","3685":"The name of the application to register","3686":"Example Request","3687":"Response Structure","3689":"Registering a New Application with version","3690":"\nIn order to use this feature, the Data Flow server must be in Skipper Mode","3691":"A {1070/} request on {1071/} allows registration of a new application in Skipper mode.","3692":"The following topics provide more detail:","3693":"Request Structure","3694":"Request Parameters","3695":"Path Parameters","3696":"Example Request","3697":"Response Structure","3698":"Request Structure","3699":"Request Parameters","3700":"Parameter","3701":"Description","3702":"URI where the application bits reside","3703":"URI where the application metadata jar can be found","3704":"Must be true if a registration with the same name and type already exists, otherwise an error will occur","3705":"Path Parameters","3706":"Table 4. /apps/{type}/{name}/{version:.+}","3707":"Parameter","3708":"Description","3709":"The type of application to register.","3710":"One of [app, source, processor, sink, task]","3711":"The name of the application to register","3712":"The version of the application to register","3713":"Example Request","3714":"Response Structure","3716":"Set the default application version","3717":"\nIn order to use this feature, the Data Flow server must be in Skipper Mode","3718":"For an application with the {1072/} and {1073/}, multiple versions can be registered in Skipper mode.","3719":"In this case, one of the versions can be chosen as the default application.","3720":"The following topics provide more detail:","3721":"Request Structure","3722":"Path Parameters","3723":"Example Request","3724":"Response Structure","3725":"Request Structure","3726":"Path Parameters","3727":"Table 5. /apps/{type}/{name}/{version:.+}","3728":"Parameter","3729":"Description","3730":"The type of application.","3731":"One of [app, source, processor, sink, task]","3732":"The name of the application","3733":"The version of the application","3734":"Example Request","3735":"Response Structure","3737":"Unregistering an Application","3738":"A {1074/} request on {1075/} unregisters a previously registered application.","3739":"The following topics provide more detail:","3740":"Request Structure","3741":"Path Parameters","3742":"Example Request","3743":"Response Structure","3744":"Request Structure","3745":"Path Parameters","3746":"Table 6. /apps/{type}/{name}","3747":"Parameter","3748":"Description","3749":"The type of application to unregister.","3750":"One of [app, source, processor, sink, task]","3751":"The name of the application to unregister","3752":"Example Request","3753":"Response Structure","3755":"Registering Applications in Bulk","3756":"A {1076/} request on {1077/} allows registering multiple applications at once.","3757":"The following topics provide more detail:","3758":"Request Structure","3759":"Request Parameters","3760":"Example Request","3761":"Response Structure","3762":"Request Structure","3763":"Request Parameters","3764":"Parameter","3765":"Description","3766":"URI where a properties file containing registrations can be fetched.","3767":"Exclusive with {1078/}.","3768":"Inline set of registrations.","3769":"Exclusive with {1079/}.","3770":"Must be true if a registration with the same name and type already exists, otherwise an error will occur","3771":"Example Request","3772":"Response Structure","3774":"Audit Records","3776":"List All Audit Records","3777":"The audit records endpoint lets you retrieve audit trail information.","3778":"The following topics provide more detail:","3779":"Request Structure","3780":"Request Parameters","3781":"Example Request","3782":"Response Structure","3783":"Request Structure","3784":"Request Parameters","3785":"Parameter","3786":"Description","3787":"The zero-based page number (optional)","3788":"The requested page size (optional)","3789":"Comma-separated list of Audit Operations (optional)","3790":"Comma-separated list of Audit Actions (optional)","3791":"Example Request","3792":"Response Structure","3794":"Stream Definitions","3795":"The registered applications endpoint provides information about the stream definitions that are registered with the {0/} server.","3796":"The following topics provide more detail:","3797":"Creating a New Stream Definition","3798":"List All Stream Definitions","3799":"List Related Stream Definitions","3800":"Delete a Single Stream Definition","3801":"Delete All Stream Definitions","3802":"Deploying Stream Definition","3803":"Undeploy Stream Definition","3804":"Undeploy All Stream Definitions","3806":"Creating a New Stream Definition","3807":"Creating a stream definition is achieved by creating a POST request to the stream definitions endpoint.","3808":"A curl request for a {1080/} stream might resemble the following:","3809":"A stream definition can also contain additional parameters.","3810":"For instance, in the example shown under “ Request Structure ”, we also provide the date-time format.","3811":"The following topics provide more detail:","3812":"Request Structure","3813":"Request Parameters","3814":"Example Request","3815":"Response Structure","3816":"Request Structure","3817":"Request Parameters","3818":"Parameter","3819":"Description","3820":"The name for the created task definitions","3821":"The definition for the stream, using Data Flow DSL","3822":"If true, the stream is deployed upon creation (default is false","3823":"Example Request","3824":"Response Structure","3826":"List All Stream Definitions","3827":"The streams endpoint lets you list all the stream definitions.","3828":"The following topics provide more detail:","3829":"Request Structure","3830":"Request Parameters","3831":"Example Request","3832":"Response Structure","3833":"Request Structure","3834":"Request Parameters","3835":"Parameter","3836":"Description","3837":"The zero-based page number (optional)","3838":"The requested page size (optional)","3839":"Example Request","3840":"Response Structure","3842":"List Related Stream Definitions","3843":"The streams endpoint lets you list related stream definitions.","3844":"The following topics provide more detail:","3845":"Request Structure","3846":"Request Parameters","3847":"Example Request","3848":"Response Structure","3849":"Request Structure","3850":"Request Parameters","3851":"Parameter","3852":"Description","3853":"Should we recursively findByNameLike for related stream definitions (optional)","3854":"Example Request","3855":"Response Structure","3857":"Delete a Single Stream Definition","3858":"The streams endpoint lets you delete a single stream definition.","3859":"(See also: Delete All Stream Definitions .) The following topics provide more detail:","3860":"Request Structure","3861":"Request Parameters","3862":"Example Request","3863":"Response Structure","3864":"Request Structure","3865":"Request Parameters","3866":"There are no request parameters for this endpoint.","3867":"Example Request","3868":"Response Structure","3870":"Delete All Stream Definitions","3871":"The streams endpoint lets you delete all single stream definitions.","3872":"(See also: Delete a Single Stream Definition .) The following topics provide more detail:","3873":"Request Structure","3874":"Request Parameters","3875":"Example Request","3876":"Response Structure","3877":"Request Structure","3878":"Request Parameters","3879":"There are no request parameters for this endpoint.","3880":"Example Request","3881":"Response Structure","3883":"Stream Validation","3884":"The stream validation endpoint lets you validate the apps in a stream definition.","3885":"The following topics provide more detail:","3886":"Request Structure","3887":"Request Parameters","3888":"Example Request","3889":"Response Structure","3891":"Request Structure","3893":"Request Parameters","3894":"There are no request parameters for this endpoint.","3896":"Example Request","3898":"Response Structure","3900":"Stream Deployments","3901":"The deployment definitions endpoint provides information about the deployments that are registered with the {0/} server.","3902":"The following topics provide more detail:","3903":"Deploying Stream Definition","3904":"Undeploy Stream Definition","3905":"Undeploy All Stream Definitions","3906":"Update Deployed Stream (In Skipper mode)","3907":"Rollback Stream Definition (In Skipper mode)","3908":"Get Manifest (In Skipper mode)","3909":"Get Deployment History (In Skipper mode)","3910":"Get Deployment Platforms (In Skipper mode)","3912":"Deploying Stream Definition","3913":"The stream definition endpoint lets you deploy a single stream definition.","3914":"Optionally, you can pass application parameters as properties in the request body.","3915":"The following topics provide more detail:","3916":"Request Structure","3917":"Request Parameters","3918":"Example Request","3919":"Response Structure","3920":"Request Structure","3921":"Table 7. /streams/deployments/{timelog}","3922":"Parameter","3923":"Description","3924":"The name of an existing stream definition (required)","3925":"Request Parameters","3926":"There are no request parameters for this endpoint.","3927":"Example Request","3928":"Response Structure","3930":"Undeploy Stream Definition","3931":"The stream definition endpoint lets you undeploy a single stream definition.","3932":"The following topics provide more detail:","3933":"Request Structure","3934":"Request Parameters","3935":"Example Request","3936":"Response Structure","3937":"Request Structure","3938":"Table 8. /streams/deployments/{timelog}","3939":"Parameter","3940":"Description","3941":"The name of an existing stream definition (required)","3942":"Request Parameters","3943":"There are no request parameters for this endpoint.","3944":"Example Request","3945":"Response Structure","3947":"Undeploy All Stream Definitions","3948":"The stream definition endpoint lets you undeploy all single stream definitions.","3949":"The following topics provide more detail:","3950":"Request Structure","3951":"Request Parameters","3952":"Example Request","3953":"Response Structure","3954":"Request Structure","3955":"Request Parameters","3956":"There are no request parameters for this endpoint.","3957":"Example Request","3958":"Response Structure","3960":"Update Deployed Stream","3961":"When using {0/} in Skipper mode, you can update deployed\nstreams, and provide additional deployment properties.","3962":"\nIn order to use this feature, the Data Flow server must be in Skipper Mode","3963":"Request Structure","3964":"Request Parameters","3965":"Example Request","3966":"Response Structure","3967":"Request Structure","3968":"Table 9. /streams/deployments/update/{timelog1}","3969":"Parameter","3970":"Description","3971":"The name of an existing stream definition (required)","3972":"Request Parameters","3973":"There are no request parameters for this endpoint.","3974":"Example Request","3975":"Response Structure","3977":"Rollback Stream Definition","3978":"Rollback the stream to the previous or a specific version of the stream.","3979":"\nIn order to use this feature, the Data Flow server must be in Skipper Mode","3980":"Request Structure","3981":"Request Parameters","3982":"Example Request","3983":"Response Structure","3984":"Request Structure","3985":"Table 10. /streams/deployments//rollback/{name}/{version}","3986":"Parameter","3987":"Description","3988":"The name of an existing stream definition (required)","3989":"The version to rollback to","3990":"Request Parameters","3991":"There are no request parameters for this endpoint.","3992":"Example Request","3993":"Response Structure","3995":"Get Manifest","3996":"Return a manifest of a released version.","3997":"For packages with dependencies, the manifest includes the contents of those dependencies.","3998":"\nIn order to use this feature, the Data Flow server must be in Skipper Mode","3999":"Request Structure","4000":"Request Parameters","4001":"Example Request","4002":"Response Structure","4003":"Request Structure","4004":"Table 11. /streams/deployments/manifest/{name}/{version}","4005":"Parameter","4006":"Description","4007":"The name of an existing stream definition (required)","4008":"The version of the stream","4009":"Request Parameters","4010":"There are no request parameters for this endpoint.","4011":"Example Request","4012":"Response Structure","4014":"Get Deployment History","4015":"Get the stream’s deployment history.","4016":"\nIn order to use this feature, the Data Flow server must be in Skipper Mode","4017":"Request Structure","4018":"Example Request","4019":"Response Structure","4020":"Request Structure","4021":"Example Request","4022":"Response Structure","4024":"Get Deployment Platforms","4025":"Retrieve a list of supported deployment platforms.","4026":"\nIn order to use this feature, the Data Flow server must be in Skipper Mode","4027":"Request Structure","4028":"Example Request","4029":"Response Structure","4030":"Request Structure","4031":"Example Request","4032":"Response Structure","4034":"Task Definitions","4035":"The task definitions endpoint provides information about the task definitions that are registered with the {0/} server.","4036":"The following topics provide more detail:","4037":"Creating a New Task Definition","4038":"List All Task Definitions","4039":"Retrieve Task Definition Detail","4040":"Delete Task Definition","4042":"Creating a New Task Definition","4043":"The task definition endpoint lets you create a new task definition.","4044":"The following topics provide more detail:","4045":"Request Structure","4046":"Request Parameters","4047":"Example Request","4048":"Response Structure","4049":"Request Structure","4050":"Request Parameters","4051":"Parameter","4052":"Description","4053":"The name for the created task definition","4054":"The definition for the task, using Data Flow DSL","4055":"Example Request","4056":"Response Structure","4058":"List All Task Definitions","4059":"The task definition endpoint lets you get all task definitions.","4060":"The following topics provide more detail:","4061":"Request Structure","4062":"Request Parameters","4063":"Example Request","4064":"Response Structure","4065":"Request Structure","4066":"Request Parameters","4067":"Parameter","4068":"Description","4069":"The zero-based page number (optional)","4070":"The requested page size (optional)","4071":"Example Request","4072":"Response Structure","4074":"Retrieve Task Definition Detail","4075":"The task definition endpoint lets you get a single task definition.","4076":"The following topics provide more detail:","4077":"Request Structure","4078":"Request Parameters","4079":"Example Request","4080":"Response Structure","4081":"Request Structure","4082":"Table 12. /tasks/definitions/{my-task}","4083":"Parameter","4084":"Description","4085":"The name of an existing task definition (required)","4086":"Request Parameters","4087":"There are no request parameters for this endpoint.","4088":"Example Request","4089":"Response Structure","4091":"Delete Task Definition","4092":"The task definition endpoint lets you delete a single task definition.","4093":"The following topics provide more detail:","4094":"Request Structure","4095":"Request Parameters","4096":"Example Request","4097":"Response Structure","4098":"Request Structure","4099":"Table 13. /tasks/definitions/{my-task}","4100":"Parameter","4101":"Description","4102":"The name of an existing task definition (required)","4103":"Request Parameters","4104":"There are no request parameters for this endpoint.","4105":"Example Request","4106":"Response Structure","4108":"Task Scheduler","4109":"The task scheduler endpoint provides information about the task schedules that are registered with the Scheduler Implementation.","4110":"The following topics provide more detail:","4111":"Creating a New Task Schedule","4112":"List All Schedules","4113":"List Filtered Schedules","4114":"Delete Task Schedule","4116":"Creating a New Task Schedule","4117":"The task schedule endpoint lets you create a new task schedule.","4118":"The following topics provide more detail:","4119":"Request Structure","4120":"Request Parameters","4121":"Example Request","4122":"Response Structure","4123":"Request Structure","4124":"Request Parameters","4125":"Parameter","4126":"Description","4127":"The name for the created schedule","4128":"The name of the task definition to be scheduled","4129":"the properties that are required to schedule and launch the task","4130":"the command line arguments to be used for launching the task","4131":"Example Request","4132":"Response Structure","4134":"List All Schedules","4135":"The task schedules endpoint lets you get all task schedules.","4136":"The following topics provide more detail:","4137":"Request Structure","4138":"Request Parameters","4139":"Example Request","4140":"Response Structure","4141":"Request Structure","4142":"Request Parameters","4143":"Parameter","4144":"Description","4145":"The zero-based page number (optional)","4146":"The requested page size (optional)","4147":"Example Request","4148":"Response Structure","4150":"List Filtered Schedules","4151":"The task schedules endpoint lets you get all task schedules that have the specified task definition name.","4152":"The following topics provide more detail:","4153":"Request Structure","4154":"Request Parameters","4155":"Example Request","4156":"Response Structure","4157":"Request Structure","4158":"Table 14. /tasks/schedules/instances/{task-definition-name}","4159":"Parameter","4160":"Description","4161":"Filter schedules based on the specified task definition (required)","4162":"Request Parameters","4163":"Parameter","4164":"Description","4165":"The zero-based page number (optional)","4166":"The requested page size (optional)","4167":"Example Request","4168":"Response Structure","4170":"Delete Task Schedule","4171":"The task schedule endpoint lets you delete a single task schedule.","4172":"The following topics provide more detail:","4173":"Request Structure","4174":"Request Parameters","4175":"Example Request","4176":"Response Structure","4177":"Request Structure","4178":"Table 15. /tasks/schedules/{scheduleName}","4179":"Parameter","4180":"Description","4181":"The name of an existing schedule (required)","4182":"Request Parameters","4183":"There are no request parameters for this endpoint.","4184":"Example Request","4185":"Response Structure","4187":"Task Validation","4188":"The task validation endpoint lets you validate the apps in a task definition.","4189":"The following topics provide more detail:","4190":"Request Structure","4191":"Request Parameters","4192":"Example Request","4193":"Response Structure","4194":"Request Structure","4195":"Request Parameters","4196":"There are no request parameters for this endpoint.","4197":"Example Request","4198":"Response Structure","4200":"Task Executions","4201":"The task executions endpoint provides information about the task executions that are registered with the {0/} server.","4202":"The following topics provide more detail:","4203":"Launching a Task","4204":"List All Task Executions","4205":"List All Task Executions With a Specified Task Name","4206":"Task Execution Detail","4207":"Delete Task Execution","4209":"Launching a Task","4210":"Launching a task is done by requesting the creation of a new task execution.","4211":"The following topics provide more detail:","4212":"Request Structure","4213":"Request Parameters","4214":"Example Request","4215":"Response Structure","4216":"Request Structure","4217":"Request Parameters","4218":"Parameter","4219":"Description","4220":"The name of the task definition to launch","4221":"Application and Deployer properties to use while launching","4222":"Command line arguments to pass to the task","4223":"Example Request","4224":"Response Structure","4226":"List All Task Executions","4227":"The task executions endpoint lets you list all task executions.","4228":"The following topics provide more detail:","4229":"Request Structure","4230":"Request Parameters","4231":"Example Request","4232":"Response Structure","4233":"Request Structure","4234":"Request Parameters","4235":"Parameter","4236":"Description","4237":"The zero-based page number (optional)","4238":"The requested page size (optional)","4239":"Example Request","4240":"Response Structure","4242":"List All Task Executions With a Specified Task Name","4243":"The task executions endpoint lets you list task executions with a specified task name.","4244":"The following topics provide more detail:","4245":"Request Structure","4246":"Request Parameters","4247":"Example Request","4248":"Response Structure","4249":"Request Structure","4250":"Request Parameters","4251":"Parameter","4252":"Description","4253":"The zero-based page number (optional)","4254":"The requested page size (optional)","4255":"The name associated with the task execution","4256":"Example Request","4257":"Response Structure","4259":"Task Execution Detail","4260":"The task executions endpoint lets you get the details about a task execution.","4261":"The following topics provide more detail:","4262":"Request Structure","4263":"Request Parameters","4264":"Example Request","4265":"Response Structure","4266":"Request Structure","4267":"Table 16. /tasks/executions/{id}","4268":"Parameter","4269":"Description","4270":"The id of an existing task execution (required)","4271":"Request Parameters","4272":"There are no request parameters for this endpoint.","4273":"Example Request","4274":"Response Structure","4276":"Delete Task Execution","4277":"The task executions endpoint lets you clean up resources used to deploy the task.","4278":"\nThe cleanup implementation is platform specific.\n","4279":"The following topics provide more detail:","4280":"Request Structure","4281":"Request Parameters","4282":"Example Request","4283":"Response Structure","4284":"Request Structure","4285":"Table 17. /tasks/executions/{id}","4286":"Parameter","4287":"Description","4288":"The id of an existing task execution (required)","4289":"Request Parameters","4290":"There are no request parameters for this endpoint.","4291":"Example Request","4292":"Response Structure","4294":"Task Execution Current Count","4295":"The task executions current endpoint lets you retrieve the current number of running executions.","4296":"The following topics provide more detail:","4297":"Request Structure","4298":"Request Parameters","4299":"Example Request","4300":"Response Structure","4301":"Request Structure","4302":"Request Parameters","4303":"There are no request parameters for this endpoint.","4304":"Example Request","4305":"Response Structure","4307":"Job Executions","4308":"The job executions endpoint provides information about the job executions that are registered with the {0/} server.","4309":"The following topics provide more detail:","4310":"List All Job Executions","4311":"List All Job Executions With a Specified Job Name","4312":"Job Execution Detail","4313":"Stop Job Execution","4314":"Restart Job Execution","4316":"List All Job Executions","4317":"The job executions endpoint lets you list all job executions.","4318":"The following topics provide more detail:","4319":"Request Structure","4320":"Request Parameters","4321":"Example Request","4322":"Response Structure","4323":"Request Structure","4324":"Request Parameters","4325":"Parameter","4326":"Description","4327":"The zero-based page number (optional)","4328":"The requested page size (optional)","4329":"Example Request","4330":"Response Structure","4332":"List All Job Executions With a Specified Job Name","4333":"The job executions endpoint lets you list all job executions.","4334":"The following topics provide more detail:","4335":"Request Structure","4336":"Request Parameters","4337":"Example Request","4338":"Response Structure","4339":"Request Structure","4340":"Request Parameters","4341":"Parameter","4342":"Description","4343":"The zero-based page number (optional)","4344":"The requested page size (optional)","4345":"The name associated with the job execution","4346":"Example Request","4347":"Response Structure","4349":"Job Execution Detail","4350":"The job executions endpoint lets you get the details about a job execution.","4351":"The following topics provide more detail:","4352":"Request Structure","4353":"Request Parameters","4354":"Example Request","4355":"Response Structure","4356":"Request Structure","4357":"Table 18. /jobs/executions/{id}","4358":"Parameter","4359":"Description","4360":"The id of an existing job execution (required)","4361":"Request Parameters","4362":"There are no request parameter for this endpoint.","4363":"Example Request","4364":"Response Structure","4366":"Stop Job Execution","4367":"The job executions endpoint lets you stop a job execution.","4368":"The following topics provide more detail:","4369":"Request structure","4370":"Request parameters","4371":"Example request","4372":"Response structure","4373":"Request structure","4374":"Table 19. /jobs/executions/{id}","4375":"Parameter","4376":"Description","4377":"The id of an existing job execution (required)","4378":"Request parameters","4379":"Parameter","4380":"Description","4381":"Sends signal to stop the job if set to true","4382":"Example request","4383":"Response structure","4385":"Restart Job Execution","4386":"The job executions endpoint lets you restart a job execution.","4387":"The following topics provide more detail:","4388":"Request Structure","4389":"Request Parameters","4390":"Example Request","4391":"Response Structure","4392":"Request Structure","4393":"Table 20. /jobs/executions/{id}","4394":"Parameter","4395":"Description","4396":"The id of an existing job execution (required)","4397":"Request Parameters","4398":"Parameter","4399":"Description","4400":"Sends signal to restart the job if set to true","4401":"Example Request","4402":"Response Structure","4404":"Job Instances","4405":"The job instances endpoint provides information about the job instances that are registered with the {0/} server.","4406":"The following topics provide more detail:","4407":"List All Job Instances","4408":"Job Instance Detail","4410":"List All Job Instances","4411":"The job instances endpoint lets you list all job instances.","4412":"The following topics provide more detail:","4413":"Request Structure","4414":"Request Parameters","4415":"Example Request","4416":"Response Structure","4417":"Request Structure","4418":"Request Parameters","4419":"Parameter","4420":"Description","4421":"The zero-based page number (optional)","4422":"The requested page size (optional)","4423":"The name associated with the job instance","4424":"Example Request","4425":"Response Structure","4427":"Job Instance Detail","4428":"The job instances endpoint lets you list all job instances.","4429":"The following topics provide more detail:","4430":"Request Structure","4431":"Request Parameters","4432":"Example Request","4433":"Response Structure","4434":"Request Structure","4435":"Table 21. /jobs/instances/{id}","4436":"Parameter","4437":"Description","4438":"The id of an existing job instance (required)","4439":"Request Parameters","4440":"There are no request parameters for this endpoint.","4441":"Example Request","4442":"Response Structure","4444":"Job Step Executions","4445":"The job step executions endpoint provides information about the job step executions that are registered with the {0/} server.","4446":"The following topics provide more detail:","4447":"List All Step Executions For a Job Execution","4448":"Job Step Execution Detail","4449":"Job Step Execution Progress","4451":"List All Step Executions For a Job Execution","4452":"The job step executions endpoint lets you list all job step executions.","4453":"The following topics provide more detail:","4454":"Request Structure","4455":"Request Parameters","4456":"Example Request","4457":"Response Structure","4458":"Request Structure","4459":"Request Parameters","4460":"Parameter","4461":"Description","4462":"The zero-based page number (optional)","4463":"The requested page size (optional)","4464":"Example Request","4465":"Response Structure","4467":"Job Step Execution Detail","4468":"The job step executions endpoint lets you get details about a job step execution.","4469":"The following topics provide more detail:","4470":"Request Structure","4471":"Request Parameters","4472":"Example Request","4473":"Response Structure","4474":"Request Structure","4475":"Table 22. /jobs/executions/{id}/steps/{stepid}","4476":"Parameter","4477":"Description","4478":"The id of an existing job execution (required)","4479":"The id of an existing step execution for a specific job execution (required)","4480":"Request Parameters","4481":"There are no request parameters for this endpoint.","4482":"Example Request","4483":"Response Structure","4485":"Job Step Execution Progress","4486":"The job step executions endpoint lets you get details about the progress of a job step execution.","4487":"The following topics provide more detail:","4488":"Request Structure","4489":"Request Parameters","4490":"Example Request","4491":"Response Structure","4492":"Request Structure","4493":"Table 23. /jobs/executions/{id}/steps/{stepid}/progress","4494":"Parameter","4495":"Description","4496":"The id of an existing job execution (required)","4497":"The id of an existing step execution for a specific job execution (required)","4498":"Request Parameters","4499":"There are no request parameters for this endpoint.","4500":"Example Request","4501":"Response Structure","4503":"Runtime Information about Applications","4504":"It is possible to get information about running apps known to the system, either globally or individually.","4505":"The following topics provide more detail:","4506":"Listing All Applications at Runtime","4507":"Querying All Instances of a Single App","4508":"Querying a Single Instance of a Single App","4510":"Listing All Applications at Runtime","4511":"To retrieve information about all instances of all apps, query the {1081/} endpoint by using {1082/}.","4512":"The following topics provide more detail:","4513":"Request Structure","4514":"Example Request","4515":"Response Structure","4516":"Request Structure","4517":"Example Request","4518":"Response Structure","4520":"Querying All Instances of a Single App","4521":"To retrieve information about all instances of a particular app, query the {1083/} endpoint by using {1084/}.","4522":"The following topics provide more detail:","4523":"Request Structure","4524":"Example Request","4525":"Response Structure","4526":"Request Structure","4527":"Example Request","4528":"Response Structure","4530":"Querying a Single Instance of a Single App","4531":"Finally, to retrieve information about a particular instance of a particular app, query the {1085/} endpoint by using {1086/}.","4532":"The following topics provide more detail:","4533":"Request Structure","4534":"Example Request","4535":"Response Structure","4536":"Request Structure","4537":"Example Request","4538":"Response Structure","4540":"Metrics for Stream Applications","4541":"This REST endpoint exposes metrics for stream applications.","4542":"It requires the Metrics Collector application to be running as a separate service.","4543":"If it is not running, this endpoint returns an empty response.","4544":"\nIn order to learn more about the Metrics Collector, please also refer to the “Monitoring Deployed Stream Applications” chapter.\n","4545":"The following topics provide more detail:","4546":"Request Structure","4547":"[api-guide-resources-metrics-stream-applications-example-request]","4548":"[api-guide-resources-metrics-stream-applications-response-structure]","4549":"[api-guide-resources-metrics-stream-applications-example-response]","4551":"Request Structure","4552":"For example, a typical request might resemble the following:","4554":"Example Request","4556":"Response Structure","4557":"This REST endpoint uses {23/} through the {1/} project under the covers to make a proxy HTTP request to the Metrics Collector.","4559":"Example Response","4560":"The endpoint does not generate an error when the Metrics Collector is not running.","4561":"Rather, it gracefully degrades and returns an empty response such as the following:","4562":"However, if metrics are being collected and the Metrics Collector is running, you should see a response similar to the listing below.","4563":"The metrics data returned in the listing below is based on the example stream definition created in the “ Monitoring Deployed Stream Applications ” chapter, where we created {1087/} with two instances of each application deployed.","4564":"Appendices","4565":"Having trouble with {0/}, We’d like to help!","4566":"Ask a question - we monitor stackoverflow.com for questions\ntagged with .","4567":"Report bugs with {0/} at github.com/spring-cloud/spring-cloud-dataflow/issues.","4568":"Appendix A: Data Flow Template","4569":"As described in the previous chapter, {0/}'s functionality is completely exposed through REST endpoints.","4570":"While you can use those endpoints directly, {0/} also provides a Java-based API, which makes using those REST endpoints even easier.","4571":"The central entry point is the {1088/} class in the {1089/} package.","4572":"This class implements the {1090/} interface and delegates to the following sub-templates that provide the specific functionality for each feature-set:","4573":"Interface","4574":"Description","4575":"REST client for stream operations","4576":"REST client for counter operations","4577":"REST client for field value counter operations","4578":"REST client for aggregate counter operations","4579":"REST client for task operations","4580":"REST client for job operations","4581":"REST client for app registry operations","4582":"REST client for completion operations","4583":"REST Client for runtime operations","4584":"When the {1091/} is being initialized, the sub-templates can be discovered through the REST relations, which are provided by HATEOAS.","4585":"[ 1 ]","4586":"If a resource cannot be resolved, the respective sub-template results in NULL.","4587":"A common cause is that {0/} offers for specific sets of features to be enabled/disabled when launching.","4588":"For more information, see “ Feature Toggles ”.","4590":"Using the Data Flow Template","4591":"When you use the Data Flow Template, the only needed Data Flow dependency is the\n{0/} Rest Client, as shown in the following Maven snippet:","4592":"With that dependency, you get the {1092/} class as well as all the dependencies needed to make calls to a {0/} server.","4593":"When instantiating the {1093/}, you also pass in a {1094/}.","4594":"Please be aware that the needed {1095/} requires some additional configuration to be valid in the context of the {1096/}.","4595":"When declaring a {1097/} as a bean, the following configuration suffices:","4596":"Now you can instantiate the {1098/} with the following code:","4597":"The {1099/} points to the ROOT of your {0/} Server.","4598":"Depending on your requirements, you can now make calls to the server.","4599":"For instance, if you want to get a list of currently available applications you can run the following code:","4600":"Appendix B: “How-to” guides","4601":"This section provides answers to some common ‘how do I do that…​’ type of questions that often arise when using {0/}.","4602":"If you are having a specific problem that we do not cover here, you might want to check out stackoverflow.com to see if someone has already provided an answer.","4603":"That is also a great place to ask new questions (please use the {1100/} tag).","4604":"We are also more than happy to extend this section.","4605":"If you want to add a “how-to”, you can send us a pull request .","4607":"Configure Maven {18/}","4608":"You can set the maven properties such as local maven repository location, remote maven repositories, authentication credentials, and proxy server properties through command line properties when starting the Data Flow server.","4609":"Alternatively, you can set the properites using {1101/} environment property for the Data Flow server.","4610":"The remote maven repositories need to be configured explicitly if the apps are resolved using maven repository, except for a {1102/} Data Flow server.","4611":"The other Data Flow server implementations (that use maven resources for app artifacts resolution) have no default value for remote repositories.","4612":"The {1103/} server has {1104/} as the default remote repository.","4613":"To pass the properties as commandline options, run the server with a command similar to the following:","4614":"You can also use the {1105/} environment property:","4615":"Here is the same content in nicely formatted JSON:","4616":"Depending on the {0/} server implementation, you may have to pass the environment properties by using the platform specific environment-setting capabilities.","4617":"For instance, in {11/}, you would pass them as {1106/}.","4619":"Logging","4620":"{0/} is built upon several {27/} projects, but ultimately the dataflow-server is a {16/} app, so the logging techniques that apply to any {16/} application are applicable here as well.","4621":"While troubleshooting, the two primary areas where enabling the DEBUG logs could be useful are","4622":"Deployment Logs","4623":"Application Logs","4625":"Deployment Logs","4626":"{0/} builds upon {14/} Deployer SPI, and the platform-specific dataflow server uses the respective SPI implementations .","4627":"Specifically, if we were to troubleshoot deployment specific issues, such as network errors, it would be useful to enable the DEBUG logs at the underlying deployer and the libraries used by it.","4628":"To enable DEBUG logs for the local-deployer, start the server as follows:","4629":"(where {1107/} is the global package for everything local-deployer\nrelated.)","4630":"To enable DEBUG logs for the cloudfoundry-deployer , set the following environment variable and, after restaging the dataflow server, you can see more logs around request and response and see detailed stack traces for failures.","4631":"The cloudfoundry deployer uses cf-java-client , so you must also enable DEBUG logs for this library.","4632":"(where {1108/} is the global package for everything {1109/} related.)","4633":"To review {24/} logs, which are used by the {1110/}, then the following commad would be helpful:","4634":"(where {1111/} is the global package for everything {1112/} related.)","4635":"Similar to the {1113/} and {1114/} options as discussed above, there are equivalent settings available for Kubernetes.","4636":"See the respective SPI implementations for more detail about the packages to configure for logging.","4638":"Application Logs","4639":"The streaming applications in {0/} are {3/} applications, which are in turn based on {16/}.","4640":"They can be independently setup with logging configurations.","4641":"For instance, if you must troubleshoot the {1115/} and {1116/} specifics that are being passed around source, processor, and sink channels, you should deploy the stream with the following options:","4642":"(where {1117/} is the global package for everything {6/} related,\nwhich is responsible for messaging channels.)","4643":"These properties can also be specified with {1118/} properties when deploying the stream, as follows:","4645":"Remote Debugging","4646":"The Data Flow local server lets you debug the deployed applications.","4647":"This is accomplished by enabling the remote debugging feature of the JVM through deployment properites, as shown in the following example:","4648":"The preceding example starts the {1119/} application in debug mode, allowing a remote debugger to be attached on port 9999. By default, the application starts in a 'suspend' mode and waits for the remote debug session to be attached (started).","4649":"Otherwise, you can provide an additional {1120/} property with value {1121/}.","4650":"Also, when there is more then one instance of the application, the debug port for each instance is the value of {1122/} + instanceId.","4651":"\nUnlike other properties you must NOT use a wildcard for the application name, since each application must use a unique debug port.\n","4653":"Log Redirect","4654":"Given that each application is a separate process that maintains its own set of logs, accessing individual logs could be a bit inconvenient, especially in the early stages of development, when logs are accessed more often.","4655":"Since it is also a common pattern to rely on a local SCDF Server that deploys each application as a local JVM process, you can redirect the stdout and stdin from the deployed applications to the parent process.","4656":"Thus, with a local SCDF Server, the application logs appear in the logs of the running local SCDF Server.","4657":"Typically when you deploy the stream, you see something resembling the following in the server logs:","4658":"However, by setting {1123/} as a deployment property, you can see the following:","4659":"After that, the application logs appear alongside the server logs, as shown in the following example:","4660":"The preceding stream definition enables log redirection for each application in the stream.","4661":"The following stream definition enables log redirection for only the application named 'my app'.","4662":"\nLog redirect is only supported with local-deployer.\n","4664":"Frequently Asked Questions","4665":"In this section, we review the frequently asked questions in {0/}.","4667":"Advanced {32/} Expressions","4668":"One of the powerful features of {32/} expressions is functions .","4669":"If the appropriate libraries are in the classpath, {6/} provides the {1124/} and {1125/} {32/}-functions .","4670":"All the provided {3/} application starters are have with the {1126/} and {1127/} in their uber-jar.","4671":"Consequently, we can use those {32/}-functions in {0/} streams whenever expressions are possible.","4672":"For example, we can transform JSON-aware {1128/} from the HTTP request by using a few {1129/} expressions, as follows:","4673":"In the preceding example, we apply {1130/} for the incoming payload to extract only the {1131/} field value.","4674":"Similar syntax can be used with {1132/} or {1133/} {1134/} options.","4675":"Actually, any available {32/}-based option has access to the built-in {32/}-functions.","4676":"For example, we can extract some value from JSON data to calculate the {1135/} before sending output to the {25/}, as follows:","4677":"The same syntax can be applied for {1136/} {32/}-function when you deal with XML data.","4678":"Any other custom {32/}-function can also be used.","4679":"However, for this purpose, you should build a library with a {1137/} class containing an appropriate {1138/} {1139/} definition.","4680":"The target {3/} application starter should be repackaged to supply such a custom extension with a built-in {16/} {1140/} mechanism or auto-configuration hook.","4682":"How to Use JDBC-sink?","4683":"The JDBC-sink can be used to insert message payload data into a relational database table.","4684":"By default, it inserts the entire payload into a table named after the {1141/} property.","4685":"If it is not set, by default, the application expects to use a table with a name of {1142/}.","4686":"To alter this behavior, the JDBC sink accepts several options that you can pass by using the --param=value notation in the stream or change globally.","4687":"The JDBC sink has a {1143/} property that, if set to {1144/}, results in the sink creating a table based on the specified configuration when it starts.","4688":"If that initialize property is {1145/}, which is the default, you must make sure that the table to use is already available.","4689":"A stream definition using {1146/} sink and relying on all defaults with MySQL as the backing database looks\nlike the following example:","4690":"In the preceding example, the system time is persisted in MySQL for every second.","4691":"For this to work, you must have the following table in the MySQL database:","4693":"How to Use Multiple Message-binders?","4694":"For situations where the data is consumed and processed between two different message brokers, {0/} provides easy-to-override global configurations, an out-of-the-box , and DSL primitives to build these type of topologies.","4695":"Assume that data is queueing up in {21/} (for example, queue = {1147/}) and the requirement is to consume all the payloads and publish them to {12/} (for example, topic = {1148/}), as the destination for downstream processing.","4696":"In that case, you should follow the global application of configurations to define multiple binder configurations, as shown in the following configuration","4697":"\nIn the preceding example, both message brokers are running locally and are reachable at {1149/} through their respective ports.\n","4698":"These properties can be supplied in a {1150/} file that is accessible to the server directly or through {1151/}, as follows:","4699":"{0/} internally uses {1152/} to directly connect different named channel destinations.","4700":"Since we are publishing and subscribing from two different messaging systems, you must build the {1153/} with both {21/} and {12/} binders in the classpath.","4701":"To do that, head over to start-scs.cfapps.io/ and select {1154/}, {1155/}, and {1156/} as the dependencies and follow the patching procedure described in the reference guide .","4702":"Specifically, for the {1157/}, you must import the {1158/} provided by the starter.","4703":"Once you have the necessary adjustments, you can build the application.","4704":"The following example registers the name of the application as {1159/}:","4705":"It is time to create a stream definition with the newly registered processor application, as follows:","4706":"\nSince we want to consume messages from {21/} (identified by {1160/}) and then publish the payload to {12/} (identified by {1161/}), we are supplying them as the {1162/} and {1163/} channel settings respectively.\n","4707":"\nThe stream consumes events from the {1164/} queue in {21/} and sends the data to the {1165/} topic in {12/}.\n","4708":"Appendix C: {27/} XD to SCDF","4709":"This appendix describes how to migrate from {27/} XD to {0/}, along with some tips and tricks that may be helpful.","4711":"Terminology Changes","4712":"The following table describes the changes in terminology from {27/} XD to {0/}:","4713":"Old","4714":"New","4716":"Modules to Applications","4717":"If you have custom {27/} XD modules, you need refactor them to use {3/} and {7/} annotations.","4718":"As part of that work, you need to update dependencies and build them as normal {16/} applications.","4720":"Custom Applications","4721":"As you convert custom applications, keep the following information in mind:","4722":"{27/} XD's stream and batch modules are refactored into the {3/} and {7/} application-starters, respectively.","4723":"These applications can be used as the reference while refactoring {27/} XD modules.","4724":"There are also some samples for {3/} and {7/} applications for reference.","4725":"If you want to create a brand new custom application, use the getting started guide for {3/} and {7/} applications and as well as review the develeopment guide.","4726":"Alternatively, if you want to patch any of the out-of-the-box stream applications, you can follow the procedure described here.","4728":"Application Registration","4729":"As you register your applications, keep the following information in mind:","4730":"Custom Stream/Task applications can be registered as {16/} uber-jar for {11/} or local implementations.","4731":"They can also be registerd as a docker image for Local, {11/}, or Kuberenetes implementations.","4732":"Other than Maven and docker resolution, you can also resolve application artifacts from {1166/} and {1167/} coordinates.","4733":"Unlike {27/} XD, you do not have to upload the application bits while registering custom applications anymore.","4734":"Instead, you need to register the application coordinates that are hosted in the Maven repository or by other means as discussed in the previous bullet.","4735":"By default, none of the out-of-the-box applications are preloaded.","4736":"It is intentionally designed to provide the flexibility to register apps as you find appropriate for the given use-case requirement.","4737":"Depending on the binder choice, you can manually add the appropriate binder dependency to build applications specific to that binder-type.","4738":"Alternatively, you can follow the {27/} Initializr procedure to create an application with binder embedded in it.","4740":"Application {18/}","4741":"As you modify your applications' properties, keep the following information in mind:","4742":"Counter-sink:","4743":"The peripheral {1168/} is not required in {0/}.","4744":"If you intend to use the {1169/}, then {1170/} is required, and you need to have your own running {1171/} cluster.","4745":"field-value-counter-sink:","4746":"The peripheral {1172/} is not required in {0/}.","4747":"If you intend to use the {1173/}, then {1174/} becomes required, and you need to have your own running {1175/} cluster.","4748":"Aggregate-counter-sink:","4749":"The peripheral {1176/} is not required in {0/}.","4750":"If you intend to use the {1177/}, then {1178/} becomes required, and you need to have your own running {1179/} cluster.","4752":"Message {35/} to {22/}","4753":"Terminology wise, in {0/}, the message bus implementation is commonly referred to as binders.","4755":"Message {35/}","4756":"Similar to {27/} XD, {0/} includes an abstraction that you can use to extend the binder interface.","4757":"By default, we take the opinionated view of {12/} and {21/} as the production-ready binders.","4758":"They are available as GA releases.","4761":"Selecting a binder requires providing the right binder dependency in the classpath.","4762":"If you choose {31/} as the binder, you need to register stream applications that are pre-built with {31/} binder in it.","4763":"If you to create a custom application with {31/} binder, you need add the following dependency in the classpath:","4764":"{3/} supports {12/} and {21/} .","4765":"All binder implementations are maintained and managed in their individual repositories.","4766":"Every Stream/Task application can be built with the binder implementation of your choice.","4767":"All the out-of-the-box applications are pre-built for both {31/} and {30/} and are readily available for use as Maven artifacts ( {3/} or {7/} ) or as Docker images ( {3/} or {7/} ).","4768":"Changing the binder requires selecting the right binder dependency .","4769":"Alternatively, you can download the pre-built application from this version of {27/} Initializr with the desired “binder-starter” dependency.","4771":"Named Channels","4772":"Fundamentally, all the messaging channels are backed by pub/sub semantics.","4773":"Unlike {27/} XD, the messaging channels are backed only by {1180/} or {1181/} and there is no representation of {1182/} in the new architecture.","4774":"{1183/} is no longer supported.","4775":"Instead, you can directly interact with named destinations .","4776":"{1184/} changes to {1185/}","4777":"For example, {1186/} changes to {1187/}.","4778":"“topic/queue” prefixes are not required to interact with named-channels.","4779":"For example, {1188/} changes to {1189/}.","4780":"For example, {1190/}.","4782":"Directed Graphs","4783":"If you build non-linear streams, you can take advantage of named destinations to build directed graphs.","4784":"Consider the following example from {27/} XD:","4785":"You can do the following in {0/}:","4787":"Batch to Tasks","4788":"A Task, by definition, is any application that does not run forever, and they end at some point.","4789":"Tasks include {13/} jobs.","4790":"Task applications can be used for on-demand use cases, such as database migration, machine learning, scheduled operations, and others.","4791":"With {7/} , you can build {13/} jobs as microservice applications.","4792":"{13/} jobs from {27/} XD are being refactored to {16/} applications, also known as {7/} applications.","4793":"Unlike {27/} XD, these tasks do not require explicit deployment.","4794":"Instead, a task is ready to be launched directly once the definition is declared.","4796":"Shell and DSL Command Changes","4797":"The following table shows the changes to shell and DSL commands:","4798":"Old Command","4799":"New Command","4801":"REST API Changes","4802":"The following table shows the changes to the REST API:","4803":"Old API","4804":"New API","4806":"UI (including Flo)","4807":"The Admin-UI is now named Dashboard.","4808":"The URI for accessing the Dashboard is changed from {1191/} to {1192/}.","4809":"Apps (a new view): Lists all the registered applications that are available for use.","4810":"This view includes details such as the URI and the properties supported by each application.","4811":"You can also register/unregister applications from this view.","4812":"Runtime (was Container): Container changes to Runtime.","4813":"The notion of {1193/} is gone, replaced by out-of-the-box applications running as autonomous {16/} applications.","4814":"The Runtime tab displays the applications running in the runtime platforms (implementations: Local, {11/}, or Kubernetes).","4815":"You can click on each application to review relevant details, such as where it is running, what resources it uses, and other details.","4816":"{27/} Flo is now an OSS product.","4817":"Flo for {0/}'s “Create Stream” is now the designer-tab in the Dashboard.","4818":"Tasks (a new view):","4819":"The “Modules” sub-tab is renamed to “Apps”.","4820":"The “Definitions” sub-tab lists all the task definitions, including {13/} jobs that are orchestrated as tasks.","4821":"The “Executions” sub-tab lists all the task execution details in a fashion similar to the listing of {27/} XD’s Job executions.","4823":"Architecture Components","4824":"{0/} comes with a significantly simplified architecture.","4825":"In fact, when compared with {27/} XD, you need fewer peripherals to use {0/}.","4828":"{20/} is not used in the new architecture.","4830":"RDBMS","4831":"{0/} uses an RDBMS instead of Redis for stream/task definitions, application registration, and for job repositories.","4832":"The default configuration uses an embedded H2 instance, but Oracle, DB2, SqlServer, MySQL/MariaDB, PostgreSQL, H2, and HSQLDB databases are supported.","4833":"To use Oracle, DB2, and SqlServer, you need to create your own Data Flow Server by using {27/} Initializr and add the appropriate JDBC driver dependency.","4835":"Redis","4836":"Running a Redis cluster is only required for analytics functionality.","4837":"Specifically, when you use the {1194/}, {1195/}, or {1196/} applications, you also need to have a running instance of Redis cluster.","4839":"Cluster Topology","4840":"{27/} XD's {1197/} and {1198/} server components are replaced by stream and task applications that are themselves running as autonomous {16/} applications.","4841":"The applications run natively on various platforms, including {11/} and Kubernetes.","4842":"You can develop, test, deploy, scale up or down, and interact with ({16/}) applications individually, and they can evolve in isolation.","4844":"Central Configuration","4845":"To support centralized and consistent management of an application's configuration properties, {4/} client libraries have been included in the {0/} server as well as the {3/} applications provided by the {3/} App Starters.","4846":"You can also pass common application properties to all streams when the Data Flow Server starts.","4848":"Distribution","4849":"{0/} is a {16/} application.","4850":"Depending on the platform of your choice, you can download the respective release uber jar and deploy or push it to the runtime platform ({11/} or Kubernetes).","4851":"For example, if you run {0/} on {11/}, you can download the {11/} server implementation and do a {1199/}, as explained in the {11/} Reference Guide .","4853":"Hadoop Distribution Compatibility","4854":"The {1200/} application builds upon {27/} Hadoop 2.4.0 release, so this application is compatible\nwith the following Hadoop distributions:","4855":"Cloudera: cdh5","4856":"Pivotal Hadoop: phd30","4857":"Hortonworks Hadoop: hdp24","4858":"Hortonworks Hadoop: hdp23","4859":"Vanilla Hadoop: hadoop26","4860":"Vanilla Hadoop: 2.7.x (default)","4862":"Use Case Comparison","4863":"The remainder of this appendix reviews some use cases to show the differences between {27/} XD and {0/}.","4865":"Use Case #1: Ticktock","4866":"This use case assumes that you have already downloaded both the XD and the SCDF distributions.","4867":"Description: Simple {1201/} example using local/singlenode.","4868":"The following table describes the differences:","4869":"{27/} XD","4872":"Use Case #2: Stream with Custom Module or Application","4873":"This use case assumes that you have already downloaded both the XD and the SCDF distributions.","4874":"Description: Stream with custom module or application.","4875":"The following table describes the differences:","4876":"{27/} XD","4879":"Use Case #3: Batch Job","4880":"This use case assumes that you have already downloaded both the XD and the SCDF distributions.","4881":"Description: batch-job.","4882":"{27/} XD","4884":"Appendix D: Building","4885":"To build the source, you need to install JDK 1.8.","4886":"The build uses the Maven wrapper so that you do not have to install a specific version of Maven.","4887":"To enable the tests for Redis, run the server before building.","4888":"More information on how to run Redis appears later in this appendix.","4889":"The main build command is as follows:","4890":"If you like, you can add '-DskipTests' to avoid running the tests.","4891":"You can also install Maven (>=3.3.3) yourself and run the {1202/} command in place of {1203/} in the examples below.","4892":"If you do that, you also might need to add {1204/} if your local Maven settings do not contain repository declarations for {27/} pre-release artifacts.","4893":"You might need to increase the amount of memory available to Maven by setting a {1205/} environment variable with a value similar to {1206/}.","4894":"We try to cover this in the {1207/} configuration, so, if you find you have to do it to make a build succeed, please raise a ticket to get the settings added to source control.","4896":"Documentation","4897":"There is a {1208/} profile that generates documentation.","4898":"You can build only the documentation by using the following command:","4900":"Working with the Code","4901":"If you do not have an IDE preference, we recommend that you use {27/} Tools Suite or Eclipse when working with the code.","4902":"We use the m2eclipse Eclipse plugin for Maven support.","4903":"Other IDEs and tools generally also work without issue.","4905":"Importing into Eclipse with m2eclipse","4906":"We recommend the m2eclipe eclipse plugin when working with Eclipse.","4907":"If you do not already have m2eclipse installed, it is available from the Eclipse marketplace.","4908":"Unfortunately, m2e does not yet support Maven 3.3.","4909":"Consequently, once the projects are imported into Eclipse, you also need to tell m2eclipse to use the {1209/} file for the projects.","4910":"If you do not do this, you may see many different errors related to the POMs in the projects.","4911":"To do so:","4912":"Open your Eclipse preferences.","4913":"Expand the Maven preferences.","4914":"Select User Settings.","4915":"In the User Settings field, click Browse and navigate to the {14/} project you imported.","4916":"Select the {1210/} file in that project.","4917":"Click Apply.","4918":"Click OK.","4919":"\nAlternatively, you can copy the repository settings from {14/}’s  file into your own {1211/}.\n","4921":"Importing into Eclipse without m2eclipse","4922":"If you prefer not to use m2eclipse, you can generate Eclipse project metadata by using the following command:","4923":"The generated Eclipse projects can be imported by selecting {1212/}\nfrom the {1213/} menu.","4924":"Appendix E: Contributing","4925":"{14/} is released under the non-restrictive Apache 2.0 license and follows a very standard Github development process, using Github tracker for issues and merging pull requests into master.","4926":"If you want to contribute even something trivial, please do not hesitate, but follow the guidelines below.","4928":"Sign the Contributor License Agreement","4929":"Before we accept a non-trivial patch or pull request, we need you to sign the contributor's agreement .","4930":"Signing the contributor's agreement does not grant anyone commit rights to the main repository, but it does mean that we can accept your contributions, and you will get an author credit if we do.","4931":"Active contributors might be asked to join the core team and be given the ability to merge pull requests.","4933":"Code Conventions and Housekeeping","4934":"None of the following guidelines is essential for a pull request, but they all help your fellow developers understand and work with your code.","4935":"They can also be added after the original pull request but before a merge.","4936":"Use the {8/} code format conventions.","4937":"If you use Eclipse, you can import formatter settings by using the {1214/} file from the {14/} Build project.","4938":"If using IntelliJ, you can use the Eclipse Code Formatter Plugin to import the same file.","4939":"Make sure all new {1215/} files have a simple Javadoc class comment with at least an {1216/} tag identifying you, and preferably at least a paragraph describing the class’s purpose.","4940":"Add the ASF license header comment to all new {1217/} files (to do so, copy from existing files in the project).","4941":"Add yourself as an {1218/} to the .java files that you modify substantially (more than cosmetic changes).","4942":"Add some Javadocs and, if you change the namespace, some XSD doc elements.","4943":"A few unit tests would help a lot as well.","4944":"Someone has to do it, and your fellow developers appreciate the effort.","4945":"If no one else uses your branch, rebase it against the current master (or other target branch in the main project).","4946":"When writing a commit message, follow these conventions .","4947":"If you fix an existing issue, add {1219/} (where XXXX is the issue number) at the end of the commit message.","4948":"1 .","4949":"HATEOAS stands for Hypermedia as the Engine of Application State","4950":"\nLast updated 2018-12-05 14:34:40 UTC\n"},"errors":{"960":{"5":"<code i=\"93\">/root/.m2/</code>","93":"<code i=\"93\">/root/.m2/</code>"}},"nouns":{"0":"Spring Cloud Data Flow","1":"Spring Cloud Netflix","2":"Spring Boot Actuator","3":"Spring Cloud Stream","4":"Spring Cloud Config","5":"spring-cloud-stream","6":"Spring Integration","7":"Spring Cloud Task","8":"Spring Framework","9":"Spring Security","10":"Spring HATEOAS","11":"Cloud Foundry","12":"Apache Kafka","13":"Spring Batch","14":"Spring Cloud","15":"spring cloud","16":"Spring Boot","17":"Spring Data","18":"Properties","19":"Repository","20":"ZooKeeper","21":"RabbitMQ","22":"Binders","23":"Hystrix","24":"Reactor","25":"Binder","26":"RxJava","27":"Spring","28":"Gitter","29":"Events","30":"Rabbit","31":"Kafka","32":"SpEL","33":"web","34":"Web","35":"Bus"},"name":"spring-cloud-dataflow","timestamp":1547107225154});</script></body></html>
